[0m20:10:40.558729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc9de81310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc9c7ab2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc9c7ab2e0>]}


============================== 20:10:40.564107 | 9ab8fa09-6460-47a7-bd74-d95dfd8a10c6 ==============================
[0m20:10:40.564107 [info ] [MainThread]: Running with dbt=1.5.7
[0m20:10:40.564656 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/includes/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/includes/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:10:40.593255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ab8fa09-6460-47a7-bd74-d95dfd8a10c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc9c7e3a90>]}
[0m20:10:40.594263 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-en_74y4s'
[0m20:10:40.594750 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:10:41.491719 [debug] [MainThread]: External call exception: HTTPSConnectionPool(host='hub.getdbt.com', port=443): Max retries exceeded with url: /api/v1/index.json (Caused by SSLError(SSLError(1, '[SSL: WRONG_VERSION_NUMBER] wrong version number (_ssl.c:1131)')))
[0m20:10:41.493301 [debug] [MainThread]: Retrying external call. Attempt: 0 Max attempts: 5
[0m20:10:42.495781 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:10:42.581138 [debug] [MainThread]: External call exception: HTTPSConnectionPool(host='hub.getdbt.com', port=443): Max retries exceeded with url: /api/v1/index.json (Caused by SSLError(SSLError(1, '[SSL: WRONG_VERSION_NUMBER] wrong version number (_ssl.c:1131)')))
[0m20:10:42.581530 [debug] [MainThread]: Retrying external call. Attempt: 1 Max attempts: 5
[0m20:10:43.582857 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:10:43.996665 [debug] [MainThread]: External call exception: HTTPSConnectionPool(host='hub.getdbt.com', port=443): Max retries exceeded with url: /api/v1/index.json (Caused by SSLError(SSLError(1, '[SSL: WRONG_VERSION_NUMBER] wrong version number (_ssl.c:1131)')))
[0m20:10:43.997244 [debug] [MainThread]: Retrying external call. Attempt: 2 Max attempts: 5
[0m20:10:44.999139 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:10:45.456930 [debug] [MainThread]: External call exception: HTTPSConnectionPool(host='hub.getdbt.com', port=443): Max retries exceeded with url: /api/v1/index.json (Caused by SSLError(SSLError(1, '[SSL: WRONG_VERSION_NUMBER] wrong version number (_ssl.c:1131)')))
[0m20:10:45.457817 [debug] [MainThread]: Retrying external call. Attempt: 3 Max attempts: 5
[0m20:10:46.459740 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:10:47.225505 [debug] [MainThread]: External call exception: HTTPSConnectionPool(host='hub.getdbt.com', port=443): Max retries exceeded with url: /api/v1/index.json (Caused by SSLError(SSLError(1, '[SSL: WRONG_VERSION_NUMBER] wrong version number (_ssl.c:1131)')))
[0m20:10:47.225885 [debug] [MainThread]: Retrying external call. Attempt: 4 Max attempts: 5
[0m20:10:48.227401 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:10:48.311165 [error] [MainThread]: Encountered an error:
External connection exception occurred: HTTPSConnectionPool(host='hub.getdbt.com', port=443): Max retries exceeded with url: /api/v1/index.json (Caused by SSLError(SSLError(1, '[SSL: WRONG_VERSION_NUMBER] wrong version number (_ssl.c:1131)')))
[0m20:10:48.311980 [debug] [MainThread]: Command `dbt deps` failed at 20:10:48.311871 after 7.76 seconds
[0m20:10:48.312316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc9de81310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efca0c6ce80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efca0c6ceb0>]}
[0m20:10:48.312732 [debug] [MainThread]: Flushing usage events
[0m20:20:22.134469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87a7484dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87a4d52160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87a4d521f0>]}


============================== 20:20:22.139650 | 42ebc266-fe54-464d-b659-59a42188f6e2 ==============================
[0m20:20:22.139650 [info ] [MainThread]: Running with dbt=1.6.5
[0m20:20:22.140300 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/includes/dbt', 'log_path': '/opt/airflow/includes/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m20:20:22.218319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42ebc266-fe54-464d-b659-59a42188f6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87a4e88e50>]}
[0m20:20:22.219199 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-o8dt6ah0'
[0m20:20:22.219684 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:20:22.501036 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:20:22.506390 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:20:22.650070 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:20:22.688484 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:20:23.296725 [info ] [MainThread]: Installed from version 1.1.1
[0m20:20:23.297173 [info ] [MainThread]: Up to date!
[0m20:20:23.297583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '42ebc266-fe54-464d-b659-59a42188f6e2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87a4d52190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87a4d52c70>]}
[0m20:20:23.298388 [debug] [MainThread]: Command `dbt deps` succeeded at 20:20:23.298281 after 1.17 seconds
[0m20:20:23.298772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87a7484dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87a9c21370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87a9d275b0>]}
[0m20:20:23.299173 [debug] [MainThread]: Flushing usage events
[0m20:21:22.008865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec4b839dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec4917b940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec4917b0a0>]}


============================== 20:21:22.013734 | cc07b040-9302-457b-81e4-d95089662e54 ==============================
[0m20:21:22.013734 [info ] [MainThread]: Running with dbt=1.6.5
[0m20:21:22.014314 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/includes/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:21:22.763120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc07b040-9302-457b-81e4-d95089662e54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec491af820>]}
[0m20:21:22.774713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc07b040-9302-457b-81e4-d95089662e54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec3143c700>]}
[0m20:21:22.775472 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m20:21:22.793208 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m20:21:22.793884 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:21:22.794307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cc07b040-9302-457b-81e4-d95089662e54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec314b7df0>]}
[0m20:21:23.942955 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.games
[0m20:21:23.948321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc07b040-9302-457b-81e4-d95089662e54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec3153a760>]}
[0m20:21:23.962169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc07b040-9302-457b-81e4-d95089662e54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec3153a9d0>]}
[0m20:21:23.962692 [info ] [MainThread]: Found 0 sources, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m20:21:23.963147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc07b040-9302-457b-81e4-d95089662e54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec3153abb0>]}
[0m20:21:23.964150 [info ] [MainThread]: 
[0m20:21:23.964545 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:21:23.965067 [debug] [MainThread]: Command end result
[0m20:21:23.975215 [debug] [MainThread]: Command `dbt run` succeeded at 20:21:23.975039 after 1.97 seconds
[0m20:21:23.975712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec4b839dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec314b79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec314de1f0>]}
[0m20:21:23.976168 [debug] [MainThread]: Flushing usage events
[0m20:25:55.685343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe43fc0e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe4196b970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe4196b070>]}


============================== 20:25:55.690484 | f37579e1-1912-4aa9-b647-8b7c2ddaaed2 ==============================
[0m20:25:55.690484 [info ] [MainThread]: Running with dbt=1.6.5
[0m20:25:55.691126 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/includes/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'send_anonymous_usage_stats': 'True'}
[0m20:25:56.303722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f37579e1-1912-4aa9-b647-8b7c2ddaaed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe4199f880>]}
[0m20:25:56.315214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f37579e1-1912-4aa9-b647-8b7c2ddaaed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe29d3ce80>]}
[0m20:25:56.316001 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m20:25:56.333909 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m20:25:56.420447 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:25:56.421100 [debug] [MainThread]: Partial parsing: added file: games://models/transform/dim_publishers.sql
[0m20:25:56.451361 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.games.dim_publishers' (models/transform/dim_publishers.sql) depends on a source named 'games.raw_games' which was not found
[0m20:25:56.452107 [debug] [MainThread]: Command `dbt run` failed at 20:25:56.451996 after 0.77 seconds
[0m20:25:56.452506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe43fc0e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe29b3aa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe29baaa30>]}
[0m20:25:56.452943 [debug] [MainThread]: Flushing usage events
[0m20:29:09.611291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f830674dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83040e98b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83040e98e0>]}


============================== 20:29:09.616143 | 8fe3b2db-b649-4991-9bf4-a76ffc0f7733 ==============================
[0m20:29:09.616143 [info ] [MainThread]: Running with dbt=1.6.5
[0m20:29:09.616704 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/includes/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/includes/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:29:10.178517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8fe3b2db-b649-4991-9bf4-a76ffc0f7733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83041567c0>]}
[0m20:29:10.189657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8fe3b2db-b649-4991-9bf4-a76ffc0f7733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82ec541b50>]}
[0m20:29:10.190320 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m20:29:10.206754 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m20:29:10.289980 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m20:29:10.290579 [debug] [MainThread]: Partial parsing: added file: games://models/sources/sources.yml
[0m20:29:10.290980 [debug] [MainThread]: Partial parsing: added file: games://models/transform/dim_publishers.sql
[0m20:29:10.351116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8fe3b2db-b649-4991-9bf4-a76ffc0f7733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82ec2f6ee0>]}
[0m20:29:10.364964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8fe3b2db-b649-4991-9bf4-a76ffc0f7733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82ec3f3580>]}
[0m20:29:10.365465 [info ] [MainThread]: Found 1 model, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m20:29:10.365891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fe3b2db-b649-4991-9bf4-a76ffc0f7733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82ec3f3490>]}
[0m20:29:10.367140 [info ] [MainThread]: 
[0m20:29:10.367925 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:29:10.368949 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m20:29:10.369402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:29:11.089081 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m20:29:11.091320 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:29:11.735582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fe3b2db-b649-4991-9bf4-a76ffc0f7733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82ec4e9eb0>]}
[0m20:29:11.739106 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:29:11.739868 [info ] [MainThread]: 
[0m20:29:11.746554 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m20:29:11.747168 [info ] [Thread-1  ]: 1 of 1 START sql table model games.dim_publishers .............................. [RUN]
[0m20:29:11.748106 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_publishers)
[0m20:29:11.748561 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m20:29:11.757907 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m20:29:11.758865 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 20:29:11.748907 => 20:29:11.758611
[0m20:29:11.759357 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m20:29:11.803011 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m20:29:11.803798 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:29:11.835503 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER () AS publishers_id,
    publishers_name
FROM
    publishers;
    );
  
[0m20:29:12.477628 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:8d1c40f9-5964-45d9-90e7-7d2efdab0d6d&page=queryresults
[0m20:29:12.479064 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [26:15]')
[0m20:29:12.860325 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:777b92bf-6ebe-4eb8-9ce6-2324b7fb5f91&page=queryresults
[0m20:29:12.863075 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:777b92bf-6ebe-4eb8-9ce6-2324b7fb5f91&page=queryresults
[0m20:29:12.863889 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 20:29:11.759708 => 20:29:12.863650
[0m20:29:12.867537 [debug] [Thread-1  ]: Database Error in model dim_publishers (models/transform/dim_publishers.sql)
  Syntax error: Expected ")" but got ";" at [26:15]
  compiled Code at target/run/games/models/transform/dim_publishers.sql
[0m20:29:12.868125 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fe3b2db-b649-4991-9bf4-a76ffc0f7733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82eb24b5e0>]}
[0m20:29:12.868785 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model games.dim_publishers ..................... [[31mERROR[0m in 1.12s]
[0m20:29:12.869461 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m20:29:12.870959 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:29:12.871343 [debug] [MainThread]: Connection 'model.games.dim_publishers' was properly closed.
[0m20:29:12.871725 [info ] [MainThread]: 
[0m20:29:12.872126 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.50 seconds (2.50s).
[0m20:29:12.872845 [debug] [MainThread]: Command end result
[0m20:29:12.882841 [info ] [MainThread]: 
[0m20:29:12.883371 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:29:12.883766 [info ] [MainThread]: 
[0m20:29:12.884204 [error] [MainThread]:   Database Error in model dim_publishers (models/transform/dim_publishers.sql)
  Syntax error: Expected ")" but got ";" at [26:15]
  compiled Code at target/run/games/models/transform/dim_publishers.sql
[0m20:29:12.884569 [info ] [MainThread]: 
[0m20:29:12.884966 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:29:12.885566 [debug] [MainThread]: Command `dbt run` failed at 20:29:12.885461 after 3.28 seconds
[0m20:29:12.885969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f830674dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82ec541790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8308574910>]}
[0m20:29:12.886389 [debug] [MainThread]: Flushing usage events
[0m20:29:50.952730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6439c13df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f643759a880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f643759a070>]}


============================== 20:29:50.957592 | e7811d1a-5da6-4b58-955e-4eb6ea038cee ==============================
[0m20:29:50.957592 [info ] [MainThread]: Running with dbt=1.6.5
[0m20:29:50.958230 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/includes/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:29:51.525410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7811d1a-5da6-4b58-955e-4eb6ea038cee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64375ca7c0>]}
[0m20:29:51.536449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7811d1a-5da6-4b58-955e-4eb6ea038cee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f641f9eeca0>]}
[0m20:29:51.537153 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m20:29:51.553503 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m20:29:51.638772 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:29:51.639421 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_publishers.sql
[0m20:29:51.680145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7811d1a-5da6-4b58-955e-4eb6ea038cee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f641f7e9760>]}
[0m20:29:51.694278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7811d1a-5da6-4b58-955e-4eb6ea038cee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f641f89c970>]}
[0m20:29:51.694777 [info ] [MainThread]: Found 1 model, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m20:29:51.695212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7811d1a-5da6-4b58-955e-4eb6ea038cee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f641f89c940>]}
[0m20:29:51.696404 [info ] [MainThread]: 
[0m20:29:51.697245 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:29:51.698297 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m20:29:51.698797 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:29:52.382373 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m20:29:52.384662 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:29:53.007424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7811d1a-5da6-4b58-955e-4eb6ea038cee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f641f7bf670>]}
[0m20:29:53.011108 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:29:53.013554 [info ] [MainThread]: 
[0m20:29:53.038481 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m20:29:53.039857 [info ] [Thread-1  ]: 1 of 1 START sql table model games.dim_publishers .............................. [RUN]
[0m20:29:53.041605 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_publishers)
[0m20:29:53.042584 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m20:29:53.055865 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m20:29:53.056794 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 20:29:53.043237 => 20:29:53.056502
[0m20:29:53.057310 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m20:29:53.099313 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m20:29:53.099996 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:29:53.131493 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER () AS publishers_id,
    publishers_name
FROM
    publishers
    );
  
[0m20:29:53.774341 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7fb428c0-cc30-46a7-b9b7-c1ac25b4e7df&page=queryresults
[0m20:29:53.779858 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "publishers" must be qualified with a dataset (e.g. dataset.table).')
[0m20:29:54.179450 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:8382e220-787c-4233-8c2b-27e254fe7f45&page=queryresults
[0m20:29:54.184072 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:8382e220-787c-4233-8c2b-27e254fe7f45&page=queryresults
[0m20:29:54.187382 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 20:29:53.057683 => 20:29:54.186366
[0m20:29:54.202392 [debug] [Thread-1  ]: Database Error in model dim_publishers (models/transform/dim_publishers.sql)
  Table "publishers" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/games/models/transform/dim_publishers.sql
[0m20:29:54.203237 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7811d1a-5da6-4b58-955e-4eb6ea038cee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f641e60c220>]}
[0m20:29:54.203943 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model games.dim_publishers ..................... [[31mERROR[0m in 1.16s]
[0m20:29:54.204721 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m20:29:54.206360 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:29:54.206770 [debug] [MainThread]: Connection 'model.games.dim_publishers' was properly closed.
[0m20:29:54.207184 [info ] [MainThread]: 
[0m20:29:54.207633 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.51 seconds (2.51s).
[0m20:29:54.208476 [debug] [MainThread]: Command end result
[0m20:29:54.220999 [info ] [MainThread]: 
[0m20:29:54.221516 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:29:54.221985 [info ] [MainThread]: 
[0m20:29:54.222386 [error] [MainThread]:   Database Error in model dim_publishers (models/transform/dim_publishers.sql)
  Table "publishers" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/games/models/transform/dim_publishers.sql
[0m20:29:54.222768 [info ] [MainThread]: 
[0m20:29:54.223214 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:29:54.223823 [debug] [MainThread]: Command `dbt run` failed at 20:29:54.223718 after 3.28 seconds
[0m20:29:54.224239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6439c13df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f641e5580a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f641e558af0>]}
[0m20:29:54.224679 [debug] [MainThread]: Flushing usage events
[0m20:30:13.209799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02a26bfd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02a00198b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02a0019880>]}


============================== 20:30:13.214737 | 3dddb72c-b98d-4018-9657-ae8ebdce9d06 ==============================
[0m20:30:13.214737 [info ] [MainThread]: Running with dbt=1.6.5
[0m20:30:13.215396 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/includes/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:30:13.778168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3dddb72c-b98d-4018-9657-ae8ebdce9d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02a00497f0>]}
[0m20:30:13.789209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3dddb72c-b98d-4018-9657-ae8ebdce9d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0288467c10>]}
[0m20:30:13.789861 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m20:30:13.806992 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m20:30:13.891909 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:30:13.892314 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:30:13.898495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3dddb72c-b98d-4018-9657-ae8ebdce9d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02882573a0>]}
[0m20:30:13.912844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3dddb72c-b98d-4018-9657-ae8ebdce9d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02883197f0>]}
[0m20:30:13.913342 [info ] [MainThread]: Found 1 model, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m20:30:13.913771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3dddb72c-b98d-4018-9657-ae8ebdce9d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0288316b80>]}
[0m20:30:13.915263 [info ] [MainThread]: 
[0m20:30:13.916020 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:30:13.917136 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m20:30:13.917629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:30:14.576359 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m20:30:14.578602 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:30:15.230659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3dddb72c-b98d-4018-9657-ae8ebdce9d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02a0049f40>]}
[0m20:30:15.234215 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:30:15.236210 [info ] [MainThread]: 
[0m20:30:15.264487 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m20:30:15.266411 [info ] [Thread-1  ]: 1 of 1 START sql table model games.dim_publishers .............................. [RUN]
[0m20:30:15.268903 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_publishers)
[0m20:30:15.270396 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m20:30:15.291854 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m20:30:15.293256 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 20:30:15.271426 => 20:30:15.292815
[0m20:30:15.294079 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m20:30:15.340333 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m20:30:15.341016 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:30:15.372763 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER () AS publishers_id,
    publishers_name
FROM
    publishers
    );
  
[0m20:30:16.258425 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c5eac56b-8420-4af2-bdb5-5924057faa71&page=queryresults
[0m20:30:16.261139 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "publishers" must be qualified with a dataset (e.g. dataset.table).')
[0m20:30:17.241841 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f02fa7e6-dadd-4fd0-9960-3ae60c94de5b&page=queryresults
[0m20:30:17.246495 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f02fa7e6-dadd-4fd0-9960-3ae60c94de5b&page=queryresults
[0m20:30:17.250029 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 20:30:15.294668 => 20:30:17.248968
[0m20:30:17.266223 [debug] [Thread-1  ]: Database Error in model dim_publishers (models/transform/dim_publishers.sql)
  Table "publishers" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/games/models/transform/dim_publishers.sql
[0m20:30:17.268676 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3dddb72c-b98d-4018-9657-ae8ebdce9d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02877f2e50>]}
[0m20:30:17.271408 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model games.dim_publishers ..................... [[31mERROR[0m in 2.00s]
[0m20:30:17.273574 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m20:30:17.278433 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:30:17.279482 [debug] [MainThread]: Connection 'model.games.dim_publishers' was properly closed.
[0m20:30:17.280421 [info ] [MainThread]: 
[0m20:30:17.281467 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.36 seconds (3.36s).
[0m20:30:17.282901 [debug] [MainThread]: Command end result
[0m20:30:17.303436 [info ] [MainThread]: 
[0m20:30:17.303959 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:30:17.304370 [info ] [MainThread]: 
[0m20:30:17.304800 [error] [MainThread]:   Database Error in model dim_publishers (models/transform/dim_publishers.sql)
  Table "publishers" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/games/models/transform/dim_publishers.sql
[0m20:30:17.305613 [info ] [MainThread]: 
[0m20:30:17.306057 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:30:17.306799 [debug] [MainThread]: Command `dbt run` failed at 20:30:17.306653 after 4.10 seconds
[0m20:30:17.307350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02a26bfd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02877d47c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02877d4ac0>]}
[0m20:30:17.308138 [debug] [MainThread]: Flushing usage events
[0m20:33:27.117876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f003f521e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f003cea4970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f003cea49a0>]}


============================== 20:33:27.122789 | c6c82ddf-b5fe-485a-a595-95ee2ed7cc6a ==============================
[0m20:33:27.122789 [info ] [MainThread]: Running with dbt=1.6.5
[0m20:33:27.123365 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/includes/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:33:27.706723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6c82ddf-b5fe-485a-a595-95ee2ed7cc6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f003ced8880>]}
[0m20:33:27.717777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6c82ddf-b5fe-485a-a595-95ee2ed7cc6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f002528ae80>]}
[0m20:33:27.718420 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m20:33:27.734919 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m20:33:27.818966 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:33:27.819610 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_publishers.sql
[0m20:33:27.860805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6c82ddf-b5fe-485a-a595-95ee2ed7cc6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00250fd820>]}
[0m20:33:27.875159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6c82ddf-b5fe-485a-a595-95ee2ed7cc6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00251b0a30>]}
[0m20:33:27.875658 [info ] [MainThread]: Found 1 model, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m20:33:27.876093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6c82ddf-b5fe-485a-a595-95ee2ed7cc6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00251b0a00>]}
[0m20:33:27.877286 [info ] [MainThread]: 
[0m20:33:27.878026 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:33:27.879046 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m20:33:27.879446 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:28.571172 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m20:33:28.573446 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:33:29.221790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6c82ddf-b5fe-485a-a595-95ee2ed7cc6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00252daa30>]}
[0m20:33:29.225341 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:33:29.225929 [info ] [MainThread]: 
[0m20:33:29.232658 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m20:33:29.233298 [info ] [Thread-1  ]: 1 of 1 START sql table model games.dim_publishers .............................. [RUN]
[0m20:33:29.234061 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_publishers)
[0m20:33:29.234520 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m20:33:29.243418 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m20:33:29.244220 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 20:33:29.234845 => 20:33:29.243985
[0m20:33:29.244685 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m20:33:29.286797 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m20:33:29.287534 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:33:29.321579 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER () AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m20:33:30.298122 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ea931c79-5d11-4c27-aeb5-49b5708afe26&page=queryresults
[0m20:33:33.774018 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 20:33:29.245008 => 20:33:33.773813
[0m20:33:33.774905 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6c82ddf-b5fe-485a-a595-95ee2ed7cc6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00240663a0>]}
[0m20:33:33.775533 [info ] [Thread-1  ]: 1 of 1 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.54s]
[0m20:33:33.776281 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m20:33:33.777672 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:33:33.778030 [debug] [MainThread]: Connection 'model.games.dim_publishers' was properly closed.
[0m20:33:33.778429 [info ] [MainThread]: 
[0m20:33:33.778840 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.90 seconds (5.90s).
[0m20:33:33.779550 [debug] [MainThread]: Command end result
[0m20:33:33.791896 [info ] [MainThread]: 
[0m20:33:33.792428 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:33:33.792835 [info ] [MainThread]: 
[0m20:33:33.793272 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:33:33.793851 [debug] [MainThread]: Command `dbt run` succeeded at 20:33:33.793747 after 6.68 seconds
[0m20:33:33.794248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f003f521e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00250e7190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00250e7250>]}
[0m20:33:33.794658 [debug] [MainThread]: Flushing usage events
[0m20:48:40.023255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1fc945e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1fa253940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1fa253910>]}


============================== 20:48:40.028246 | 2d71edfd-8f9d-475a-b274-8898dd81d8e0 ==============================
[0m20:48:40.028246 [info ] [MainThread]: Running with dbt=1.6.5
[0m20:48:40.028920 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/includes/dbt/logs', 'profiles_dir': '/opt/airflow/includes/dbt/', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:48:40.661502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d71edfd-8f9d-475a-b274-8898dd81d8e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1fa3078b0>]}
[0m20:48:40.672454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d71edfd-8f9d-475a-b274-8898dd81d8e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e26bde80>]}
[0m20:48:40.673234 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m20:48:40.689304 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m20:48:40.775836 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:48:40.776427 [debug] [MainThread]: Partial parsing: added file: games://models/transform/dim_developers.sql
[0m20:48:40.817260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d71edfd-8f9d-475a-b274-8898dd81d8e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e2527be0>]}
[0m20:48:40.831386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d71edfd-8f9d-475a-b274-8898dd81d8e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e25e0cd0>]}
[0m20:48:40.831898 [info ] [MainThread]: Found 2 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m20:48:40.832532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d71edfd-8f9d-475a-b274-8898dd81d8e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e25e0d60>]}
[0m20:48:40.833827 [info ] [MainThread]: 
[0m20:48:40.834582 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:48:40.835686 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m20:48:40.836157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:48:41.529153 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m20:48:41.531372 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:48:42.180398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d71edfd-8f9d-475a-b274-8898dd81d8e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1fa307f10>]}
[0m20:48:42.183630 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:48:42.184099 [info ] [MainThread]: 
[0m20:48:42.191094 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m20:48:42.191704 [info ] [Thread-1  ]: 1 of 2 START sql table model games.dim_developers .............................. [RUN]
[0m20:48:42.192489 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m20:48:42.192966 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m20:48:42.201362 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m20:48:42.202096 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 20:48:42.193266 => 20:48:42.201889
[0m20:48:42.202531 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m20:48:42.242866 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m20:48:42.243532 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:48:42.275429 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m20:48:43.240197 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:faf36704-cbd6-4883-acf3-0f5f2096e119&page=queryresults
[0m20:48:46.428093 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 20:48:42.202819 => 20:48:46.427888
[0m20:48:46.428919 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d71edfd-8f9d-475a-b274-8898dd81d8e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e1492a30>]}
[0m20:48:46.429539 [info ] [Thread-1  ]: 1 of 2 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.7k rows, 40.8 KiB processed)[0m in 4.24s]
[0m20:48:46.430249 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m20:48:46.430739 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m20:48:46.431279 [info ] [Thread-1  ]: 2 of 2 START sql table model games.dim_publishers .............................. [RUN]
[0m20:48:46.432150 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_publishers)
[0m20:48:46.432579 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m20:48:46.435599 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m20:48:46.436293 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 20:48:46.432897 => 20:48:46.436075
[0m20:48:46.436734 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m20:48:46.444061 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:48:47.063802 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m20:48:47.066848 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER () AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m20:48:47.666228 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ce59ac8d-9f87-43c9-97ea-1f9c74237d3e&page=queryresults
[0m20:48:51.055243 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 20:48:46.437022 => 20:48:51.054275
[0m20:48:51.058661 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d71edfd-8f9d-475a-b274-8898dd81d8e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e25da970>]}
[0m20:48:51.061518 [info ] [Thread-1  ]: 2 of 2 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.63s]
[0m20:48:51.064672 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m20:48:51.070997 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:48:51.072776 [debug] [MainThread]: Connection 'model.games.dim_publishers' was properly closed.
[0m20:48:51.074573 [info ] [MainThread]: 
[0m20:48:51.076918 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 10.24 seconds (10.24s).
[0m20:48:51.081264 [debug] [MainThread]: Command end result
[0m20:48:51.106204 [info ] [MainThread]: 
[0m20:48:51.106964 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:48:51.107602 [info ] [MainThread]: 
[0m20:48:51.108251 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:48:51.109213 [debug] [MainThread]: Command `dbt run` succeeded at 20:48:51.109041 after 11.09 seconds
[0m20:48:51.109827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1fc945e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e26bd130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e26fa700>]}
[0m20:48:51.110405 [debug] [MainThread]: Flushing usage events
[0m21:16:45.701388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb01af1bdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0188b2940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0188b2910>]}


============================== 21:16:45.706661 | 95e34a02-6e48-4176-94b3-776fbf31504b ==============================
[0m21:16:45.706661 [info ] [MainThread]: Running with dbt=1.6.5
[0m21:16:45.707252 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/includes/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:16:46.796883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95e34a02-6e48-4176-94b3-776fbf31504b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0188e6820>]}
[0m21:16:46.808003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95e34a02-6e48-4176-94b3-776fbf31504b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb000ca3e20>]}
[0m21:16:46.808992 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m21:16:46.826985 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m21:16:46.939377 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:16:46.940035 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_developers.sql
[0m21:16:46.981332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95e34a02-6e48-4176-94b3-776fbf31504b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb000b0dc40>]}
[0m21:16:46.995404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95e34a02-6e48-4176-94b3-776fbf31504b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb000bc0190>]}
[0m21:16:46.995902 [info ] [MainThread]: Found 2 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m21:16:46.996384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95e34a02-6e48-4176-94b3-776fbf31504b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb000bc01f0>]}
[0m21:16:46.997657 [info ] [MainThread]: 
[0m21:16:46.998421 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:16:46.999480 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m21:16:46.999894 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:16:47.735741 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m21:16:47.738342 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:16:48.360236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95e34a02-6e48-4176-94b3-776fbf31504b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb000c540a0>]}
[0m21:16:48.362953 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:16:48.363764 [info ] [MainThread]: 
[0m21:16:48.370688 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m21:16:48.371274 [info ] [Thread-1  ]: 1 of 2 START sql table model games.dim_developers .............................. [RUN]
[0m21:16:48.371981 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m21:16:48.372398 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m21:16:48.380811 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m21:16:48.381578 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 21:16:48.372727 => 21:16:48.381350
[0m21:16:48.381994 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m21:16:48.398339 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:16:49.122776 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m21:16:49.123574 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m21:16:49.736209 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:45a0fb76-389e-4c08-95b4-2aa4023ad4b9&page=queryresults
[0m21:16:53.133970 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 21:16:48.382289 => 21:16:53.133759
[0m21:16:53.134918 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95e34a02-6e48-4176-94b3-776fbf31504b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0002473d0>]}
[0m21:16:53.135582 [info ] [Thread-1  ]: 1 of 2 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.76s]
[0m21:16:53.136328 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m21:16:53.136893 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m21:16:53.137441 [info ] [Thread-1  ]: 2 of 2 START sql table model games.dim_publishers .............................. [RUN]
[0m21:16:53.138217 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_publishers)
[0m21:16:53.138795 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m21:16:53.142083 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m21:16:53.142878 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 21:16:53.139114 => 21:16:53.142636
[0m21:16:53.143323 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m21:16:53.150825 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:16:53.763623 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m21:16:53.765251 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER () AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m21:16:54.368423 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:4b8482aa-6ab2-42d8-ac1f-4b7a18e1476f&page=queryresults
[0m21:16:57.772805 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 21:16:53.143614 => 21:16:57.771800
[0m21:16:57.776178 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95e34a02-6e48-4176-94b3-776fbf31504b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb00023ff10>]}
[0m21:16:57.779167 [info ] [Thread-1  ]: 2 of 2 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.64s]
[0m21:16:57.782352 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m21:16:57.788765 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:16:57.790529 [debug] [MainThread]: Connection 'model.games.dim_publishers' was properly closed.
[0m21:16:57.792333 [info ] [MainThread]: 
[0m21:16:57.794377 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 10.79 seconds (10.79s).
[0m21:16:57.798639 [debug] [MainThread]: Command end result
[0m21:16:57.828666 [info ] [MainThread]: 
[0m21:16:57.829567 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:16:57.830221 [info ] [MainThread]: 
[0m21:16:57.830869 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:16:57.831814 [debug] [MainThread]: Command `dbt run` succeeded at 21:16:57.831640 after 12.14 seconds
[0m21:16:57.832464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb01af1bdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0188e6f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb000bb00d0>]}
[0m21:16:57.833149 [debug] [MainThread]: Flushing usage events
[0m21:29:15.323075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0e994dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0c324910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0c3240a0>]}


============================== 21:29:15.328429 | cc32fd53-ff50-4e76-aee8-a2c1aa39b8ff ==============================
[0m21:29:15.328429 [info ] [MainThread]: Running with dbt=1.6.5
[0m21:29:15.328979 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/includes/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:29:15.978208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc32fd53-ff50-4e76-aee8-a2c1aa39b8ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0c358820>]}
[0m21:29:15.989793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc32fd53-ff50-4e76-aee8-a2c1aa39b8ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ef470ae20>]}
[0m21:29:15.990574 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m21:29:16.009486 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m21:29:16.101073 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m21:29:16.101660 [debug] [MainThread]: Partial parsing: added file: games://models/transform/dim_platforms.sql
[0m21:29:16.102137 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_publishers.sql
[0m21:29:16.129843 [error] [MainThread]: Encountered an error:
Compilation Error in model dim_platforms (models/transform/dim_platforms.sql)
  expected token ':', got '}'
    line 6
      FROM {{{ source('games', 'raw_games') }}}
[0m21:29:16.130565 [debug] [MainThread]: Command `dbt run` failed at 21:29:16.130431 after 0.81 seconds
[0m21:29:16.131037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0e994dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ef4525220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ef4525160>]}
[0m21:29:16.131488 [debug] [MainThread]: Flushing usage events
[0m21:29:38.042344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74c915d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74a2e6910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74a2e68e0>]}


============================== 21:29:38.047271 | c9d80d79-06c2-43cc-8727-9eb9b03c8804 ==============================
[0m21:29:38.047271 [info ] [MainThread]: Running with dbt=1.6.5
[0m21:29:38.047805 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/includes/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'send_anonymous_usage_stats': 'True'}
[0m21:29:38.650464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9d80d79-06c2-43cc-8727-9eb9b03c8804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74a2978e0>]}
[0m21:29:38.661787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9d80d79-06c2-43cc-8727-9eb9b03c8804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd732701c10>]}
[0m21:29:38.662532 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m21:29:38.680242 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m21:29:38.769039 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m21:29:38.769640 [debug] [MainThread]: Partial parsing: added file: games://models/transform/dim_platforms.sql
[0m21:29:38.770120 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_publishers.sql
[0m21:29:38.817096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': 'c9d80d79-06c2-43cc-8727-9eb9b03c8804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd73249b0d0>]}
[0m21:29:38.832390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9d80d79-06c2-43cc-8727-9eb9b03c8804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd731c34190>]}
[0m21:29:38.847482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9d80d79-06c2-43cc-8727-9eb9b03c8804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7325aa370>]}
[0m21:29:38.848012 [info ] [MainThread]: Found 3 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m21:29:38.848428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9d80d79-06c2-43cc-8727-9eb9b03c8804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7325aa2e0>]}
[0m21:29:38.849823 [info ] [MainThread]: 
[0m21:29:38.850689 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:29:38.851912 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m21:29:38.852371 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:39.546364 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m21:29:39.546941 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:29:40.106799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9d80d79-06c2-43cc-8727-9eb9b03c8804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7326add00>]}
[0m21:29:40.107654 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:29:40.108189 [info ] [MainThread]: 
[0m21:29:40.114645 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m21:29:40.115225 [info ] [Thread-1  ]: 1 of 3 START sql table model games.dim_developers .............................. [RUN]
[0m21:29:40.115926 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m21:29:40.116347 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m21:29:40.129026 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m21:29:40.129826 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 21:29:40.116659 => 21:29:40.129584
[0m21:29:40.130280 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m21:29:40.147042 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:29:40.780251 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m21:29:40.781003 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m21:29:41.494715 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:99849c51-e88c-4f15-9884-f1208a0067fb&page=queryresults
[0m21:29:44.596366 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 21:29:40.130593 => 21:29:44.596144
[0m21:29:44.597278 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9d80d79-06c2-43cc-8727-9eb9b03c8804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd731391a00>]}
[0m21:29:44.597985 [info ] [Thread-1  ]: 1 of 3 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.48s]
[0m21:29:44.598703 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m21:29:44.599211 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m21:29:44.599848 [info ] [Thread-1  ]: 2 of 3 START sql table model games.dim_platforms ............................... [RUN]
[0m21:29:44.600622 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m21:29:44.601179 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m21:29:44.604883 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m21:29:44.605753 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 21:29:44.601558 => 21:29:44.605475
[0m21:29:44.606236 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m21:29:44.609807 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m21:29:44.610516 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:29:44.643516 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m21:29:45.488563 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:210aadbd-0ac8-4633-b970-fd242ec3042c&page=queryresults
[0m21:29:48.287528 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 21:29:44.606556 => 21:29:48.287315
[0m21:29:48.288320 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9d80d79-06c2-43cc-8727-9eb9b03c8804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd731327ca0>]}
[0m21:29:48.288957 [info ] [Thread-1  ]: 2 of 3 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 3.69s]
[0m21:29:48.289622 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m21:29:48.290153 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m21:29:48.290680 [info ] [Thread-1  ]: 3 of 3 START sql table model games.dim_publishers .............................. [RUN]
[0m21:29:48.291538 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_publishers)
[0m21:29:48.291974 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m21:29:48.299753 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m21:29:48.300546 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 21:29:48.292277 => 21:29:48.300308
[0m21:29:48.301036 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m21:29:48.304224 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:29:48.933793 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m21:29:48.934551 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m21:29:49.582166 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:25fa3374-3df5-4ebd-b4d4-3246f433cfa9&page=queryresults
[0m21:29:52.681474 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 21:29:48.301363 => 21:29:52.681243
[0m21:29:52.682441 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9d80d79-06c2-43cc-8727-9eb9b03c8804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd731391190>]}
[0m21:29:52.683149 [info ] [Thread-1  ]: 3 of 3 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.39s]
[0m21:29:52.683818 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m21:29:52.685388 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:29:52.685839 [debug] [MainThread]: Connection 'model.games.dim_publishers' was properly closed.
[0m21:29:52.686343 [info ] [MainThread]: 
[0m21:29:52.686827 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 13.84 seconds (13.84s).
[0m21:29:52.688003 [debug] [MainThread]: Command end result
[0m21:29:52.699622 [info ] [MainThread]: 
[0m21:29:52.700199 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:29:52.700700 [info ] [MainThread]: 
[0m21:29:52.701210 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:29:52.701891 [debug] [MainThread]: Command `dbt run` succeeded at 21:29:52.701772 after 14.67 seconds
[0m21:29:52.702333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74c915d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7326d7a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7326aa040>]}
[0m21:29:52.702801 [debug] [MainThread]: Flushing usage events
[0m22:57:10.717303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75c7cf5d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75c5689880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75c5689070>]}


============================== 22:57:10.723263 | 267fcd7d-e901-4c8f-8fea-264e8873b815 ==============================
[0m22:57:10.723263 [info ] [MainThread]: Running with dbt=1.6.5
[0m22:57:10.723793 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/includes/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:57:11.742371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '267fcd7d-e901-4c8f-8fea-264e8873b815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75c56b97f0>]}
[0m22:57:11.754561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '267fcd7d-e901-4c8f-8fea-264e8873b815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ada73df0>]}
[0m22:57:11.755403 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m22:57:11.775017 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m22:57:11.867621 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:57:11.868256 [debug] [MainThread]: Partial parsing: added file: games://models/transform/dim_release.sql
[0m22:57:11.919319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '267fcd7d-e901-4c8f-8fea-264e8873b815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ad8614c0>]}
[0m22:57:11.937194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '267fcd7d-e901-4c8f-8fea-264e8873b815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ad997970>]}
[0m22:57:11.937763 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m22:57:11.938248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '267fcd7d-e901-4c8f-8fea-264e8873b815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ad997670>]}
[0m22:57:11.940057 [info ] [MainThread]: 
[0m22:57:11.940960 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:57:11.942406 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m22:57:11.943038 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:57:12.646419 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m22:57:12.647125 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:57:13.280542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '267fcd7d-e901-4c8f-8fea-264e8873b815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ad985580>]}
[0m22:57:13.281448 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:57:13.281920 [info ] [MainThread]: 
[0m22:57:13.289191 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m22:57:13.289822 [info ] [Thread-1  ]: 1 of 4 START sql table model games.dim_developers .............................. [RUN]
[0m22:57:13.290810 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m22:57:13.291347 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m22:57:13.301180 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m22:57:13.302057 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 22:57:13.291766 => 22:57:13.301787
[0m22:57:13.302598 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m22:57:13.319410 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:57:13.979567 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m22:57:13.980388 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m22:57:14.642790 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ca6d15e7-c128-42cc-ba0e-f364df15c847&page=queryresults
[0m22:57:17.485231 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 22:57:13.302937 => 22:57:17.485006
[0m22:57:17.486085 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '267fcd7d-e901-4c8f-8fea-264e8873b815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ad00df40>]}
[0m22:57:17.486702 [info ] [Thread-1  ]: 1 of 4 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.20s]
[0m22:57:17.487404 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m22:57:17.487892 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m22:57:17.488411 [info ] [Thread-1  ]: 2 of 4 START sql table model games.dim_platforms ............................... [RUN]
[0m22:57:17.489395 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m22:57:17.490056 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m22:57:17.499348 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m22:57:17.500339 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 22:57:17.490522 => 22:57:17.500068
[0m22:57:17.500838 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m22:57:17.503917 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:57:18.132196 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m22:57:18.132925 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m22:57:18.779000 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:52e2c057-ed3c-412e-8a2e-a42f67b51645&page=queryresults
[0m22:57:21.865779 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 22:57:17.501183 => 22:57:21.865547
[0m22:57:21.866619 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '267fcd7d-e901-4c8f-8fea-264e8873b815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ad00dac0>]}
[0m22:57:21.867272 [info ] [Thread-1  ]: 2 of 4 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.38s]
[0m22:57:21.867930 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m22:57:21.868477 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m22:57:21.869221 [info ] [Thread-1  ]: 3 of 4 START sql table model games.dim_publishers .............................. [RUN]
[0m22:57:21.870087 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_publishers)
[0m22:57:21.870573 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m22:57:21.873940 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m22:57:21.874701 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 22:57:21.870875 => 22:57:21.874472
[0m22:57:21.875120 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m22:57:21.878036 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:57:22.475739 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m22:57:22.476479 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m22:57:23.077321 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e1420355-e5b5-4433-8372-e338e7532786&page=queryresults
[0m22:57:25.875990 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 22:57:21.875417 => 22:57:25.875775
[0m22:57:25.876897 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '267fcd7d-e901-4c8f-8fea-264e8873b815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ac64e790>]}
[0m22:57:25.877889 [info ] [Thread-1  ]: 3 of 4 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.01s]
[0m22:57:25.879435 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m22:57:25.880045 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m22:57:25.880646 [info ] [Thread-1  ]: 4 of 4 START sql table model games.dim_release ................................. [RUN]
[0m22:57:25.881335 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m22:57:25.881751 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m22:57:25.884887 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m22:57:25.885649 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 22:57:25.882049 => 22:57:25.885441
[0m22:57:25.886055 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m22:57:25.889699 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m22:57:25.890521 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:57:25.923523 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date,
        coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m22:57:26.535062 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d5f8ae57-5987-4845-a036-a32a31e86587&page=queryresults
[0m22:57:26.536225 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword AS at [24:23]')
[0m22:57:27.717984 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b777d48b-b545-42ef-b640-9670e68045c5&page=queryresults
[0m22:57:27.719245 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b777d48b-b545-42ef-b640-9670e68045c5&page=queryresults
[0m22:57:27.720124 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 22:57:25.886349 => 22:57:27.719854
[0m22:57:27.727671 [debug] [Thread-1  ]: Database Error in model dim_release (models/transform/dim_release.sql)
  Syntax error: Unexpected keyword AS at [24:23]
  compiled Code at target/run/games/models/transform/dim_release.sql
[0m22:57:27.728248 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '267fcd7d-e901-4c8f-8fea-264e8873b815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ac731340>]}
[0m22:57:27.728864 [error] [Thread-1  ]: 4 of 4 ERROR creating sql table model games.dim_release ........................ [[31mERROR[0m in 1.85s]
[0m22:57:27.729510 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m22:57:27.731080 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:57:27.731575 [debug] [MainThread]: Connection 'model.games.dim_release' was properly closed.
[0m22:57:27.732095 [info ] [MainThread]: 
[0m22:57:27.732575 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 15.79 seconds (15.79s).
[0m22:57:27.734141 [debug] [MainThread]: Command end result
[0m22:57:27.750834 [info ] [MainThread]: 
[0m22:57:27.751353 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:57:27.751798 [info ] [MainThread]: 
[0m22:57:27.752237 [error] [MainThread]:   Database Error in model dim_release (models/transform/dim_release.sql)
  Syntax error: Unexpected keyword AS at [24:23]
  compiled Code at target/run/games/models/transform/dim_release.sql
[0m22:57:27.752958 [info ] [MainThread]: 
[0m22:57:27.754091 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m22:57:27.754697 [debug] [MainThread]: Command `dbt run` failed at 22:57:27.754589 after 17.04 seconds
[0m22:57:27.755106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75c7cf5d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ac74fc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ac74f130>]}
[0m22:57:27.755519 [debug] [MainThread]: Flushing usage events
[0m22:59:15.364252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97780fbf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9775a809d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9775a80a00>]}


============================== 22:59:15.369558 | 9bf5fbdc-8c5b-46b2-b90a-71161bc17678 ==============================
[0m22:59:15.369558 [info ] [MainThread]: Running with dbt=1.6.5
[0m22:59:15.370072 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/includes/dbt/', 'log_path': '/opt/airflow/includes/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:59:16.056996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9bf5fbdc-8c5b-46b2-b90a-71161bc17678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9775aac940>]}
[0m22:59:16.069564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9bf5fbdc-8c5b-46b2-b90a-71161bc17678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f975de68ee0>]}
[0m22:59:16.070348 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m22:59:16.089089 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m22:59:16.189633 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:59:16.191548 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_release.sql
[0m22:59:16.243162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9bf5fbdc-8c5b-46b2-b90a-71161bc17678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f975dc5c670>]}
[0m22:59:16.259020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9bf5fbdc-8c5b-46b2-b90a-71161bc17678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f975dd7fa00>]}
[0m22:59:16.259567 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m22:59:16.260138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bf5fbdc-8c5b-46b2-b90a-71161bc17678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f975dd7f820>]}
[0m22:59:16.261559 [info ] [MainThread]: 
[0m22:59:16.262393 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:59:16.263751 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m22:59:16.264285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:59:16.904350 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m22:59:16.904876 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:59:17.477500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bf5fbdc-8c5b-46b2-b90a-71161bc17678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f975de92400>]}
[0m22:59:17.478330 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:59:17.478784 [info ] [MainThread]: 
[0m22:59:17.485323 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m22:59:17.485908 [info ] [Thread-1  ]: 1 of 4 START sql table model games.dim_developers .............................. [RUN]
[0m22:59:17.486614 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m22:59:17.487030 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m22:59:17.496014 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m22:59:17.496865 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 22:59:17.487332 => 22:59:17.496623
[0m22:59:17.497316 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m22:59:17.513995 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:59:18.161388 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m22:59:18.162214 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m22:59:18.783943 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a842a7e7-9b99-468d-8ed0-4cb0f7d6b956&page=queryresults
[0m22:59:21.344290 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 22:59:17.497618 => 22:59:21.344075
[0m22:59:21.345108 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bf5fbdc-8c5b-46b2-b90a-71161bc17678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f975d403fa0>]}
[0m22:59:21.345726 [info ] [Thread-1  ]: 1 of 4 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 3.86s]
[0m22:59:21.346482 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m22:59:21.347173 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m22:59:21.347812 [info ] [Thread-1  ]: 2 of 4 START sql table model games.dim_platforms ............................... [RUN]
[0m22:59:21.348779 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m22:59:21.349267 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m22:59:21.358539 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m22:59:21.359530 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 22:59:21.349579 => 22:59:21.359264
[0m22:59:21.360137 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m22:59:21.365560 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:59:21.969543 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m22:59:21.970537 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m22:59:22.597340 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:701d6175-1af2-4eae-a0c2-0e724e04ebb1&page=queryresults
[0m22:59:25.375994 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 22:59:21.360640 => 22:59:25.375755
[0m22:59:25.376948 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bf5fbdc-8c5b-46b2-b90a-71161bc17678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f975d403fa0>]}
[0m22:59:25.377672 [info ] [Thread-1  ]: 2 of 4 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.03s]
[0m22:59:25.378368 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m22:59:25.378854 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m22:59:25.379343 [info ] [Thread-1  ]: 3 of 4 START sql table model games.dim_publishers .............................. [RUN]
[0m22:59:25.380159 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_publishers)
[0m22:59:25.380616 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m22:59:25.383955 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m22:59:25.384677 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 22:59:25.380938 => 22:59:25.384450
[0m22:59:25.385130 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m22:59:25.387818 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:59:25.992730 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m22:59:25.993435 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m22:59:26.468031 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:cc764911-6749-476f-9b3d-c5d9c63d0b28&page=queryresults
[0m22:59:29.385580 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 22:59:25.385468 => 22:59:29.385370
[0m22:59:29.386329 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bf5fbdc-8c5b-46b2-b90a-71161bc17678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f975ca39070>]}
[0m22:59:29.386931 [info ] [Thread-1  ]: 3 of 4 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.01s]
[0m22:59:29.387596 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m22:59:29.388181 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m22:59:29.388836 [info ] [Thread-1  ]: 4 of 4 START sql table model games.dim_release ................................. [RUN]
[0m22:59:29.389594 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m22:59:29.390044 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m22:59:29.393521 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m22:59:29.394273 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 22:59:29.390350 => 22:59:29.394058
[0m22:59:29.394692 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m22:59:29.398105 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m22:59:29.398789 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:59:29.431552 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m22:59:30.049555 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:98beb5be-2b3b-4994-bea6-3b34d57e9366&page=queryresults
[0m22:59:30.050663 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword AS at [23:23]')
[0m22:59:30.539070 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:3289870f-d23b-4473-88f3-2fd6587d2c22&page=queryresults
[0m22:59:30.540233 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:3289870f-d23b-4473-88f3-2fd6587d2c22&page=queryresults
[0m22:59:30.540987 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 22:59:29.394991 => 22:59:30.540745
[0m22:59:30.544815 [debug] [Thread-1  ]: Database Error in model dim_release (models/transform/dim_release.sql)
  Syntax error: Unexpected keyword AS at [23:23]
  compiled Code at target/run/games/models/transform/dim_release.sql
[0m22:59:30.545419 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bf5fbdc-8c5b-46b2-b90a-71161bc17678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f975cb2b370>]}
[0m22:59:30.546097 [error] [Thread-1  ]: 4 of 4 ERROR creating sql table model games.dim_release ........................ [[31mERROR[0m in 1.16s]
[0m22:59:30.546750 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m22:59:30.548327 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:59:30.548754 [debug] [MainThread]: Connection 'model.games.dim_release' was properly closed.
[0m22:59:30.549148 [info ] [MainThread]: 
[0m22:59:30.549544 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 14.29 seconds (14.29s).
[0m22:59:30.550755 [debug] [MainThread]: Command end result
[0m22:59:30.566834 [info ] [MainThread]: 
[0m22:59:30.567438 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:59:30.567852 [info ] [MainThread]: 
[0m22:59:30.568240 [error] [MainThread]:   Database Error in model dim_release (models/transform/dim_release.sql)
  Syntax error: Unexpected keyword AS at [23:23]
  compiled Code at target/run/games/models/transform/dim_release.sql
[0m22:59:30.568645 [info ] [MainThread]: 
[0m22:59:30.569063 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m22:59:30.569713 [debug] [MainThread]: Command `dbt run` failed at 22:59:30.569584 after 15.21 seconds
[0m22:59:30.570164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97780fbf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f975cb46c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f975cb46160>]}
[0m22:59:30.570609 [debug] [MainThread]: Flushing usage events
[0m23:00:04.970175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efebbd37e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efeb96459d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efeb96459a0>]}


============================== 23:00:04.975862 | e29158ab-be2c-4a17-a12d-738e8fe044b3 ==============================
[0m23:00:04.975862 [info ] [MainThread]: Running with dbt=1.6.5
[0m23:00:04.976561 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/includes/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:00:05.590233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e29158ab-be2c-4a17-a12d-738e8fe044b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efeb96b38e0>]}
[0m23:00:05.601371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e29158ab-be2c-4a17-a12d-738e8fe044b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efea1ab3eb0>]}
[0m23:00:05.602022 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m23:00:05.618396 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m23:00:05.704281 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:00:05.704976 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_release.sql
[0m23:00:05.747898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e29158ab-be2c-4a17-a12d-738e8fe044b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efea191f3a0>]}
[0m23:00:05.829371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e29158ab-be2c-4a17-a12d-738e8fe044b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efea19d09d0>]}
[0m23:00:05.831088 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m23:00:05.832486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e29158ab-be2c-4a17-a12d-738e8fe044b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efea19d07f0>]}
[0m23:00:05.837216 [info ] [MainThread]: 
[0m23:00:05.839673 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:00:05.841257 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m23:00:05.841867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:00:06.537610 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m23:00:06.539752 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:00:07.197037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e29158ab-be2c-4a17-a12d-738e8fe044b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efea18add30>]}
[0m23:00:07.200560 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:00:07.202567 [info ] [MainThread]: 
[0m23:00:07.230073 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m23:00:07.231500 [info ] [Thread-1  ]: 1 of 4 START sql table model games.dim_developers .............................. [RUN]
[0m23:00:07.233451 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m23:00:07.234653 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m23:00:07.248816 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m23:00:07.252935 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 23:00:07.235452 => 23:00:07.252626
[0m23:00:07.253482 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m23:00:07.270944 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:00:07.927731 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m23:00:07.976700 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m23:00:08.610530 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:14650430-2da4-4d2f-bc98-a56a7f22e424&page=queryresults
[0m23:00:11.922596 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 23:00:07.253875 => 23:00:11.922378
[0m23:00:11.923489 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e29158ab-be2c-4a17-a12d-738e8fe044b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efea1053fa0>]}
[0m23:00:11.924173 [info ] [Thread-1  ]: 1 of 4 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.69s]
[0m23:00:11.924994 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m23:00:11.925599 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m23:00:11.926366 [info ] [Thread-1  ]: 2 of 4 START sql table model games.dim_platforms ............................... [RUN]
[0m23:00:11.927297 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m23:00:11.927854 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m23:00:11.937640 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m23:00:11.938736 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 23:00:11.928228 => 23:00:11.938442
[0m23:00:11.939290 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m23:00:11.942260 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:00:12.571469 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m23:00:12.572227 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m23:00:13.051211 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f0f50dbb-c2e2-428c-8338-59d0f21d6daf&page=queryresults
[0m23:00:15.880128 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 23:00:11.939682 => 23:00:15.879630
[0m23:00:15.882157 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e29158ab-be2c-4a17-a12d-738e8fe044b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efea10536d0>]}
[0m23:00:15.884454 [info ] [Thread-1  ]: 2 of 4 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 3.96s]
[0m23:00:15.885843 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m23:00:15.886679 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m23:00:15.888088 [info ] [Thread-1  ]: 3 of 4 START sql table model games.dim_publishers .............................. [RUN]
[0m23:00:15.889278 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_publishers)
[0m23:00:15.889932 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m23:00:15.894414 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m23:00:15.895384 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 23:00:15.890446 => 23:00:15.895109
[0m23:00:15.895990 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m23:00:15.900338 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:00:16.515537 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m23:00:16.528091 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m23:00:17.135641 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b9d84b3d-732c-488b-b0fa-e67613f472a8&page=queryresults
[0m23:00:20.607475 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 23:00:15.896466 => 23:00:20.606492
[0m23:00:20.610936 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e29158ab-be2c-4a17-a12d-738e8fe044b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efea10537c0>]}
[0m23:00:20.613808 [info ] [Thread-1  ]: 3 of 4 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.72s]
[0m23:00:20.617017 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m23:00:20.619318 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m23:00:20.622014 [info ] [Thread-1  ]: 4 of 4 START sql table model games.dim_release ................................. [RUN]
[0m23:00:20.625268 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m23:00:20.626800 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m23:00:20.635714 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m23:00:20.639110 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 23:00:20.628069 => 23:00:20.638565
[0m23:00:20.640023 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m23:00:20.646067 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m23:00:20.647618 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:00:20.682589 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m23:00:21.572478 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:79f8226e-7c12-48dc-a885-92c92eac3d12&page=queryresults
[0m23:00:23.966262 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 23:00:20.640672 => 23:00:23.965293
[0m23:00:23.969811 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e29158ab-be2c-4a17-a12d-738e8fe044b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efea068ac70>]}
[0m23:00:23.972684 [info ] [Thread-1  ]: 4 of 4 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 3.35s]
[0m23:00:23.975849 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m23:00:23.982158 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:00:23.989278 [debug] [MainThread]: Connection 'model.games.dim_release' was properly closed.
[0m23:00:23.991903 [info ] [MainThread]: 
[0m23:00:23.994525 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 18.15 seconds (18.15s).
[0m23:00:24.000623 [debug] [MainThread]: Command end result
[0m23:00:24.145084 [info ] [MainThread]: 
[0m23:00:24.163855 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:00:24.267940 [info ] [MainThread]: 
[0m23:00:24.270087 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m23:00:24.272877 [debug] [MainThread]: Command `dbt run` succeeded at 23:00:24.272343 after 19.31 seconds
[0m23:00:24.274758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efebbd37e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efea1b21490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efea07e0640>]}
[0m23:00:24.276763 [debug] [MainThread]: Flushing usage events
[0m23:06:47.694045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69efee7f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69ed86ca00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69ed86c9d0>]}


============================== 23:06:47.699691 | a5cae857-9b55-4a60-a04d-0245967b4e90 ==============================
[0m23:06:47.699691 [info ] [MainThread]: Running with dbt=1.6.5
[0m23:06:47.700247 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'log_path': '/opt/airflow/includes/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:06:48.506335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5cae857-9b55-4a60-a04d-0245967b4e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69ed898940>]}
[0m23:06:48.517958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5cae857-9b55-4a60-a04d-0245967b4e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69d5c55ee0>]}
[0m23:06:48.518697 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m23:06:48.536208 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m23:06:48.637067 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:06:48.637635 [debug] [MainThread]: Partial parsing: added file: games://models/transform/dim_support_language.sql
[0m23:06:48.683011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5cae857-9b55-4a60-a04d-0245967b4e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69d5a46a00>]}
[0m23:06:48.698466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5cae857-9b55-4a60-a04d-0245967b4e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69d5b76ee0>]}
[0m23:06:48.699013 [info ] [MainThread]: Found 5 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m23:06:48.699456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5cae857-9b55-4a60-a04d-0245967b4e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69d5b76be0>]}
[0m23:06:48.701070 [info ] [MainThread]: 
[0m23:06:48.701889 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:06:48.703264 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m23:06:48.703662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:06:49.404087 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m23:06:49.404664 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:06:49.987576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5cae857-9b55-4a60-a04d-0245967b4e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69d5a96eb0>]}
[0m23:06:49.988396 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:06:49.988860 [info ] [MainThread]: 
[0m23:06:49.996000 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m23:06:49.996610 [info ] [Thread-1  ]: 1 of 5 START sql table model games.dim_developers .............................. [RUN]
[0m23:06:49.997369 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m23:06:49.997791 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m23:06:50.006718 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m23:06:50.007701 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 23:06:49.998128 => 23:06:50.007442
[0m23:06:50.008237 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m23:06:50.025244 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:06:50.669042 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m23:06:50.669850 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m23:06:51.319934 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ccdcbdb7-7326-4323-8a54-53d1d7259907&page=queryresults
[0m23:06:54.126895 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 23:06:50.008543 => 23:06:54.126669
[0m23:06:54.127749 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5cae857-9b55-4a60-a04d-0245967b4e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69d51ff5e0>]}
[0m23:06:54.128437 [info ] [Thread-1  ]: 1 of 5 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.13s]
[0m23:06:54.129187 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m23:06:54.129669 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m23:06:54.130157 [info ] [Thread-1  ]: 2 of 5 START sql table model games.dim_platforms ............................... [RUN]
[0m23:06:54.130954 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m23:06:54.131374 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m23:06:54.140398 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m23:06:54.141243 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 23:06:54.131674 => 23:06:54.140981
[0m23:06:54.141731 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m23:06:54.144300 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:06:54.736674 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m23:06:54.737510 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m23:06:55.198411 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b938a1d3-ad49-4e22-a7dd-bb03823242fb&page=queryresults
[0m23:06:58.656884 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 23:06:54.142048 => 23:06:58.656669
[0m23:06:58.657628 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5cae857-9b55-4a60-a04d-0245967b4e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69d51f4af0>]}
[0m23:06:58.658265 [info ] [Thread-1  ]: 2 of 5 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.53s]
[0m23:06:58.659184 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m23:06:58.659760 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m23:06:58.660453 [info ] [Thread-1  ]: 3 of 5 START sql table model games.dim_publishers .............................. [RUN]
[0m23:06:58.661265 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_publishers)
[0m23:06:58.661718 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m23:06:58.665145 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m23:06:58.665886 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 23:06:58.662017 => 23:06:58.665671
[0m23:06:58.666304 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m23:06:58.668935 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:06:59.276159 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m23:06:59.276922 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m23:06:59.877565 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d2ac9b9e-9eaf-479f-8c99-6bd82f426268&page=queryresults
[0m23:07:03.003723 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 23:06:58.666602 => 23:07:03.003511
[0m23:07:03.004474 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5cae857-9b55-4a60-a04d-0245967b4e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69d4811ca0>]}
[0m23:07:03.005105 [info ] [Thread-1  ]: 3 of 5 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.34s]
[0m23:07:03.005934 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m23:07:03.006440 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m23:07:03.007026 [info ] [Thread-1  ]: 4 of 5 START sql table model games.dim_release ................................. [RUN]
[0m23:07:03.007792 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m23:07:03.008219 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m23:07:03.011503 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m23:07:03.012202 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 23:07:03.008538 => 23:07:03.011987
[0m23:07:03.012634 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m23:07:03.015417 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:07:03.624662 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m23:07:03.625733 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m23:07:04.243387 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:37a0ada6-cfc7-4667-bfdc-5c32941bc75c&page=queryresults
[0m23:07:07.410755 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 23:07:03.012937 => 23:07:07.410539
[0m23:07:07.411517 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5cae857-9b55-4a60-a04d-0245967b4e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69d48337f0>]}
[0m23:07:07.412128 [info ] [Thread-1  ]: 4 of 5 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.40s]
[0m23:07:07.412795 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m23:07:07.413277 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m23:07:07.413766 [info ] [Thread-1  ]: 5 of 5 START sql table model games.dim_support_language ........................ [RUN]
[0m23:07:07.414544 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m23:07:07.414979 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m23:07:07.418422 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m23:07:07.419143 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 23:07:07.415289 => 23:07:07.418914
[0m23:07:07.419583 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m23:07:07.423043 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m23:07:07.423652 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:07:07.457705 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m23:07:08.159765 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:26b2fdce-4849-40f7-a490-f0586376198d&page=queryresults
[0m23:07:10.996029 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 23:07:07.419894 => 23:07:10.995813
[0m23:07:10.996864 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5cae857-9b55-4a60-a04d-0245967b4e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69d49165e0>]}
[0m23:07:10.997533 [info ] [Thread-1  ]: 5 of 5 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 3.58s]
[0m23:07:10.998330 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m23:07:10.999783 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:07:11.000168 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m23:07:11.000560 [info ] [MainThread]: 
[0m23:07:11.000969 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 22.30 seconds (22.30s).
[0m23:07:11.002310 [debug] [MainThread]: Command end result
[0m23:07:11.011548 [info ] [MainThread]: 
[0m23:07:11.012041 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:07:11.012427 [info ] [MainThread]: 
[0m23:07:11.015727 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m23:07:11.016378 [debug] [MainThread]: Command `dbt run` succeeded at 23:07:11.016270 after 23.33 seconds
[0m23:07:11.016801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69efee7f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69d51e4fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69d5c552b0>]}
[0m23:07:11.017217 [debug] [MainThread]: Flushing usage events
[0m23:27:44.201789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01f7a44dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01f5359880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01f53598b0>]}


============================== 23:27:44.206911 | 7c25f518-8747-4344-8d19-67251ea6403b ==============================
[0m23:27:44.206911 [info ] [MainThread]: Running with dbt=1.6.5
[0m23:27:44.207495 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/includes/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:27:44.950019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c25f518-8747-4344-8d19-67251ea6403b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01f5446790>]}
[0m23:27:44.962808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c25f518-8747-4344-8d19-67251ea6403b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01dd831d30>]}
[0m23:27:44.963613 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m23:27:44.982174 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m23:27:45.080938 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:27:45.081606 [debug] [MainThread]: Partial parsing: added file: games://models/transform/dim_price_overview.sql
[0m23:27:45.226285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c25f518-8747-4344-8d19-67251ea6403b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01dd5b7d30>]}
[0m23:27:45.243973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c25f518-8747-4344-8d19-67251ea6403b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01dd6e3e50>]}
[0m23:27:45.244533 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m23:27:45.244973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c25f518-8747-4344-8d19-67251ea6403b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01dd6e3eb0>]}
[0m23:27:45.246552 [info ] [MainThread]: 
[0m23:27:45.247402 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:27:45.249022 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m23:27:45.249655 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:27:45.937802 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m23:27:45.938362 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:27:46.598731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c25f518-8747-4344-8d19-67251ea6403b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01dd7dd0d0>]}
[0m23:27:46.599547 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:27:46.600006 [info ] [MainThread]: 
[0m23:27:46.606922 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m23:27:46.607572 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m23:27:46.608410 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m23:27:46.608872 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m23:27:46.617769 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m23:27:46.618583 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 23:27:46.609168 => 23:27:46.618324
[0m23:27:46.619065 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m23:27:46.635192 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:27:47.300588 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m23:27:47.301439 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m23:27:47.909773 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:09040a08-703f-4b98-9a45-caa8be39e692&page=queryresults
[0m23:27:50.471962 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 23:27:46.619382 => 23:27:50.471738
[0m23:27:50.472911 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c25f518-8747-4344-8d19-67251ea6403b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01dcd6d820>]}
[0m23:27:50.473613 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 3.86s]
[0m23:27:50.474645 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m23:27:50.475204 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m23:27:50.476402 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m23:27:50.478429 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m23:27:50.478947 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m23:27:50.489142 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m23:27:50.490069 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 23:27:50.479257 => 23:27:50.489791
[0m23:27:50.490549 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m23:27:50.493220 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:27:51.109419 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m23:27:51.110226 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m23:27:51.604756 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:eadc2a92-b7f6-48bc-a423-300303f7127d&page=queryresults
[0m23:27:54.593557 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 23:27:50.490860 => 23:27:54.593341
[0m23:27:54.594363 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c25f518-8747-4344-8d19-67251ea6403b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01dc3a7fd0>]}
[0m23:27:54.595029 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.12s]
[0m23:27:54.595761 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m23:27:54.596293 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m23:27:54.597009 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m23:27:54.598037 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m23:27:54.598525 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m23:27:54.602042 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m23:27:54.602766 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 23:27:54.598831 => 23:27:54.602554
[0m23:27:54.603178 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m23:27:54.606985 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m23:27:54.607659 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:27:54.640566 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

WITH price_overview_cte AS (
    SELECT
         currency,
         initial_price,
         final_price,
         formatted_initial_price,
         formatted_final_price,
         (discount_percent / 100) AS discount_pct,
         (initial_price - final_price) AS discount_amount,
         final_price AS price_with_discount,
         initial_price AS price_original,
         (final_price / (1 + 0.75)) AS price_with_tax
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    *
FROM
    price_overview_cte
    );
  
[0m23:27:55.575219 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:01412698-25c9-48ec-9750-3dd6d8c88bcb&page=queryresults
[0m23:27:58.355893 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 23:27:54.603472 => 23:27:58.355679
[0m23:27:58.356763 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c25f518-8747-4344-8d19-67251ea6403b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01dd6139a0>]}
[0m23:27:58.357548 [info ] [Thread-1  ]: 3 of 6 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (2.7k rows, 98.5 KiB processed)[0m in 3.76s]
[0m23:27:58.358322 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m23:27:58.358820 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m23:27:58.359426 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m23:27:58.360126 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m23:27:58.360544 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m23:27:58.363944 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m23:27:58.364683 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 23:27:58.360854 => 23:27:58.364464
[0m23:27:58.365096 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m23:27:58.368036 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:27:58.988479 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m23:27:58.989318 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m23:27:59.602022 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7e5c64b1-7528-4038-804c-f4f793395682&page=queryresults
[0m23:28:02.784278 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 23:27:58.365390 => 23:28:02.783283
[0m23:28:02.787578 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c25f518-8747-4344-8d19-67251ea6403b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01dd613f40>]}
[0m23:28:02.790404 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.43s]
[0m23:28:02.792601 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m23:28:02.794005 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m23:28:02.795426 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m23:28:02.797292 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m23:28:02.798594 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m23:28:02.805314 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m23:28:02.806513 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 23:28:02.799340 => 23:28:02.806147
[0m23:28:02.807140 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m23:28:02.811396 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:28:03.477515 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m23:28:03.478446 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m23:28:04.088455 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:669550cd-0e2d-49b4-8994-962e612ac28f&page=queryresults
[0m23:28:06.907586 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 23:28:02.807611 => 23:28:06.907376
[0m23:28:06.908361 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c25f518-8747-4344-8d19-67251ea6403b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01dc4f02b0>]}
[0m23:28:06.908985 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.11s]
[0m23:28:06.909703 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m23:28:06.910207 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m23:28:06.910836 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m23:28:06.911569 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m23:28:06.912021 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m23:28:06.915694 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m23:28:06.916447 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 23:28:06.912330 => 23:28:06.916231
[0m23:28:06.916874 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m23:28:06.919547 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:28:07.580814 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m23:28:07.581552 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m23:28:08.295774 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ffd4e202-06f6-4801-8bae-aceedf376472&page=queryresults
[0m23:28:11.382511 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 23:28:06.917170 => 23:28:11.382303
[0m23:28:11.383299 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c25f518-8747-4344-8d19-67251ea6403b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01dc38d5b0>]}
[0m23:28:11.383981 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.47s]
[0m23:28:11.385115 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m23:28:11.387020 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:28:11.387560 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m23:28:11.388041 [info ] [MainThread]: 
[0m23:28:11.388533 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 26.14 seconds (26.14s).
[0m23:28:11.390725 [debug] [MainThread]: Command end result
[0m23:28:11.406575 [info ] [MainThread]: 
[0m23:28:11.407084 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:28:11.407514 [info ] [MainThread]: 
[0m23:28:11.407975 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m23:28:11.408583 [debug] [MainThread]: Command `dbt run` succeeded at 23:28:11.408476 after 27.21 seconds
[0m23:28:11.408991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01f7a44dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01dd6e3f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01dd6e3130>]}
[0m23:28:11.409406 [debug] [MainThread]: Flushing usage events
[0m23:33:53.861338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc1f359e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc1cc9b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc1cc9b940>]}


============================== 23:33:53.866189 | 825afdbe-f060-448b-bf1a-aa71f44b4e10 ==============================
[0m23:33:53.866189 [info ] [MainThread]: Running with dbt=1.6.5
[0m23:33:53.866765 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/includes/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:33:54.427762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '825afdbe-f060-448b-bf1a-aa71f44b4e10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc1cd0d880>]}
[0m23:33:54.438999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '825afdbe-f060-448b-bf1a-aa71f44b4e10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0509be20>]}
[0m23:33:54.439682 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m23:33:54.455945 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m23:33:54.541858 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:33:54.542486 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m23:33:54.584389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '825afdbe-f060-448b-bf1a-aa71f44b4e10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc04ef5e80>]}
[0m23:33:54.599115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '825afdbe-f060-448b-bf1a-aa71f44b4e10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc04fa6280>]}
[0m23:33:54.599620 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m23:33:54.600025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '825afdbe-f060-448b-bf1a-aa71f44b4e10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc04fa60d0>]}
[0m23:33:54.601535 [info ] [MainThread]: 
[0m23:33:54.602357 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:33:54.603624 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m23:33:54.604066 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:33:55.303404 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m23:33:55.305623 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:33:55.971726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '825afdbe-f060-448b-bf1a-aa71f44b4e10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc050b4190>]}
[0m23:33:55.972547 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:33:55.973070 [info ] [MainThread]: 
[0m23:33:55.979622 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m23:33:55.980228 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m23:33:55.980957 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m23:33:55.981404 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m23:33:55.990543 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m23:33:55.991374 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 23:33:55.981705 => 23:33:55.991133
[0m23:33:55.991826 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m23:33:56.008166 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:33:56.721298 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m23:33:56.722093 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m23:33:57.378847 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f17da6c1-1801-4b91-a04d-68fad330d896&page=queryresults
[0m23:34:00.535915 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 23:33:55.992149 => 23:34:00.535617
[0m23:34:00.537026 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '825afdbe-f060-448b-bf1a-aa71f44b4e10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc04643e20>]}
[0m23:34:00.537909 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.56s]
[0m23:34:00.538833 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m23:34:00.539422 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m23:34:00.540127 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m23:34:00.541049 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m23:34:00.541579 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m23:34:00.550935 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m23:34:00.551871 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 23:34:00.541959 => 23:34:00.551629
[0m23:34:00.552303 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m23:34:00.555138 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:34:01.186984 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m23:34:01.187694 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m23:34:01.787028 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:beb7b10d-2d0e-4e2f-948f-d3cedd3a5921&page=queryresults
[0m23:34:04.630656 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 23:34:00.552613 => 23:34:04.630312
[0m23:34:04.631836 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '825afdbe-f060-448b-bf1a-aa71f44b4e10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0453b670>]}
[0m23:34:04.632840 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.09s]
[0m23:34:04.633930 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m23:34:04.634715 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m23:34:04.635518 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m23:34:04.636495 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m23:34:04.637120 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m23:34:04.641529 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m23:34:04.642474 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 23:34:04.637549 => 23:34:04.642173
[0m23:34:04.643061 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m23:34:04.646950 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:34:05.300517 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m23:34:05.303648 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

WITH price_overview_cte AS (
    SELECT
        currency,
        initial_price,
        final_price,
        discount_percent,
        formatted_initial_price,
        formatted_final_price,
        (discount_percent / 100) AS discount_pct,
        (initial_price - final_price) AS discount_amount,
        final_price AS price_with_discount,
        initial_price AS price_original,
        ROUND(final_price / 1.75, 2) AS price_with_tax 
    FROM `pristine-flames-400818`.`games`.`raw_games`;
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    *
FROM
    price_overview_cte
    );
  
[0m23:34:05.642903 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ce22fc8a-e5c1-4f7d-9e51-5258e92da41a&page=queryresults
[0m23:34:05.645388 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [28:54]')
[0m23:34:06.369014 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9cdc81dd-3154-4d9f-8eda-a5b663c395a9&page=queryresults
[0m23:34:06.374157 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9cdc81dd-3154-4d9f-8eda-a5b663c395a9&page=queryresults
[0m23:34:06.378676 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 23:34:04.643486 => 23:34:06.377361
[0m23:34:06.395985 [debug] [Thread-1  ]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Syntax error: Expected ")" but got ";" at [28:54]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m23:34:06.397701 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '825afdbe-f060-448b-bf1a-aa71f44b4e10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0455da00>]}
[0m23:34:06.399678 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 1.76s]
[0m23:34:06.401321 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m23:34:06.402494 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m23:34:06.403868 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m23:34:06.405384 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m23:34:06.406204 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m23:34:06.412427 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m23:34:06.413612 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 23:34:06.406812 => 23:34:06.413239
[0m23:34:06.414302 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m23:34:06.417902 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:34:07.056632 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m23:34:07.057543 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m23:34:07.722193 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c51dfabc-03d9-40c8-a4af-a9fc8ea19f0d&page=queryresults
[0m23:34:10.201213 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 23:34:06.414792 => 23:34:10.201000
[0m23:34:10.201973 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '825afdbe-f060-448b-bf1a-aa71f44b4e10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc04643580>]}
[0m23:34:10.202609 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 3.80s]
[0m23:34:10.203266 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m23:34:10.203748 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m23:34:10.204310 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m23:34:10.205005 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m23:34:10.205682 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m23:34:10.209769 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m23:34:10.210541 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 23:34:10.206338 => 23:34:10.210317
[0m23:34:10.210981 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m23:34:10.213671 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:34:10.878949 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m23:34:10.881186 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m23:34:11.395578 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:23f6343d-7f8b-4bcd-b7e2-849feef86db0&page=queryresults
[0m23:34:14.317639 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 23:34:10.211293 => 23:34:14.316660
[0m23:34:14.321089 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '825afdbe-f060-448b-bf1a-aa71f44b4e10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc046434f0>]}
[0m23:34:14.324039 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.12s]
[0m23:34:14.328321 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m23:34:14.330867 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m23:34:14.333545 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m23:34:14.336810 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m23:34:14.338627 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m23:34:14.347637 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m23:34:14.349090 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 23:34:14.339665 => 23:34:14.348656
[0m23:34:14.349932 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m23:34:14.354733 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:34:15.040733 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m23:34:15.043784 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m23:34:15.664537 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:08e6c202-f41e-4345-b1ac-6e5ec305d3b3&page=queryresults
[0m23:34:18.321910 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 23:34:14.350527 => 23:34:18.320931
[0m23:34:18.325265 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '825afdbe-f060-448b-bf1a-aa71f44b4e10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0442a640>]}
[0m23:34:18.328102 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 3.99s]
[0m23:34:18.332160 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m23:34:18.338320 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:34:18.339669 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m23:34:18.341374 [info ] [MainThread]: 
[0m23:34:18.342788 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 23.74 seconds (23.74s).
[0m23:34:18.345903 [debug] [MainThread]: Command end result
[0m23:34:18.363909 [info ] [MainThread]: 
[0m23:34:18.364429 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:34:18.364846 [info ] [MainThread]: 
[0m23:34:18.365247 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Syntax error: Expected ")" but got ";" at [28:54]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m23:34:18.365662 [info ] [MainThread]: 
[0m23:34:18.366084 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m23:34:18.366723 [debug] [MainThread]: Command `dbt run` failed at 23:34:18.366607 after 24.51 seconds
[0m23:34:18.367170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc1f359e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0509be20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc04fa6310>]}
[0m23:34:18.367624 [debug] [MainThread]: Flushing usage events
[0m23:35:10.326412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb6d37dd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb6ad2c910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb6ad2c8e0>]}


============================== 23:35:10.331353 | c3bad35a-9078-49e1-a475-a099e6dc6d56 ==============================
[0m23:35:10.331353 [info ] [MainThread]: Running with dbt=1.6.5
[0m23:35:10.331880 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/includes/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:35:10.894605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3bad35a-9078-49e1-a475-a099e6dc6d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb6ad9a760>]}
[0m23:35:10.905697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3bad35a-9078-49e1-a475-a099e6dc6d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb5315db80>]}
[0m23:35:10.906347 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m23:35:10.922550 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m23:35:11.007943 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:35:11.008589 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m23:35:11.051461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3bad35a-9078-49e1-a475-a099e6dc6d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb52f4bdc0>]}
[0m23:35:11.066307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3bad35a-9078-49e1-a475-a099e6dc6d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb53000730>]}
[0m23:35:11.066817 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m23:35:11.067249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3bad35a-9078-49e1-a475-a099e6dc6d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb52ff91c0>]}
[0m23:35:11.068973 [info ] [MainThread]: 
[0m23:35:11.069940 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:35:11.071405 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m23:35:11.071936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:35:11.724511 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m23:35:11.726774 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:35:12.358570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3bad35a-9078-49e1-a475-a099e6dc6d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb5310b370>]}
[0m23:35:12.362026 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:35:12.365131 [info ] [MainThread]: 
[0m23:35:12.394478 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m23:35:12.396326 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m23:35:12.398497 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m23:35:12.399622 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m23:35:12.414767 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m23:35:12.415760 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 23:35:12.400385 => 23:35:12.415453
[0m23:35:12.416344 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m23:35:12.433822 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:35:13.151819 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m23:35:13.152630 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m23:35:13.796139 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:3b751910-70b8-4531-8751-8e22aaf0ba36&page=queryresults
[0m23:35:16.684320 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 23:35:12.416775 => 23:35:16.684045
[0m23:35:16.685347 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3bad35a-9078-49e1-a475-a099e6dc6d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb52895cd0>]}
[0m23:35:16.686139 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.29s]
[0m23:35:16.686987 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m23:35:16.687595 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m23:35:16.688209 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m23:35:16.689275 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m23:35:16.689872 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m23:35:16.699248 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m23:35:16.700028 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 23:35:16.690231 => 23:35:16.699791
[0m23:35:16.700456 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m23:35:16.703234 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:35:17.328027 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m23:35:17.328839 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m23:35:17.957428 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:48028cd1-c3f1-473a-b446-10a8501160bf&page=queryresults
[0m23:35:20.436036 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 23:35:16.700766 => 23:35:20.435824
[0m23:35:20.436809 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3bad35a-9078-49e1-a475-a099e6dc6d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb52895cd0>]}
[0m23:35:20.437492 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 3.75s]
[0m23:35:20.438349 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m23:35:20.439015 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m23:35:20.439611 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m23:35:20.440451 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m23:35:20.440922 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m23:35:20.444571 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m23:35:20.445364 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 23:35:20.441229 => 23:35:20.445124
[0m23:35:20.445848 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m23:35:20.448795 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:35:21.065889 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m23:35:21.066792 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

WITH price_overview_cte AS (
    SELECT
        currency,
        initial_price,
        final_price,
        discount_percent,
        formatted_initial_price,
        formatted_final_price,
        (discount_percent / 100) AS discount_pct,
        (initial_price - final_price) AS discount_amount,
        final_price AS price_with_discount,
        initial_price AS price_original,
        ROUND(final_price / 1.75, 2) AS price_with_tax 
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    *
FROM
    price_overview_cte
    );
  
[0m23:35:21.692679 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e01bb74d-86ac-4772-831d-6e05b1af241e&page=queryresults
[0m23:35:24.477721 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 23:35:20.446171 => 23:35:24.477511
[0m23:35:24.478478 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3bad35a-9078-49e1-a475-a099e6dc6d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb51e79550>]}
[0m23:35:24.479180 [info ] [Thread-1  ]: 3 of 6 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (2.7k rows, 98.5 KiB processed)[0m in 4.04s]
[0m23:35:24.480025 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m23:35:24.480590 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m23:35:24.481211 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m23:35:24.481949 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m23:35:24.482376 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m23:35:24.485702 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m23:35:24.486387 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 23:35:24.482680 => 23:35:24.486175
[0m23:35:24.486798 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m23:35:24.489281 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:35:25.125174 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m23:35:25.125904 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m23:35:25.817895 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b0b9a9e4-3171-4581-8ac2-4e3356fb96cc&page=queryresults
[0m23:35:28.708144 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 23:35:24.487096 => 23:35:28.707899
[0m23:35:28.709067 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3bad35a-9078-49e1-a475-a099e6dc6d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb51fe9f70>]}
[0m23:35:28.709768 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.23s]
[0m23:35:28.710449 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m23:35:28.710928 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m23:35:28.711411 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m23:35:28.712259 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m23:35:28.712735 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m23:35:28.716048 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m23:35:28.716834 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 23:35:28.713040 => 23:35:28.716570
[0m23:35:28.717268 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m23:35:28.719833 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:35:29.362189 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m23:35:29.362910 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m23:35:29.941597 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:1282e466-8d22-40c2-bb45-a0ee0ed9076f&page=queryresults
[0m23:35:32.715653 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 23:35:28.717576 => 23:35:32.715437
[0m23:35:32.716424 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3bad35a-9078-49e1-a475-a099e6dc6d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb51e9d3d0>]}
[0m23:35:32.717112 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.00s]
[0m23:35:32.717853 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m23:35:32.718362 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m23:35:32.718904 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m23:35:32.719869 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m23:35:32.720317 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m23:35:32.723828 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m23:35:32.724800 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 23:35:32.720638 => 23:35:32.724487
[0m23:35:32.725272 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m23:35:32.728201 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:35:33.369693 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m23:35:33.370400 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m23:35:33.977459 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7f79d3af-5725-4af6-b463-331262334741&page=queryresults
[0m23:35:36.514578 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 23:35:32.725578 => 23:35:36.514362
[0m23:35:36.515403 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3bad35a-9078-49e1-a475-a099e6dc6d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb51fbb910>]}
[0m23:35:36.516263 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 3.80s]
[0m23:35:36.517087 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m23:35:36.518681 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:35:36.519070 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m23:35:36.519469 [info ] [MainThread]: 
[0m23:35:36.519899 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 25.45 seconds (25.45s).
[0m23:35:36.521552 [debug] [MainThread]: Command end result
[0m23:35:36.535987 [info ] [MainThread]: 
[0m23:35:36.536517 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:35:36.537012 [info ] [MainThread]: 
[0m23:35:36.537486 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m23:35:36.538182 [debug] [MainThread]: Command `dbt run` succeeded at 23:35:36.538050 after 26.22 seconds
[0m23:35:36.538618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb6d37dd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb5315db80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb52f31af0>]}
[0m23:35:36.539053 [debug] [MainThread]: Flushing usage events
[0m23:39:44.381941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde29fd5df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde2796a970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde2796a9a0>]}


============================== 23:39:44.386806 | e495d3c0-5885-40ce-a52f-cc18930c39b0 ==============================
[0m23:39:44.386806 [info ] [MainThread]: Running with dbt=1.6.5
[0m23:39:44.387373 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/includes/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:39:44.990416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e495d3c0-5885-40ce-a52f-cc18930c39b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde2799f850>]}
[0m23:39:45.001908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e495d3c0-5885-40ce-a52f-cc18930c39b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde0fd51e50>]}
[0m23:39:45.002769 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m23:39:45.019651 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m23:39:45.105361 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:39:45.106018 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m23:39:45.148319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e495d3c0-5885-40ce-a52f-cc18930c39b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde0fb56eb0>]}
[0m23:39:45.162978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e495d3c0-5885-40ce-a52f-cc18930c39b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde0fc64100>]}
[0m23:39:45.163483 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m23:39:45.163924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e495d3c0-5885-40ce-a52f-cc18930c39b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde0fc640d0>]}
[0m23:39:45.165457 [info ] [MainThread]: 
[0m23:39:45.166266 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:39:45.167513 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m23:39:45.167925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:39:45.907987 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m23:39:45.910248 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:39:46.575600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e495d3c0-5885-40ce-a52f-cc18930c39b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde0fb9cbb0>]}
[0m23:39:46.579289 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:39:46.581316 [info ] [MainThread]: 
[0m23:39:46.605951 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m23:39:46.607314 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m23:39:46.609170 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m23:39:46.610145 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m23:39:46.625846 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m23:39:46.626893 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 23:39:46.610784 => 23:39:46.626570
[0m23:39:46.627521 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m23:39:46.645131 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:39:47.386871 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m23:39:47.387652 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m23:39:47.976151 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:eeed20f3-84d5-40b4-896c-9a3d805e374a&page=queryresults
[0m23:39:51.789727 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 23:39:46.627964 => 23:39:51.789398
[0m23:39:51.791012 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e495d3c0-5885-40ce-a52f-cc18930c39b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde0f501f10>]}
[0m23:39:51.792021 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 5.18s]
[0m23:39:51.793066 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m23:39:51.793800 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m23:39:51.794679 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m23:39:51.795779 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m23:39:51.796375 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m23:39:51.806465 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m23:39:51.807259 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 23:39:51.796790 => 23:39:51.807030
[0m23:39:51.807701 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m23:39:51.810441 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:39:52.423540 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m23:39:52.424505 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m23:39:53.016696 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:78936393-21cb-4758-b652-d7800e1df2be&page=queryresults
[0m23:39:55.789757 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 23:39:51.808015 => 23:39:55.789435
[0m23:39:55.790871 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e495d3c0-5885-40ce-a52f-cc18930c39b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde0eb06700>]}
[0m23:39:55.791860 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.00s]
[0m23:39:55.792985 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m23:39:55.793736 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m23:39:55.794516 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m23:39:55.795715 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m23:39:55.796387 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m23:39:55.801369 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m23:39:55.802438 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 23:39:55.796935 => 23:39:55.802111
[0m23:39:55.803074 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m23:39:55.807071 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:39:56.451681 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m23:39:56.452635 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

WITH price_overview_cte AS (
   SELECT
        currency,
        initial_price,
        final_price,
        discount_percent,
        formatted_initial_price,
        formatted_final_price,
        (discount_percent / 100) AS discount_pct,
        (initial_price - final_price) AS discount_amount,
        final_price AS price_with_discount,
        initial_price AS price_original,
        ROUND(final_price / 1.75, 2) AS price_with_tax,  
        CONCAT('ARS$', FORMAT(final_price / 1.75, 2)) AS formatted_price_with_tax
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    *
FROM
    price_overview_cte
    );
  
[0m23:39:57.093115 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c648198a-ad63-41b4-9bef-5529e5d8c8f0&page=queryresults
[0m23:39:57.622822 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for function FORMAT for argument types: FLOAT64, INT64. Supported signature: FORMAT(STRING, [ANY, ...]) at [28:24]')
[0m23:39:58.711131 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:160ee8cd-a423-43ea-9d06-04d004305ee4&page=queryresults
[0m23:39:59.243623 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:160ee8cd-a423-43ea-9d06-04d004305ee4&page=queryresults
[0m23:39:59.244586 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 23:39:55.803531 => 23:39:59.244301
[0m23:39:59.248873 [debug] [Thread-1  ]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  No matching signature for function FORMAT for argument types: FLOAT64, INT64. Supported signature: FORMAT(STRING, [ANY, ...]) at [28:24]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m23:39:59.249516 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e495d3c0-5885-40ce-a52f-cc18930c39b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde0ec1aac0>]}
[0m23:39:59.250286 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 3.45s]
[0m23:39:59.251089 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m23:39:59.251717 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m23:39:59.252380 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m23:39:59.253415 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m23:39:59.253960 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m23:39:59.258340 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m23:39:59.259242 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 23:39:59.254342 => 23:39:59.258975
[0m23:39:59.259758 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m23:39:59.262896 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:39:59.883614 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m23:39:59.884443 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m23:40:00.465259 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:6beca8f1-de44-4127-a46c-26f74f7305c7&page=queryresults
[0m23:40:03.672355 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 23:39:59.260130 => 23:40:03.671370
[0m23:40:03.675814 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e495d3c0-5885-40ce-a52f-cc18930c39b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde0eb061c0>]}
[0m23:40:03.678219 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.42s]
[0m23:40:03.680476 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m23:40:03.681839 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m23:40:03.683172 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m23:40:03.684853 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m23:40:03.685953 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m23:40:03.692286 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m23:40:03.693509 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 23:40:03.686691 => 23:40:03.693141
[0m23:40:03.694203 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m23:40:03.697991 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:40:04.344211 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m23:40:04.347415 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m23:40:04.938858 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:2df83835-b349-40ce-89a6-a6bd7d78b57b&page=queryresults
[0m23:40:08.303571 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 23:40:03.694697 => 23:40:08.303159
[0m23:40:08.305138 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e495d3c0-5885-40ce-a52f-cc18930c39b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde0ca59d00>]}
[0m23:40:08.306388 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.62s]
[0m23:40:08.307797 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m23:40:08.308762 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m23:40:08.309886 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m23:40:08.311304 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m23:40:08.312204 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m23:40:08.318634 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m23:40:08.320053 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 23:40:08.312833 => 23:40:08.319621
[0m23:40:08.320914 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m23:40:08.326035 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:40:08.978787 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m23:40:08.980320 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m23:40:09.454984 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e9b11a08-f919-4330-a461-0f3414078b11&page=queryresults
[0m23:40:12.227970 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 23:40:08.321511 => 23:40:12.227681
[0m23:40:12.229199 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e495d3c0-5885-40ce-a52f-cc18930c39b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde0ebf3520>]}
[0m23:40:12.230055 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 3.92s]
[0m23:40:12.230948 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m23:40:12.232630 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:40:12.233106 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m23:40:12.233613 [info ] [MainThread]: 
[0m23:40:12.234480 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 27.07 seconds (27.07s).
[0m23:40:12.237056 [debug] [MainThread]: Command end result
[0m23:40:12.252777 [info ] [MainThread]: 
[0m23:40:12.253551 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:40:12.254142 [info ] [MainThread]: 
[0m23:40:12.254576 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  No matching signature for function FORMAT for argument types: FLOAT64, INT64. Supported signature: FORMAT(STRING, [ANY, ...]) at [28:24]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m23:40:12.255047 [info ] [MainThread]: 
[0m23:40:12.255447 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m23:40:12.256061 [debug] [MainThread]: Command `dbt run` failed at 23:40:12.255948 after 27.88 seconds
[0m23:40:12.256480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde29fd5df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde0fd81fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde0fc64340>]}
[0m23:40:12.256919 [debug] [MainThread]: Flushing usage events
[0m23:41:09.721878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c65246e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c62bc89d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c62bc8070>]}


============================== 23:41:09.726670 | 89c008be-8f3c-4f3e-ab12-8ab34799b390 ==============================
[0m23:41:09.726670 [info ] [MainThread]: Running with dbt=1.6.5
[0m23:41:09.727245 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/includes/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:41:10.294478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89c008be-8f3c-4f3e-ab12-8ab34799b390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c62bf68e0>]}
[0m23:41:10.305742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89c008be-8f3c-4f3e-ab12-8ab34799b390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4afc1eb0>]}
[0m23:41:10.306429 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m23:41:10.323375 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m23:41:10.409021 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:41:10.409688 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m23:41:10.451486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89c008be-8f3c-4f3e-ab12-8ab34799b390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4adb3e80>]}
[0m23:41:10.466184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89c008be-8f3c-4f3e-ab12-8ab34799b390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4aec3100>]}
[0m23:41:10.466691 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m23:41:10.467123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89c008be-8f3c-4f3e-ab12-8ab34799b390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4aec3160>]}
[0m23:41:10.468582 [info ] [MainThread]: 
[0m23:41:10.469462 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:41:10.470780 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m23:41:10.471267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:11.113115 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m23:41:11.115581 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:41:11.755374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89c008be-8f3c-4f3e-ab12-8ab34799b390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4adf9c10>]}
[0m23:41:11.756194 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:41:11.756623 [info ] [MainThread]: 
[0m23:41:11.763589 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m23:41:11.764205 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m23:41:11.764958 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m23:41:11.765424 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m23:41:11.774094 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m23:41:11.774825 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 23:41:11.765759 => 23:41:11.774614
[0m23:41:11.775236 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m23:41:11.790802 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:41:12.480751 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m23:41:12.481533 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m23:41:13.147752 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:2b4a4ff7-235d-4c92-ab0d-21989761869a&page=queryresults
[0m23:41:16.450579 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 23:41:11.775527 => 23:41:16.450274
[0m23:41:16.451712 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89c008be-8f3c-4f3e-ab12-8ab34799b390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4a55de50>]}
[0m23:41:16.452540 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.69s]
[0m23:41:16.453375 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m23:41:16.453964 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m23:41:16.454571 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m23:41:16.455609 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m23:41:16.456145 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m23:41:16.465721 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m23:41:16.466660 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 23:41:16.456525 => 23:41:16.466423
[0m23:41:16.467089 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m23:41:16.469954 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:41:17.110242 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m23:41:17.113299 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m23:41:17.658887 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:78e0c22b-ddd2-4432-bcc5-52b1d2e9b9cd&page=queryresults
[0m23:41:20.484479 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 23:41:16.467395 => 23:41:20.483492
[0m23:41:20.487851 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89c008be-8f3c-4f3e-ab12-8ab34799b390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4a55d9a0>]}
[0m23:41:20.490687 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.03s]
[0m23:41:20.494287 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m23:41:20.496579 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m23:41:20.499302 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m23:41:20.502577 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m23:41:20.504658 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m23:41:20.515907 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m23:41:20.517669 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 23:41:20.506180 => 23:41:20.517126
[0m23:41:20.518734 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m23:41:20.524234 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:41:21.171295 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m23:41:21.172129 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

WITH price_overview_cte AS (
   SELECT
        currency,
        initial_price,
        final_price,
        discount_percent,
        formatted_initial_price,
        formatted_final_price,
        (discount_percent / 100) AS discount_pct,
        (initial_price - final_price) AS discount_amount,
        final_price AS price_with_discount,
        initial_price AS price_original,
        ROUND(final_price / 1.75, 2) AS price_with_tax,
        CONCAT('ARS$ ', FORMAT(ROUND(final_price / 1.75, 2), 'C')) AS price_with_discount_and_tax
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    *
FROM
    price_overview_cte
    );
  
[0m23:41:21.768179 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:23255d99-19fc-4ce9-945c-ece214fb335d&page=queryresults
[0m23:41:22.342114 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for function FORMAT for argument types: FLOAT64, STRING. Supported signature: FORMAT(STRING, [ANY, ...]) at [28:25]')
[0m23:41:23.910451 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:13071889-3a42-4baf-b9c0-53e449e0c14a&page=queryresults
[0m23:41:24.429074 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:13071889-3a42-4baf-b9c0-53e449e0c14a&page=queryresults
[0m23:41:24.430136 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 23:41:20.519426 => 23:41:24.429858
[0m23:41:24.433581 [debug] [Thread-1  ]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  No matching signature for function FORMAT for argument types: FLOAT64, STRING. Supported signature: FORMAT(STRING, [ANY, ...]) at [28:25]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m23:41:24.434136 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89c008be-8f3c-4f3e-ab12-8ab34799b390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c49c76df0>]}
[0m23:41:24.434777 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 3.93s]
[0m23:41:24.435575 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m23:41:24.436083 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m23:41:24.436715 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m23:41:24.437443 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m23:41:24.437870 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m23:41:24.441737 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m23:41:24.442760 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 23:41:24.438176 => 23:41:24.442467
[0m23:41:24.443277 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m23:41:24.446294 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:41:25.062486 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m23:41:25.063369 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m23:41:25.540988 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:609bad3d-0afd-428e-b6e9-754d52829b3f&page=queryresults
[0m23:41:28.510363 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 23:41:24.443612 => 23:41:28.510164
[0m23:41:28.511176 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89c008be-8f3c-4f3e-ab12-8ab34799b390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c49b5ce80>]}
[0m23:41:28.511789 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.07s]
[0m23:41:28.512506 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m23:41:28.513077 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m23:41:28.513655 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m23:41:28.514438 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m23:41:28.514869 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m23:41:28.518283 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m23:41:28.518998 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 23:41:28.515186 => 23:41:28.518778
[0m23:41:28.519431 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m23:41:28.522002 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:41:29.175662 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m23:41:29.178733 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m23:41:29.771130 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:69dd7200-08e6-43f0-b45d-f93cafc2f298&page=queryresults
[0m23:41:32.891871 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 23:41:28.519745 => 23:41:32.891663
[0m23:41:32.892701 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89c008be-8f3c-4f3e-ab12-8ab34799b390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c482b2ee0>]}
[0m23:41:32.893302 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.38s]
[0m23:41:32.894088 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m23:41:32.894601 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m23:41:32.895114 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m23:41:32.895974 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m23:41:32.896438 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m23:41:32.899880 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m23:41:32.900611 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 23:41:32.896772 => 23:41:32.900379
[0m23:41:32.901052 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m23:41:32.903717 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:41:33.554928 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m23:41:33.556527 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m23:41:34.054419 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ee0db1c3-cbfc-40c6-951c-59cc4c2e3e41&page=queryresults
[0m23:41:37.270138 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 23:41:32.901367 => 23:41:37.269928
[0m23:41:37.270956 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89c008be-8f3c-4f3e-ab12-8ab34799b390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c482b2d90>]}
[0m23:41:37.271698 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.38s]
[0m23:41:37.272625 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m23:41:37.274320 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:41:37.274722 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m23:41:37.275115 [info ] [MainThread]: 
[0m23:41:37.275524 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 26.81 seconds (26.81s).
[0m23:41:37.277090 [debug] [MainThread]: Command end result
[0m23:41:37.290476 [info ] [MainThread]: 
[0m23:41:37.291041 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:41:37.291466 [info ] [MainThread]: 
[0m23:41:37.291860 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  No matching signature for function FORMAT for argument types: FLOAT64, STRING. Supported signature: FORMAT(STRING, [ANY, ...]) at [28:25]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m23:41:37.292294 [info ] [MainThread]: 
[0m23:41:37.292699 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m23:41:37.293290 [debug] [MainThread]: Command `dbt run` failed at 23:41:37.293184 after 27.58 seconds
[0m23:41:37.293700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c65246e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4b024d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4aec3370>]}
[0m23:41:37.294131 [debug] [MainThread]: Flushing usage events
[0m23:42:49.833176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f839bdbcdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f839974c910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f839974c940>]}


============================== 23:42:49.837990 | 737f9518-953c-408d-bfb1-983799d0e79b ==============================
[0m23:42:49.837990 [info ] [MainThread]: Running with dbt=1.6.5
[0m23:42:49.838549 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/includes/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'send_anonymous_usage_stats': 'True'}
[0m23:42:50.409960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '737f9518-953c-408d-bfb1-983799d0e79b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83997be880>]}
[0m23:42:50.421310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '737f9518-953c-408d-bfb1-983799d0e79b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8381b35e20>]}
[0m23:42:50.422143 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m23:42:50.439720 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m23:42:50.524334 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:42:50.525071 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m23:42:50.567132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '737f9518-953c-408d-bfb1-983799d0e79b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f838198fe80>]}
[0m23:42:50.581791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '737f9518-953c-408d-bfb1-983799d0e79b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8381a3d280>]}
[0m23:42:50.582295 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m23:42:50.582748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '737f9518-953c-408d-bfb1-983799d0e79b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8381a3d0d0>]}
[0m23:42:50.584354 [info ] [MainThread]: 
[0m23:42:50.585193 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:42:50.586461 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m23:42:50.586929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:42:51.288060 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818_games'
[0m23:42:51.288892 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:42:51.935412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '737f9518-953c-408d-bfb1-983799d0e79b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8381b51190>]}
[0m23:42:51.936399 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:42:51.937011 [info ] [MainThread]: 
[0m23:42:51.943814 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m23:42:51.944393 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m23:42:51.945095 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m23:42:51.945517 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m23:42:51.954050 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m23:42:51.954818 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 23:42:51.945815 => 23:42:51.954596
[0m23:42:51.955234 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m23:42:51.971153 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:42:52.652754 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m23:42:52.653521 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m23:42:53.235299 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:bf6d35e0-6331-45fb-98d9-472f1774b45c&page=queryresults
[0m23:42:55.858949 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 23:42:51.955531 => 23:42:55.858652
[0m23:42:55.860044 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '737f9518-953c-408d-bfb1-983799d0e79b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83810dbd30>]}
[0m23:42:55.860911 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 3.92s]
[0m23:42:55.861846 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m23:42:55.862513 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m23:42:55.863108 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m23:42:55.864069 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m23:42:55.864608 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m23:42:55.872115 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m23:42:55.873061 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 23:42:55.864986 => 23:42:55.872811
[0m23:42:55.873541 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m23:42:55.876389 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:42:56.508494 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m23:42:56.511555 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m23:42:57.142539 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f830d757-d0d3-406c-9cef-5cafe39fb847&page=queryresults
[0m23:42:59.933178 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 23:42:55.873858 => 23:42:59.932928
[0m23:42:59.934050 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '737f9518-953c-408d-bfb1-983799d0e79b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83810db880>]}
[0m23:42:59.934751 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.07s]
[0m23:42:59.935713 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m23:42:59.936273 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m23:42:59.936987 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m23:42:59.937881 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m23:42:59.938483 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m23:42:59.942198 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m23:42:59.943063 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 23:42:59.938895 => 23:42:59.942793
[0m23:42:59.943568 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m23:42:59.946679 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:43:00.561871 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m23:43:00.562681 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

WITH price_overview_cte AS (
   SELECT
        currency,
        initial_price,
        final_price,
        discount_percent,
        formatted_initial_price,
        formatted_final_price,
        (discount_percent / 100) AS discount_pct,
        (initial_price - final_price) AS discount_amount,
        final_price AS price_with_discount,
        initial_price AS price_original,
        ROUND(final_price / 1.75, 2) AS price_with_tax,
        CONCAT('ARS$ ', FORMAT(ROUND(final_price / 1.75, 2), 'C')) AS formatted_price_with_tax  -- Formato ARS$ 400,00
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    *
FROM
    price_overview_cte
    );
  
[0m23:43:01.159747 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:424faa7d-1618-4f24-a086-bf0e3512b8b9&page=queryresults
[0m23:43:01.692082 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for function FORMAT for argument types: FLOAT64, STRING. Supported signature: FORMAT(STRING, [ANY, ...]) at [28:25]')
[0m23:43:03.221565 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:aa0892fd-e7c8-474e-a1b4-fbe715f28cb7&page=queryresults
[0m23:43:03.770327 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:aa0892fd-e7c8-474e-a1b4-fbe715f28cb7&page=queryresults
[0m23:43:03.773831 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 23:42:59.943902 => 23:43:03.772776
[0m23:43:03.790968 [debug] [Thread-1  ]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  No matching signature for function FORMAT for argument types: FLOAT64, STRING. Supported signature: FORMAT(STRING, [ANY, ...]) at [28:25]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m23:43:03.793503 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '737f9518-953c-408d-bfb1-983799d0e79b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f836bfcefa0>]}
[0m23:43:03.796438 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 3.86s]
[0m23:43:03.799626 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m23:43:03.801316 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m23:43:03.803313 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m23:43:03.805886 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m23:43:03.807278 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m23:43:03.815003 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m23:43:03.816241 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 23:43:03.808119 => 23:43:03.815864
[0m23:43:03.816989 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m23:43:03.821285 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:43:04.472924 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m23:43:04.473704 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m23:43:05.047921 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:45e30e0c-7f28-4080-8770-d4573787e36b&page=queryresults
[0m23:43:07.893477 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 23:43:03.817527 => 23:43:07.892481
[0m23:43:07.896866 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '737f9518-953c-408d-bfb1-983799d0e79b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f836be98820>]}
[0m23:43:07.899701 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.09s]
[0m23:43:07.902897 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m23:43:07.905233 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m23:43:07.907871 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m23:43:07.911118 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m23:43:07.913158 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m23:43:07.923476 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m23:43:07.925267 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 23:43:07.914643 => 23:43:07.924705
[0m23:43:07.926239 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m23:43:07.931388 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:43:08.647221 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m23:43:08.650234 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m23:43:09.232521 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:dd09229d-1f27-4fb4-b2aa-388ceff53865&page=queryresults
[0m23:43:12.036038 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 23:43:07.926897 => 23:43:12.035069
[0m23:43:12.039623 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '737f9518-953c-408d-bfb1-983799d0e79b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f836a60c970>]}
[0m23:43:12.042493 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.13s]
[0m23:43:12.045647 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m23:43:12.047931 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m23:43:12.050619 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m23:43:12.054019 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m23:43:12.056070 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m23:43:12.066508 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m23:43:12.068258 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 23:43:12.057639 => 23:43:12.067709
[0m23:43:12.069199 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m23:43:12.074317 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:43:12.763702 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m23:43:12.766787 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m23:43:13.371021 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7dc410c3-fafe-43d2-9051-df41f901477b&page=queryresults
[0m23:43:16.483728 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 23:43:12.069805 => 23:43:16.482759
[0m23:43:16.487080 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '737f9518-953c-408d-bfb1-983799d0e79b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f836a60cfa0>]}
[0m23:43:16.489922 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.43s]
[0m23:43:16.493086 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m23:43:16.499421 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:43:16.501214 [debug] [MainThread]: Connection 'list_pristine-flames-400818' was properly closed.
[0m23:43:16.502848 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m23:43:16.504726 [info ] [MainThread]: 
[0m23:43:16.506706 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 25.92 seconds (25.92s).
[0m23:43:16.514720 [debug] [MainThread]: Command end result
[0m23:43:16.552446 [info ] [MainThread]: 
[0m23:43:16.553238 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:43:16.553862 [info ] [MainThread]: 
[0m23:43:16.554419 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  No matching signature for function FORMAT for argument types: FLOAT64, STRING. Supported signature: FORMAT(STRING, [ANY, ...]) at [28:25]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m23:43:16.554995 [info ] [MainThread]: 
[0m23:43:16.555689 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m23:43:16.556731 [debug] [MainThread]: Command `dbt run` failed at 23:43:16.556494 after 26.73 seconds
[0m23:43:16.557282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f839bdbcdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8381b35250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8381a3d130>]}
[0m23:43:16.557849 [debug] [MainThread]: Flushing usage events
[0m23:45:08.679661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8407c32e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84055369a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8405536970>]}


============================== 23:45:08.684434 | d2c5145f-03c4-44f9-ac1e-e7884c459115 ==============================
[0m23:45:08.684434 [info ] [MainThread]: Running with dbt=1.6.5
[0m23:45:08.685056 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/includes/dbt/logs', 'profiles_dir': '/opt/airflow/includes/dbt/', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:45:09.248025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2c5145f-03c4-44f9-ac1e-e7884c459115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84055e98b0>]}
[0m23:45:09.259296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2c5145f-03c4-44f9-ac1e-e7884c459115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83ed9a6e80>]}
[0m23:45:09.260058 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m23:45:09.277360 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m23:45:09.364898 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:45:09.365532 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m23:45:09.407664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2c5145f-03c4-44f9-ac1e-e7884c459115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83ed802ee0>]}
[0m23:45:09.422385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2c5145f-03c4-44f9-ac1e-e7884c459115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83ed8b3130>]}
[0m23:45:09.422889 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m23:45:09.423324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2c5145f-03c4-44f9-ac1e-e7884c459115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83ed8b3100>]}
[0m23:45:09.424842 [info ] [MainThread]: 
[0m23:45:09.425582 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:45:09.426841 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m23:45:09.427315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:45:10.135539 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m23:45:10.137781 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:45:10.814562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2c5145f-03c4-44f9-ac1e-e7884c459115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83ed7e7be0>]}
[0m23:45:10.818306 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:45:10.820437 [info ] [MainThread]: 
[0m23:45:10.844307 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m23:45:10.845561 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m23:45:10.846928 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m23:45:10.847850 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m23:45:10.860790 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m23:45:10.861688 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 23:45:10.848476 => 23:45:10.861409
[0m23:45:10.862204 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m23:45:10.878673 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:45:11.601471 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m23:45:11.602201 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m23:45:12.218028 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:afa02bce-72e4-4cbc-8bef-c4695cbde7c0&page=queryresults
[0m23:45:14.805233 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 23:45:10.862572 => 23:45:14.804931
[0m23:45:14.806315 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2c5145f-03c4-44f9-ac1e-e7884c459115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83ecf49df0>]}
[0m23:45:14.807129 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 3.96s]
[0m23:45:14.808046 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m23:45:14.808726 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m23:45:14.809408 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m23:45:14.810372 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m23:45:14.810849 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m23:45:14.819538 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m23:45:14.820656 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 23:45:14.811181 => 23:45:14.820356
[0m23:45:14.821278 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m23:45:14.824020 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:45:15.512552 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m23:45:15.515649 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m23:45:15.971485 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:149229d6-fff2-41d8-95d4-c13d200e8d44&page=queryresults
[0m23:45:18.785776 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 23:45:14.821590 => 23:45:18.784297
[0m23:45:18.789388 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2c5145f-03c4-44f9-ac1e-e7884c459115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83ecf49d90>]}
[0m23:45:18.792278 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 3.98s]
[0m23:45:18.795530 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m23:45:18.797862 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m23:45:18.800474 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m23:45:18.802811 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m23:45:18.804246 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m23:45:18.812869 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m23:45:18.814314 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 23:45:18.805398 => 23:45:18.813858
[0m23:45:18.815166 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m23:45:18.819410 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:45:19.477099 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m23:45:19.480163 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

WITH price_overview_cte AS (
   SELECT
        currency,
        initial_price AS price_original,
        final_price,
        discount_percent,
        formatted_initial_price,
        formatted_final_price,
        (initial_price - final_price) AS discount_amount,
        ROUND(final_price / 1.75, 2) AS price_with_tax,
        CONCAT('ARS$ ', CAST(ROUND(final_price / 1.75, 2) AS STRING)) AS formatted_price  -- Formato ARS$ 400,00
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    *
FROM
    price_overview_cte
    );
  
[0m23:45:20.077790 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f4678bea-a4b5-4f58-9f62-e7ccaa3f67e0&page=queryresults
[0m23:45:22.869100 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 23:45:18.815664 => 23:45:22.867937
[0m23:45:22.872848 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2c5145f-03c4-44f9-ac1e-e7884c459115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83ec5299a0>]}
[0m23:45:22.876095 [info ] [Thread-1  ]: 3 of 6 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (2.7k rows, 98.5 KiB processed)[0m in 4.07s]
[0m23:45:22.878793 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m23:45:22.880583 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m23:45:22.882499 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m23:45:22.884369 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m23:45:22.885721 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m23:45:22.893081 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m23:45:22.894301 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 23:45:22.886608 => 23:45:22.893929
[0m23:45:22.895026 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m23:45:22.899271 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:45:23.599062 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m23:45:23.602052 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m23:45:24.213402 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:902cbd0a-bfce-4548-93a6-2bcceed989dc&page=queryresults
[0m23:45:27.276960 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 23:45:22.895715 => 23:45:27.276242
[0m23:45:27.279320 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2c5145f-03c4-44f9-ac1e-e7884c459115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83ec54afd0>]}
[0m23:45:27.281587 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.40s]
[0m23:45:27.283797 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m23:45:27.285392 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m23:45:27.287221 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m23:45:27.289483 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m23:45:27.290995 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m23:45:27.301678 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m23:45:27.303956 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 23:45:27.292059 => 23:45:27.303225
[0m23:45:27.305383 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m23:45:27.312140 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:45:27.980344 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m23:45:27.984338 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m23:45:28.563653 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:332184fc-f744-448e-ae1b-ae23384bbd2f&page=queryresults
[0m23:45:31.413117 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 23:45:27.306409 => 23:45:31.412135
[0m23:45:31.416431 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2c5145f-03c4-44f9-ac1e-e7884c459115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83ec693e80>]}
[0m23:45:31.419248 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.13s]
[0m23:45:31.422378 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m23:45:31.424654 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m23:45:31.427272 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m23:45:31.430596 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m23:45:31.432781 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m23:45:31.437485 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m23:45:31.438317 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 23:45:31.433640 => 23:45:31.438071
[0m23:45:31.438792 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m23:45:31.441999 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:45:32.130008 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m23:45:32.133110 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m23:45:32.736656 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ed371e67-37b9-469c-812f-ec6eee19bc80&page=queryresults
[0m23:45:35.495235 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 23:45:31.439151 => 23:45:35.494264
[0m23:45:35.498780 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2c5145f-03c4-44f9-ac1e-e7884c459115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83ec696f70>]}
[0m23:45:35.501612 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.07s]
[0m23:45:35.504751 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m23:45:35.509776 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:45:35.510989 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m23:45:35.512276 [info ] [MainThread]: 
[0m23:45:35.513641 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 26.09 seconds (26.09s).
[0m23:45:35.518864 [debug] [MainThread]: Command end result
[0m23:45:35.552063 [info ] [MainThread]: 
[0m23:45:35.552744 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:45:35.553288 [info ] [MainThread]: 
[0m23:45:35.553844 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m23:45:35.554661 [debug] [MainThread]: Command `dbt run` succeeded at 23:45:35.554512 after 26.88 seconds
[0m23:45:35.555222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8407c32e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83ed996e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83ed8b3310>]}
[0m23:45:35.555812 [debug] [MainThread]: Flushing usage events
[0m17:16:02.539449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f042278ed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04200f8880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04200f8070>]}


============================== 17:16:02.544694 | 71b0c347-c0ba-4e10-b606-495fe5aa28d9 ==============================
[0m17:16:02.544694 [info ] [MainThread]: Running with dbt=1.6.5
[0m17:16:02.545268 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/includes/dbt/', 'log_path': '/opt/airflow/includes/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:16:03.308830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71b0c347-c0ba-4e10-b606-495fe5aa28d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04201287f0>]}
[0m17:16:03.320283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71b0c347-c0ba-4e10-b606-495fe5aa28d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04083866d0>]}
[0m17:16:03.321377 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m17:16:03.340228 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m17:16:03.460351 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:16:03.461034 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m17:16:03.503549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71b0c347-c0ba-4e10-b606-495fe5aa28d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0407ca7e20>]}
[0m17:16:03.518262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71b0c347-c0ba-4e10-b606-495fe5aa28d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f040875a760>]}
[0m17:16:03.518759 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m17:16:03.519196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71b0c347-c0ba-4e10-b606-495fe5aa28d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f040874f250>]}
[0m17:16:03.520803 [info ] [MainThread]: 
[0m17:16:03.521613 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:16:03.522924 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m17:16:03.523377 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:04.271145 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m17:16:04.271724 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:16:04.874003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71b0c347-c0ba-4e10-b606-495fe5aa28d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04084631f0>]}
[0m17:16:04.874934 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:16:04.875434 [info ] [MainThread]: 
[0m17:16:04.881846 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m17:16:04.882432 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m17:16:04.883231 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m17:16:04.883654 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m17:16:04.892192 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m17:16:04.893012 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 17:16:04.883954 => 17:16:04.892749
[0m17:16:04.893456 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m17:16:04.909529 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:16:05.560758 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m17:16:05.561531 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m17:16:06.287636 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:55758c2e-7bf3-4576-849d-ae7c933298f3&page=queryresults
[0m17:16:09.754756 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 17:16:04.893760 => 17:16:09.754459
[0m17:16:09.755806 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71b0c347-c0ba-4e10-b606-495fe5aa28d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04073a6880>]}
[0m17:16:09.756659 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.87s]
[0m17:16:09.757590 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m17:16:09.758254 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m17:16:09.759055 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m17:16:09.759922 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m17:16:09.760460 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m17:16:09.764408 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m17:16:09.765165 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 17:16:09.760851 => 17:16:09.764935
[0m17:16:09.765619 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m17:16:09.768414 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:16:10.417302 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m17:16:10.418118 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m17:16:11.131263 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ab0c5801-d668-46b5-9661-bcd78b791756&page=queryresults
[0m17:16:14.236674 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 17:16:09.765941 => 17:16:14.235686
[0m17:16:14.240025 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71b0c347-c0ba-4e10-b606-495fe5aa28d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0407c9d640>]}
[0m17:16:14.242857 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.48s]
[0m17:16:14.246007 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m17:16:14.248306 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m17:16:14.250982 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m17:16:14.254205 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m17:16:14.256196 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m17:16:14.267035 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m17:16:14.268733 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 17:16:14.257692 => 17:16:14.268191
[0m17:16:14.269623 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m17:16:14.274909 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:16:14.975932 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m17:16:14.979070 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
   SELECT
        currency,
        initial_price AS price_original,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        (initial_price - final_price) AS discount_amount,
        CASE
            WHEN discount_percent > 0 THEN
                final_price + (final_price * 0.75)  -- Aplicar impuesto con descuento
            ELSE
                (final_price * (1 + 0.75))  -- Aplicar impuesto sin descuento
        END AS price_with_tax,
        CONCAT('ARS$ ', CAST(CASE
            WHEN discount_percent > 0 THEN
                ROUND(final_price + (final_price * 0.75), 2)  -- Formato con impuesto y descuento
            ELSE
                ROUND((final_price * (1 + 0.75)), 2)  -- Formato con impuesto sin descuento
        END AS STRING)) AS formatted_price_with_tax
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    *
FROM
    price_overview_cte
    );
  
[0m17:16:15.552561 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:cf79d26e-2d70-4b40-abaf-a43421e06149&page=queryresults
[0m17:16:18.586193 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 17:16:14.270204 => 17:16:18.585983
[0m17:16:18.587164 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71b0c347-c0ba-4e10-b606-495fe5aa28d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04072590a0>]}
[0m17:16:18.587905 [info ] [Thread-1  ]: 3 of 6 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (2.7k rows, 98.5 KiB processed)[0m in 4.33s]
[0m17:16:18.588730 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m17:16:18.589250 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m17:16:18.589936 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m17:16:18.590706 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m17:16:18.591146 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m17:16:18.594582 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m17:16:18.595298 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 17:16:18.591447 => 17:16:18.595075
[0m17:16:18.595711 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m17:16:18.602080 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:16:19.272255 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m17:16:19.273128 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m17:16:19.888058 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:2f70e1fc-f39a-4852-ae2b-03ef508c0182&page=queryresults
[0m17:16:23.769002 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 17:16:18.596002 => 17:16:23.768012
[0m17:16:23.772349 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71b0c347-c0ba-4e10-b606-495fe5aa28d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f040736fcd0>]}
[0m17:16:23.775226 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 5.18s]
[0m17:16:23.779129 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m17:16:23.781580 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m17:16:23.784298 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m17:16:23.786900 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m17:16:23.788298 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m17:16:23.796590 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m17:16:23.797983 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 17:16:23.789328 => 17:16:23.797559
[0m17:16:23.798822 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m17:16:23.803162 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:16:24.451901 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m17:16:24.452628 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m17:16:25.068508 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f3a23c38-30e8-473c-b80a-05baedc9342b&page=queryresults
[0m17:16:28.313684 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 17:16:23.799428 => 17:16:28.313462
[0m17:16:28.314473 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71b0c347-c0ba-4e10-b606-495fe5aa28d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f040736fb80>]}
[0m17:16:28.315091 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.53s]
[0m17:16:28.315749 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m17:16:28.316222 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m17:16:28.316864 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m17:16:28.317646 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m17:16:28.318136 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m17:16:28.321492 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m17:16:28.322199 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 17:16:28.318435 => 17:16:28.321951
[0m17:16:28.322622 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m17:16:28.325188 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:16:28.962651 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m17:16:28.965641 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m17:16:29.560631 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:47774e4b-5111-404a-9d82-399a067edc87&page=queryresults
[0m17:16:32.733376 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 17:16:28.322919 => 17:16:32.733162
[0m17:16:32.734370 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71b0c347-c0ba-4e10-b606-495fe5aa28d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0407327b20>]}
[0m17:16:32.735027 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.42s]
[0m17:16:32.735907 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m17:16:32.737422 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:16:32.737817 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m17:16:32.738209 [info ] [MainThread]: 
[0m17:16:32.738602 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 29.22 seconds (29.22s).
[0m17:16:32.740086 [debug] [MainThread]: Command end result
[0m17:16:32.754622 [info ] [MainThread]: 
[0m17:16:32.755195 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:16:32.755630 [info ] [MainThread]: 
[0m17:16:32.756036 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m17:16:32.756744 [debug] [MainThread]: Command `dbt run` succeeded at 17:16:32.756594 after 30.22 seconds
[0m17:16:32.757131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f042278ed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04083866d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0408411af0>]}
[0m17:16:32.757527 [debug] [MainThread]: Flushing usage events
[0m18:47:28.146793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1f71cbdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1f4a9a940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1f4a9a0a0>]}


============================== 18:47:28.152533 | 40c9a4a1-e12f-4ddc-a9cb-43a32210ae05 ==============================
[0m18:47:28.152533 [info ] [MainThread]: Running with dbt=1.6.5
[0m18:47:28.153159 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/includes/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:47:28.987021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40c9a4a1-e12f-4ddc-a9cb-43a32210ae05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1f4b4d850>]}
[0m18:47:28.997922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40c9a4a1-e12f-4ddc-a9cb-43a32210ae05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1dcf0ee20>]}
[0m18:47:28.998791 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m18:47:29.014794 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m18:47:29.126356 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:47:29.126949 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m18:47:29.168965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40c9a4a1-e12f-4ddc-a9cb-43a32210ae05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1dcd69e80>]}
[0m18:47:29.183413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40c9a4a1-e12f-4ddc-a9cb-43a32210ae05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1dce16280>]}
[0m18:47:29.183921 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m18:47:29.184361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40c9a4a1-e12f-4ddc-a9cb-43a32210ae05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1dce160d0>]}
[0m18:47:29.185856 [info ] [MainThread]: 
[0m18:47:29.186622 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:47:29.187943 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m18:47:29.188422 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:47:29.910558 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m18:47:29.911028 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:47:30.554098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40c9a4a1-e12f-4ddc-a9cb-43a32210ae05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1dcf11190>]}
[0m18:47:30.557568 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:47:30.559421 [info ] [MainThread]: 
[0m18:47:30.585629 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m18:47:30.587021 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m18:47:30.588853 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m18:47:30.589966 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m18:47:30.603665 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m18:47:30.604700 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 18:47:30.590558 => 18:47:30.604357
[0m18:47:30.605255 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m18:47:30.622648 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:47:31.448064 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m18:47:31.448840 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m18:47:32.136399 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:803f37d2-a576-4d71-b44f-f12639a8aabe&page=queryresults
[0m18:47:35.132461 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 18:47:30.605618 => 18:47:35.132161
[0m18:47:35.133621 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40c9a4a1-e12f-4ddc-a9cb-43a32210ae05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1dc4b2e50>]}
[0m18:47:35.134536 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.55s]
[0m18:47:35.135446 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m18:47:35.136058 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m18:47:35.136794 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m18:47:35.137727 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m18:47:35.138296 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m18:47:35.147624 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m18:47:35.148360 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 18:47:35.138683 => 18:47:35.148146
[0m18:47:35.148786 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m18:47:35.151297 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:47:35.807241 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m18:47:35.807970 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m18:47:36.453730 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:30695d43-4654-4e95-bc11-3184b1677a83&page=queryresults
[0m18:47:39.580214 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 18:47:35.149077 => 18:47:39.579233
[0m18:47:39.583589 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40c9a4a1-e12f-4ddc-a9cb-43a32210ae05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1dc292a00>]}
[0m18:47:39.586466 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.45s]
[0m18:47:39.589628 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m18:47:39.592028 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m18:47:39.594799 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m18:47:39.597238 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m18:47:39.598672 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m18:47:39.606369 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m18:47:39.607688 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 18:47:39.599688 => 18:47:39.607265
[0m18:47:39.608505 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m18:47:39.612832 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:47:40.303271 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m18:47:40.306430 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        currency,
        price_original,
        final_price,
        discount_pct,
        formatted_initial_price,
        formatted_final_price,
        CASE
            WHEN discount_pct > 0 THEN
                price_original * (1 - discount_pct / 100)
            ELSE
                price_original
        END AS price_with_discount,
        CASE
            WHEN discount_pct > 0 THEN
                price_original * (1 - discount_pct / 100) + (price_original * (1 - discount_pct / 100)) * 0.75
            ELSE
                price_original + price_original * 0.75
        END AS price_with_tax
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    currency,
    price_original,
    final_price,
    discount_pct,
    formatted_initial_price,
    formatted_final_price,
    ROUND(price_with_discount, 2) AS price_with_discount,
    ROUND(price_with_tax, 2) AS price_with_tax
FROM price_overview_cte;
    );
  
[0m18:47:40.634281 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9d62cf0b-0cbf-4da9-930e-26b5218e5585&page=queryresults
[0m18:47:40.637471 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [49:24]')
[0m18:47:41.634270 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:2e5e6f8a-eba1-4a29-ad8a-e005059b38e4&page=queryresults
[0m18:47:41.638999 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:2e5e6f8a-eba1-4a29-ad8a-e005059b38e4&page=queryresults
[0m18:47:41.642552 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 18:47:39.609112 => 18:47:41.641481
[0m18:47:41.659477 [debug] [Thread-1  ]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Syntax error: Expected ")" but got ";" at [49:24]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m18:47:41.660897 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40c9a4a1-e12f-4ddc-a9cb-43a32210ae05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1dc3cd970>]}
[0m18:47:41.662387 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 2.06s]
[0m18:47:41.663991 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m18:47:41.665135 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m18:47:41.666082 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m18:47:41.667715 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m18:47:41.668565 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m18:47:41.674263 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m18:47:41.675318 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 18:47:41.669194 => 18:47:41.675018
[0m18:47:41.675905 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m18:47:41.679338 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:47:43.312055 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m18:47:43.312777 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m18:47:43.900690 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:06b3f3e4-bd61-4a74-abcb-2dfe33da4cd4&page=queryresults
[0m18:47:46.764238 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 18:47:41.676324 => 18:47:46.764024
[0m18:47:46.765001 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40c9a4a1-e12f-4ddc-a9cb-43a32210ae05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1dc299940>]}
[0m18:47:46.765627 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 5.10s]
[0m18:47:46.766333 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m18:47:46.766811 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m18:47:46.767394 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m18:47:46.768078 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m18:47:46.768500 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m18:47:46.771793 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m18:47:46.772510 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 18:47:46.768808 => 18:47:46.772284
[0m18:47:46.772968 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m18:47:46.775854 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:47:47.423985 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m18:47:47.426933 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m18:47:48.062304 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ca3d39a5-607c-4a73-9651-8bc3184e8101&page=queryresults
[0m18:47:51.160542 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 18:47:46.773273 => 18:47:51.160198
[0m18:47:51.161861 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40c9a4a1-e12f-4ddc-a9cb-43a32210ae05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1dc4b2610>]}
[0m18:47:51.162982 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.39s]
[0m18:47:51.164201 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m18:47:51.165109 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m18:47:51.166223 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m18:47:51.167677 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m18:47:51.168595 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m18:47:51.175481 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m18:47:51.176959 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 18:47:51.169333 => 18:47:51.176468
[0m18:47:51.177869 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m18:47:51.183203 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:47:51.885399 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m18:47:51.888364 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m18:47:52.517319 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d49d054e-8cea-431e-b234-f75998d74026&page=queryresults
[0m18:47:55.321442 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 18:47:51.178525 => 18:47:55.321233
[0m18:47:55.322201 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40c9a4a1-e12f-4ddc-a9cb-43a32210ae05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1dc28a520>]}
[0m18:47:55.322804 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.16s]
[0m18:47:55.323727 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m18:47:55.325238 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:47:55.325596 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m18:47:55.325969 [info ] [MainThread]: 
[0m18:47:55.326380 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 26.14 seconds (26.14s).
[0m18:47:55.328093 [debug] [MainThread]: Command end result
[0m18:47:55.341000 [info ] [MainThread]: 
[0m18:47:55.341681 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:47:55.342139 [info ] [MainThread]: 
[0m18:47:55.342671 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Syntax error: Expected ")" but got ";" at [49:24]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m18:47:55.343146 [info ] [MainThread]: 
[0m18:47:55.343615 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m18:47:55.344466 [debug] [MainThread]: Command `dbt run` failed at 18:47:55.344303 after 27.20 seconds
[0m18:47:55.345120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1f71cbdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1dcf0ee20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1dce16310>]}
[0m18:47:55.346370 [debug] [MainThread]: Flushing usage events
[0m18:48:10.102092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc4f77f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc28f09a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc28f0970>]}


============================== 18:48:10.106927 | 4b7fb733-72d7-4327-93d6-2e3fb8928113 ==============================
[0m18:48:10.106927 [info ] [MainThread]: Running with dbt=1.6.5
[0m18:48:10.107529 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/includes/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'send_anonymous_usage_stats': 'True'}
[0m18:48:10.662875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b7fb733-72d7-4327-93d6-2e3fb8928113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc291d940>]}
[0m18:48:10.674659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b7fb733-72d7-4327-93d6-2e3fb8928113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5caacdeee0>]}
[0m18:48:10.675544 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m18:48:10.692135 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m18:48:10.777451 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:48:10.778037 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m18:48:10.819423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b7fb733-72d7-4327-93d6-2e3fb8928113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5caaaddeb0>]}
[0m18:48:10.834605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b7fb733-72d7-4327-93d6-2e3fb8928113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5caabec130>]}
[0m18:48:10.835143 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m18:48:10.835604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b7fb733-72d7-4327-93d6-2e3fb8928113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5caabec190>]}
[0m18:48:10.837133 [info ] [MainThread]: 
[0m18:48:10.837891 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:48:10.839163 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m18:48:10.839619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:48:11.509695 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m18:48:11.511943 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:48:12.174628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b7fb733-72d7-4327-93d6-2e3fb8928113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5caaaddfd0>]}
[0m18:48:12.178132 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:48:12.179998 [info ] [MainThread]: 
[0m18:48:12.197596 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m18:48:12.198719 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m18:48:12.199943 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m18:48:12.200667 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m18:48:12.212746 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m18:48:12.213692 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 18:48:12.201173 => 18:48:12.213417
[0m18:48:12.214227 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m18:48:12.229523 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:48:13.112689 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m18:48:13.113470 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m18:48:13.722134 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:8f33a717-51d2-4152-b8eb-21663e7b4e51&page=queryresults
[0m18:48:16.863256 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 18:48:12.214538 => 18:48:16.863052
[0m18:48:16.864049 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b7fb733-72d7-4327-93d6-2e3fb8928113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5caa483f10>]}
[0m18:48:16.864690 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.66s]
[0m18:48:16.865429 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m18:48:16.865942 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m18:48:16.866513 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m18:48:16.867229 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m18:48:16.867631 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m18:48:16.876342 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m18:48:16.877199 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 18:48:16.867921 => 18:48:16.876950
[0m18:48:16.877693 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m18:48:16.881011 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:48:17.553430 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m18:48:17.554240 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m18:48:18.190490 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:cfe3c2a3-c397-4b83-b9d0-0d8241040cfc&page=queryresults
[0m18:48:21.265156 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 18:48:16.878006 => 18:48:21.264697
[0m18:48:21.266714 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b7fb733-72d7-4327-93d6-2e3fb8928113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ca9b7f550>]}
[0m18:48:21.268026 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.40s]
[0m18:48:21.269614 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m18:48:21.270879 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m18:48:21.272360 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m18:48:21.274165 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m18:48:21.275305 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m18:48:21.283627 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m18:48:21.285623 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 18:48:21.276122 => 18:48:21.284998
[0m18:48:21.286758 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m18:48:21.293536 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:48:21.989518 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m18:48:21.990296 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        currency,
        price_original,
        final_price,
        discount_pct,
        formatted_initial_price,
        formatted_final_price,
        CASE
            WHEN discount_pct > 0 THEN
                price_original * (1 - discount_pct / 100)
            ELSE
                price_original
        END AS price_with_discount,
        CASE
            WHEN discount_pct > 0 THEN
                price_original * (1 - discount_pct / 100) + (price_original * (1 - discount_pct / 100)) * 0.75
            ELSE
                price_original + price_original * 0.75
        END AS price_with_tax
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    currency,
    price_original,
    final_price,
    discount_pct,
    formatted_initial_price,
    formatted_final_price,
    ROUND(price_with_discount, 2) AS price_with_discount,
    ROUND(price_with_tax, 2) AS price_with_tax
FROM price_overview_cte
    );
  
[0m18:48:22.616734 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5961ab8c-e086-4b6d-99c3-c471a20a5030&page=queryresults
[0m18:48:23.174018 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: price_original at [19:9]')
[0m18:48:24.555973 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:8dd4fd28-a03c-4e90-b552-89f6f02e22ca&page=queryresults
[0m18:48:25.075014 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:8dd4fd28-a03c-4e90-b552-89f6f02e22ca&page=queryresults
[0m18:48:25.078416 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 18:48:21.287564 => 18:48:25.077391
[0m18:48:25.082293 [debug] [Thread-1  ]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Unrecognized name: price_original at [19:9]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m18:48:25.082799 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b7fb733-72d7-4327-93d6-2e3fb8928113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ca9b6dcd0>]}
[0m18:48:25.083417 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 3.81s]
[0m18:48:25.084173 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m18:48:25.084675 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m18:48:25.085177 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m18:48:25.086049 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m18:48:25.086501 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m18:48:25.090370 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m18:48:25.091307 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 18:48:25.086821 => 18:48:25.091057
[0m18:48:25.091762 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m18:48:25.094634 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:48:25.751085 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m18:48:25.754098 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m18:48:26.350441 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:81b9c925-e82b-449a-95a2-4939e248e99c&page=queryresults
[0m18:48:29.190380 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 18:48:25.092077 => 18:48:29.190171
[0m18:48:29.191161 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b7fb733-72d7-4327-93d6-2e3fb8928113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ca9a89430>]}
[0m18:48:29.191803 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.11s]
[0m18:48:29.192471 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m18:48:29.192998 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m18:48:29.193605 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m18:48:29.194318 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m18:48:29.194753 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m18:48:29.198127 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m18:48:29.198888 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 18:48:29.195056 => 18:48:29.198638
[0m18:48:29.199320 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m18:48:29.201918 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:48:29.868365 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m18:48:29.869237 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m18:48:30.462797 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:1ce684f9-fbbf-447b-95d1-ad05971dc2c0&page=queryresults
[0m18:48:33.545920 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 18:48:29.199612 => 18:48:33.545721
[0m18:48:33.546664 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b7fb733-72d7-4327-93d6-2e3fb8928113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ca9ba1910>]}
[0m18:48:33.547268 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.35s]
[0m18:48:33.547966 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m18:48:33.548480 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m18:48:33.549064 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m18:48:33.549865 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m18:48:33.550302 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m18:48:33.553688 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m18:48:33.554404 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 18:48:33.550613 => 18:48:33.554172
[0m18:48:33.554832 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m18:48:33.557432 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:48:34.213503 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m18:48:34.214331 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m18:48:34.818689 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:630b5fcd-1397-4b7f-af49-523871a74a21&page=queryresults
[0m18:48:38.236780 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 18:48:33.555142 => 18:48:38.235785
[0m18:48:38.240095 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b7fb733-72d7-4327-93d6-2e3fb8928113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ca9ba1430>]}
[0m18:48:38.242924 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.69s]
[0m18:48:38.246102 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m18:48:38.252473 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:48:38.254268 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m18:48:38.255295 [info ] [MainThread]: 
[0m18:48:38.255762 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 27.42 seconds (27.42s).
[0m18:48:38.257361 [debug] [MainThread]: Command end result
[0m18:48:38.270844 [info ] [MainThread]: 
[0m18:48:38.271328 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:48:38.271699 [info ] [MainThread]: 
[0m18:48:38.272066 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Unrecognized name: price_original at [19:9]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m18:48:38.272492 [info ] [MainThread]: 
[0m18:48:38.272929 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m18:48:38.273608 [debug] [MainThread]: Command `dbt run` failed at 18:48:38.273486 after 28.18 seconds
[0m18:48:38.274059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc4f77f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5caacdef70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5caab2edc0>]}
[0m18:48:38.274507 [debug] [MainThread]: Flushing usage events
[0m18:49:47.805815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd92674edc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9240e8940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9240e8910>]}


============================== 18:49:47.810590 | cf0becee-de14-4485-9716-d38bc608ba41 ==============================
[0m18:49:47.810590 [info ] [MainThread]: Running with dbt=1.6.5
[0m18:49:47.811267 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/includes/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:49:48.394552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf0becee-de14-4485-9716-d38bc608ba41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd92411c820>]}
[0m18:49:48.405470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf0becee-de14-4485-9716-d38bc608ba41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90c4dce20>]}
[0m18:49:48.406086 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m18:49:48.422488 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m18:49:48.506650 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:49:48.507242 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m18:49:48.548788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf0becee-de14-4485-9716-d38bc608ba41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90c334e80>]}
[0m18:49:48.563565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf0becee-de14-4485-9716-d38bc608ba41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90c3e3280>]}
[0m18:49:48.564062 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m18:49:48.564486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf0becee-de14-4485-9716-d38bc608ba41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90c3e30d0>]}
[0m18:49:48.565923 [info ] [MainThread]: 
[0m18:49:48.566680 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:49:48.567953 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m18:49:48.568411 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:49:49.268030 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m18:49:49.270252 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:49:49.892261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf0becee-de14-4485-9716-d38bc608ba41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90c4ed190>]}
[0m18:49:49.893040 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:49:49.893461 [info ] [MainThread]: 
[0m18:49:49.900060 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m18:49:49.900653 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m18:49:49.901430 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m18:49:49.901869 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m18:49:49.910957 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m18:49:49.911792 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 18:49:49.902179 => 18:49:49.911546
[0m18:49:49.912262 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m18:49:49.930147 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:49:50.593059 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m18:49:50.593866 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m18:49:51.232742 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c9577126-9fe2-4e3a-9a97-a3c82d619b62&page=queryresults
[0m18:49:54.327385 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 18:49:49.912593 => 18:49:54.327182
[0m18:49:54.328167 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf0becee-de14-4485-9716-d38bc608ba41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90bc7fdf0>]}
[0m18:49:54.328784 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.43s]
[0m18:49:54.329503 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m18:49:54.330016 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m18:49:54.330600 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m18:49:54.331393 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m18:49:54.331823 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m18:49:54.339821 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m18:49:54.340632 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 18:49:54.332111 => 18:49:54.340385
[0m18:49:54.341153 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m18:49:54.344157 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:49:55.007566 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m18:49:55.008323 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m18:49:55.609067 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ab1db3dd-2b2f-44f5-9f15-fc694687c6a0&page=queryresults
[0m18:49:58.996133 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 18:49:54.341464 => 18:49:58.995917
[0m18:49:58.996890 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf0becee-de14-4485-9716-d38bc608ba41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90b377670>]}
[0m18:49:58.997501 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.67s]
[0m18:49:58.998161 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m18:49:58.998642 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m18:49:58.999132 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m18:49:58.999875 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m18:49:59.000309 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m18:49:59.003576 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m18:49:59.004258 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 18:49:59.000613 => 18:49:59.004045
[0m18:49:59.004677 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m18:49:59.007238 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:49:59.637396 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m18:49:59.640255 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        currency,
        initial_price AS price_original,
        final_price,
        discount_pct,
        formatted_initial_price,
        formatted_final_price,
        CASE
            WHEN discount_pct > 0 THEN
                price_original * (1 - discount_pct / 100)
            ELSE
                price_original
        END AS price_with_discount,
        CASE
            WHEN discount_pct > 0 THEN
                price_original * (1 - discount_pct / 100) + (price_original * (1 - discount_pct / 100)) * 0.75
            ELSE
                price_original + price_original * 0.75
        END AS price_with_tax
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    currency,
    price_original,
    final_price,
    discount_pct,
    formatted_initial_price,
    formatted_final_price,
    ROUND(price_with_discount, 2) AS price_with_discount,
    ROUND(price_with_tax, 2) AS price_with_tax
FROM price_overview_cte
    );
  
[0m18:50:00.253144 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ff900fcf-7a49-41c4-99d6-68f4c4ab2602&page=queryresults
[0m18:50:00.811219 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: discount_pct; Did you mean discount_percent? at [21:9]')
[0m18:50:01.572560 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:79a612c9-c404-465e-aa46-5f3db30842cb&page=queryresults
[0m18:50:02.169699 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:79a612c9-c404-465e-aa46-5f3db30842cb&page=queryresults
[0m18:50:02.173279 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 18:49:59.004977 => 18:50:02.172154
[0m18:50:02.177381 [debug] [Thread-1  ]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Unrecognized name: discount_pct; Did you mean discount_percent? at [21:9]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m18:50:02.177874 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf0becee-de14-4485-9716-d38bc608ba41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90b39be50>]}
[0m18:50:02.178507 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 3.18s]
[0m18:50:02.179180 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m18:50:02.179686 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m18:50:02.180196 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m18:50:02.180962 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m18:50:02.181364 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m18:50:02.185220 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m18:50:02.186043 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 18:50:02.181648 => 18:50:02.185797
[0m18:50:02.186489 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m18:50:02.189255 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:50:02.874636 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m18:50:02.875417 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m18:50:03.466708 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:831ac8d4-3d8b-4aed-9d47-89ddacc62996&page=queryresults
[0m18:50:06.605000 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 18:50:02.186783 => 18:50:06.604796
[0m18:50:06.605744 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf0becee-de14-4485-9716-d38bc608ba41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90bc7f490>]}
[0m18:50:06.606344 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.43s]
[0m18:50:06.607060 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m18:50:06.607581 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m18:50:06.608151 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m18:50:06.608874 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m18:50:06.609272 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m18:50:06.612596 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m18:50:06.613307 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 18:50:06.609557 => 18:50:06.613089
[0m18:50:06.613732 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m18:50:06.616260 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:50:07.311396 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m18:50:07.312256 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m18:50:08.042922 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c1e8b175-49ed-4afa-8c38-a885fdafd6d8&page=queryresults
[0m18:50:11.135741 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 18:50:06.614038 => 18:50:11.135327
[0m18:50:11.137153 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf0becee-de14-4485-9716-d38bc608ba41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9091d7b50>]}
[0m18:50:11.138319 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.53s]
[0m18:50:11.139598 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m18:50:11.140470 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m18:50:11.141373 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m18:50:11.142454 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m18:50:11.143140 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m18:50:11.148327 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m18:50:11.149443 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 18:50:11.143628 => 18:50:11.149089
[0m18:50:11.150125 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m18:50:11.154592 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:50:11.837484 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m18:50:11.838268 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m18:50:12.481747 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:1a52004e-28ef-43c6-a266-9599e59bb58a&page=queryresults
[0m18:50:15.638869 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 18:50:11.150613 => 18:50:15.637982
[0m18:50:15.641924 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf0becee-de14-4485-9716-d38bc608ba41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90b39e760>]}
[0m18:50:15.644444 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.50s]
[0m18:50:15.647282 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m18:50:15.653161 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:50:15.654701 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m18:50:15.656356 [info ] [MainThread]: 
[0m18:50:15.658085 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 27.09 seconds (27.09s).
[0m18:50:15.661993 [debug] [MainThread]: Command end result
[0m18:50:15.675919 [info ] [MainThread]: 
[0m18:50:15.676486 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:50:15.676944 [info ] [MainThread]: 
[0m18:50:15.677307 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Unrecognized name: discount_pct; Did you mean discount_percent? at [21:9]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m18:50:15.677729 [info ] [MainThread]: 
[0m18:50:15.678123 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m18:50:15.678759 [debug] [MainThread]: Command `dbt run` failed at 18:50:15.678649 after 27.88 seconds
[0m18:50:15.679201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd92674edc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90c4dce20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90c3e3310>]}
[0m18:50:15.679645 [debug] [MainThread]: Flushing usage events
[0m18:50:47.646078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb44fbe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb1e8b9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb1e8b9d0>]}


============================== 18:50:47.650668 | 6b39de75-b41b-4f16-9db4-f53bc4ec1580 ==============================
[0m18:50:47.650668 [info ] [MainThread]: Running with dbt=1.6.5
[0m18:50:47.651244 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/includes/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:50:48.203666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b39de75-b41b-4f16-9db4-f53bc4ec1580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb1eb7910>]}
[0m18:50:48.214427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b39de75-b41b-4f16-9db4-f53bc4ec1580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f9a27aeb0>]}
[0m18:50:48.215077 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m18:50:48.231630 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m18:50:48.314850 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:50:48.315447 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m18:50:48.356483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b39de75-b41b-4f16-9db4-f53bc4ec1580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f9a07be80>]}
[0m18:50:48.371260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b39de75-b41b-4f16-9db4-f53bc4ec1580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f9a189100>]}
[0m18:50:48.371759 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m18:50:48.372190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b39de75-b41b-4f16-9db4-f53bc4ec1580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f9a189160>]}
[0m18:50:48.373634 [info ] [MainThread]: 
[0m18:50:48.374372 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:50:48.375630 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m18:50:48.376028 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:49.071850 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m18:50:49.074060 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:50:49.649121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b39de75-b41b-4f16-9db4-f53bc4ec1580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f9a0bec10>]}
[0m18:50:49.651022 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:50:49.652090 [info ] [MainThread]: 
[0m18:50:49.663090 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m18:50:49.663920 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m18:50:49.665024 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m18:50:49.665686 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m18:50:49.675911 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m18:50:49.676735 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 18:50:49.666148 => 18:50:49.676475
[0m18:50:49.677193 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m18:50:49.692919 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:50:50.454089 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m18:50:50.454850 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m18:50:51.031538 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:33d43978-015b-480f-83e0-aa34b1cc4ca9&page=queryresults
[0m18:50:53.852369 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 18:50:49.677499 => 18:50:53.852072
[0m18:50:53.853364 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b39de75-b41b-4f16-9db4-f53bc4ec1580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f99820ee0>]}
[0m18:50:53.854135 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.19s]
[0m18:50:53.854971 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m18:50:53.855564 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m18:50:53.856293 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m18:50:53.857200 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m18:50:53.857687 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m18:50:53.866903 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m18:50:53.867891 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 18:50:53.858023 => 18:50:53.867616
[0m18:50:53.868339 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m18:50:53.871089 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:50:54.544637 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m18:50:54.545440 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m18:50:55.150715 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:cf56e41b-3a72-43df-a0d3-90cffb7b410e&page=queryresults
[0m18:50:58.280188 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 18:50:53.868631 => 18:50:58.279717
[0m18:50:58.281824 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b39de75-b41b-4f16-9db4-f53bc4ec1580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f98f0e670>]}
[0m18:50:58.283401 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.42s]
[0m18:50:58.285388 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m18:50:58.286724 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m18:50:58.288299 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m18:50:58.290227 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m18:50:58.291404 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m18:50:58.300415 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m18:50:58.302418 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 18:50:58.292247 => 18:50:58.301781
[0m18:50:58.303615 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m18:50:58.309949 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:50:59.027739 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m18:50:59.028566 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        currency,
        initial_price AS price_original,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        CASE
            WHEN discount_pct > 0 THEN
                price_original * (1 - discount_pct / 100)
            ELSE
                price_original
        END AS price_with_discount,
        CASE
            WHEN discount_pct > 0 THEN
                price_original * (1 - discount_pct / 100) + (price_original * (1 - discount_pct / 100)) * 0.75
            ELSE
                price_original + price_original * 0.75
        END AS price_with_tax
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    currency,
    price_original,
    final_price,
    discount_pct,
    formatted_initial_price,
    formatted_final_price,
    ROUND(price_with_discount, 2) AS price_with_discount,
    ROUND(price_with_tax, 2) AS price_with_tax
FROM price_overview_cte
    );
  
[0m18:50:59.737047 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:cd19a515-dc94-40e4-ad3f-97da622bd230&page=queryresults
[0m18:51:00.244244 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: discount_pct; Did you mean discount_percent? at [25:18]')
[0m18:51:01.358006 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:57f58d05-e25c-4141-ad33-c77a5964b1cd&page=queryresults
[0m18:51:01.903757 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:57f58d05-e25c-4141-ad33-c77a5964b1cd&page=queryresults
[0m18:51:01.907325 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 18:50:58.304459 => 18:51:01.906255
[0m18:51:01.911462 [debug] [Thread-1  ]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Unrecognized name: discount_pct; Did you mean discount_percent? at [25:18]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m18:51:01.911939 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b39de75-b41b-4f16-9db4-f53bc4ec1580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f98f3aa00>]}
[0m18:51:01.912565 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 3.62s]
[0m18:51:01.913327 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m18:51:01.913875 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m18:51:01.914433 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m18:51:01.915346 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m18:51:01.915806 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m18:51:01.920170 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m18:51:01.921026 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 18:51:01.916130 => 18:51:01.920761
[0m18:51:01.921507 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m18:51:01.924453 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:51:02.650578 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m18:51:02.651387 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m18:51:03.240111 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f1edfc6d-d43d-4b83-8969-500c711a8bd3&page=queryresults
[0m18:51:06.424135 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 18:51:01.921847 => 18:51:06.423926
[0m18:51:06.425330 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b39de75-b41b-4f16-9db4-f53bc4ec1580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f98e24280>]}
[0m18:51:06.426015 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.51s]
[0m18:51:06.426724 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m18:51:06.427241 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m18:51:06.427838 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m18:51:06.428627 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m18:51:06.429142 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m18:51:06.432417 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m18:51:06.433216 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 18:51:06.429437 => 18:51:06.432974
[0m18:51:06.433651 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m18:51:06.436164 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:51:07.068820 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m18:51:07.069612 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m18:51:07.780402 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:270d6a39-7f5e-40a9-8772-bf2977bb3c54&page=queryresults
[0m18:51:10.971094 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 18:51:06.433937 => 18:51:10.970137
[0m18:51:10.974389 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b39de75-b41b-4f16-9db4-f53bc4ec1580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f9857bd90>]}
[0m18:51:10.977200 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.55s]
[0m18:51:10.980334 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m18:51:10.982601 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m18:51:10.985212 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m18:51:10.988338 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m18:51:10.990377 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m18:51:10.997830 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m18:51:10.998676 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 18:51:10.991823 => 18:51:10.998410
[0m18:51:10.999133 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m18:51:11.001818 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:51:11.683723 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m18:51:11.684511 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m18:51:12.230553 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:2a8062c1-51b8-459d-852e-5a0d1843337d&page=queryresults
[0m18:51:15.413692 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 18:51:10.999423 => 18:51:15.413486
[0m18:51:15.414451 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b39de75-b41b-4f16-9db4-f53bc4ec1580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f98f3d880>]}
[0m18:51:15.415064 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.43s]
[0m18:51:15.415809 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m18:51:15.417332 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:51:15.417725 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m18:51:15.418134 [info ] [MainThread]: 
[0m18:51:15.418550 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 27.04 seconds (27.04s).
[0m18:51:15.420148 [debug] [MainThread]: Command end result
[0m18:51:15.435178 [info ] [MainThread]: 
[0m18:51:15.435713 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:51:15.436137 [info ] [MainThread]: 
[0m18:51:15.436560 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Unrecognized name: discount_pct; Did you mean discount_percent? at [25:18]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m18:51:15.437009 [info ] [MainThread]: 
[0m18:51:15.437455 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m18:51:15.438126 [debug] [MainThread]: Command `dbt run` failed at 18:51:15.438002 after 27.80 seconds
[0m18:51:15.438591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb44fbe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f9a2e9d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f9a1892e0>]}
[0m18:51:15.439078 [debug] [MainThread]: Flushing usage events
[0m18:52:35.442441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0624f1fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff05fe77a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff05fe77a60>]}


============================== 18:52:35.447463 | bb25bf5e-1b03-41f8-8941-fb67d5723e12 ==============================
[0m18:52:35.447463 [info ] [MainThread]: Running with dbt=1.6.5
[0m18:52:35.448085 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/includes/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:52:36.147051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb25bf5e-1b03-41f8-8941-fb67d5723e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff05fea3a30>]}
[0m18:52:36.158912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb25bf5e-1b03-41f8-8941-fb67d5723e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff04825df70>]}
[0m18:52:36.159652 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m18:52:36.179237 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m18:52:36.273690 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:52:36.274338 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m18:52:36.319405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb25bf5e-1b03-41f8-8941-fb67d5723e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff048069f40>]}
[0m18:52:36.335089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb25bf5e-1b03-41f8-8941-fb67d5723e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff048174220>]}
[0m18:52:36.335637 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m18:52:36.336053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb25bf5e-1b03-41f8-8941-fb67d5723e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0481741f0>]}
[0m18:52:36.337734 [info ] [MainThread]: 
[0m18:52:36.338549 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:52:36.339894 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m18:52:36.340378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:37.108046 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m18:52:37.108773 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:52:37.742352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb25bf5e-1b03-41f8-8941-fb67d5723e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff048287160>]}
[0m18:52:37.743115 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:52:37.743510 [info ] [MainThread]: 
[0m18:52:37.750150 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m18:52:37.750737 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m18:52:37.751490 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m18:52:37.751909 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m18:52:37.760361 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m18:52:37.761235 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 18:52:37.752205 => 18:52:37.761012
[0m18:52:37.761654 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m18:52:37.777717 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:52:38.619720 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m18:52:38.620442 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m18:52:39.224516 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:95e9b6a6-91e1-43ac-85c6-c1bf704f6586&page=queryresults
[0m18:52:42.455664 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 18:52:37.761944 => 18:52:42.455454
[0m18:52:42.456569 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb25bf5e-1b03-41f8-8941-fb67d5723e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff047810f70>]}
[0m18:52:42.457265 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.71s]
[0m18:52:42.457990 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m18:52:42.458491 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m18:52:42.459156 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m18:52:42.459957 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m18:52:42.460422 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m18:52:42.469964 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m18:52:42.470857 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 18:52:42.460761 => 18:52:42.470559
[0m18:52:42.471323 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m18:52:42.474579 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:52:43.094807 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m18:52:43.096141 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m18:52:43.575968 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e0684fd4-f0d4-4be8-a781-0144fdddcbf9&page=queryresults
[0m18:52:47.246602 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 18:52:42.471621 => 18:52:47.246400
[0m18:52:47.247349 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb25bf5e-1b03-41f8-8941-fb67d5723e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff046f9d490>]}
[0m18:52:47.247952 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.79s]
[0m18:52:47.248671 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m18:52:47.249190 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m18:52:47.249807 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m18:52:47.250562 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m18:52:47.250976 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m18:52:47.254174 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m18:52:47.254860 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 18:52:47.251271 => 18:52:47.254658
[0m18:52:47.255255 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m18:52:47.257762 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:52:47.998251 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m18:52:47.999065 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        currency,
        initial_price AS price_original,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        CASE
            WHEN discount_percent > 0 THEN
                initial_price * (1 - discount_percent / 100)
            ELSE
                initial_price
        END AS price_with_discount,
        CASE
            WHEN discount_percent > 0 THEN
                initial_price * (1 - discount_pct / 100) + (initial_price * (1 - discount_percent / 100)) * 0.75
            ELSE
                initial_price + initial_price * 0.75
        END AS price_with_tax
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    currency,
    price_original,
    final_price,
    discount_pct,
    formatted_initial_price,
    formatted_final_price,
    ROUND(price_with_discount, 2) AS price_with_discount,
    ROUND(price_with_tax, 2) AS price_with_tax
FROM price_overview_cte
    );
  
[0m18:52:48.627191 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:aa17fe79-e864-4672-b2c4-d548cfe71643&page=queryresults
[0m18:52:49.150099 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: discount_pct; Did you mean discount_percent? at [32:38]')
[0m18:52:50.498073 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e2ffe9ff-4132-4902-ab60-b2f7ad29005e&page=queryresults
[0m18:52:51.024795 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e2ffe9ff-4132-4902-ab60-b2f7ad29005e&page=queryresults
[0m18:52:51.028162 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 18:52:47.255538 => 18:52:51.027136
[0m18:52:51.043781 [debug] [Thread-1  ]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Unrecognized name: discount_pct; Did you mean discount_percent? at [32:38]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m18:52:51.045355 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb25bf5e-1b03-41f8-8941-fb67d5723e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff046f29c70>]}
[0m18:52:51.047305 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 3.79s]
[0m18:52:51.049048 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m18:52:51.050232 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m18:52:51.051688 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m18:52:51.053260 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m18:52:51.054090 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m18:52:51.060082 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m18:52:51.061207 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 18:52:51.054679 => 18:52:51.060845
[0m18:52:51.061881 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m18:52:51.065468 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:52:51.730099 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m18:52:51.730835 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m18:52:52.361033 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:cb69cb4e-d059-48db-98b2-4b7e8af96f33&page=queryresults
[0m18:52:55.709700 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 18:52:51.062367 => 18:52:55.709496
[0m18:52:55.710440 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb25bf5e-1b03-41f8-8941-fb67d5723e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff046df8a60>]}
[0m18:52:55.711045 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.66s]
[0m18:52:55.711744 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m18:52:55.712233 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m18:52:55.712796 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m18:52:55.713465 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m18:52:55.713895 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m18:52:55.717094 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m18:52:55.717754 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 18:52:55.714180 => 18:52:55.717551
[0m18:52:55.718150 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m18:52:55.720527 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:52:56.367926 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m18:52:56.368718 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m18:52:57.007306 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:48e28c3b-ce40-4ceb-80dd-76ef6ca3808b&page=queryresults
[0m18:53:00.305778 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 18:52:55.718435 => 18:53:00.305574
[0m18:53:00.306495 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb25bf5e-1b03-41f8-8941-fb67d5723e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff044d65fa0>]}
[0m18:53:00.307085 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.59s]
[0m18:53:00.307805 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m18:53:00.308291 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m18:53:00.308793 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m18:53:00.309602 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m18:53:00.310034 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m18:53:00.313248 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m18:53:00.313935 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 18:53:00.310321 => 18:53:00.313730
[0m18:53:00.314331 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m18:53:00.316801 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:53:00.969865 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m18:53:00.972847 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m18:53:01.544004 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:6bb98855-b36a-4816-b83e-3883ae7053dc&page=queryresults
[0m18:53:04.671952 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 18:53:00.314616 => 18:53:04.671750
[0m18:53:04.672720 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb25bf5e-1b03-41f8-8941-fb67d5723e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff046f2cc40>]}
[0m18:53:04.673323 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.36s]
[0m18:53:04.674040 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m18:53:04.675864 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:53:04.676339 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m18:53:04.676762 [info ] [MainThread]: 
[0m18:53:04.677205 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 28.34 seconds (28.34s).
[0m18:53:04.678822 [debug] [MainThread]: Command end result
[0m18:53:04.692559 [info ] [MainThread]: 
[0m18:53:04.693080 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:53:04.693733 [info ] [MainThread]: 
[0m18:53:04.694100 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Unrecognized name: discount_pct; Did you mean discount_percent? at [32:38]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m18:53:04.694475 [info ] [MainThread]: 
[0m18:53:04.694859 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m18:53:04.695446 [debug] [MainThread]: Command `dbt run` failed at 18:53:04.695341 after 29.26 seconds
[0m18:53:04.695850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0624f1fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff048174400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff048174220>]}
[0m18:53:04.696259 [debug] [MainThread]: Flushing usage events
[0m18:55:14.720491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0928a7cdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0926431940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09264310a0>]}


============================== 18:55:14.725186 | 641fbc80-76dd-4e66-a3af-c4f281cb43e2 ==============================
[0m18:55:14.725186 [info ] [MainThread]: Running with dbt=1.6.5
[0m18:55:14.725786 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/includes/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/includes/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:55:15.275730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '641fbc80-76dd-4e66-a3af-c4f281cb43e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0926465850>]}
[0m18:55:15.286596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '641fbc80-76dd-4e66-a3af-c4f281cb43e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f090e7fde50>]}
[0m18:55:15.287225 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m18:55:15.303575 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m18:55:15.388170 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:55:15.388792 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m18:55:15.430672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '641fbc80-76dd-4e66-a3af-c4f281cb43e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f090e5fdeb0>]}
[0m18:55:15.445280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '641fbc80-76dd-4e66-a3af-c4f281cb43e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f090e70b100>]}
[0m18:55:15.445782 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m18:55:15.446187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '641fbc80-76dd-4e66-a3af-c4f281cb43e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f090e70b0d0>]}
[0m18:55:15.447661 [info ] [MainThread]: 
[0m18:55:15.448486 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:55:15.449832 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m18:55:15.450327 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:55:16.159528 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m18:55:16.161793 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:55:16.805132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '641fbc80-76dd-4e66-a3af-c4f281cb43e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f090e640bb0>]}
[0m18:55:16.806549 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:55:16.807325 [info ] [MainThread]: 
[0m18:55:16.818994 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m18:55:16.820130 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m18:55:16.821557 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m18:55:16.822405 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m18:55:16.837997 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m18:55:16.839361 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 18:55:16.822975 => 18:55:16.838933
[0m18:55:16.840160 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m18:55:16.863255 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:55:17.582490 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m18:55:17.583317 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m18:55:18.280250 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9cd8aff1-d35f-4f18-805e-c20702424787&page=queryresults
[0m18:55:21.678723 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 18:55:16.840746 => 18:55:21.678517
[0m18:55:21.679491 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '641fbc80-76dd-4e66-a3af-c4f281cb43e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f090dfa5e20>]}
[0m18:55:21.680094 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.86s]
[0m18:55:21.680854 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m18:55:21.681374 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m18:55:21.681944 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m18:55:21.682882 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m18:55:21.683490 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m18:55:21.692104 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m18:55:21.693108 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 18:55:21.683827 => 18:55:21.692799
[0m18:55:21.693607 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m18:55:21.696441 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:55:22.388632 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m18:55:22.389420 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m18:55:23.038977 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:6379f64a-16e3-4542-a165-64c73dafbcfb&page=queryresults
[0m18:55:26.172626 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 18:55:21.693917 => 18:55:26.171651
[0m18:55:26.175965 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '641fbc80-76dd-4e66-a3af-c4f281cb43e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f090d589a00>]}
[0m18:55:26.178800 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.49s]
[0m18:55:26.181937 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m18:55:26.184193 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m18:55:26.186874 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m18:55:26.190117 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m18:55:26.192140 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m18:55:26.198876 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m18:55:26.199723 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 18:55:26.193645 => 18:55:26.199459
[0m18:55:26.200177 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m18:55:26.202773 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:55:26.833845 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m18:55:26.837163 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        currency,
        initial_price AS price_original,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        CASE
            WHEN discount_percent > 0 THEN
                initial_price * (1 - discount_percent / 100)
            ELSE
                initial_price
        END AS price_with_discount,
        CASE
            WHEN discount_percent > 0 THEN
                initial_price * (1 - discount_percent / 100) + (initial_price * (1 - discount_percent / 100)) * 0.75
            ELSE
                initial_price + initial_price * 0.75
        END AS price_with_tax
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    currency,
    price_original,
    final_price,
    discount_pct,
    formatted_initial_price,
    formatted_final_price,
    ROUND(price_with_discount, 2) AS price_with_discount,
    ROUND(price_with_tax, 2) AS price_with_tax
FROM price_overview_cte
    );
  
[0m18:55:27.391907 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:627eddfa-9e97-42d6-801e-06d60ff6fda6&page=queryresults
[0m18:55:30.446732 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 18:55:26.200469 => 18:55:30.445759
[0m18:55:30.450079 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '641fbc80-76dd-4e66-a3af-c4f281cb43e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f090d58c7c0>]}
[0m18:55:30.452940 [info ] [Thread-1  ]: 3 of 6 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (2.7k rows, 98.5 KiB processed)[0m in 4.26s]
[0m18:55:30.456065 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m18:55:30.458340 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m18:55:30.461026 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m18:55:30.464229 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m18:55:30.466288 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m18:55:30.476513 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m18:55:30.478274 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 18:55:30.467757 => 18:55:30.477719
[0m18:55:30.479117 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m18:55:30.484100 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:55:31.160705 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m18:55:31.161525 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m18:55:31.811230 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ac46b6aa-b153-4d02-b9e0-14077470c058&page=queryresults
[0m18:55:34.678822 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 18:55:30.479714 => 18:55:34.678614
[0m18:55:34.679599 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '641fbc80-76dd-4e66-a3af-c4f281cb43e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f090d5ada60>]}
[0m18:55:34.680235 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.22s]
[0m18:55:34.680944 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m18:55:34.681446 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m18:55:34.682096 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m18:55:34.682832 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m18:55:34.683255 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m18:55:34.686565 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m18:55:34.687326 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 18:55:34.683554 => 18:55:34.687055
[0m18:55:34.687769 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m18:55:34.690320 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:55:35.382573 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m18:55:35.383321 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m18:55:36.044778 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ebec7d71-59fc-44b4-bda7-45e3d492973a&page=queryresults
[0m18:55:38.619022 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 18:55:34.688059 => 18:55:38.617972
[0m18:55:38.622568 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '641fbc80-76dd-4e66-a3af-c4f281cb43e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f090d5add90>]}
[0m18:55:38.624877 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 3.94s]
[0m18:55:38.627286 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m18:55:38.628923 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m18:55:38.630819 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m18:55:38.633125 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m18:55:38.634542 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m18:55:38.643439 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m18:55:38.644849 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 18:55:38.635548 => 18:55:38.644399
[0m18:55:38.645692 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m18:55:38.650393 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:55:39.368886 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m18:55:39.371895 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m18:55:39.964819 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:edd4faf8-cca1-4c99-bec3-fba32a0a752d&page=queryresults
[0m18:55:43.058749 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 18:55:38.646295 => 18:55:43.057774
[0m18:55:43.062254 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '641fbc80-76dd-4e66-a3af-c4f281cb43e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f090d6cc6d0>]}
[0m18:55:43.065101 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.43s]
[0m18:55:43.068213 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m18:55:43.074483 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:55:43.076210 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m18:55:43.078082 [info ] [MainThread]: 
[0m18:55:43.079958 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 27.63 seconds (27.63s).
[0m18:55:43.087474 [debug] [MainThread]: Command end result
[0m18:55:43.123532 [info ] [MainThread]: 
[0m18:55:43.124190 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:55:43.124797 [info ] [MainThread]: 
[0m18:55:43.125383 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:55:43.126277 [debug] [MainThread]: Command `dbt run` succeeded at 18:55:43.126109 after 28.41 seconds
[0m18:55:43.126849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0928a7cdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f090e7fde50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f090e70b280>]}
[0m18:55:43.127427 [debug] [MainThread]: Flushing usage events
[0m19:22:49.148535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a7e7ae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a58119a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a5811070>]}


============================== 19:22:49.153759 | f7ff3666-d4b4-441e-98d6-bed379f52a37 ==============================
[0m19:22:49.153759 [info ] [MainThread]: Running with dbt=1.6.5
[0m19:22:49.154376 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/includes/dbt/logs', 'profiles_dir': '/opt/airflow/includes/dbt/', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'send_anonymous_usage_stats': 'True'}
[0m19:22:49.896817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7ff3666-d4b4-441e-98d6-bed379f52a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a583d910>]}
[0m19:22:49.909032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f7ff3666-d4b4-441e-98d6-bed379f52a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f008dbf1eb0>]}
[0m19:22:49.909906 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m19:22:49.927913 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m19:22:50.020067 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:22:50.020743 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m19:22:50.066123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7ff3666-d4b4-441e-98d6-bed379f52a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f008d9f8e80>]}
[0m19:22:50.081783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7ff3666-d4b4-441e-98d6-bed379f52a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f008db08100>]}
[0m19:22:50.082294 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m19:22:50.082680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7ff3666-d4b4-441e-98d6-bed379f52a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f008db08160>]}
[0m19:22:50.084134 [info ] [MainThread]: 
[0m19:22:50.084906 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:22:50.086380 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m19:22:50.086966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:22:50.756492 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m19:22:50.757032 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:22:51.417130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7ff3666-d4b4-441e-98d6-bed379f52a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f008da3cc10>]}
[0m19:22:51.420894 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:22:51.423985 [info ] [MainThread]: 
[0m19:22:51.449063 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m19:22:51.450551 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m19:22:51.452181 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m19:22:51.453097 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m19:22:51.468128 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m19:22:51.469480 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 19:22:51.453699 => 19:22:51.469048
[0m19:22:51.470151 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m19:22:51.491232 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:22:52.191217 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m19:22:52.191953 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m19:22:52.990914 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a1a6fb30-3891-4005-971b-7ddda15ee25a&page=queryresults
[0m19:22:56.002646 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 19:22:51.470609 => 19:22:56.002112
[0m19:22:56.004771 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7ff3666-d4b4-441e-98d6-bed379f52a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f008d1a1df0>]}
[0m19:22:56.006213 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.55s]
[0m19:22:56.007612 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m19:22:56.008597 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m19:22:56.009779 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m19:22:56.011284 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m19:22:56.012132 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m19:22:56.025316 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m19:22:56.026413 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 19:22:56.012745 => 19:22:56.026055
[0m19:22:56.027023 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m19:22:56.030717 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:22:56.666441 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m19:22:56.669823 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m19:22:57.306833 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:878ac31d-7d02-42c0-8104-75808cd34ed1&page=queryresults
[0m19:23:00.339332 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 19:22:56.027448 => 19:23:00.338315
[0m19:23:00.342734 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7ff3666-d4b4-441e-98d6-bed379f52a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f008d1a12b0>]}
[0m19:23:00.345642 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.33s]
[0m19:23:00.349357 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m19:23:00.352350 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m19:23:00.355318 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m19:23:00.359000 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m19:23:00.361531 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m19:23:00.377365 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m19:23:00.381968 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 19:23:00.363294 => 19:23:00.380815
[0m19:23:00.384052 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m19:23:00.396444 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:23:01.118436 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m19:23:01.121832 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        currency,
        initial_price AS price_original,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        CASE
            WHEN discount_pct > 0 THEN
                price_original * (discount_percent / 100)  -- Monto del descuento
            ELSE
                0  -- Si no hay descuento, el monto del descuento es cero
        END AS discount_amount,
        CASE
            WHEN discount_percent > 0 THEN
                initial_price * (1 - discount_percent / 100) + (initial_price * (1 - discount_percent / 100)) * 0.75
            ELSE
                initial_price + initial_price * 0.75
        END AS price_with_tax
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    currency,
    price_original,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    ROUND(price_with_tax, 2) AS price_with_tax
    CONCAT('ARS$ ', CAST(ROUND(price_with_tax, 2) AS STRING)) AS formatted_price_with_tax  -- Formato ARS$ xxx,xx

FROM price_overview_cte
    );
  
[0m19:23:01.447777 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:2162056a-9d1a-4633-9799-8480ecf0dd16&page=queryresults
[0m19:23:01.452953 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got identifier "CONCAT" at [49:5]')
[0m19:23:02.202685 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5ff5317a-153e-4939-8fda-7f6c4d99395e&page=queryresults
[0m19:23:02.207576 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5ff5317a-153e-4939-8fda-7f6c4d99395e&page=queryresults
[0m19:23:02.211282 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 19:23:00.385629 => 19:23:02.210250
[0m19:23:02.244187 [debug] [Thread-1  ]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Syntax error: Expected ")" but got identifier "CONCAT" at [49:5]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m19:23:02.246620 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7ff3666-d4b4-441e-98d6-bed379f52a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f008c8c2af0>]}
[0m19:23:02.249690 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 1.89s]
[0m19:23:02.253758 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m19:23:02.256189 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m19:23:02.259055 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m19:23:02.263178 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m19:23:02.265285 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m19:23:02.281354 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m19:23:02.283769 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 19:23:02.266746 => 19:23:02.283018
[0m19:23:02.285205 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m19:23:02.292929 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:23:03.039900 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m19:23:03.041011 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m19:23:03.660607 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:8f882d11-0151-4d91-bd11-d25865d145d3&page=queryresults
[0m19:23:06.773948 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 19:23:02.286196 => 19:23:06.772948
[0m19:23:06.777534 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7ff3666-d4b4-441e-98d6-bed379f52a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f008c7908e0>]}
[0m19:23:06.780777 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.52s]
[0m19:23:06.784035 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m19:23:06.786313 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m19:23:06.788960 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m19:23:06.792580 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m19:23:06.794722 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m19:23:06.810147 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m19:23:06.813459 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 19:23:06.796195 => 19:23:06.812335
[0m19:23:06.815535 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m19:23:06.827331 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:23:07.512986 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m19:23:07.515977 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m19:23:08.180256 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9b8407e4-4cf5-4a58-8234-d58949811f37&page=queryresults
[0m19:23:11.269955 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 19:23:06.817050 => 19:23:11.268973
[0m19:23:11.273397 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7ff3666-d4b4-441e-98d6-bed379f52a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f008d1a15b0>]}
[0m19:23:11.276244 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.48s]
[0m19:23:11.282754 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m19:23:11.285540 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m19:23:11.288296 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m19:23:11.292950 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m19:23:11.295172 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m19:23:11.310732 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m19:23:11.313987 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 19:23:11.296770 => 19:23:11.312956
[0m19:23:11.316027 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m19:23:11.328305 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:23:12.056165 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m19:23:12.056909 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m19:23:12.665357 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:60862043-18c3-4e19-b7d1-c77f3649007f&page=queryresults
[0m19:23:15.433739 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 19:23:11.317566 => 19:23:15.433527
[0m19:23:15.434491 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7ff3666-d4b4-441e-98d6-bed379f52a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f008c78ed30>]}
[0m19:23:15.435213 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.14s]
[0m19:23:15.435923 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m19:23:15.437452 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:23:15.437875 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m19:23:15.438314 [info ] [MainThread]: 
[0m19:23:15.438790 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 25.35 seconds (25.35s).
[0m19:23:15.440436 [debug] [MainThread]: Command end result
[0m19:23:15.455436 [info ] [MainThread]: 
[0m19:23:15.455934 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:23:15.456310 [info ] [MainThread]: 
[0m19:23:15.456678 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Syntax error: Expected ")" but got identifier "CONCAT" at [49:5]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m19:23:15.457076 [info ] [MainThread]: 
[0m19:23:15.457459 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m19:23:15.458054 [debug] [MainThread]: Command `dbt run` failed at 19:23:15.457948 after 26.32 seconds
[0m19:23:15.458463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a7e7ae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f008dbf12e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f008db08370>]}
[0m19:23:15.458883 [debug] [MainThread]: Flushing usage events
[0m19:24:06.027304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1040662e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f103dff99a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f103dff9070>]}


============================== 19:24:06.033018 | 83303ade-cdcd-4235-a813-d2423925e5a2 ==============================
[0m19:24:06.033018 [info ] [MainThread]: Running with dbt=1.6.5
[0m19:24:06.033728 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'log_path': '/opt/airflow/includes/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'send_anonymous_usage_stats': 'True'}
[0m19:24:06.676929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83303ade-cdcd-4235-a813-d2423925e5a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f103e02d880>]}
[0m19:24:06.688685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83303ade-cdcd-4235-a813-d2423925e5a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10263e9e80>]}
[0m19:24:06.689572 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m19:24:06.708923 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m19:24:06.803571 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:24:06.804227 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m19:24:06.851175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83303ade-cdcd-4235-a813-d2423925e5a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10261e0ee0>]}
[0m19:24:06.867706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83303ade-cdcd-4235-a813-d2423925e5a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10262f1130>]}
[0m19:24:06.868278 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m19:24:06.868774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83303ade-cdcd-4235-a813-d2423925e5a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10262f1100>]}
[0m19:24:06.870552 [info ] [MainThread]: 
[0m19:24:06.871661 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:24:06.873160 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m19:24:06.873749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:07.541522 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m19:24:07.542060 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:24:08.145923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83303ade-cdcd-4235-a813-d2423925e5a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1026228be0>]}
[0m19:24:08.146688 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:24:08.147084 [info ] [MainThread]: 
[0m19:24:08.154516 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m19:24:08.155173 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m19:24:08.156061 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m19:24:08.156564 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m19:24:08.165934 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m19:24:08.166930 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 19:24:08.156884 => 19:24:08.166537
[0m19:24:08.167479 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m19:24:08.184869 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:24:08.881910 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m19:24:08.882738 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m19:24:09.598765 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:8a343e65-f575-4a26-92ef-f64e4fde47ad&page=queryresults
[0m19:24:12.811203 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 19:24:08.167787 => 19:24:12.810847
[0m19:24:12.812558 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83303ade-cdcd-4235-a813-d2423925e5a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102598cf40>]}
[0m19:24:12.813853 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.66s]
[0m19:24:12.815269 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m19:24:12.816326 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m19:24:12.817419 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m19:24:12.818682 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m19:24:12.819848 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m19:24:12.831946 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m19:24:12.834106 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 19:24:12.820322 => 19:24:12.832592
[0m19:24:12.834824 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m19:24:12.838255 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:24:13.508114 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m19:24:13.511226 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m19:24:14.113392 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:295c86e8-d238-462f-b08d-c026f6712613&page=queryresults
[0m19:24:16.936326 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 19:24:12.835256 => 19:24:16.935340
[0m19:24:16.939884 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83303ade-cdcd-4235-a813-d2423925e5a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102511c610>]}
[0m19:24:16.942813 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.12s]
[0m19:24:16.946218 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m19:24:16.948567 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m19:24:16.951376 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m19:24:16.954843 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m19:24:16.956953 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m19:24:16.972016 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m19:24:16.975251 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 19:24:16.958431 => 19:24:16.974194
[0m19:24:16.977395 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m19:24:16.988618 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:24:17.686914 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m19:24:17.688141 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        currency,
        initial_price AS price_original,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        CASE
            WHEN discount_pct > 0 THEN
                price_original * (discount_percent / 100)  -- Monto del descuento
            ELSE
                0  -- Si no hay descuento, el monto del descuento es cero
        END AS discount_amount,
        CASE
            WHEN discount_percent > 0 THEN
                initial_price * (1 - discount_percent / 100) + (initial_price * (1 - discount_percent / 100)) * 0.75
            ELSE
                initial_price + initial_price * 0.75
        END AS price_with_tax
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    currency,
    price_original,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    ROUND(price_with_tax, 2) AS price_with_tax
    CONCAT('ARS$ ', CAST(ROUND(price_with_tax, 2) AS STRING)) AS formatted_price_with_tax  -- Formato ARS$ 400,00
FROM price_overview_cte
    );
  
[0m19:24:18.122985 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:bdd6ee0c-cab1-43bb-8ed7-b8c549789aed&page=queryresults
[0m19:24:18.124118 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got identifier "CONCAT" at [49:5]')
[0m19:24:18.977426 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a2d927d2-8668-4645-bb77-42efd16e3e93&page=queryresults
[0m19:24:18.982355 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a2d927d2-8668-4645-bb77-42efd16e3e93&page=queryresults
[0m19:24:18.986512 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 19:24:16.979027 => 19:24:18.985360
[0m19:24:19.003271 [debug] [Thread-1  ]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Syntax error: Expected ")" but got identifier "CONCAT" at [49:5]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m19:24:19.005809 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83303ade-cdcd-4235-a813-d2423925e5a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102507fb80>]}
[0m19:24:19.008972 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 2.05s]
[0m19:24:19.012258 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m19:24:19.014692 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m19:24:19.017512 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m19:24:19.020903 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m19:24:19.023011 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m19:24:19.038846 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m19:24:19.042082 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 19:24:19.024497 => 19:24:19.041063
[0m19:24:19.044258 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m19:24:19.054969 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:24:19.699236 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m19:24:19.699937 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m19:24:20.278502 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:055c96c7-65b5-465b-bfc7-67542511c304&page=queryresults
[0m19:24:23.473853 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 19:24:19.045838 => 19:24:23.473617
[0m19:24:23.474628 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83303ade-cdcd-4235-a813-d2423925e5a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102511cd90>]}
[0m19:24:23.475520 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.46s]
[0m19:24:23.478588 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m19:24:23.479867 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m19:24:23.480584 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m19:24:23.481380 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m19:24:23.481809 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m19:24:23.485381 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m19:24:23.486215 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 19:24:23.482104 => 19:24:23.485962
[0m19:24:23.486639 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m19:24:23.490175 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:24:24.140588 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m19:24:24.141445 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m19:24:24.751893 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:0b2b4503-6901-4d66-85b5-f99e93e0a54e&page=queryresults
[0m19:24:27.576534 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 19:24:23.486930 => 19:24:27.575670
[0m19:24:27.579429 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83303ade-cdcd-4235-a813-d2423925e5a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102598c700>]}
[0m19:24:27.581857 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.10s]
[0m19:24:27.587665 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m19:24:27.589792 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m19:24:27.592056 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m19:24:27.594945 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m19:24:27.596767 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m19:24:27.608173 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m19:24:27.610162 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 19:24:27.598058 => 19:24:27.609525
[0m19:24:27.611334 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m19:24:27.617539 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:24:28.291519 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m19:24:28.294686 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m19:24:28.857788 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:42e4b409-0bfb-40e0-a743-e6bb96e210db&page=queryresults
[0m19:24:31.984343 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 19:24:27.612189 => 19:24:31.983358
[0m19:24:31.987960 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83303ade-cdcd-4235-a813-d2423925e5a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1024f6c430>]}
[0m19:24:31.991339 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.39s]
[0m19:24:31.996077 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m19:24:32.001805 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:24:32.003092 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m19:24:32.004386 [info ] [MainThread]: 
[0m19:24:32.006097 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 25.13 seconds (25.13s).
[0m19:24:32.011838 [debug] [MainThread]: Command end result
[0m19:24:32.038332 [info ] [MainThread]: 
[0m19:24:32.039056 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:24:32.039649 [info ] [MainThread]: 
[0m19:24:32.040168 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Syntax error: Expected ")" but got identifier "CONCAT" at [49:5]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m19:24:32.040713 [info ] [MainThread]: 
[0m19:24:32.041362 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m19:24:32.042262 [debug] [MainThread]: Command `dbt run` failed at 19:24:32.042098 after 26.02 seconds
[0m19:24:32.042805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1040662e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10262f1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10262f1280>]}
[0m19:24:32.043356 [debug] [MainThread]: Flushing usage events
[0m19:25:20.820420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f913788ef70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9135273a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9135273a00>]}


============================== 19:25:20.825346 | a3a28f4b-91a2-4cb5-920a-0ae3fc0855c2 ==============================
[0m19:25:20.825346 [info ] [MainThread]: Running with dbt=1.6.5
[0m19:25:20.826010 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/includes/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'send_anonymous_usage_stats': 'True'}
[0m19:25:21.407904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3a28f4b-91a2-4cb5-920a-0ae3fc0855c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9135220910>]}
[0m19:25:21.419250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3a28f4b-91a2-4cb5-920a-0ae3fc0855c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911d604f10>]}
[0m19:25:21.420003 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m19:25:21.437526 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m19:25:21.525605 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:25:21.526273 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m19:25:21.569027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3a28f4b-91a2-4cb5-920a-0ae3fc0855c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911d3ffee0>]}
[0m19:25:21.584125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3a28f4b-91a2-4cb5-920a-0ae3fc0855c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911d5141c0>]}
[0m19:25:21.584665 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m19:25:21.585146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3a28f4b-91a2-4cb5-920a-0ae3fc0855c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911d514190>]}
[0m19:25:21.586645 [info ] [MainThread]: 
[0m19:25:21.587465 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:25:21.588822 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m19:25:21.589267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:25:22.274600 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m19:25:22.275207 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:25:22.878281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3a28f4b-91a2-4cb5-920a-0ae3fc0855c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911d3fff10>]}
[0m19:25:22.879061 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:25:22.879469 [info ] [MainThread]: 
[0m19:25:22.886034 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m19:25:22.886741 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m19:25:22.887551 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m19:25:22.887998 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m19:25:22.896338 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m19:25:22.897170 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 19:25:22.888296 => 19:25:22.896923
[0m19:25:22.897616 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m19:25:22.913631 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:25:23.563890 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m19:25:23.564931 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m19:25:24.178214 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:136dfcff-fdcb-4de5-a88a-51a7ac3aa318&page=queryresults
[0m19:25:26.704480 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 19:25:22.897970 => 19:25:26.704251
[0m19:25:26.705417 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3a28f4b-91a2-4cb5-920a-0ae3fc0855c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911cdaeee0>]}
[0m19:25:26.706126 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 3.82s]
[0m19:25:26.707451 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m19:25:26.707999 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m19:25:26.708533 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m19:25:26.709798 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m19:25:26.710365 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m19:25:26.720490 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m19:25:26.721391 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 19:25:26.710811 => 19:25:26.721127
[0m19:25:26.721911 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m19:25:26.725431 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:25:27.346620 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m19:25:27.347363 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m19:25:27.946343 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7bdc7fe7-01b3-429f-b8a2-ffb980e1ce37&page=queryresults
[0m19:25:31.020914 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 19:25:26.722302 => 19:25:31.019889
[0m19:25:31.024241 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3a28f4b-91a2-4cb5-920a-0ae3fc0855c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911cdaea60>]}
[0m19:25:31.027090 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.31s]
[0m19:25:31.030272 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m19:25:31.032552 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m19:25:31.035243 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m19:25:31.038481 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m19:25:31.040547 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m19:25:31.051660 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m19:25:31.053335 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 19:25:31.042061 => 19:25:31.052804
[0m19:25:31.054375 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m19:25:31.059411 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:25:31.704380 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m19:25:31.705195 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        currency,
        initial_price AS price_original,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        CASE
            WHEN discount_pct > 0 THEN
                price_original * (discount_percent / 100)  -- Monto del descuento
            ELSE
                0  -- Si no hay descuento, el monto del descuento es cero
        END AS discount_amount,
        CASE
            WHEN discount_percent > 0 THEN
                initial_price * (1 - discount_percent / 100) + (initial_price * (1 - discount_percent / 100)) * 0.75
            ELSE
                initial_price + initial_price * 0.75
        END AS price_with_tax
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    currency,
    price_original,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    ROUND(price_with_tax, 2) AS price_with_tax
    'ARS$ ' || CAST(ROUND(price_with_tax, 2) AS STRING) AS formatted_price_with_tax  -- Formato ARS$ 400,00
FROM price_overview_cte
    );
  
[0m19:25:32.040005 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a99a1dfd-8683-4673-bf19-79da893372f2&page=queryresults
[0m19:25:32.041125 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got string literal \'ARS$ \' at [49:5]')
[0m19:25:33.054652 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9d3a617d-bbfc-4609-bdf6-4cce07ca4554&page=queryresults
[0m19:25:33.055818 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9d3a617d-bbfc-4609-bdf6-4cce07ca4554&page=queryresults
[0m19:25:33.056589 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 19:25:31.055080 => 19:25:33.056350
[0m19:25:33.060115 [debug] [Thread-1  ]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Syntax error: Expected ")" but got string literal 'ARS$ ' at [49:5]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m19:25:33.060727 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3a28f4b-91a2-4cb5-920a-0ae3fc0855c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911c4c5a90>]}
[0m19:25:33.061420 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 2.02s]
[0m19:25:33.062185 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m19:25:33.062779 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m19:25:33.063527 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m19:25:33.064408 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m19:25:33.064929 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m19:25:33.068834 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m19:25:33.069791 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 19:25:33.065278 => 19:25:33.069506
[0m19:25:33.070262 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m19:25:33.073150 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:25:33.754991 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m19:25:33.758673 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m19:25:34.241435 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ea94a330-5c4e-4880-8d49-0c0bc542dd3e&page=queryresults
[0m19:25:37.737470 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 19:25:33.070578 => 19:25:37.736466
[0m19:25:37.740990 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3a28f4b-91a2-4cb5-920a-0ae3fc0855c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911c48b5e0>]}
[0m19:25:37.744272 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.68s]
[0m19:25:37.748520 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m19:25:37.750927 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m19:25:37.753577 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m19:25:37.757517 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m19:25:37.760008 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m19:25:37.775462 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m19:25:37.778237 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 19:25:37.761828 => 19:25:37.777523
[0m19:25:37.779635 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m19:25:37.787253 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:25:38.474881 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m19:25:38.477925 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m19:25:39.025255 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:4ed45cd9-7302-4892-9d4a-08ec236b45df&page=queryresults
[0m19:25:41.855216 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 19:25:37.780638 => 19:25:41.855007
[0m19:25:41.856083 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3a28f4b-91a2-4cb5-920a-0ae3fc0855c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911cdae580>]}
[0m19:25:41.856819 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.10s]
[0m19:25:41.857602 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m19:25:41.858142 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m19:25:41.858761 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m19:25:41.859494 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m19:25:41.859949 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m19:25:41.863546 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m19:25:41.864328 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 19:25:41.860252 => 19:25:41.864090
[0m19:25:41.864784 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m19:25:41.867470 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:25:42.544154 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m19:25:42.545275 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m19:25:43.160038 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e9dfaa45-8d66-4c5c-8180-bbef68fb4189&page=queryresults
[0m19:25:45.975379 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 19:25:41.865088 => 19:25:45.975170
[0m19:25:45.976204 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3a28f4b-91a2-4cb5-920a-0ae3fc0855c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911c494a00>]}
[0m19:25:45.976934 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.12s]
[0m19:25:45.977748 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m19:25:45.979324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:25:45.979857 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m19:25:45.980287 [info ] [MainThread]: 
[0m19:25:45.980749 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 24.39 seconds (24.39s).
[0m19:25:45.982275 [debug] [MainThread]: Command end result
[0m19:25:45.995945 [info ] [MainThread]: 
[0m19:25:45.996450 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:25:45.996867 [info ] [MainThread]: 
[0m19:25:45.997265 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Syntax error: Expected ")" but got string literal 'ARS$ ' at [49:5]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m19:25:45.997655 [info ] [MainThread]: 
[0m19:25:45.998165 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m19:25:45.998751 [debug] [MainThread]: Command `dbt run` failed at 19:25:45.998646 after 25.18 seconds
[0m19:25:45.999150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f913788ef70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911d5142e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911d514400>]}
[0m19:25:45.999557 [debug] [MainThread]: Flushing usage events
[0m19:26:21.444679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f7bf14f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f7989aa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f7989a0a0>]}


============================== 19:26:21.450007 | 95e2f201-d118-4fd0-be60-3d7decb927ba ==============================
[0m19:26:21.450007 [info ] [MainThread]: Running with dbt=1.6.5
[0m19:26:21.450548 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'log_path': '/opt/airflow/includes/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:26:22.099493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95e2f201-d118-4fd0-be60-3d7decb927ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f798c8910>]}
[0m19:26:22.111578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95e2f201-d118-4fd0-be60-3d7decb927ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f61c81ee0>]}
[0m19:26:22.112350 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m19:26:22.130000 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m19:26:22.222301 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:26:22.222987 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m19:26:22.269721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95e2f201-d118-4fd0-be60-3d7decb927ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f61adfeb0>]}
[0m19:26:22.285732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95e2f201-d118-4fd0-be60-3d7decb927ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f61b8f130>]}
[0m19:26:22.286514 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m19:26:22.287064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95e2f201-d118-4fd0-be60-3d7decb927ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f61b8f190>]}
[0m19:26:22.288766 [info ] [MainThread]: 
[0m19:26:22.289631 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:26:22.291012 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m19:26:22.291531 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:26:22.950697 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m19:26:22.951306 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:26:23.567359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95e2f201-d118-4fd0-be60-3d7decb927ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f61adffd0>]}
[0m19:26:23.568169 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:26:23.568580 [info ] [MainThread]: 
[0m19:26:23.575606 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m19:26:23.576202 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m19:26:23.576925 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m19:26:23.577352 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m19:26:23.586313 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m19:26:23.587139 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 19:26:23.577656 => 19:26:23.586887
[0m19:26:23.587615 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m19:26:23.603600 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:26:24.328738 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m19:26:24.329503 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m19:26:24.967685 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:69952505-773d-450f-8366-0b1705aa6c40&page=queryresults
[0m19:26:28.170526 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 19:26:23.587934 => 19:26:28.170181
[0m19:26:28.171792 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95e2f201-d118-4fd0-be60-3d7decb927ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f61426e20>]}
[0m19:26:28.172887 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.60s]
[0m19:26:28.174293 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m19:26:28.175149 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m19:26:28.176022 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m19:26:28.177534 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m19:26:28.178143 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m19:26:28.189486 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m19:26:28.190467 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 19:26:28.178594 => 19:26:28.190184
[0m19:26:28.191098 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m19:26:28.194322 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:26:28.968680 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m19:26:28.969769 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m19:26:29.599189 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:330ae00f-dd17-4a85-a7b8-95c6a893e876&page=queryresults
[0m19:26:32.487872 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 19:26:28.191489 => 19:26:32.487646
[0m19:26:32.488708 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95e2f201-d118-4fd0-be60-3d7decb927ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f61426dc0>]}
[0m19:26:32.489360 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.31s]
[0m19:26:32.490034 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m19:26:32.490518 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m19:26:32.491012 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m19:26:32.491780 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m19:26:32.492208 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m19:26:32.495495 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m19:26:32.496210 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 19:26:32.492507 => 19:26:32.495993
[0m19:26:32.496629 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m19:26:32.499222 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:26:33.177872 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m19:26:33.180159 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        currency,
        initial_price AS price_original,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        CASE
            WHEN discount_pct > 0 THEN
                price_original * (discount_percent / 100)  -- Monto del descuento
            ELSE
                0  -- Si no hay descuento, el monto del descuento es cero
        END AS discount_amount,
        CASE
            WHEN discount_percent > 0 THEN
                initial_price * (1 - discount_percent / 100) + (initial_price * (1 - discount_percent / 100)) * 0.75
            ELSE
                initial_price + initial_price * 0.75
        END AS price_with_tax
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    currency,
    price_original,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    ROUND(price_with_tax, 2) AS price_with_tax
    CONCAT('ARS$ ', CAST(ROUND(price_with_tax, 2) AS STRING)) AS formatted_price_with_tax  -- Formato ARS$ 400,00
FROM price_overview_cte
    );
  
[0m19:26:33.498647 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a5772c71-4d6f-42d7-abd1-3d3b4ecddf0f&page=queryresults
[0m19:26:33.503075 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got identifier "CONCAT" at [49:5]')
[0m19:26:33.851587 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:832713b0-e757-40e0-8d45-9bd040afc9e4&page=queryresults
[0m19:26:33.856535 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:832713b0-e757-40e0-8d45-9bd040afc9e4&page=queryresults
[0m19:26:33.861069 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 19:26:32.496942 => 19:26:33.859909
[0m19:26:33.878529 [debug] [Thread-1  ]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Syntax error: Expected ")" but got identifier "CONCAT" at [49:5]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m19:26:33.880954 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95e2f201-d118-4fd0-be60-3d7decb927ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f60b1bd30>]}
[0m19:26:33.883855 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 1.39s]
[0m19:26:33.887265 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m19:26:33.889783 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m19:26:33.892612 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m19:26:33.895920 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m19:26:33.898050 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m19:26:33.914396 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m19:26:33.917792 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 19:26:33.899530 => 19:26:33.916695
[0m19:26:33.919904 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m19:26:33.932070 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:26:34.622018 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m19:26:34.624157 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m19:26:35.215508 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:779d5859-e0bf-4e2d-a599-2b26f85e04ee&page=queryresults
[0m19:26:38.597769 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 19:26:33.921448 => 19:26:38.596772
[0m19:26:38.602014 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95e2f201-d118-4fd0-be60-3d7decb927ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f61ad0310>]}
[0m19:26:38.605573 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.71s]
[0m19:26:38.610242 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m19:26:38.613124 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m19:26:38.615982 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m19:26:38.621696 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m19:26:38.623689 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m19:26:38.632177 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m19:26:38.634891 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 19:26:38.624710 => 19:26:38.634292
[0m19:26:38.635828 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m19:26:38.640818 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:26:39.285750 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m19:26:39.287340 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m19:26:39.949878 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:4ef60db9-d3d3-4eed-965d-64ab1d35db3b&page=queryresults
[0m19:26:42.775750 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 19:26:38.636470 => 19:26:42.775537
[0m19:26:42.776502 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95e2f201-d118-4fd0-be60-3d7decb927ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f60a12a00>]}
[0m19:26:42.777139 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.16s]
[0m19:26:42.777794 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m19:26:42.778269 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m19:26:42.778874 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m19:26:42.779566 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m19:26:42.779984 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m19:26:42.783269 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m19:26:42.783968 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 19:26:42.780285 => 19:26:42.783751
[0m19:26:42.784387 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m19:26:42.786961 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:26:43.446397 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m19:26:43.447839 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m19:26:44.050114 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:47919f4b-4aa3-40d9-b42a-8e1731725d43&page=queryresults
[0m19:26:46.558383 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 19:26:42.784696 => 19:26:46.557396
[0m19:26:46.562936 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95e2f201-d118-4fd0-be60-3d7decb927ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f60a16460>]}
[0m19:26:46.566416 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 3.78s]
[0m19:26:46.570378 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m19:26:46.577549 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:26:46.579501 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m19:26:46.581598 [info ] [MainThread]: 
[0m19:26:46.583608 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 24.29 seconds (24.29s).
[0m19:26:46.590987 [debug] [MainThread]: Command end result
[0m19:26:46.657533 [info ] [MainThread]: 
[0m19:26:46.658947 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:26:46.660236 [info ] [MainThread]: 
[0m19:26:46.661482 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Syntax error: Expected ")" but got identifier "CONCAT" at [49:5]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m19:26:46.662729 [info ] [MainThread]: 
[0m19:26:46.664229 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m19:26:46.666121 [debug] [MainThread]: Command `dbt run` failed at 19:26:46.665802 after 25.23 seconds
[0m19:26:46.667271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f7bf14f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f61c81fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f61b976d0>]}
[0m19:26:46.668318 [debug] [MainThread]: Flushing usage events
[0m19:27:40.332374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5affdcd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5ad992880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5ad992070>]}


============================== 19:27:40.337713 | 748d03e4-d8f0-4592-9301-0d6c2556bd81 ==============================
[0m19:27:40.337713 [info ] [MainThread]: Running with dbt=1.6.5
[0m19:27:40.338238 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/includes/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:27:40.929786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '748d03e4-d8f0-4592-9301-0d6c2556bd81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5ad9c27f0>]}
[0m19:27:40.941527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '748d03e4-d8f0-4592-9301-0d6c2556bd81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb595d62df0>]}
[0m19:27:40.942287 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m19:27:40.959607 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m19:27:41.050392 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:27:41.051066 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m19:27:41.098832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '748d03e4-d8f0-4592-9301-0d6c2556bd81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb595bb4e50>]}
[0m19:27:41.115557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '748d03e4-d8f0-4592-9301-0d6c2556bd81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb595c681f0>]}
[0m19:27:41.116165 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m19:27:41.116604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '748d03e4-d8f0-4592-9301-0d6c2556bd81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb595c68040>]}
[0m19:27:41.118211 [info ] [MainThread]: 
[0m19:27:41.119065 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:27:41.120409 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m19:27:41.120815 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:27:41.797701 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m19:27:41.798272 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:27:42.465164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '748d03e4-d8f0-4592-9301-0d6c2556bd81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb595ba1fd0>]}
[0m19:27:42.468598 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:27:42.470499 [info ] [MainThread]: 
[0m19:27:42.497837 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m19:27:42.499228 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m19:27:42.501056 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m19:27:42.502096 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m19:27:42.510106 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m19:27:42.510825 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 19:27:42.502425 => 19:27:42.510579
[0m19:27:42.511244 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m19:27:42.525962 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:27:43.282040 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m19:27:43.282848 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m19:27:43.933214 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:13c8a1ce-81c0-4d6f-9c3f-f17d4eae4a2f&page=queryresults
[0m19:27:46.753550 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 19:27:42.511538 => 19:27:46.753348
[0m19:27:46.754335 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '748d03e4-d8f0-4592-9301-0d6c2556bd81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb595307d00>]}
[0m19:27:46.754937 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.25s]
[0m19:27:46.755666 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m19:27:46.756172 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m19:27:46.756741 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m19:27:46.757531 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m19:27:46.757958 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m19:27:46.765947 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m19:27:46.766743 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 19:27:46.758245 => 19:27:46.766502
[0m19:27:46.767203 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m19:27:46.770181 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:27:47.431581 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m19:27:47.432354 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m19:27:47.864823 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:0114c389-91bf-49c1-80ec-a4ceb629c679&page=queryresults
[0m19:27:51.007314 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 19:27:46.767568 => 19:27:51.006343
[0m19:27:51.010671 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '748d03e4-d8f0-4592-9301-0d6c2556bd81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5953071c0>]}
[0m19:27:51.013495 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.25s]
[0m19:27:51.016688 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m19:27:51.018939 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m19:27:51.021595 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m19:27:51.024784 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m19:27:51.026844 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m19:27:51.038852 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m19:27:51.040487 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 19:27:51.028291 => 19:27:51.039967
[0m19:27:51.041529 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m19:27:51.046721 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:27:51.730721 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m19:27:51.731588 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        currency,
        initial_price AS price_original,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        CASE
            WHEN discount_pct > 0 THEN
                price_original * (discount_percent / 100)  -- Monto del descuento
            ELSE
                0  -- Si no hay descuento, el monto del descuento es cero
        END AS discount_amount,
        CASE
            WHEN discount_percent > 0 THEN
                initial_price * (1 - discount_percent / 100) + (initial_price * (1 - discount_percent / 100)) * 0.75
            ELSE
                initial_price + initial_price * 0.75
        END AS price_with_tax
        CONCAT('ARS$ ', CAST(ROUND(price_with_tax, 2) AS STRING)) AS formatted_price_with_tax  -- Formato ARS$ 400,00

    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    currency,
    price_original,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    ROUND(price_with_tax, 2) AS price_with_tax
FROM price_overview_cte
    );
  
[0m19:27:52.039058 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:8688f72f-0aaf-41b5-b534-0a3dc74f48fa&page=queryresults
[0m19:27:52.043714 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got identifier "CONCAT" at [36:9]')
[0m19:27:53.334761 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:421d0c89-491a-489e-8b4d-9131b2cc2aa5&page=queryresults
[0m19:27:53.338104 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:421d0c89-491a-489e-8b4d-9131b2cc2aa5&page=queryresults
[0m19:27:53.341219 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 19:27:51.042268 => 19:27:53.340281
[0m19:27:53.357286 [debug] [Thread-1  ]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Syntax error: Expected ")" but got identifier "CONCAT" at [36:9]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m19:27:53.359539 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '748d03e4-d8f0-4592-9301-0d6c2556bd81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb594a1d8b0>]}
[0m19:27:53.362344 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 2.34s]
[0m19:27:53.365389 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m19:27:53.367583 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m19:27:53.369662 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m19:27:53.371885 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m19:27:53.373301 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m19:27:53.380658 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m19:27:53.381970 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 19:27:53.374034 => 19:27:53.381539
[0m19:27:53.382767 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m19:27:53.386820 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:27:54.008777 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m19:27:54.011753 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m19:27:54.768182 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7ef53668-3925-4bae-9de6-2301800a70c9&page=queryresults
[0m19:27:58.294969 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 19:27:53.383337 => 19:27:58.293946
[0m19:27:58.298372 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '748d03e4-d8f0-4592-9301-0d6c2556bd81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb594903f10>]}
[0m19:27:58.301258 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.93s]
[0m19:27:58.304532 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m19:27:58.306909 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m19:27:58.309588 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m19:27:58.312749 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m19:27:58.314734 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m19:27:58.321055 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m19:27:58.321887 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 19:27:58.316166 => 19:27:58.321639
[0m19:27:58.322362 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m19:27:58.325072 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:27:59.016726 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m19:27:59.017502 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m19:27:59.458315 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:03945ced-54a9-462d-9d15-3965a6538d78&page=queryresults
[0m19:28:02.545687 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 19:27:58.322659 => 19:28:02.544729
[0m19:28:02.549002 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '748d03e4-d8f0-4592-9301-0d6c2556bd81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5949f7550>]}
[0m19:28:02.551780 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.24s]
[0m19:28:02.554871 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m19:28:02.557113 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m19:28:02.559692 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m19:28:02.562864 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m19:28:02.564878 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m19:28:02.572402 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m19:28:02.573250 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 19:28:02.566329 => 19:28:02.573002
[0m19:28:02.573723 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m19:28:02.576484 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:28:03.243808 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m19:28:03.244639 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m19:28:03.852156 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:dea98b8f-9783-42fc-a58b-74e6a1e0a2a5&page=queryresults
[0m19:28:06.897488 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 19:28:02.574017 => 19:28:06.896498
[0m19:28:06.901799 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '748d03e4-d8f0-4592-9301-0d6c2556bd81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5948e90a0>]}
[0m19:28:06.904608 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.34s]
[0m19:28:06.907751 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m19:28:06.914132 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:28:06.915840 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m19:28:06.917846 [info ] [MainThread]: 
[0m19:28:06.919747 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 25.80 seconds (25.80s).
[0m19:28:06.927130 [debug] [MainThread]: Command end result
[0m19:28:06.963397 [info ] [MainThread]: 
[0m19:28:06.964053 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:28:06.964575 [info ] [MainThread]: 
[0m19:28:06.965104 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Syntax error: Expected ")" but got identifier "CONCAT" at [36:9]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m19:28:06.965682 [info ] [MainThread]: 
[0m19:28:06.966259 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m19:28:06.967156 [debug] [MainThread]: Command `dbt run` failed at 19:28:06.966994 after 26.64 seconds
[0m19:28:06.967716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5affdcd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb595d62df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb595c68220>]}
[0m19:28:06.968232 [debug] [MainThread]: Flushing usage events
[0m19:29:27.067110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8933b87d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893150e880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893150e070>]}


============================== 19:29:27.071806 | a8381909-34be-4d1b-9643-cff58a970b6f ==============================
[0m19:29:27.071806 [info ] [MainThread]: Running with dbt=1.6.5
[0m19:29:27.072408 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/includes/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:29:27.641413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8381909-34be-4d1b-9643-cff58a970b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893157c820>]}
[0m19:29:27.652532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8381909-34be-4d1b-9643-cff58a970b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8919968dc0>]}
[0m19:29:27.653412 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m19:29:27.671118 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m19:29:27.755170 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:29:27.755754 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m19:29:27.798489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8381909-34be-4d1b-9643-cff58a970b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89196f8e20>]}
[0m19:29:27.813098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8381909-34be-4d1b-9643-cff58a970b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f891980c760>]}
[0m19:29:27.813597 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m19:29:27.814057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8381909-34be-4d1b-9643-cff58a970b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8919804250>]}
[0m19:29:27.815570 [info ] [MainThread]: 
[0m19:29:27.816363 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:29:27.817679 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m19:29:27.818106 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:29:28.522510 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m19:29:28.524812 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:29:29.201462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8381909-34be-4d1b-9643-cff58a970b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f891973db50>]}
[0m19:29:29.202312 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:29:29.202734 [info ] [MainThread]: 
[0m19:29:29.209331 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m19:29:29.209936 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m19:29:29.210656 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m19:29:29.211097 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m19:29:29.219980 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m19:29:29.220772 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 19:29:29.211410 => 19:29:29.220534
[0m19:29:29.221212 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m19:29:29.237609 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:29:29.978534 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m19:29:29.979264 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m19:29:30.648942 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e8f774a8-24b2-4dcb-8a0c-12e70aa0cd8c&page=queryresults
[0m19:29:33.797485 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 19:29:29.221520 => 19:29:33.797187
[0m19:29:33.798563 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8381909-34be-4d1b-9643-cff58a970b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89190a0d90>]}
[0m19:29:33.799417 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.59s]
[0m19:29:33.800350 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m19:29:33.801029 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m19:29:33.801705 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m19:29:33.802711 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m19:29:33.803240 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m19:29:33.812774 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m19:29:33.813675 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 19:29:33.803616 => 19:29:33.813447
[0m19:29:33.814103 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m19:29:33.816977 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:29:34.468373 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m19:29:34.469244 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m19:29:34.927198 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:cb6ec30c-53d5-494e-ae09-e9eb1966f983&page=queryresults
[0m19:29:37.834572 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 19:29:33.814407 => 19:29:37.833590
[0m19:29:37.837895 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8381909-34be-4d1b-9643-cff58a970b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8918680a00>]}
[0m19:29:37.840725 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.04s]
[0m19:29:37.843888 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m19:29:37.846168 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m19:29:37.848863 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m19:29:37.852024 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m19:29:37.854079 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m19:29:37.864527 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m19:29:37.866211 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 19:29:37.855553 => 19:29:37.865660
[0m19:29:37.867233 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m19:29:37.872126 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:29:38.545642 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m19:29:38.546540 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        currency,
        initial_price AS price_original,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        CASE
            WHEN discount_pct > 0 THEN
                price_original * (discount_percent / 100)  -- Monto del descuento
            ELSE
                0  -- Si no hay descuento, el monto del descuento es cero
        END AS discount_amount,
        CASE
            WHEN discount_percent > 0 THEN
                initial_price * (1 - discount_percent / 100) + (initial_price * (1 - discount_percent / 100)) * 0.75
            ELSE
                initial_price + initial_price * 0.75
        END AS price_with_tax
        CONCAT('ARS$ ', CAST(ROUND(price_original * 0.75, 2) AS STRING)) AS formatted_price_with_tax


    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    currency,
    price_original,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    ROUND(price_with_tax, 2) AS price_with_tax
FROM price_overview_cte
    );
  
[0m19:29:38.861190 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:478d4aaf-3892-4ac0-93f2-fdd75dcc8d6f&page=queryresults
[0m19:29:38.865891 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got identifier "CONCAT" at [36:9]')
[0m19:29:39.471395 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:fad5e0cb-7b96-4cc7-884e-55d569ccfbb1&page=queryresults
[0m19:29:39.476059 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:fad5e0cb-7b96-4cc7-884e-55d569ccfbb1&page=queryresults
[0m19:29:39.479419 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 19:29:37.867827 => 19:29:39.478402
[0m19:29:39.495523 [debug] [Thread-1  ]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Syntax error: Expected ")" but got identifier "CONCAT" at [36:9]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m19:29:39.497773 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8381909-34be-4d1b-9643-cff58a970b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89187b99d0>]}
[0m19:29:39.500554 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 1.65s]
[0m19:29:39.503233 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m19:29:39.504799 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m19:29:39.506396 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m19:29:39.508235 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m19:29:39.509545 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m19:29:39.516545 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m19:29:39.517781 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 19:29:39.510319 => 19:29:39.517432
[0m19:29:39.518459 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m19:29:39.522453 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:29:40.203545 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m19:29:40.204313 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m19:29:40.805725 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d6e5fffa-1c6b-4ce4-9faf-f19dcdab6ee6&page=queryresults
[0m19:29:44.287347 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 19:29:39.518949 => 19:29:44.286906
[0m19:29:44.288906 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8381909-34be-4d1b-9643-cff58a970b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f891869f490>]}
[0m19:29:44.290216 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.78s]
[0m19:29:44.291647 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m19:29:44.292798 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m19:29:44.294257 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m19:29:44.295991 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m19:29:44.297116 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m19:29:44.305300 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m19:29:44.307056 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 19:29:44.297908 => 19:29:44.306496
[0m19:29:44.308148 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m19:29:44.314629 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:29:44.999294 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m19:29:45.002452 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m19:29:45.496420 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:fac67dd4-1678-40d4-9dc2-65f7fee8377e&page=queryresults
[0m19:29:48.608863 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 19:29:44.308962 => 19:29:48.608653
[0m19:29:48.609703 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8381909-34be-4d1b-9643-cff58a970b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8918683a00>]}
[0m19:29:48.610316 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.31s]
[0m19:29:48.611060 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m19:29:48.611540 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m19:29:48.612178 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m19:29:48.612914 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m19:29:48.613344 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m19:29:48.616834 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m19:29:48.617591 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 19:29:48.613634 => 19:29:48.617342
[0m19:29:48.618145 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m19:29:48.621129 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:29:49.290810 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m19:29:49.291585 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m19:29:49.702667 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:3c53cd0c-3307-4a66-832e-ab3c8ff80986&page=queryresults
[0m19:29:52.494616 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 19:29:48.618438 => 19:29:52.494384
[0m19:29:52.495409 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8381909-34be-4d1b-9643-cff58a970b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f891869ff70>]}
[0m19:29:52.496028 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 3.88s]
[0m19:29:52.496778 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m19:29:52.498351 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:29:52.498722 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m19:29:52.499135 [info ] [MainThread]: 
[0m19:29:52.499565 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 24.68 seconds (24.68s).
[0m19:29:52.501166 [debug] [MainThread]: Command end result
[0m19:29:52.514304 [info ] [MainThread]: 
[0m19:29:52.514984 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:29:52.515422 [info ] [MainThread]: 
[0m19:29:52.515790 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Syntax error: Expected ")" but got identifier "CONCAT" at [36:9]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m19:29:52.516165 [info ] [MainThread]: 
[0m19:29:52.516541 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m19:29:52.517132 [debug] [MainThread]: Command `dbt run` failed at 19:29:52.517027 after 25.46 seconds
[0m19:29:52.517535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8933b87d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89198f74c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8919917970>]}
[0m19:29:52.517945 [debug] [MainThread]: Flushing usage events
[0m19:30:29.353260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1facaed60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1f8642850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1f8642880>]}


============================== 19:30:29.357890 | b750af80-a39d-4e9b-8b81-c8d1e03ffe33 ==============================
[0m19:30:29.357890 [info ] [MainThread]: Running with dbt=1.6.5
[0m19:30:29.358485 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/includes/dbt/logs', 'profiles_dir': '/opt/airflow/includes/dbt/', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'send_anonymous_usage_stats': 'True'}
[0m19:30:29.910939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b750af80-a39d-4e9b-8b81-c8d1e03ffe33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1f86727c0>]}
[0m19:30:29.922044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b750af80-a39d-4e9b-8b81-c8d1e03ffe33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1e0a94bb0>]}
[0m19:30:29.922810 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m19:30:29.940139 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m19:30:30.024775 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:30:30.025365 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m19:30:30.066577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b750af80-a39d-4e9b-8b81-c8d1e03ffe33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1e087ce20>]}
[0m19:30:30.081375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b750af80-a39d-4e9b-8b81-c8d1e03ffe33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1e0933760>]}
[0m19:30:30.081873 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m19:30:30.082274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b750af80-a39d-4e9b-8b81-c8d1e03ffe33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1e092c250>]}
[0m19:30:30.083780 [info ] [MainThread]: 
[0m19:30:30.084607 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:30:30.085896 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m19:30:30.086308 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:30:30.809726 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m19:30:30.811976 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:30:31.460607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b750af80-a39d-4e9b-8b81-c8d1e03ffe33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1e0867b50>]}
[0m19:30:31.461492 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:30:31.461934 [info ] [MainThread]: 
[0m19:30:31.468774 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m19:30:31.469395 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m19:30:31.470189 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m19:30:31.470644 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m19:30:31.480349 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m19:30:31.481220 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 19:30:31.470964 => 19:30:31.480953
[0m19:30:31.481704 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m19:30:31.499693 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:30:32.186913 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m19:30:32.187779 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m19:30:32.882803 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:4f6d83a3-b5ea-49be-81e1-9e32aa74ad19&page=queryresults
[0m19:30:35.734075 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 19:30:31.482051 => 19:30:35.733782
[0m19:30:35.735160 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b750af80-a39d-4e9b-8b81-c8d1e03ffe33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1e01cacd0>]}
[0m19:30:35.736019 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.27s]
[0m19:30:35.736951 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m19:30:35.737616 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m19:30:35.738230 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m19:30:35.739206 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m19:30:35.739732 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m19:30:35.749101 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m19:30:35.750042 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 19:30:35.740106 => 19:30:35.749792
[0m19:30:35.750468 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m19:30:35.753260 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:30:36.379105 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m19:30:36.380047 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m19:30:36.963550 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e657aaee-4215-4ca3-8623-526d90420e31&page=queryresults
[0m19:30:40.057721 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 19:30:35.750762 => 19:30:40.057515
[0m19:30:40.058532 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b750af80-a39d-4e9b-8b81-c8d1e03ffe33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1db78a4f0>]}
[0m19:30:40.059157 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.32s]
[0m19:30:40.059899 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m19:30:40.060389 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m19:30:40.060953 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m19:30:40.061777 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m19:30:40.062212 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m19:30:40.065728 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m19:30:40.066502 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 19:30:40.062518 => 19:30:40.066275
[0m19:30:40.066913 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m19:30:40.069552 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:30:40.679295 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m19:30:40.680107 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        currency,
        initial_price AS price_original,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        CASE
            WHEN discount_pct > 0 THEN
                price_original * (discount_percent / 100)  -- Monto del descuento
            ELSE
                0  -- Si no hay descuento, el monto del descuento es cero
        END AS discount_amount,
        CASE
            WHEN discount_percent > 0 THEN
                initial_price * (1 - discount_percent / 100) + (initial_price * (1 - discount_percent / 100)) * 0.75
            ELSE
                initial_price + initial_price * 0.75
        END AS price_with_tax
        CONCAT('ARS$ ', CAST(ROUND(price_original * 0.75, 2) AS STRING)) AS formatted_price_with_tax  -- Formato ARS$ 400,00
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    currency,
    price_original,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    ROUND(price_with_tax, 2) AS price_with_tax
FROM price_overview_cte
    );
  
[0m19:30:41.110983 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:15bc35fd-cf80-45d6-b34e-9d3b469cbd6c&page=queryresults
[0m19:30:41.112230 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got identifier "CONCAT" at [36:9]')
[0m19:30:41.673833 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:0663ac4b-d5b4-4377-bbeb-718b2c5c375e&page=queryresults
[0m19:30:41.677764 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:0663ac4b-d5b4-4377-bbeb-718b2c5c375e&page=queryresults
[0m19:30:41.680601 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 19:30:40.067200 => 19:30:41.679760
[0m19:30:41.690238 [debug] [Thread-1  ]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Syntax error: Expected ")" but got identifier "CONCAT" at [36:9]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m19:30:41.691323 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b750af80-a39d-4e9b-8b81-c8d1e03ffe33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1e00eea00>]}
[0m19:30:41.692609 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 1.63s]
[0m19:30:41.693992 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m19:30:41.694838 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m19:30:41.695902 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m19:30:41.697275 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m19:30:41.698099 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m19:30:41.703432 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m19:30:41.704439 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 19:30:41.698725 => 19:30:41.704133
[0m19:30:41.705034 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m19:30:41.708534 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:30:42.372969 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m19:30:42.375889 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m19:30:42.991951 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9cdea132-a0d5-4dfe-a5fd-d67e0b5932bf&page=queryresults
[0m19:30:45.802028 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 19:30:41.705447 => 19:30:45.801815
[0m19:30:45.802782 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b750af80-a39d-4e9b-8b81-c8d1e03ffe33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1db7ad3d0>]}
[0m19:30:45.803418 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.11s]
[0m19:30:45.804081 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m19:30:45.804550 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m19:30:45.805029 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m19:30:45.805790 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m19:30:45.806204 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m19:30:45.809422 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m19:30:45.810123 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 19:30:45.806500 => 19:30:45.809905
[0m19:30:45.810557 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m19:30:45.813445 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:30:46.497065 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m19:30:46.498350 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m19:30:47.053197 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:8cdcdc1c-4a4d-42b9-9dd9-81444fa288ea&page=queryresults
[0m19:30:49.891801 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 19:30:45.810877 => 19:30:49.890845
[0m19:30:49.895201 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b750af80-a39d-4e9b-8b81-c8d1e03ffe33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1e01ca3a0>]}
[0m19:30:49.898064 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.09s]
[0m19:30:49.901221 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m19:30:49.903500 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m19:30:49.906175 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m19:30:49.909440 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m19:30:49.911485 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m19:30:49.921094 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m19:30:49.922737 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 19:30:49.912950 => 19:30:49.922207
[0m19:30:49.923581 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m19:30:49.928322 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:30:50.584147 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m19:30:50.584931 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m19:30:51.053243 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:4ce8ee05-aa6e-4a23-9fe5-8e23eddaad0c&page=queryresults
[0m19:30:53.827746 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 19:30:49.924171 => 19:30:53.826784
[0m19:30:53.831288 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b750af80-a39d-4e9b-8b81-c8d1e03ffe33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1e00b5910>]}
[0m19:30:53.834142 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 3.92s]
[0m19:30:53.838303 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m19:30:53.845169 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:30:53.846923 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m19:30:53.847320 [info ] [MainThread]: 
[0m19:30:53.847801 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 23.76 seconds (23.76s).
[0m19:30:53.849370 [debug] [MainThread]: Command end result
[0m19:30:53.861927 [info ] [MainThread]: 
[0m19:30:53.862417 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:30:53.862844 [info ] [MainThread]: 
[0m19:30:53.863271 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Syntax error: Expected ")" but got identifier "CONCAT" at [36:9]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m19:30:53.863700 [info ] [MainThread]: 
[0m19:30:53.864132 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m19:30:53.864768 [debug] [MainThread]: Command `dbt run` failed at 19:30:53.864651 after 24.52 seconds
[0m19:30:53.865185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1facaed60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1e0a243d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1e0a40970>]}
[0m19:30:53.865584 [debug] [MainThread]: Flushing usage events
[0m19:32:39.598970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed5b89be50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed591f29a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed591f29d0>]}


============================== 19:32:39.603668 | 474f49ca-6ec6-42a0-a8a4-a94637db7407 ==============================
[0m19:32:39.603668 [info ] [MainThread]: Running with dbt=1.6.5
[0m19:32:39.604252 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/includes/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:32:40.158987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '474f49ca-6ec6-42a0-a8a4-a94637db7407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed5921e910>]}
[0m19:32:40.169976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '474f49ca-6ec6-42a0-a8a4-a94637db7407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed415e4eb0>]}
[0m19:32:40.170690 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m19:32:40.187342 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m19:32:40.272736 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:32:40.273348 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m19:32:40.315261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '474f49ca-6ec6-42a0-a8a4-a94637db7407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed413e1e80>]}
[0m19:32:40.330020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '474f49ca-6ec6-42a0-a8a4-a94637db7407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed414f2100>]}
[0m19:32:40.330524 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m19:32:40.330934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '474f49ca-6ec6-42a0-a8a4-a94637db7407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed414f2160>]}
[0m19:32:40.332453 [info ] [MainThread]: 
[0m19:32:40.333276 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:32:40.334580 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m19:32:40.335082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:32:40.985429 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m19:32:40.987633 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:32:41.669151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '474f49ca-6ec6-42a0-a8a4-a94637db7407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed41426c10>]}
[0m19:32:41.670118 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:32:41.670725 [info ] [MainThread]: 
[0m19:32:41.677177 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m19:32:41.677756 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m19:32:41.678454 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m19:32:41.678864 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m19:32:41.687375 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m19:32:41.688139 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 19:32:41.679162 => 19:32:41.687912
[0m19:32:41.688554 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m19:32:41.704273 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:32:42.399034 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m19:32:42.399837 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m19:32:43.091891 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:81720807-2144-4b29-88dd-a0eaf8dae6dd&page=queryresults
[0m19:32:46.586483 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 19:32:41.688858 => 19:32:46.586269
[0m19:32:46.587307 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '474f49ca-6ec6-42a0-a8a4-a94637db7407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed40b8bee0>]}
[0m19:32:46.587943 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.91s]
[0m19:32:46.588718 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m19:32:46.589246 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m19:32:46.589790 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m19:32:46.590650 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m19:32:46.591100 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m19:32:46.599787 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m19:32:46.600761 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 19:32:46.591411 => 19:32:46.600443
[0m19:32:46.601283 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m19:32:46.604251 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:32:47.257291 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m19:32:47.258087 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m19:32:47.924754 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:81b31438-852b-4ebd-af04-7807ce88d50c&page=queryresults
[0m19:32:50.782114 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 19:32:46.601621 => 19:32:50.781901
[0m19:32:50.782864 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '474f49ca-6ec6-42a0-a8a4-a94637db7407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed40b8ba30>]}
[0m19:32:50.783488 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.19s]
[0m19:32:50.784275 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m19:32:50.784776 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m19:32:50.785278 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m19:32:50.786046 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m19:32:50.786469 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m19:32:50.789781 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m19:32:50.790476 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 19:32:50.786772 => 19:32:50.790261
[0m19:32:50.790895 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m19:32:50.793849 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:32:51.456468 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m19:32:51.458700 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        currency,
        initial_price AS price_original,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        CASE
            WHEN discount_pct > 0 THEN
                price_original * (discount_percent / 100)  -- Monto del descuento
            ELSE
                0  -- Si no hay descuento, el monto del descuento es cero
        END AS discount_amount,
        CASE
            WHEN discount_percent > 0 THEN
                initial_price * (1 - discount_percent / 100) + (initial_price * (1 - discount_percent / 100)) * 0.75
            ELSE
                initial_price + initial_price * 0.75
        END AS price_with_tax
        CONCAT('ARS$ ', CAST(ROUND(initial_price * 0.75, 2) AS STRING)) AS formatted_price_with_tax  -- Formato ARS$ 400,00
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    currency,
    price_original,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    ROUND(price_with_tax, 2) AS price_with_tax
FROM price_overview_cte
    );
  
[0m19:32:51.759533 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:88a8e8ca-7f91-402f-b67b-66d811e40a10&page=queryresults
[0m19:32:51.764250 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got identifier "CONCAT" at [36:9]')
[0m19:32:52.244486 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:2b39e1a0-6886-4d07-ad6f-937212401b98&page=queryresults
[0m19:32:52.249262 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:2b39e1a0-6886-4d07-ad6f-937212401b98&page=queryresults
[0m19:32:52.252521 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 19:32:50.791192 => 19:32:52.251515
[0m19:32:52.268795 [debug] [Thread-1  ]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Syntax error: Expected ")" but got identifier "CONCAT" at [36:9]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m19:32:52.271062 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '474f49ca-6ec6-42a0-a8a4-a94637db7407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed402a3b20>]}
[0m19:32:52.273046 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 1.48s]
[0m19:32:52.275194 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m19:32:52.276576 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m19:32:52.278059 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m19:32:52.279752 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m19:32:52.280808 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m19:32:52.287118 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m19:32:52.288239 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 19:32:52.281432 => 19:32:52.287873
[0m19:32:52.288924 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m19:32:52.292676 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:32:52.967406 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m19:32:52.970490 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m19:32:53.628434 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7ee65d99-2724-4eeb-b0e2-6cb9d63136d5&page=queryresults
[0m19:32:56.412081 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 19:32:52.289422 => 19:32:56.411874
[0m19:32:56.412847 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '474f49ca-6ec6-42a0-a8a4-a94637db7407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed4018f280>]}
[0m19:32:56.413433 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.13s]
[0m19:32:56.414178 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m19:32:56.414664 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m19:32:56.415126 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m19:32:56.415930 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m19:32:56.416377 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m19:32:56.419620 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m19:32:56.420274 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 19:32:56.416704 => 19:32:56.420073
[0m19:32:56.420706 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m19:32:56.423072 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:32:57.091669 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m19:32:57.094730 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m19:32:57.695675 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:de53827f-b044-40b1-9275-9542246f5e32&page=queryresults
[0m19:33:00.542636 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 19:32:56.420991 => 19:33:00.542433
[0m19:33:00.543379 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '474f49ca-6ec6-42a0-a8a4-a94637db7407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed40b8b5b0>]}
[0m19:33:00.544007 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.13s]
[0m19:33:00.544777 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m19:33:00.545329 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m19:33:00.545831 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m19:33:00.546745 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m19:33:00.547188 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m19:33:00.550445 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m19:33:00.551132 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 19:33:00.547479 => 19:33:00.550926
[0m19:33:00.551528 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m19:33:00.554021 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:33:01.196894 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m19:33:01.200057 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m19:33:01.916063 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f1aa0a75-8ef1-4c57-abb9-1d8f2e243dfc&page=queryresults
[0m19:33:05.322516 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 19:33:00.551815 => 19:33:05.321530
[0m19:33:05.326064 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '474f49ca-6ec6-42a0-a8a4-a94637db7407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed40278a90>]}
[0m19:33:05.328930 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.78s]
[0m19:33:05.333032 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m19:33:05.338762 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:33:05.340000 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m19:33:05.341316 [info ] [MainThread]: 
[0m19:33:05.342509 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 25.01 seconds (25.01s).
[0m19:33:05.346327 [debug] [MainThread]: Command end result
[0m19:33:05.367925 [info ] [MainThread]: 
[0m19:33:05.368576 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:33:05.369117 [info ] [MainThread]: 
[0m19:33:05.369642 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Syntax error: Expected ")" but got identifier "CONCAT" at [36:9]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m19:33:05.370178 [info ] [MainThread]: 
[0m19:33:05.370729 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m19:33:05.371540 [debug] [MainThread]: Command `dbt run` failed at 19:33:05.371392 after 25.78 seconds
[0m19:33:05.372111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed5b89be50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed41652e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed414f22e0>]}
[0m19:33:05.372624 [debug] [MainThread]: Flushing usage events
[0m19:33:35.275972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f137361edf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1370fb5940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1370fb5970>]}


============================== 19:33:35.281401 | 6bd82f7b-2290-4de6-ae6c-8921f5c0f001 ==============================
[0m19:33:35.281401 [info ] [MainThread]: Running with dbt=1.6.5
[0m19:33:35.281959 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/includes/dbt/logs', 'profiles_dir': '/opt/airflow/includes/dbt/', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'send_anonymous_usage_stats': 'True'}
[0m19:33:35.959112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6bd82f7b-2290-4de6-ae6c-8921f5c0f001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1370fe9850>]}
[0m19:33:35.970856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6bd82f7b-2290-4de6-ae6c-8921f5c0f001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f135939ce50>]}
[0m19:33:35.971693 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m19:33:35.989477 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m19:33:36.086517 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:33:36.087163 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m19:33:36.134247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6bd82f7b-2290-4de6-ae6c-8921f5c0f001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13591f6eb0>]}
[0m19:33:36.150084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6bd82f7b-2290-4de6-ae6c-8921f5c0f001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13592ab100>]}
[0m19:33:36.150699 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m19:33:36.151224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bd82f7b-2290-4de6-ae6c-8921f5c0f001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13592ab0d0>]}
[0m19:33:36.152757 [info ] [MainThread]: 
[0m19:33:36.153708 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:33:36.155499 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m19:33:36.156057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:33:36.937516 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m19:33:36.939709 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:33:37.617643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bd82f7b-2290-4de6-ae6c-8921f5c0f001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13591dfbb0>]}
[0m19:33:37.621123 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:33:37.622997 [info ] [MainThread]: 
[0m19:33:37.648422 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m19:33:37.649847 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m19:33:37.651828 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m19:33:37.652876 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m19:33:37.666376 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m19:33:37.667378 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 19:33:37.653574 => 19:33:37.667078
[0m19:33:37.667957 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m19:33:37.688207 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:33:38.416773 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m19:33:38.417609 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m19:33:39.026711 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:03c009d8-6962-4bad-bf8e-5ade411499be&page=queryresults
[0m19:33:42.162699 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 19:33:37.668373 => 19:33:42.162401
[0m19:33:42.163781 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bd82f7b-2290-4de6-ae6c-8921f5c0f001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1358b43d90>]}
[0m19:33:42.164637 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.51s]
[0m19:33:42.165587 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m19:33:42.166258 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m19:33:42.166995 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m19:33:42.167876 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m19:33:42.168395 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m19:33:42.177505 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m19:33:42.178456 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 19:33:42.168785 => 19:33:42.178198
[0m19:33:42.178929 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m19:33:42.181734 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:33:42.833603 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m19:33:42.834369 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m19:33:43.400303 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5840a0a1-05ee-435c-b10a-0698be86292b&page=queryresults
[0m19:33:46.233499 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 19:33:42.179248 => 19:33:46.233297
[0m19:33:46.234238 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bd82f7b-2290-4de6-ae6c-8921f5c0f001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f135821ef40>]}
[0m19:33:46.234844 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.07s]
[0m19:33:46.235555 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m19:33:46.236053 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m19:33:46.236529 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m19:33:46.237328 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m19:33:46.237765 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m19:33:46.240983 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m19:33:46.241697 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 19:33:46.238067 => 19:33:46.241494
[0m19:33:46.242117 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m19:33:46.244638 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:33:46.898054 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m19:33:46.898937 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        currency,
        initial_price AS price_original,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        CASE
            WHEN discount_pct > 0 THEN
                price_original * (discount_percent / 100)  -- Monto del descuento
            ELSE
                0  -- Si no hay descuento, el monto del descuento es cero
        END AS discount_amount,
        CASE
            WHEN discount_percent > 0 THEN
                initial_price * (1 - discount_percent / 100) + (initial_price * (1 - discount_percent / 100)) * 0.75
            ELSE
                initial_price + initial_price * 0.75
        END AS price_with_tax
        CONCAT('ARS$ ', CAST(ROUND(initial_price * 0.75, 2) AS STRING))) AS formatted_price_with_tax  -- Formato ARS$ 400,00
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    currency,
    price_original,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    ROUND(price_with_tax, 2) AS price_with_tax
FROM price_overview_cte
    );
  
[0m19:33:47.222369 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:4f817f15-6cf5-4204-a8aa-dc03b82ce886&page=queryresults
[0m19:33:47.223515 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got identifier "CONCAT" at [36:9]')
[0m19:33:47.915420 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:eff3700e-8caa-4953-ac08-772df3745245&page=queryresults
[0m19:33:47.920067 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:eff3700e-8caa-4953-ac08-772df3745245&page=queryresults
[0m19:33:47.923599 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 19:33:46.242426 => 19:33:47.922550
[0m19:33:47.937939 [debug] [Thread-1  ]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Syntax error: Expected ")" but got identifier "CONCAT" at [36:9]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m19:33:47.938590 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bd82f7b-2290-4de6-ae6c-8921f5c0f001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1358265a90>]}
[0m19:33:47.939232 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 1.70s]
[0m19:33:47.939990 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m19:33:47.940499 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m19:33:47.941195 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m19:33:47.941978 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m19:33:47.942461 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m19:33:47.945852 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m19:33:47.946526 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 19:33:47.942751 => 19:33:47.946321
[0m19:33:47.946924 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m19:33:47.949789 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:33:48.618556 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m19:33:48.621520 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m19:33:49.092299 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b389b881-b344-4f76-9d9e-b56378bf6bf5&page=queryresults
[0m19:33:52.521340 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 19:33:47.947212 => 19:33:52.520331
[0m19:33:52.524663 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bd82f7b-2290-4de6-ae6c-8921f5c0f001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1358b434f0>]}
[0m19:33:52.527486 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.58s]
[0m19:33:52.530652 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m19:33:52.532935 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m19:33:52.535545 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m19:33:52.538754 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m19:33:52.540800 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m19:33:52.548084 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m19:33:52.548930 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 19:33:52.542260 => 19:33:52.548668
[0m19:33:52.549378 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m19:33:52.552059 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:33:53.242569 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m19:33:53.243305 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m19:33:53.812005 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:bfd2564a-9c75-4ce0-8b48-d0bde846ffbd&page=queryresults
[0m19:33:56.566433 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 19:33:52.549673 => 19:33:56.565475
[0m19:33:56.569794 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bd82f7b-2290-4de6-ae6c-8921f5c0f001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1358b43460>]}
[0m19:33:56.572601 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.03s]
[0m19:33:56.575745 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m19:33:56.578050 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m19:33:56.580723 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m19:33:56.583904 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m19:33:56.585962 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m19:33:56.592006 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m19:33:56.592935 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 19:33:56.587133 => 19:33:56.592597
[0m19:33:56.593398 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m19:33:56.596126 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:33:57.228830 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m19:33:57.229512 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m19:33:57.705957 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:cbf53f4b-46ac-44da-854d-e581f7030e71&page=queryresults
[0m19:34:00.860812 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 19:33:56.593696 => 19:34:00.860454
[0m19:34:00.862154 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bd82f7b-2290-4de6-ae6c-8921f5c0f001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13581298e0>]}
[0m19:34:00.863277 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.28s]
[0m19:34:00.864916 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m19:34:00.867769 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:34:00.868560 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m19:34:00.869424 [info ] [MainThread]: 
[0m19:34:00.870287 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 24.72 seconds (24.72s).
[0m19:34:00.872436 [debug] [MainThread]: Command end result
[0m19:34:00.886324 [info ] [MainThread]: 
[0m19:34:00.886866 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:34:00.887327 [info ] [MainThread]: 
[0m19:34:00.887749 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Syntax error: Expected ")" but got identifier "CONCAT" at [36:9]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m19:34:00.888133 [info ] [MainThread]: 
[0m19:34:00.888545 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m19:34:00.889214 [debug] [MainThread]: Command `dbt run` failed at 19:34:00.889109 after 25.62 seconds
[0m19:34:00.889626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f137361edf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13593c8eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13592ab340>]}
[0m19:34:00.890053 [debug] [MainThread]: Flushing usage events
[0m19:34:06.459322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf04140dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf01ac5940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf01ac5910>]}


============================== 19:34:06.464065 | 33815ba6-7f93-437d-a7ff-3e06ad027474 ==============================
[0m19:34:06.464065 [info ] [MainThread]: Running with dbt=1.6.5
[0m19:34:06.464652 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/includes/dbt/logs', 'profiles_dir': '/opt/airflow/includes/dbt/', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:34:07.020119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33815ba6-7f93-437d-a7ff-3e06ad027474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf01af9820>]}
[0m19:34:07.031130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33815ba6-7f93-437d-a7ff-3e06ad027474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faee9eaae20>]}
[0m19:34:07.031756 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m19:34:07.048147 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m19:34:07.132600 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:34:07.133233 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m19:34:07.175298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33815ba6-7f93-437d-a7ff-3e06ad027474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faee9ca2e80>]}
[0m19:34:07.190005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33815ba6-7f93-437d-a7ff-3e06ad027474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faee9daf280>]}
[0m19:34:07.190505 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m19:34:07.190944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33815ba6-7f93-437d-a7ff-3e06ad027474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faee9daf0d0>]}
[0m19:34:07.192423 [info ] [MainThread]: 
[0m19:34:07.193244 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:34:07.194506 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m19:34:07.194941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:34:07.871156 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m19:34:07.873390 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:34:08.455627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33815ba6-7f93-437d-a7ff-3e06ad027474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faee9ec2190>]}
[0m19:34:08.456425 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:34:08.456852 [info ] [MainThread]: 
[0m19:34:08.463260 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m19:34:08.463813 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m19:34:08.464517 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m19:34:08.464973 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m19:34:08.474180 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m19:34:08.475014 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 19:34:08.465280 => 19:34:08.474766
[0m19:34:08.475487 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m19:34:08.493308 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:34:09.212471 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m19:34:09.213251 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m19:34:09.780578 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:05a7d34c-f23f-4982-b934-30b98eb17218&page=queryresults
[0m19:34:12.590642 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 19:34:08.475819 => 19:34:12.590343
[0m19:34:12.591729 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33815ba6-7f93-437d-a7ff-3e06ad027474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faee944ed30>]}
[0m19:34:12.592580 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.13s]
[0m19:34:12.593527 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m19:34:12.594188 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m19:34:12.594841 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m19:34:12.595804 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m19:34:12.596329 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m19:34:12.605590 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m19:34:12.606559 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 19:34:12.596714 => 19:34:12.606297
[0m19:34:12.606994 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m19:34:12.609808 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:34:13.270201 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m19:34:13.273257 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m19:34:13.739426 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b33e3b45-213a-4208-8088-f6b1f6e63303&page=queryresults
[0m19:34:17.405676 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 19:34:12.607292 => 19:34:17.405468
[0m19:34:17.406441 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33815ba6-7f93-437d-a7ff-3e06ad027474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faee944e8b0>]}
[0m19:34:17.407076 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.81s]
[0m19:34:17.407781 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m19:34:17.408280 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m19:34:17.408871 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m19:34:17.409696 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m19:34:17.410158 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m19:34:17.414324 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m19:34:17.415128 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 19:34:17.410467 => 19:34:17.414862
[0m19:34:17.415569 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m19:34:17.418518 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:34:18.122377 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m19:34:18.125580 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        currency,
        initial_price AS price_original,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        CASE
            WHEN discount_pct > 0 THEN
                price_original * (discount_percent / 100)  -- Monto del descuento
            ELSE
                0  -- Si no hay descuento, el monto del descuento es cero
        END AS discount_amount,
        CASE
            WHEN discount_percent > 0 THEN
                initial_price * (1 - discount_percent / 100) + (initial_price * (1 - discount_percent / 100)) * 0.75
            ELSE
                initial_price + initial_price * 0.75
        END AS price_with_tax
        CONCAT('ARS$ ', CAST(ROUND(initial_price * 0.75, 2) AS STRING))) AS formatted_price_with_tax  -- Formato ARS$ 400,00
    FROM `pristine-flames-400818`.`games`.`raw_games`

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    currency,
    price_original,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    ROUND(price_with_tax, 2) AS price_with_tax
FROM price_overview_cte
    );
  
[0m19:34:18.429267 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a135297b-586e-4d90-9247-869227a85bd4&page=queryresults
[0m19:34:18.431610 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got identifier "CONCAT" at [36:9]')
[0m19:34:19.300918 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:1dae9db7-f6dc-402f-9e83-5ee548425ff2&page=queryresults
[0m19:34:19.303511 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:1dae9db7-f6dc-402f-9e83-5ee548425ff2&page=queryresults
[0m19:34:19.304289 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 19:34:17.415873 => 19:34:19.304064
[0m19:34:19.307838 [debug] [Thread-1  ]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Syntax error: Expected ")" but got identifier "CONCAT" at [36:9]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m19:34:19.308348 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33815ba6-7f93-437d-a7ff-3e06ad027474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faee8b6eb20>]}
[0m19:34:19.308994 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 1.90s]
[0m19:34:19.309663 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m19:34:19.310146 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m19:34:19.310645 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m19:34:19.311502 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m19:34:19.311947 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m19:34:19.315513 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m19:34:19.316248 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 19:34:19.312259 => 19:34:19.316023
[0m19:34:19.316745 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m19:34:19.319813 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:34:20.009094 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m19:34:20.009855 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m19:34:20.582332 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:6b80b30f-5ba0-4c54-b20f-773c5a504f7c&page=queryresults
[0m19:34:23.684987 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 19:34:19.317078 => 19:34:23.683996
[0m19:34:23.688323 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33815ba6-7f93-437d-a7ff-3e06ad027474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faee8be25e0>]}
[0m19:34:23.691157 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.38s]
[0m19:34:23.694336 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m19:34:23.696579 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m19:34:23.699213 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m19:34:23.702417 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m19:34:23.704418 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m19:34:23.711446 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m19:34:23.712319 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 19:34:23.705899 => 19:34:23.712039
[0m19:34:23.712834 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m19:34:23.715489 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:34:24.388034 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m19:34:24.389010 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m19:34:24.988366 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:cc19fbb9-1627-4fad-8a08-5692cf5e4dcd&page=queryresults
[0m19:34:27.768943 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 19:34:23.713146 => 19:34:27.767942
[0m19:34:27.772249 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33815ba6-7f93-437d-a7ff-3e06ad027474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faee944e460>]}
[0m19:34:27.775084 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.07s]
[0m19:34:27.778363 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m19:34:27.780610 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m19:34:27.783257 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m19:34:27.786456 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m19:34:27.788474 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m19:34:27.795490 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m19:34:27.796366 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 19:34:27.789964 => 19:34:27.796082
[0m19:34:27.796873 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m19:34:27.799619 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:34:28.444220 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m19:34:28.445010 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m19:34:28.859589 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:704841cb-5b8a-45ec-8edd-df9d3723bbb1&page=queryresults
[0m19:34:31.686463 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 19:34:27.797172 => 19:34:31.685489
[0m19:34:31.689969 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33815ba6-7f93-437d-a7ff-3e06ad027474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faee8b48b20>]}
[0m19:34:31.692797 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 3.90s]
[0m19:34:31.696842 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m19:34:31.703216 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:34:31.704995 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m19:34:31.706068 [info ] [MainThread]: 
[0m19:34:31.706533 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 24.51 seconds (24.51s).
[0m19:34:31.708158 [debug] [MainThread]: Command end result
[0m19:34:31.721702 [info ] [MainThread]: 
[0m19:34:31.722300 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:34:31.722712 [info ] [MainThread]: 
[0m19:34:31.723100 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Syntax error: Expected ")" but got identifier "CONCAT" at [36:9]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m19:34:31.723497 [info ] [MainThread]: 
[0m19:34:31.723898 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m19:34:31.724500 [debug] [MainThread]: Command `dbt run` failed at 19:34:31.724391 after 25.27 seconds
[0m19:34:31.724929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf04140dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faee9eaa250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faee9daf2b0>]}
[0m19:34:31.725353 [debug] [MainThread]: Flushing usage events
[0m19:34:57.677827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35f0c1bdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35ee5ba850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35ee5ba880>]}


============================== 19:34:57.683248 | 367a119f-dd09-405a-87d5-1cc823091913 ==============================
[0m19:34:57.683248 [info ] [MainThread]: Running with dbt=1.6.5
[0m19:34:57.683913 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/includes/dbt/', 'log_path': '/opt/airflow/includes/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'send_anonymous_usage_stats': 'True'}
[0m19:34:58.280463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '367a119f-dd09-405a-87d5-1cc823091913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35ee5e97c0>]}
[0m19:34:58.291729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '367a119f-dd09-405a-87d5-1cc823091913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d69a1dc0>]}
[0m19:34:58.292471 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m19:34:58.310002 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m19:34:58.398476 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:34:58.399096 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m19:34:58.443591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '367a119f-dd09-405a-87d5-1cc823091913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d67f9e20>]}
[0m19:34:58.458846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '367a119f-dd09-405a-87d5-1cc823091913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d68b6820>]}
[0m19:34:58.459388 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m19:34:58.459806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '367a119f-dd09-405a-87d5-1cc823091913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d68aa070>]}
[0m19:34:58.461384 [info ] [MainThread]: 
[0m19:34:58.462132 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:34:58.463404 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m19:34:58.463847 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:34:59.154097 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m19:34:59.154942 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:34:59.799396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '367a119f-dd09-405a-87d5-1cc823091913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d67e3fa0>]}
[0m19:34:59.800550 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:34:59.801172 [info ] [MainThread]: 
[0m19:34:59.810555 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m19:34:59.811352 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m19:34:59.812371 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m19:34:59.812965 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m19:34:59.823821 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m19:34:59.824794 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 19:34:59.813349 => 19:34:59.824471
[0m19:34:59.825343 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m19:34:59.842327 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:35:00.500454 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m19:35:00.501180 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m19:35:01.190256 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a5377dab-c6b8-44cb-a095-c7ae20729726&page=queryresults
[0m19:35:04.048713 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 19:34:59.825726 => 19:35:04.048405
[0m19:35:04.049797 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '367a119f-dd09-405a-87d5-1cc823091913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d5f49d60>]}
[0m19:35:04.050652 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.24s]
[0m19:35:04.051586 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m19:35:04.052257 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m19:35:04.052953 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m19:35:04.053915 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m19:35:04.054433 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m19:35:04.063911 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m19:35:04.064683 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 19:35:04.054809 => 19:35:04.064459
[0m19:35:04.065103 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m19:35:04.067658 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:35:04.747555 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m19:35:04.748274 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m19:35:05.388468 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:6f67e438-bf8e-4d07-a802-1d1a99633d10&page=queryresults
[0m19:35:08.792526 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 19:35:04.065401 => 19:35:08.792184
[0m19:35:08.793817 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '367a119f-dd09-405a-87d5-1cc823091913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d5f498b0>]}
[0m19:35:08.794932 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.74s]
[0m19:35:08.796161 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m19:35:08.797063 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m19:35:08.798136 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m19:35:08.799380 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m19:35:08.800164 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m19:35:08.806070 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m19:35:08.807368 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 19:35:08.800749 => 19:35:08.806949
[0m19:35:08.808147 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m19:35:08.812875 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:35:09.497730 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m19:35:09.498899 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        currency,
        initial_price AS price_original,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        CASE
            WHEN discount_pct > 0 THEN
                price_original * (discount_percent / 100)  -- Monto del descuento
            ELSE
                0  -- Si no hay descuento, el monto del descuento es cero
        END AS discount_amount,
        CASE
            WHEN discount_percent > 0 THEN
                initial_price * (1 - discount_percent / 100) + (initial_price * (1 - discount_percent / 100)) * 0.75
            ELSE
                initial_price + initial_price * 0.75
        END AS price_with_tax
        CONCAT('ARS$ ', CAST(ROUND(initial_price * 0.75, 2) AS STRING)) AS formatted_price_with_tax  -- Formato ARS$ 400,00
    FROM `pristine-flames-400818`.`games`.`raw_games`

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    currency,
    price_original,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    ROUND(price_with_tax, 2) AS price_with_tax
FROM price_overview_cte
    );
  
[0m19:35:09.821108 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:febf60f5-2f2b-4015-8626-c6e0c37d871f&page=queryresults
[0m19:35:09.825989 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got identifier "CONCAT" at [36:9]')
[0m19:35:10.730243 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d7999310-b2c8-406f-a6d4-7abd6cb9b543&page=queryresults
[0m19:35:10.735228 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d7999310-b2c8-406f-a6d4-7abd6cb9b543&page=queryresults
[0m19:35:10.739146 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 19:35:08.808724 => 19:35:10.738068
[0m19:35:10.755616 [debug] [Thread-1  ]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Syntax error: Expected ")" but got identifier "CONCAT" at [36:9]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m19:35:10.757966 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '367a119f-dd09-405a-87d5-1cc823091913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d5661a60>]}
[0m19:35:10.760822 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 1.96s]
[0m19:35:10.763962 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m19:35:10.766384 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m19:35:10.769340 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m19:35:10.772674 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m19:35:10.774770 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m19:35:10.790821 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m19:35:10.794633 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 19:35:10.776310 => 19:35:10.793548
[0m19:35:10.797138 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m19:35:10.809630 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:35:11.548584 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m19:35:11.551606 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m19:35:12.192110 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:50488d3b-67ea-4ea0-9a80-64a913fa156c&page=queryresults
[0m19:35:15.224936 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 19:35:10.798893 => 19:35:15.223923
[0m19:35:15.228377 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '367a119f-dd09-405a-87d5-1cc823091913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d552f850>]}
[0m19:35:15.231289 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.46s]
[0m19:35:15.234569 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m19:35:15.236996 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m19:35:15.239564 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m19:35:15.241977 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m19:35:15.243460 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m19:35:15.251446 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m19:35:15.252897 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 19:35:15.244593 => 19:35:15.252433
[0m19:35:15.253723 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m19:35:15.257845 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:35:15.937304 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m19:35:15.940372 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m19:35:16.511528 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:195b452d-2310-46cb-99b3-fc8d06d86deb&page=queryresults
[0m19:35:19.642813 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 19:35:15.254293 => 19:35:19.641823
[0m19:35:19.646350 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '367a119f-dd09-405a-87d5-1cc823091913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d5f49400>]}
[0m19:35:19.649319 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.40s]
[0m19:35:19.652497 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m19:35:19.654802 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m19:35:19.657475 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m19:35:19.660698 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m19:35:19.662728 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m19:35:19.672779 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m19:35:19.674442 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 19:35:19.664220 => 19:35:19.673945
[0m19:35:19.675268 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m19:35:19.680004 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:35:20.373957 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m19:35:20.376981 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m19:35:20.815633 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ce5b95a7-2eaf-46d5-b5cd-dc05754a338e&page=queryresults
[0m19:35:23.682399 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 19:35:19.675863 => 19:35:23.682187
[0m19:35:23.683215 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '367a119f-dd09-405a-87d5-1cc823091913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d56389a0>]}
[0m19:35:23.683903 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.02s]
[0m19:35:23.685328 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m19:35:23.687029 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:35:23.687472 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m19:35:23.687896 [info ] [MainThread]: 
[0m19:35:23.688329 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 25.23 seconds (25.23s).
[0m19:35:23.690081 [debug] [MainThread]: Command end result
[0m19:35:23.704178 [info ] [MainThread]: 
[0m19:35:23.704665 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:35:23.705046 [info ] [MainThread]: 
[0m19:35:23.705420 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Syntax error: Expected ")" but got identifier "CONCAT" at [36:9]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m19:35:23.705875 [info ] [MainThread]: 
[0m19:35:23.706318 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m19:35:23.707017 [debug] [MainThread]: Command `dbt run` failed at 19:35:23.706879 after 26.03 seconds
[0m19:35:23.707498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35f0c1bdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d69a1ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d67e3b50>]}
[0m19:35:23.707956 [debug] [MainThread]: Flushing usage events
[0m19:37:00.812116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea65f25d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea63879850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea63879070>]}


============================== 19:37:00.816835 | eb01327b-6c86-4172-b376-513bf0589cd3 ==============================
[0m19:37:00.816835 [info ] [MainThread]: Running with dbt=1.6.5
[0m19:37:00.817438 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/includes/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:37:01.400886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb01327b-6c86-4172-b376-513bf0589cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea638e7820>]}
[0m19:37:01.412233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb01327b-6c86-4172-b376-513bf0589cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea4bcd1bb0>]}
[0m19:37:01.412980 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m19:37:01.429971 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m19:37:01.518238 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:37:01.518876 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m19:37:01.563014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb01327b-6c86-4172-b376-513bf0589cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea4babae20>]}
[0m19:37:01.578290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb01327b-6c86-4172-b376-513bf0589cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea4bb76760>]}
[0m19:37:01.578825 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m19:37:01.579229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb01327b-6c86-4172-b376-513bf0589cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea4bb6e250>]}
[0m19:37:01.580745 [info ] [MainThread]: 
[0m19:37:01.581566 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:37:01.582995 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m19:37:01.583457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:37:02.226612 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m19:37:02.227391 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:37:02.851278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb01327b-6c86-4172-b376-513bf0589cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea4baa7b50>]}
[0m19:37:02.852142 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:37:02.852597 [info ] [MainThread]: 
[0m19:37:02.862590 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m19:37:02.863198 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m19:37:02.864003 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m19:37:02.864619 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m19:37:02.876988 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m19:37:02.877892 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 19:37:02.865405 => 19:37:02.877616
[0m19:37:02.878646 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m19:37:02.902514 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:37:03.590460 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m19:37:03.591262 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m19:37:04.197002 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:326400f3-0ddc-4e2b-a529-07d8f99a389e&page=queryresults
[0m19:37:06.971887 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 19:37:02.882312 => 19:37:06.971671
[0m19:37:06.972688 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb01327b-6c86-4172-b376-513bf0589cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea4b206d30>]}
[0m19:37:06.973310 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.11s]
[0m19:37:06.973974 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m19:37:06.974447 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m19:37:06.975037 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m19:37:06.975747 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m19:37:06.976172 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m19:37:06.985004 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m19:37:06.985761 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 19:37:06.976483 => 19:37:06.985542
[0m19:37:06.986186 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m19:37:06.988762 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:37:07.646065 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m19:37:07.646770 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m19:37:08.198760 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:af41903d-65e8-442a-bf8c-13b532dd2a83&page=queryresults
[0m19:37:10.996240 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 19:37:06.986485 => 19:37:10.996028
[0m19:37:10.996997 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb01327b-6c86-4172-b376-513bf0589cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea4b2068e0>]}
[0m19:37:10.997610 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.02s]
[0m19:37:10.998264 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m19:37:10.998739 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m19:37:10.999229 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m19:37:10.999973 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m19:37:11.000392 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m19:37:11.003667 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m19:37:11.004355 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 19:37:11.000706 => 19:37:11.004142
[0m19:37:11.004788 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m19:37:11.007677 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:37:11.642761 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m19:37:11.643574 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        currency,
        initial_price AS price_original,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        CASE
            WHEN discount_pct > 0 THEN
                price_original * (discount_pct / 100)  -- Monto del descuento
            ELSE
                0  -- Si no hay descuento, el monto del descuento es cero
        END AS discount_amount,
        CASE
            WHEN discount_pct > 0 THEN
                initial_price * (1 - discount_percent / 100) + (initial_price * (1 - discount_percent / 100)) * 0.75
            ELSE
                initial_price + initial_price * 0.75
        END AS price_with_tax,
        CONCAT('ARS$ ', CAST(ROUND(initial_price * 0.75, 2) AS STRING)) AS formatted_price_with_tax  -- Formato ARS$ 400,00
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    currency,
    price_original,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    ROUND(price_with_tax, 2) AS price_with_tax
FROM price_overview_cte
    );
  
[0m19:37:12.108504 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9181cdba-6b50-4373-94db-2234ad1ac64e&page=queryresults
[0m19:37:12.651385 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: discount_pct; Did you mean discount_percent? at [25:18]')
[0m19:37:13.383814 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:89092065-34c0-40ab-86d1-75828532727b&page=queryresults
[0m19:37:13.959214 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:89092065-34c0-40ab-86d1-75828532727b&page=queryresults
[0m19:37:13.962966 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 19:37:11.005103 => 19:37:13.961833
[0m19:37:13.973911 [debug] [Thread-1  ]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Unrecognized name: discount_pct; Did you mean discount_percent? at [25:18]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m19:37:13.975243 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb01327b-6c86-4172-b376-513bf0589cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea4a922e50>]}
[0m19:37:13.976532 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 2.98s]
[0m19:37:13.977914 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m19:37:13.978895 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m19:37:13.980109 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m19:37:13.981312 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m19:37:13.982047 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m19:37:13.987520 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m19:37:13.988637 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 19:37:13.982569 => 19:37:13.988252
[0m19:37:13.989322 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m19:37:13.992821 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:37:14.662716 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m19:37:14.663572 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m19:37:15.247799 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:43ab0ea5-c8e9-452e-9806-0a56b62cfdd7&page=queryresults
[0m19:37:18.332435 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 19:37:13.989768 => 19:37:18.331458
[0m19:37:18.335810 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb01327b-6c86-4172-b376-513bf0589cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea4babe430>]}
[0m19:37:18.338649 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.35s]
[0m19:37:18.341856 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m19:37:18.344121 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m19:37:18.346798 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m19:37:18.350037 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m19:37:18.352051 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m19:37:18.362550 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m19:37:18.364184 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 19:37:18.353541 => 19:37:18.363660
[0m19:37:18.365234 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m19:37:18.369930 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:37:19.022698 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m19:37:19.023559 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m19:37:19.497466 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:028508d9-f045-467f-8745-1efca96b7c5d&page=queryresults
[0m19:37:22.295576 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 19:37:18.365828 => 19:37:22.295056
[0m19:37:22.297454 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb01327b-6c86-4172-b376-513bf0589cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea48760af0>]}
[0m19:37:22.299007 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 3.95s]
[0m19:37:22.300738 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m19:37:22.301892 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m19:37:22.303080 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m19:37:22.304604 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m19:37:22.305575 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m19:37:22.311140 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m19:37:22.312664 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 19:37:22.306219 => 19:37:22.312211
[0m19:37:22.313549 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m19:37:22.317688 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:37:22.986566 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m19:37:22.987296 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m19:37:23.570618 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d845fb5e-eab1-4bee-9c67-a069db45d279&page=queryresults
[0m19:37:26.904588 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 19:37:22.314177 => 19:37:26.903594
[0m19:37:26.908115 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb01327b-6c86-4172-b376-513bf0589cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea4a8f0460>]}
[0m19:37:26.911469 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.60s]
[0m19:37:26.914985 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m19:37:26.919719 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:37:26.920725 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m19:37:26.921779 [info ] [MainThread]: 
[0m19:37:26.923183 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 25.34 seconds (25.34s).
[0m19:37:26.926536 [debug] [MainThread]: Command end result
[0m19:37:26.945921 [info ] [MainThread]: 
[0m19:37:26.946475 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:37:26.946905 [info ] [MainThread]: 
[0m19:37:26.947338 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Unrecognized name: discount_pct; Did you mean discount_percent? at [25:18]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m19:37:26.947767 [info ] [MainThread]: 
[0m19:37:26.948222 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m19:37:26.948904 [debug] [MainThread]: Command `dbt run` failed at 19:37:26.948769 after 26.14 seconds
[0m19:37:26.949396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea65f25d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea4bc63070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea4bc80970>]}
[0m19:37:26.949865 [debug] [MainThread]: Flushing usage events
[0m19:37:35.025837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4716404df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4713d99940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4713d99970>]}


============================== 19:37:35.030622 | 611d3c97-2a64-477e-8a36-425985090c40 ==============================
[0m19:37:35.030622 [info ] [MainThread]: Running with dbt=1.6.5
[0m19:37:35.031276 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'log_path': '/opt/airflow/includes/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:37:35.636080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '611d3c97-2a64-477e-8a36-425985090c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4713d4c940>]}
[0m19:37:35.647122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '611d3c97-2a64-477e-8a36-425985090c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46fc13fe50>]}
[0m19:37:35.647870 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m19:37:35.664872 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m19:37:35.754517 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:37:35.755162 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m19:37:35.798126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '611d3c97-2a64-477e-8a36-425985090c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46fbf43eb0>]}
[0m19:37:35.813071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '611d3c97-2a64-477e-8a36-425985090c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46fc055100>]}
[0m19:37:35.813608 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m19:37:35.814166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '611d3c97-2a64-477e-8a36-425985090c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46fc0550d0>]}
[0m19:37:35.815690 [info ] [MainThread]: 
[0m19:37:35.816499 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:37:35.817846 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m19:37:35.818303 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:37:36.404798 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m19:37:36.407019 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:37:37.089262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '611d3c97-2a64-477e-8a36-425985090c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46fbf8abb0>]}
[0m19:37:37.093149 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:37:37.095150 [info ] [MainThread]: 
[0m19:37:37.122049 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m19:37:37.123317 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m19:37:37.125009 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m19:37:37.125948 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m19:37:37.138563 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m19:37:37.139420 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 19:37:37.126505 => 19:37:37.139158
[0m19:37:37.139890 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m19:37:37.156316 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:37:37.851739 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m19:37:37.852497 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m19:37:38.040019 [info ] [MainThread]: [33mThe bigquery adapter does not support query cancellation. Some queries may still be running![0m
[0m19:37:38.378715 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:bf7b2633-6d8a-4e5e-82d5-9fb2bb3deb9d&page=queryresults
[0m19:37:41.159919 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 19:37:37.140229 => 19:37:41.159714
[0m19:37:41.160758 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '611d3c97-2a64-477e-8a36-425985090c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46faef7670>]}
[0m19:37:41.161382 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.04s]
[0m19:37:41.162139 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m19:37:41.162592 [info ] [MainThread]: 
[0m19:37:41.163088 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m19:37:41.163547 [info ] [MainThread]: 
[0m19:37:41.163948 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
[0m19:37:41.164380 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:37:41.164754 [debug] [MainThread]: Connection 'model.games.dim_developers' was properly closed.
[0m19:37:41.165093 [info ] [MainThread]: 
[0m19:37:41.165562 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 5.35 seconds (5.35s).
[0m19:37:41.166104 [error] [MainThread]: Encountered an error:

[0m19:37:41.168568 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 87, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 72, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 143, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 172, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 219, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 259, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/main.py", line 580, in run
    results = task.run()
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 469, in run
    result = self.execute_with_hooks(selected_uids)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 430, in execute_with_hooks
    res = self.execute_nodes()
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 356, in execute_nodes
    self.run_queue(pool)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 288, in run_queue
    self.job_queue.join()
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/graph/queue.py", line 198, in join
    self.inner.join()
  File "/usr/local/lib/python3.8/queue.py", line 89, in join
    self.all_tasks_done.wait()
  File "/usr/local/lib/python3.8/threading.py", line 302, in wait
    waiter.acquire()
KeyboardInterrupt

[0m19:37:41.169354 [debug] [MainThread]: Command `dbt run` failed at 19:37:41.169252 after 6.15 seconds
[0m19:37:41.169748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4716404df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46fc055220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46fc05e910>]}
[0m19:37:41.170155 [debug] [MainThread]: Flushing usage events
[0m19:38:07.089128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ca70efa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0c8097a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0c80979d0>]}


============================== 19:38:07.094082 | 1a12ed07-fe6c-4674-96e9-13c97c5a2a0c ==============================
[0m19:38:07.094082 [info ] [MainThread]: Running with dbt=1.6.5
[0m19:38:07.094766 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/includes/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:38:07.705208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a12ed07-fe6c-4674-96e9-13c97c5a2a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0c80c59a0>]}
[0m19:38:07.716228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a12ed07-fe6c-4674-96e9-13c97c5a2a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b047af40>]}
[0m19:38:07.716923 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m19:38:07.732805 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m19:38:07.817596 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:38:07.818192 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m19:38:07.861205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a12ed07-fe6c-4674-96e9-13c97c5a2a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b0281f10>]}
[0m19:38:07.875828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a12ed07-fe6c-4674-96e9-13c97c5a2a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b03951f0>]}
[0m19:38:07.876330 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m19:38:07.876770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a12ed07-fe6c-4674-96e9-13c97c5a2a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b03951c0>]}
[0m19:38:07.878223 [info ] [MainThread]: 
[0m19:38:07.879020 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:38:07.880284 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m19:38:07.880750 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:38:08.476367 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m19:38:08.478578 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:38:09.183904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a12ed07-fe6c-4674-96e9-13c97c5a2a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b02ceb50>]}
[0m19:38:09.184699 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:38:09.185159 [info ] [MainThread]: 
[0m19:38:09.191715 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m19:38:09.192320 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m19:38:09.193076 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m19:38:09.193521 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m19:38:09.202582 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m19:38:09.203389 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 19:38:09.193841 => 19:38:09.203140
[0m19:38:09.203873 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m19:38:09.221931 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:38:09.941596 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m19:38:09.942377 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m19:38:10.523987 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b7a205cb-8f33-45aa-ac3c-650cff251d87&page=queryresults
[0m19:38:13.606721 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 19:38:09.204217 => 19:38:13.606515
[0m19:38:13.607515 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a12ed07-fe6c-4674-96e9-13c97c5a2a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0afa2de20>]}
[0m19:38:13.608133 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.41s]
[0m19:38:13.608862 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m19:38:13.609355 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m19:38:13.609955 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m19:38:13.610770 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m19:38:13.611207 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m19:38:13.619242 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m19:38:13.620038 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 19:38:13.611507 => 19:38:13.619818
[0m19:38:13.620467 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m19:38:13.622943 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:38:14.294448 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m19:38:14.297505 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m19:38:14.865676 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ffe3e413-447e-4119-8d9b-6ba3374bd87c&page=queryresults
[0m19:38:18.272808 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 19:38:13.620804 => 19:38:18.271814
[0m19:38:18.276143 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a12ed07-fe6c-4674-96e9-13c97c5a2a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0afa2dbb0>]}
[0m19:38:18.279024 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.67s]
[0m19:38:18.282241 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m19:38:18.284505 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m19:38:18.287208 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m19:38:18.290469 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m19:38:18.292294 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m19:38:18.301186 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m19:38:18.302652 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 19:38:18.293358 => 19:38:18.302208
[0m19:38:18.303479 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m19:38:18.308197 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:38:18.969469 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m19:38:18.970259 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        currency,
        initial_price AS price_original,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        CASE
            WHEN discount_percent > 0 THEN
                price_original * (discount_percent / 100)  -- Monto del descuento
            ELSE
                0  -- Si no hay descuento, el monto del descuento es cero
        END AS discount_amount,
        CASE
            WHEN discount_percent > 0 THEN
                initial_price * (1 - discount_percent / 100) + (initial_price * (1 - discount_percent / 100)) * 0.75
            ELSE
                initial_price + initial_price * 0.75
        END AS price_with_tax,
        'ARS$ ' || CAST(ROUND(initial_price * 0.75, 2) AS STRING) AS formatted_price_with_tax  -- Formato ARS$ 400,00
    FROM `pristine-flames-400818`.`games`.`raw_games`
)


SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    currency,
    price_original,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    ROUND(price_with_tax, 2) AS price_with_tax
FROM price_overview_cte
    );
  
[0m19:38:19.520886 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:979def07-a2eb-4d81-bc01-0ac9dbbfc44b&page=queryresults
[0m19:38:20.048895 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: price_original at [26:17]')
[0m19:38:21.322439 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:12843f8a-aa72-4be5-aec9-39f3464302a1&page=queryresults
[0m19:38:21.848623 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:12843f8a-aa72-4be5-aec9-39f3464302a1&page=queryresults
[0m19:38:21.852386 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 19:38:18.304073 => 19:38:21.851283
[0m19:38:21.868906 [debug] [Thread-1  ]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Unrecognized name: price_original at [26:17]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m19:38:21.871154 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a12ed07-fe6c-4674-96e9-13c97c5a2a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0af02eb80>]}
[0m19:38:21.873343 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 3.58s]
[0m19:38:21.875505 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m19:38:21.876986 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m19:38:21.878434 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m19:38:21.880114 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m19:38:21.881182 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m19:38:21.887565 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m19:38:21.888686 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 19:38:21.881896 => 19:38:21.888314
[0m19:38:21.889372 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m19:38:21.893131 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:38:22.567068 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m19:38:22.567835 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m19:38:23.170819 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:aaa9cb92-d681-476e-9226-7cd0bd3ff42f&page=queryresults
[0m19:38:26.240176 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 19:38:21.889869 => 19:38:26.239666
[0m19:38:26.241901 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a12ed07-fe6c-4674-96e9-13c97c5a2a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0af02ed60>]}
[0m19:38:26.243061 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.36s]
[0m19:38:26.244356 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m19:38:26.245359 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m19:38:26.246527 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m19:38:26.247700 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m19:38:26.248448 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m19:38:26.253433 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m19:38:26.254376 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 19:38:26.248966 => 19:38:26.254075
[0m19:38:26.254961 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m19:38:26.258160 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:38:26.953429 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m19:38:26.956361 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m19:38:27.550201 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d36e9e85-da53-4db1-8bf5-60f52a971974&page=queryresults
[0m19:38:30.603859 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 19:38:26.255380 => 19:38:30.603651
[0m19:38:30.604763 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a12ed07-fe6c-4674-96e9-13c97c5a2a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0af14a610>]}
[0m19:38:30.605466 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.36s]
[0m19:38:30.606212 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m19:38:30.606699 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m19:38:30.607195 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m19:38:30.607915 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m19:38:30.608422 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m19:38:30.611605 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m19:38:30.612313 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 19:38:30.608773 => 19:38:30.612066
[0m19:38:30.612767 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m19:38:30.615149 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:38:31.296304 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m19:38:31.297112 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m19:38:31.935413 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:358ae008-29a5-4d8b-8cb4-f6d0b21c19ec&page=queryresults
[0m19:38:35.087222 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 19:38:30.613062 => 19:38:35.087020
[0m19:38:35.088013 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a12ed07-fe6c-4674-96e9-13c97c5a2a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0af14a3d0>]}
[0m19:38:35.088641 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.48s]
[0m19:38:35.089397 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m19:38:35.091019 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:38:35.091370 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m19:38:35.091741 [info ] [MainThread]: 
[0m19:38:35.092209 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 27.21 seconds (27.21s).
[0m19:38:35.093717 [debug] [MainThread]: Command end result
[0m19:38:35.106437 [info ] [MainThread]: 
[0m19:38:35.106976 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:38:35.107460 [info ] [MainThread]: 
[0m19:38:35.107847 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Unrecognized name: price_original at [26:17]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m19:38:35.108220 [info ] [MainThread]: 
[0m19:38:35.108636 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m19:38:35.109232 [debug] [MainThread]: Command `dbt run` failed at 19:38:35.109127 after 28.03 seconds
[0m19:38:35.109630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ca70efa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b02ceca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b0395430>]}
[0m19:38:35.110041 [debug] [MainThread]: Flushing usage events
[0m19:39:15.652011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa7aa5ef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa783e2a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa783e29d0>]}


============================== 19:39:15.656701 | ca6b5198-0981-4edd-af5f-c46f3e37d3c7 ==============================
[0m19:39:15.656701 [info ] [MainThread]: Running with dbt=1.6.5
[0m19:39:15.657294 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/includes/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:39:16.211889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca6b5198-0981-4edd-af5f-c46f3e37d3c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa78411910>]}
[0m19:39:16.223016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca6b5198-0981-4edd-af5f-c46f3e37d3c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa607d2ee0>]}
[0m19:39:16.223749 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m19:39:16.241359 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m19:39:16.331293 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:39:16.331948 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m19:39:16.381902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca6b5198-0981-4edd-af5f-c46f3e37d3c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa605cfeb0>]}
[0m19:39:16.398043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca6b5198-0981-4edd-af5f-c46f3e37d3c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa606dd130>]}
[0m19:39:16.398587 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m19:39:16.399003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca6b5198-0981-4edd-af5f-c46f3e37d3c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa606dd190>]}
[0m19:39:16.400697 [info ] [MainThread]: 
[0m19:39:16.401812 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:39:16.403527 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m19:39:16.404135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:17.089286 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m19:39:17.091486 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:39:17.777689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca6b5198-0981-4edd-af5f-c46f3e37d3c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa605cffd0>]}
[0m19:39:17.781225 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:39:17.783104 [info ] [MainThread]: 
[0m19:39:17.810545 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m19:39:17.812165 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m19:39:17.814043 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m19:39:17.815122 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m19:39:17.823346 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m19:39:17.824107 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 19:39:17.815480 => 19:39:17.823850
[0m19:39:17.824514 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m19:39:17.839920 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:39:18.535660 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m19:39:18.536442 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m19:39:19.121033 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:8afd5b43-cb73-42c1-8f4e-316b4632e9ef&page=queryresults
[0m19:39:22.290944 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 19:39:17.824859 => 19:39:22.290731
[0m19:39:22.291859 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca6b5198-0981-4edd-af5f-c46f3e37d3c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa6017be20>]}
[0m19:39:22.292565 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.48s]
[0m19:39:22.293409 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m19:39:22.293982 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m19:39:22.294616 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m19:39:22.295493 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m19:39:22.296005 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m19:39:22.304873 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m19:39:22.305663 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 19:39:22.296342 => 19:39:22.305391
[0m19:39:22.306106 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m19:39:22.308771 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:39:22.969571 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m19:39:22.970743 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m19:39:23.600347 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:52169523-5827-4cba-93b8-e67a4c41a6f9&page=queryresults
[0m19:39:26.812240 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 19:39:22.306399 => 19:39:26.812037
[0m19:39:26.813017 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca6b5198-0981-4edd-af5f-c46f3e37d3c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa6017b2e0>]}
[0m19:39:26.813622 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.52s]
[0m19:39:26.814360 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m19:39:26.814861 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m19:39:26.815468 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m19:39:26.816189 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m19:39:26.816634 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m19:39:26.820010 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m19:39:26.820720 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 19:39:26.816959 => 19:39:26.820490
[0m19:39:26.821148 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m19:39:26.823786 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:39:27.511377 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m19:39:27.514552 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        currency,
        initial_price AS price_original,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        CASE
            WHEN discount_percent > 0 THEN
                initial_price * (discount_percent / 100)  -- Monto del descuento
            ELSE
                0  -- Si no hay descuento, el monto del descuento es cero
        END AS discount_amount,
        CASE
            WHEN discount_percent > 0 THEN
                initial_price * (1 - discount_percent / 100) + (initial_price * (1 - discount_percent / 100)) * 0.75
            ELSE
                initial_price + initial_price * 0.75
        END AS price_with_tax,
        'ARS$ ' || CAST(ROUND(initial_price * 0.75, 2) AS STRING) AS formatted_price_with_tax  -- Formato ARS$ 400,00
    FROM `pristine-flames-400818`.`games`.`raw_games`
)


SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    currency,
    price_original,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    ROUND(price_with_tax, 2) AS price_with_tax
FROM price_overview_cte
    );
  
[0m19:39:28.113444 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5f28bd31-35f3-4c34-89ce-23f84fd8a8da&page=queryresults
[0m19:39:30.925795 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 19:39:26.821453 => 19:39:30.924811
[0m19:39:30.929194 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca6b5198-0981-4edd-af5f-c46f3e37d3c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa5b351700>]}
[0m19:39:30.932087 [info ] [Thread-1  ]: 3 of 6 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (2.7k rows, 98.5 KiB processed)[0m in 4.11s]
[0m19:39:30.935313 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m19:39:30.937641 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m19:39:30.940320 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m19:39:30.943595 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m19:39:30.945708 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m19:39:30.955180 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m19:39:30.956797 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 19:39:30.946928 => 19:39:30.956346
[0m19:39:30.957643 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m19:39:30.962612 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:39:31.621581 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m19:39:31.622702 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m19:39:32.200479 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:256a1978-0874-414f-be61-e773871fb297&page=queryresults
[0m19:39:35.338126 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 19:39:30.958240 => 19:39:35.337147
[0m19:39:35.340754 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca6b5198-0981-4edd-af5f-c46f3e37d3c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa5b36dd90>]}
[0m19:39:35.341473 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.40s]
[0m19:39:35.342214 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m19:39:35.342839 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m19:39:35.343455 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m19:39:35.344154 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m19:39:35.344570 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m19:39:35.347832 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m19:39:35.348604 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 19:39:35.344881 => 19:39:35.348306
[0m19:39:35.349054 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m19:39:35.351709 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:39:36.006022 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m19:39:36.009124 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m19:39:36.604335 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:59a15cb7-cf95-4fd4-a0e4-440eafb9af40&page=queryresults
[0m19:39:39.414223 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 19:39:35.349363 => 19:39:39.413472
[0m19:39:39.416892 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca6b5198-0981-4edd-af5f-c46f3e37d3c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa600c5f70>]}
[0m19:39:39.419672 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.07s]
[0m19:39:39.422826 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m19:39:39.425109 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m19:39:39.427773 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m19:39:39.430937 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m19:39:39.432965 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m19:39:39.445692 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m19:39:39.447497 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 19:39:39.434414 => 19:39:39.446974
[0m19:39:39.448553 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m19:39:39.453862 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:39:40.140218 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m19:39:40.141018 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m19:39:40.606442 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:80f64a9e-23a3-4787-a2f3-9638185cd730&page=queryresults
[0m19:39:43.090374 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 19:39:39.449342 => 19:39:43.089370
[0m19:39:43.093948 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca6b5198-0981-4edd-af5f-c46f3e37d3c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa600c5f70>]}
[0m19:39:43.095060 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 3.66s]
[0m19:39:43.095787 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m19:39:43.097317 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:39:43.097677 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m19:39:43.098074 [info ] [MainThread]: 
[0m19:39:43.098493 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 26.70 seconds (26.70s).
[0m19:39:43.100144 [debug] [MainThread]: Command end result
[0m19:39:43.113683 [info ] [MainThread]: 
[0m19:39:43.114214 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:39:43.114697 [info ] [MainThread]: 
[0m19:39:43.115109 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m19:39:43.115717 [debug] [MainThread]: Command `dbt run` succeeded at 19:39:43.115611 after 27.47 seconds
[0m19:39:43.116111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa7aa5ef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa607c4dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa606e9700>]}
[0m19:39:43.116517 [debug] [MainThread]: Flushing usage events
[0m19:42:25.005170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b45f93dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b438fe910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b438fe940>]}


============================== 19:42:25.010077 | fe6d1d7e-e9f2-4b9e-a091-9a462f8e4660 ==============================
[0m19:42:25.010077 [info ] [MainThread]: Running with dbt=1.6.5
[0m19:42:25.010592 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'log_path': '/opt/airflow/includes/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:42:25.580635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe6d1d7e-e9f2-4b9e-a091-9a462f8e4660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b43932820>]}
[0m19:42:25.591461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe6d1d7e-e9f2-4b9e-a091-9a462f8e4660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b2bcf2e20>]}
[0m19:42:25.592115 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m19:42:25.608272 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m19:42:25.699789 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:42:25.700419 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m19:42:25.744816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe6d1d7e-e9f2-4b9e-a091-9a462f8e4660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b2baf0e80>]}
[0m19:42:25.760040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe6d1d7e-e9f2-4b9e-a091-9a462f8e4660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b2bbf8280>]}
[0m19:42:25.760564 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m19:42:25.761004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe6d1d7e-e9f2-4b9e-a091-9a462f8e4660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b2bbf80d0>]}
[0m19:42:25.762479 [info ] [MainThread]: 
[0m19:42:25.763269 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:42:25.764531 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m19:42:25.765005 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:42:26.435604 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m19:42:26.436082 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:42:27.035671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe6d1d7e-e9f2-4b9e-a091-9a462f8e4660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b2bd06190>]}
[0m19:42:27.036562 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:42:27.037032 [info ] [MainThread]: 
[0m19:42:27.044268 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m19:42:27.044999 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m19:42:27.045954 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m19:42:27.046520 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m19:42:27.056693 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m19:42:27.057734 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 19:42:27.046877 => 19:42:27.057417
[0m19:42:27.058295 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m19:42:27.075152 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:42:27.740388 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m19:42:27.741107 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m19:42:28.330764 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:01d4da11-bf87-49d8-a5d0-50bb5c9805cb&page=queryresults
[0m19:42:31.181939 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 19:42:27.058683 => 19:42:31.181620
[0m19:42:31.183574 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe6d1d7e-e9f2-4b9e-a091-9a462f8e4660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b2b496e20>]}
[0m19:42:31.184623 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.14s]
[0m19:42:31.185611 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m19:42:31.186431 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m19:42:31.187206 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m19:42:31.188185 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m19:42:31.188843 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m19:42:31.200228 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m19:42:31.201122 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 19:42:31.189260 => 19:42:31.200875
[0m19:42:31.201589 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m19:42:31.205009 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:42:31.811407 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m19:42:31.812270 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m19:42:32.274685 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:562c2dda-c783-4e5f-95d7-3a99a4647170&page=queryresults
[0m19:42:35.394597 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 19:42:31.201904 => 19:42:35.393628
[0m19:42:35.397912 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe6d1d7e-e9f2-4b9e-a091-9a462f8e4660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b2b4962e0>]}
[0m19:42:35.400738 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.21s]
[0m19:42:35.403860 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m19:42:35.406139 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m19:42:35.408826 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m19:42:35.412028 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m19:42:35.414434 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m19:42:35.426164 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m19:42:35.427812 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 19:42:35.416067 => 19:42:35.427266
[0m19:42:35.428853 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m19:42:35.433927 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:42:36.111389 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m19:42:36.112347 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        currency,
        initial_price AS price_original,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        TO_JSON_STRING(
            STRUCT(
                CASE
                    WHEN discount_pct > 0 THEN
                        CAST(ROUND(initial_price * (discount_pct / 100), 2) AS FLOAT64)  -- Monto del descuento
                    ELSE
                        CAST(0.0 AS FLOAT64)  -- Si no hay descuento, el monto del descuento es cero
                END AS discount_amount
            )
        ) AS discount_amount,
        CASE
            WHEN discount_pct > 0 THEN
                initial_price * (1 - discount_pct / 100) + (initial_price * (1 - discount_pct / 100)) * 0.75
            ELSE
                initial_price + initial_price * 0.75
        END AS price_with_tax,
        'ARS$ ' || CAST(ROUND(initial_price * 0.75, 2) AS STRING) AS formatted_price_with_tax  -- Formato ARS$ 4,100.00
    FROM `pristine-flames-400818`.`games`.`raw_games`
)


SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    currency,
    price_original,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    ROUND(price_with_tax, 2) AS price_with_tax
FROM price_overview_cte
    );
  
[0m19:42:36.635717 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:8b22cc77-30d3-404b-948a-d49e189d4c3c&page=queryresults
[0m19:42:37.176299 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: discount_pct; Did you mean discount_percent? at [27:26]')
[0m19:42:37.826938 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:53c67b90-d36e-4ed0-8f73-934c32682b3d&page=queryresults
[0m19:42:38.335373 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:53c67b90-d36e-4ed0-8f73-934c32682b3d&page=queryresults
[0m19:42:38.337964 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 19:42:35.429595 => 19:42:38.337207
[0m19:42:38.342657 [debug] [Thread-1  ]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Unrecognized name: discount_pct; Did you mean discount_percent? at [27:26]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m19:42:38.343191 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe6d1d7e-e9f2-4b9e-a091-9a462f8e4660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b2ab89bb0>]}
[0m19:42:38.343830 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 2.93s]
[0m19:42:38.344518 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m19:42:38.345016 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m19:42:38.345514 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m19:42:38.346366 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m19:42:38.346796 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m19:42:38.350248 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m19:42:38.350924 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 19:42:38.347094 => 19:42:38.350717
[0m19:42:38.351323 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m19:42:38.353793 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:42:38.994254 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m19:42:38.995053 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m19:42:39.584620 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c07e2b0c-9484-40aa-9641-b688290d8930&page=queryresults
[0m19:42:42.930257 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 19:42:38.351609 => 19:42:42.930032
[0m19:42:42.931050 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe6d1d7e-e9f2-4b9e-a091-9a462f8e4660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b289ec760>]}
[0m19:42:42.931701 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.58s]
[0m19:42:42.932395 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m19:42:42.932908 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m19:42:42.933422 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m19:42:42.934181 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m19:42:42.934621 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m19:42:42.938360 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m19:42:42.939160 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 19:42:42.934957 => 19:42:42.938901
[0m19:42:42.939637 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m19:42:42.942464 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:42:43.580748 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m19:42:43.583778 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m19:42:44.215576 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9fc69747-368f-4a1d-8db0-18d84a2f2591&page=queryresults
[0m19:42:47.117229 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 19:42:42.939982 => 19:42:47.116237
[0m19:42:47.120508 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe6d1d7e-e9f2-4b9e-a091-9a462f8e4660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b289ec730>]}
[0m19:42:47.123323 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.19s]
[0m19:42:47.126477 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m19:42:47.128770 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m19:42:47.131425 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m19:42:47.134620 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m19:42:47.136640 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m19:42:47.147366 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m19:42:47.149155 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 19:42:47.138130 => 19:42:47.148575
[0m19:42:47.150151 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m19:42:47.155410 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:42:47.817308 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m19:42:47.818146 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m19:42:48.677468 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:0496a7e0-c2a7-4590-afad-0617ade86fea&page=queryresults
[0m19:42:52.013226 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 19:42:47.150746 => 19:42:52.013011
[0m19:42:52.014161 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe6d1d7e-e9f2-4b9e-a091-9a462f8e4660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b289ece80>]}
[0m19:42:52.014846 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.88s]
[0m19:42:52.015712 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m19:42:52.017329 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:42:52.017742 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m19:42:52.018191 [info ] [MainThread]: 
[0m19:42:52.018665 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 26.26 seconds (26.26s).
[0m19:42:52.020267 [debug] [MainThread]: Command end result
[0m19:42:52.035152 [info ] [MainThread]: 
[0m19:42:52.035699 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:42:52.036169 [info ] [MainThread]: 
[0m19:42:52.036576 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Unrecognized name: discount_pct; Did you mean discount_percent? at [27:26]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m19:42:52.036982 [info ] [MainThread]: 
[0m19:42:52.037436 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m19:42:52.038043 [debug] [MainThread]: Command `dbt run` failed at 19:42:52.037937 after 27.04 seconds
[0m19:42:52.038444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b45f93dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b2bcf2e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b2bbf8310>]}
[0m19:42:52.039459 [debug] [MainThread]: Flushing usage events
[0m19:43:50.397212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2bcdb3df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2ba6d4400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2ba6d4370>]}


============================== 19:43:50.401927 | 35e90ada-40ec-4d9b-b3f8-805bfad88406 ==============================
[0m19:43:50.401927 [info ] [MainThread]: Running with dbt=1.6.5
[0m19:43:50.402526 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/includes/dbt/models/transform/dim_price_overview.sql', 'log_path': '/opt/airflow/includes/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/models/transform/dim_price_overview.sql', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:43:50.404766 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'games'
[0m19:43:50.405445 [debug] [MainThread]: Command `dbt run` failed at 19:43:50.405342 after 0.01 seconds
[0m19:43:50.405827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2bcdb3df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2ba7b8d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2ba7b8f40>]}
[0m19:43:50.406257 [debug] [MainThread]: Flushing usage events
[0m19:43:55.724675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc54113f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc51ab8a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc51ab8a60>]}


============================== 19:43:55.729368 | 0ecee790-01ad-4441-9837-a1a5a7b61b60 ==============================
[0m19:43:55.729368 [info ] [MainThread]: Running with dbt=1.6.5
[0m19:43:55.729936 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/includes/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:43:56.281379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ecee790-01ad-4441-9837-a1a5a7b61b60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc51ae5970>]}
[0m19:43:56.292391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ecee790-01ad-4441-9837-a1a5a7b61b60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc39e90f10>]}
[0m19:43:56.293053 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m19:43:56.309327 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m19:43:56.395518 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:43:56.396169 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m19:43:56.440141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ecee790-01ad-4441-9837-a1a5a7b61b60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc39c8bee0>]}
[0m19:43:56.455547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ecee790-01ad-4441-9837-a1a5a7b61b60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc39d9b1c0>]}
[0m19:43:56.456089 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m19:43:56.456493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ecee790-01ad-4441-9837-a1a5a7b61b60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc39d9b190>]}
[0m19:43:56.458014 [info ] [MainThread]: 
[0m19:43:56.458785 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:43:56.460132 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m19:43:56.460662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:43:57.173120 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m19:43:57.175294 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:43:57.826726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ecee790-01ad-4441-9837-a1a5a7b61b60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc39c8bf10>]}
[0m19:43:57.827504 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:43:57.827910 [info ] [MainThread]: 
[0m19:43:57.834445 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m19:43:57.835063 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m19:43:57.835786 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m19:43:57.836212 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m19:43:57.844932 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m19:43:57.845724 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 19:43:57.836516 => 19:43:57.845495
[0m19:43:57.846159 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m19:43:57.862129 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:43:58.569824 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m19:43:58.570610 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m19:43:59.158235 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:87d3330f-3c14-4ba5-b02e-a1544c4b7815&page=queryresults
[0m19:44:02.012820 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 19:43:57.846458 => 19:44:02.012517
[0m19:44:02.013911 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ecee790-01ad-4441-9837-a1a5a7b61b60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc39633f40>]}
[0m19:44:02.014751 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.18s]
[0m19:44:02.015667 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m19:44:02.016330 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m19:44:02.017009 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m19:44:02.018054 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m19:44:02.018578 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m19:44:02.027914 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m19:44:02.028874 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 19:44:02.018947 => 19:44:02.028593
[0m19:44:02.029330 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m19:44:02.032110 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:44:02.704259 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m19:44:02.707212 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m19:44:03.275618 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d5998075-58cb-4455-b88a-3b5d7e592b3a&page=queryresults
[0m19:44:06.104531 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 19:44:02.029628 => 19:44:06.104332
[0m19:44:06.105311 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ecee790-01ad-4441-9837-a1a5a7b61b60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc39633ee0>]}
[0m19:44:06.105914 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.09s]
[0m19:44:06.106679 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m19:44:06.107196 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m19:44:06.107794 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m19:44:06.108508 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m19:44:06.108953 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m19:44:06.112378 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m19:44:06.113093 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 19:44:06.109264 => 19:44:06.112873
[0m19:44:06.113523 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m19:44:06.116156 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:44:06.784359 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m19:44:06.785226 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        currency,
        initial_price AS price_original,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        CASE
            WHEN discount_pct > 0 THEN
                price_original * (discount_pct / 100)  -- Monto del descuento
            ELSE
                0  -- Si no hay descuento, el monto del descuento es cero
        END AS discount_amount,
        CASE
            WHEN discount_pct > 0 THEN
                initial_price * (1 - discount_pct / 100) + (initial_price * (1 - discount_pct / 100)) * 0.75
            ELSE
                initial_price + initial_price * 0.75
        END AS price_with_tax,
        'ARS$ ' || CAST(ROUND(initial_price * 0.75, 2) AS STRING) AS formatted_price_with_tax,  -- Formato ARS$ 400,00
        CASE
            WHEN discount_pct > 0 THEN
                CAST(ROUND(discount_pct, 2) AS STRING)
            ELSE
                '0.00'
        END AS formatted_discount_pct  -- Formato del descuento como número decimal
    FROM `pristine-flames-400818`.`games`.`raw_games`
)


SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    currency,
    price_original,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    ROUND(price_with_tax, 2) AS price_with_tax
FROM price_overview_cte
    );
  
[0m19:44:07.433370 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:27b0f38a-2891-41da-bc5d-e81f4adf7fea&page=queryresults
[0m19:44:07.986990 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: discount_pct; Did you mean discount_percent? at [25:18]')
[0m19:44:08.742368 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5bf188d2-0535-48f8-84ce-fd9883b42837&page=queryresults
[0m19:44:09.279753 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5bf188d2-0535-48f8-84ce-fd9883b42837&page=queryresults
[0m19:44:09.283124 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 19:44:06.113831 => 19:44:09.282106
[0m19:44:09.286932 [debug] [Thread-1  ]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Unrecognized name: discount_pct; Did you mean discount_percent? at [25:18]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m19:44:09.287455 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ecee790-01ad-4441-9837-a1a5a7b61b60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc38d4dc70>]}
[0m19:44:09.288078 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 3.18s]
[0m19:44:09.288809 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m19:44:09.289297 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m19:44:09.289936 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m19:44:09.290686 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m19:44:09.291096 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m19:44:09.294736 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m19:44:09.295697 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 19:44:09.291391 => 19:44:09.295403
[0m19:44:09.296156 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m19:44:09.298915 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:44:09.977472 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m19:44:09.978197 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m19:44:10.599891 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:1e816c6c-198c-467f-8993-edfcc90c060a&page=queryresults
[0m19:44:13.974228 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 19:44:09.296445 => 19:44:13.973269
[0m19:44:13.977566 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ecee790-01ad-4441-9837-a1a5a7b61b60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc38d205b0>]}
[0m19:44:13.980335 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.69s]
[0m19:44:13.983450 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m19:44:13.985722 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m19:44:13.988363 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m19:44:13.991566 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m19:44:13.993584 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m19:44:14.001113 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m19:44:14.001984 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 19:44:13.995026 => 19:44:14.001700
[0m19:44:14.002452 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m19:44:14.005376 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:44:14.673971 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m19:44:14.674744 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m19:44:15.252282 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a07a0300-f3fd-44d7-9da4-270e42ca470c&page=queryresults
[0m19:44:18.473271 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 19:44:14.002746 => 19:44:18.472273
[0m19:44:18.476632 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ecee790-01ad-4441-9837-a1a5a7b61b60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc3838beb0>]}
[0m19:44:18.479509 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.49s]
[0m19:44:18.482655 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m19:44:18.484937 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m19:44:18.487569 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m19:44:18.490833 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m19:44:18.492894 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m19:44:18.504334 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m19:44:18.506089 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 19:44:18.494353 => 19:44:18.505548
[0m19:44:18.507131 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m19:44:18.512612 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:44:19.200115 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m19:44:19.200959 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m19:44:19.662776 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b5a5586e-6e0b-40ed-865c-255725c9e4d4&page=queryresults
[0m19:44:22.483026 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 19:44:18.507829 => 19:44:22.482826
[0m19:44:22.483769 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ecee790-01ad-4441-9837-a1a5a7b61b60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc38d205b0>]}
[0m19:44:22.484372 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 3.99s]
[0m19:44:22.485075 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m19:44:22.486709 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:44:22.487144 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m19:44:22.487609 [info ] [MainThread]: 
[0m19:44:22.488075 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 26.03 seconds (26.03s).
[0m19:44:22.489638 [debug] [MainThread]: Command end result
[0m19:44:22.503540 [info ] [MainThread]: 
[0m19:44:22.504082 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:44:22.504780 [info ] [MainThread]: 
[0m19:44:22.505195 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Unrecognized name: discount_pct; Did you mean discount_percent? at [25:18]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m19:44:22.505616 [info ] [MainThread]: 
[0m19:44:22.506034 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m19:44:22.506678 [debug] [MainThread]: Command `dbt run` failed at 19:44:22.506574 after 26.79 seconds
[0m19:44:22.507086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc54113f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc39d9b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc39d9b400>]}
[0m19:44:22.507513 [debug] [MainThread]: Flushing usage events
[0m19:44:49.441296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06cf636df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06ccfe79a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06ccfe7970>]}


============================== 19:44:49.446182 | 7879c3f5-c69d-40ed-abfc-2007393527b2 ==============================
[0m19:44:49.446182 [info ] [MainThread]: Running with dbt=1.6.5
[0m19:44:49.446784 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/includes/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:44:50.011919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7879c3f5-c69d-40ed-abfc-2007393527b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06cd01c850>]}
[0m19:44:50.024151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7879c3f5-c69d-40ed-abfc-2007393527b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06b53aee50>]}
[0m19:44:50.025079 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m19:44:50.044189 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m19:44:50.138696 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:44:50.139323 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m19:44:50.186667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7879c3f5-c69d-40ed-abfc-2007393527b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06b51aceb0>]}
[0m19:44:50.203708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7879c3f5-c69d-40ed-abfc-2007393527b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06b52bc100>]}
[0m19:44:50.204286 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m19:44:50.204760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7879c3f5-c69d-40ed-abfc-2007393527b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06b52bc0d0>]}
[0m19:44:50.206304 [info ] [MainThread]: 
[0m19:44:50.207100 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:44:50.208470 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m19:44:50.208961 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:44:50.868356 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m19:44:50.868935 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:44:51.498530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7879c3f5-c69d-40ed-abfc-2007393527b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06b51f0bb0>]}
[0m19:44:51.501638 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:44:51.503560 [info ] [MainThread]: 
[0m19:44:51.526001 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m19:44:51.527249 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m19:44:51.528516 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m19:44:51.529298 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m19:44:51.541496 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m19:44:51.542381 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 19:44:51.529842 => 19:44:51.542133
[0m19:44:51.542859 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m19:44:51.558861 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:44:52.248679 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m19:44:52.249400 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m19:44:52.701518 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f4218607-1e1e-488d-8ecc-af37e5826d5f&page=queryresults
[0m19:44:55.622697 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 19:44:51.543201 => 19:44:55.622482
[0m19:44:55.623489 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7879c3f5-c69d-40ed-abfc-2007393527b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06b4953e50>]}
[0m19:44:55.624097 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.10s]
[0m19:44:55.624788 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m19:44:55.625265 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m19:44:55.625861 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m19:44:55.626586 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m19:44:55.627073 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m19:44:55.636114 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m19:44:55.636880 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 19:44:55.627441 => 19:44:55.636664
[0m19:44:55.637296 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m19:44:55.639894 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:44:56.283912 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m19:44:56.284928 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m19:44:56.868318 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:bcf9fa2e-e627-435c-b20c-3cf28414c733&page=queryresults
[0m19:44:59.390909 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 19:44:55.637588 => 19:44:59.390708
[0m19:44:59.391647 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7879c3f5-c69d-40ed-abfc-2007393527b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06b4035220>]}
[0m19:44:59.392250 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 3.77s]
[0m19:44:59.392932 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m19:44:59.393428 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m19:44:59.394001 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m19:44:59.394696 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m19:44:59.395096 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m19:44:59.398294 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m19:44:59.399008 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 19:44:59.395384 => 19:44:59.398755
[0m19:44:59.399423 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m19:44:59.401935 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:45:00.042154 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m19:45:00.043267 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        currency,
        initial_price AS price_original,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        CASE
            WHEN discount_percent > 0 THEN
                price_original * (discount_percent / 100)  -- Monto del descuento
            ELSE
                0  -- Si no hay descuento, el monto del descuento es cero
        END AS discount_amount,
        CASE
            WHEN discount_percent > 0 THEN
                initial_price * (1 - discount_percent / 100) + (initial_price * (1 - discount_percent / 100)) * 0.75
            ELSE
                initial_price + initial_price * 0.75
        END AS price_with_tax,
        'ARS$ ' || CAST(ROUND(initial_price * 0.75, 2) AS STRING) AS formatted_price_with_tax,  -- Formato ARS$ 400,00
        CASE
            WHEN discount_percent > 0 THEN
                CAST(ROUND(discount_percent, 2) AS STRING)
            ELSE
                '0.00'
        END AS formatted_discount_pct  -- Formato del descuento como número decimal
    FROM `pristine-flames-400818`.`games`.`raw_games`
)


SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    currency,
    price_original,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    ROUND(price_with_tax, 2) AS price_with_tax
FROM price_overview_cte
    );
  
[0m19:45:00.656574 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:266419af-7a0d-4118-a993-5afdafec6747&page=queryresults
[0m19:45:01.208233 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: price_original at [26:17]')
[0m19:45:01.851070 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5a7208ab-82c0-4df2-a6fa-52af26253dc3&page=queryresults
[0m19:45:02.384161 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5a7208ab-82c0-4df2-a6fa-52af26253dc3&page=queryresults
[0m19:45:02.387843 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 19:44:59.399717 => 19:45:02.386770
[0m19:45:02.391381 [debug] [Thread-1  ]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Unrecognized name: price_original at [26:17]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m19:45:02.391866 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7879c3f5-c69d-40ed-abfc-2007393527b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06b4073f40>]}
[0m19:45:02.392464 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 3.00s]
[0m19:45:02.393255 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m19:45:02.393740 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m19:45:02.394234 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m19:45:02.394936 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m19:45:02.395367 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m19:45:02.398956 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m19:45:02.399790 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 19:45:02.395680 => 19:45:02.399542
[0m19:45:02.400224 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m19:45:02.402844 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:45:03.094197 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m19:45:03.094989 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m19:45:03.681350 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:22130855-63f4-4564-bb23-3ff91b10f6cf&page=queryresults
[0m19:45:06.473125 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 19:45:02.400532 => 19:45:06.472924
[0m19:45:06.473869 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7879c3f5-c69d-40ed-abfc-2007393527b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06b4077880>]}
[0m19:45:06.474470 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.08s]
[0m19:45:06.475162 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m19:45:06.475624 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m19:45:06.476187 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m19:45:06.476885 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m19:45:06.477284 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m19:45:06.480459 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m19:45:06.481210 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 19:45:06.477569 => 19:45:06.480982
[0m19:45:06.481607 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m19:45:06.483974 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:45:07.132304 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m19:45:07.135385 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m19:45:07.620206 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5ed7159d-8ec9-4b36-9efc-87819e496fd2&page=queryresults
[0m19:45:10.419178 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 19:45:06.481890 => 19:45:10.418200
[0m19:45:10.422585 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7879c3f5-c69d-40ed-abfc-2007393527b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06b4077670>]}
[0m19:45:10.425489 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 3.95s]
[0m19:45:10.428668 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m19:45:10.430961 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m19:45:10.433475 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m19:45:10.435773 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m19:45:10.437239 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m19:45:10.444988 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m19:45:10.446357 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 19:45:10.438248 => 19:45:10.445922
[0m19:45:10.447167 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m19:45:10.451398 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:45:11.098591 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m19:45:11.099493 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m19:45:11.596627 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f6c44b03-6f30-42dd-9d12-ab91e29faf16&page=queryresults
[0m19:45:14.684190 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 19:45:10.447749 => 19:45:14.683989
[0m19:45:14.685001 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7879c3f5-c69d-40ed-abfc-2007393527b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06b4031280>]}
[0m19:45:14.685604 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.25s]
[0m19:45:14.686332 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m19:45:14.687832 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:45:14.688208 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m19:45:14.688611 [info ] [MainThread]: 
[0m19:45:14.689030 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 24.48 seconds (24.48s).
[0m19:45:14.690583 [debug] [MainThread]: Command end result
[0m19:45:14.704390 [info ] [MainThread]: 
[0m19:45:14.704991 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:45:14.705392 [info ] [MainThread]: 
[0m19:45:14.705753 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Unrecognized name: price_original at [26:17]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m19:45:14.706197 [info ] [MainThread]: 
[0m19:45:14.706616 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m19:45:14.707213 [debug] [MainThread]: Command `dbt run` failed at 19:45:14.707109 after 25.27 seconds
[0m19:45:14.707625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06cf636df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06b53d9df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06b52bc340>]}
[0m19:45:14.708036 [debug] [MainThread]: Flushing usage events
[0m19:46:48.356120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9676d9e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9650709a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe965070970>]}


============================== 19:46:48.360787 | 06e6c05c-0c12-4618-aada-0b3fece07368 ==============================
[0m19:46:48.360787 [info ] [MainThread]: Running with dbt=1.6.5
[0m19:46:48.361370 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/includes/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:46:48.913618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06e6c05c-0c12-4618-aada-0b3fece07368', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9650a4880>]}
[0m19:46:48.924510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06e6c05c-0c12-4618-aada-0b3fece07368', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe94d457e80>]}
[0m19:46:48.925211 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m19:46:48.941019 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m19:46:49.025390 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:46:49.025978 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m19:46:49.068111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06e6c05c-0c12-4618-aada-0b3fece07368', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe94d2b7ee0>]}
[0m19:46:49.082778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06e6c05c-0c12-4618-aada-0b3fece07368', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe94d366130>]}
[0m19:46:49.083278 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m19:46:49.083686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06e6c05c-0c12-4618-aada-0b3fece07368', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe94d366100>]}
[0m19:46:49.085173 [info ] [MainThread]: 
[0m19:46:49.085979 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:46:49.087280 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m19:46:49.087764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:46:49.759480 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m19:46:49.761722 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:46:50.735224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06e6c05c-0c12-4618-aada-0b3fece07368', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe94d29dbe0>]}
[0m19:46:50.736009 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:46:50.736464 [info ] [MainThread]: 
[0m19:46:50.743569 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m19:46:50.744203 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m19:46:50.745091 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m19:46:50.745580 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m19:46:50.754751 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m19:46:50.755549 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 19:46:50.745899 => 19:46:50.755303
[0m19:46:50.756017 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m19:46:50.773196 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:46:51.465065 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m19:46:51.465865 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m19:46:51.964416 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:6d9361ea-9d79-4ab1-b976-d163bd79f8df&page=queryresults
[0m19:46:54.755540 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 19:46:50.756354 => 19:46:54.755325
[0m19:46:54.756429 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06e6c05c-0c12-4618-aada-0b3fece07368', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe94cc03eb0>]}
[0m19:46:54.757073 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.01s]
[0m19:46:54.757755 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m19:46:54.758225 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m19:46:54.758701 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m19:46:54.759475 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m19:46:54.759889 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m19:46:54.769678 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m19:46:54.770475 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 19:46:54.760192 => 19:46:54.770235
[0m19:46:54.770949 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m19:46:54.773924 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:46:55.378611 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m19:46:55.379352 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m19:46:55.956027 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:1e71e6ff-1b97-40be-88a1-fb41519e0d45&page=queryresults
[0m19:46:58.712389 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 19:46:54.771309 => 19:46:58.712162
[0m19:46:58.713339 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06e6c05c-0c12-4618-aada-0b3fece07368', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe94cc03a00>]}
[0m19:46:58.714031 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 3.95s]
[0m19:46:58.714731 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m19:46:58.715207 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m19:46:58.715800 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m19:46:58.716492 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m19:46:58.716935 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m19:46:58.720338 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m19:46:58.721063 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 19:46:58.717257 => 19:46:58.720842
[0m19:46:58.721506 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m19:46:58.724374 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:46:59.349195 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m19:46:59.349985 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        currency,
        initial_price AS price_original,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        CASE
            WHEN discount_percent > 0 THEN
                initial_price * (discount_percent / 100)  -- Monto del descuento
            ELSE
                0  -- Si no hay descuento, el monto del descuento es cero
        END AS discount_amount,
        CASE
            WHEN discount_percent > 0 THEN
                initial_price * (1 - discount_percent / 100) + (initial_price * (1 - discount_percent / 100)) * 0.75
            ELSE
                initial_price + initial_price * 0.75
        END AS price_with_tax,
        'ARS$ ' || CAST(ROUND(initial_price * 0.75, 2) AS STRING) AS formatted_price_with_tax,  -- Formato ARS$ 400,00
        CASE
            WHEN discount_percent > 0 THEN
                CAST(ROUND(discount_percent, 2) AS STRING)
            ELSE
                '0.00'
        END AS formatted_discount_pct  -- Formato del descuento como número decimal
    FROM `pristine-flames-400818`.`games`.`raw_games`
)


SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    currency,
    price_original,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    ROUND(price_with_tax, 2) AS price_with_tax
FROM price_overview_cte
    );
  
[0m19:46:59.951813 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f27662ac-5cb3-4b96-b874-72a60fcb186e&page=queryresults
[0m19:47:02.732200 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 19:46:58.721826 => 19:47:02.731984
[0m19:47:02.732962 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06e6c05c-0c12-4618-aada-0b3fece07368', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe94c2015b0>]}
[0m19:47:02.733577 [info ] [Thread-1  ]: 3 of 6 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (2.7k rows, 98.5 KiB processed)[0m in 4.02s]
[0m19:47:02.734243 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m19:47:02.734736 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m19:47:02.735371 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m19:47:02.736081 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m19:47:02.736504 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m19:47:02.740018 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m19:47:02.740836 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 19:47:02.736824 => 19:47:02.740585
[0m19:47:02.741260 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m19:47:02.744099 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:47:03.385990 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m19:47:03.386709 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m19:47:03.971645 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5ad4d3c7-41c7-4ee5-b9b2-6d0ce58bfbd8&page=queryresults
[0m19:47:07.058377 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 19:47:02.741562 => 19:47:07.058111
[0m19:47:07.059391 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06e6c05c-0c12-4618-aada-0b3fece07368', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe94c2f7c10>]}
[0m19:47:07.060256 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.32s]
[0m19:47:07.061125 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m19:47:07.061716 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m19:47:07.062316 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m19:47:07.063242 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m19:47:07.063834 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m19:47:07.068189 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m19:47:07.069528 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 19:47:07.064241 => 19:47:07.069156
[0m19:47:07.070282 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m19:47:07.073227 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:47:07.716382 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m19:47:07.717339 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m19:47:08.259318 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:6f6836d8-97c3-4567-b9e5-787d1b676aa2&page=queryresults
[0m19:47:11.004184 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 19:47:07.070704 => 19:47:11.003949
[0m19:47:11.005080 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06e6c05c-0c12-4618-aada-0b3fece07368', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe94c34aeb0>]}
[0m19:47:11.005835 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 3.94s]
[0m19:47:11.006575 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m19:47:11.007106 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m19:47:11.007641 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m19:47:11.008457 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m19:47:11.008940 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m19:47:11.012491 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m19:47:11.013350 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 19:47:11.009268 => 19:47:11.013082
[0m19:47:11.013833 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m19:47:11.020827 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:47:11.660896 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m19:47:11.661765 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m19:47:12.258319 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5aec9702-476d-4a22-98f1-8086ace128d1&page=queryresults
[0m19:47:15.101530 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 19:47:11.014161 => 19:47:15.101310
[0m19:47:15.102321 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06e6c05c-0c12-4618-aada-0b3fece07368', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe94c32d160>]}
[0m19:47:15.102951 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.09s]
[0m19:47:15.103774 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m19:47:15.105396 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:47:15.105831 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m19:47:15.106246 [info ] [MainThread]: 
[0m19:47:15.106670 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 26.02 seconds (26.02s).
[0m19:47:15.108210 [debug] [MainThread]: Command end result
[0m19:47:15.122788 [info ] [MainThread]: 
[0m19:47:15.123370 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:47:15.123833 [info ] [MainThread]: 
[0m19:47:15.124295 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m19:47:15.124987 [debug] [MainThread]: Command `dbt run` succeeded at 19:47:15.124869 after 26.77 seconds
[0m19:47:15.125402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9676d9e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe94d4caca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe94d3662b0>]}
[0m19:47:15.125832 [debug] [MainThread]: Flushing usage events
[0m19:53:12.012441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f738d3b5e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f738ad83910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f738ad83070>]}


============================== 19:53:12.017092 | 022eed58-4c90-4026-8f7f-bf5e3eaaef21 ==============================
[0m19:53:12.017092 [info ] [MainThread]: Running with dbt=1.6.5
[0m19:53:12.017665 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/includes/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/includes/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:53:12.572477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '022eed58-4c90-4026-8f7f-bf5e3eaaef21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f738ad37970>]}
[0m19:53:12.583565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '022eed58-4c90-4026-8f7f-bf5e3eaaef21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7373128e80>]}
[0m19:53:12.584303 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m19:53:12.600597 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m19:53:12.685080 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:53:12.685664 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m19:53:12.726975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '022eed58-4c90-4026-8f7f-bf5e3eaaef21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7372f26ee0>]}
[0m19:53:12.741744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '022eed58-4c90-4026-8f7f-bf5e3eaaef21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7373035130>]}
[0m19:53:12.742241 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m19:53:12.742689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '022eed58-4c90-4026-8f7f-bf5e3eaaef21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7373035100>]}
[0m19:53:12.744130 [info ] [MainThread]: 
[0m19:53:12.744890 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:53:12.746194 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m19:53:12.746680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:53:13.465407 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818_games'
[0m19:53:13.465917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:53:14.130543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '022eed58-4c90-4026-8f7f-bf5e3eaaef21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7372f69be0>]}
[0m19:53:14.134028 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:53:14.135895 [info ] [MainThread]: 
[0m19:53:14.155616 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m19:53:14.156242 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m19:53:14.157065 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m19:53:14.157529 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m19:53:14.166127 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m19:53:14.167039 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 19:53:14.157819 => 19:53:14.166745
[0m19:53:14.167507 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m19:53:14.182470 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:53:14.989646 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m19:53:14.990515 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m19:53:15.610531 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e0c93ab9-2cdf-40ac-8a62-33d89397cf00&page=queryresults
[0m19:53:18.491335 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 19:53:14.167802 => 19:53:18.491127
[0m19:53:18.492123 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '022eed58-4c90-4026-8f7f-bf5e3eaaef21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73728cdf10>]}
[0m19:53:18.492805 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.34s]
[0m19:53:18.493512 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m19:53:18.494008 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m19:53:18.494556 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m19:53:18.495284 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m19:53:18.495703 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m19:53:18.502830 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m19:53:18.503629 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 19:53:18.496005 => 19:53:18.503379
[0m19:53:18.504072 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m19:53:18.507727 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:53:19.183599 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m19:53:19.184402 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m19:53:19.788569 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:81cad6f2-1a0b-4ed3-830f-d71da9d96dbb&page=queryresults
[0m19:53:22.584831 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 19:53:18.504366 => 19:53:22.584585
[0m19:53:22.585800 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '022eed58-4c90-4026-8f7f-bf5e3eaaef21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73717ac730>]}
[0m19:53:22.586646 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.09s]
[0m19:53:22.587402 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m19:53:22.587979 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m19:53:22.588632 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m19:53:22.589412 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m19:53:22.589955 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m19:53:22.593700 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m19:53:22.594525 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 19:53:22.590276 => 19:53:22.594249
[0m19:53:22.594971 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m19:53:22.597722 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:53:23.170587 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m19:53:23.171526 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        currency,
        initial_price AS price_original,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        CASE
            WHEN discount_percent > 0 THEN
                initial_price * (discount_percent / 100)  -- Monto del descuento
            ELSE
                0  -- Si no hay descuento, el monto del descuento es cero
        END AS discount_amount,
        CASE
            WHEN discount_percent > 0 THEN
                initial_price * (1 - discount_percent / 100) + (initial_price * (1 - discount_percent / 100)) * 0.75
            ELSE
                initial_price + initial_price * 0.75
        END AS price_with_tax,
        'ARS$ ' || CAST(ROUND(initial_price * 0.75, 2) AS STRING) AS formatted_price_with_tax,  -- Formato ARS$ 400,00
        CASE
            WHEN discount_percent > 0 THEN
                CAST(ROUND(discount_percent, 2) AS STRING)
            ELSE
                0
        END AS formatted_discount_pct  -- Formato del descuento como número decimal
    FROM `pristine-flames-400818`.`games`.`raw_games`
)


SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    currency,
    price_original,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    formatted_price_with_tax
    ROUND(price_with_tax, 2) AS price_with_tax
FROM price_overview_cte
    );
  
[0m19:53:23.499515 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5bfe79a7-1aa1-48d5-b3a8-9454f1b9bb3e&page=queryresults
[0m19:53:23.500720 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got "(" at [57:10]')
[0m19:53:24.305147 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:fe2d2aa8-c191-4b58-b64c-45e256e4ab4f&page=queryresults
[0m19:53:24.309877 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:fe2d2aa8-c191-4b58-b64c-45e256e4ab4f&page=queryresults
[0m19:53:24.313261 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 19:53:22.595261 => 19:53:24.312182
[0m19:53:24.329812 [debug] [Thread-1  ]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Syntax error: Expected ")" but got "(" at [57:10]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m19:53:24.332051 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '022eed58-4c90-4026-8f7f-bf5e3eaaef21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73717f3b20>]}
[0m19:53:24.334884 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 1.74s]
[0m19:53:24.338038 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m19:53:24.339726 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m19:53:24.341682 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m19:53:24.343924 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m19:53:24.345011 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m19:53:24.352206 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m19:53:24.353524 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 19:53:24.345765 => 19:53:24.353108
[0m19:53:24.354209 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m19:53:24.358207 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:53:25.039706 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m19:53:25.040482 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m19:53:25.631885 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b6e034f1-41a4-4b1e-a604-22256c4aabbd&page=queryresults
[0m19:53:28.698678 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 19:53:24.354703 => 19:53:28.698470
[0m19:53:28.699401 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '022eed58-4c90-4026-8f7f-bf5e3eaaef21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73717ac730>]}
[0m19:53:28.700031 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.36s]
[0m19:53:28.700741 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m19:53:28.701251 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m19:53:28.701844 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m19:53:28.702609 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m19:53:28.703039 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m19:53:28.706340 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m19:53:28.707019 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 19:53:28.703342 => 19:53:28.706807
[0m19:53:28.707428 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m19:53:28.709890 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:53:29.403797 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m19:53:29.404534 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m19:53:29.883302 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:fc0636f0-b7d7-4a19-8442-fcd373246050&page=queryresults
[0m19:53:33.009612 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 19:53:28.707724 => 19:53:33.009408
[0m19:53:33.010384 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '022eed58-4c90-4026-8f7f-bf5e3eaaef21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73728cd5e0>]}
[0m19:53:33.010993 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.31s]
[0m19:53:33.011702 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m19:53:33.012215 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m19:53:33.012738 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m19:53:33.013571 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m19:53:33.014015 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m19:53:33.017423 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m19:53:33.018140 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 19:53:33.014329 => 19:53:33.017915
[0m19:53:33.018575 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m19:53:33.021215 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:53:33.693942 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m19:53:33.694975 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m19:53:34.280295 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ecb38698-8b6b-4b0b-a39b-521cbd86a205&page=queryresults
[0m19:53:37.361186 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 19:53:33.018885 => 19:53:37.360965
[0m19:53:37.361981 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '022eed58-4c90-4026-8f7f-bf5e3eaaef21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73716bb640>]}
[0m19:53:37.362627 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.35s]
[0m19:53:37.363322 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m19:53:37.364900 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:53:37.365357 [debug] [MainThread]: Connection 'list_pristine-flames-400818' was properly closed.
[0m19:53:37.365727 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m19:53:37.366140 [info ] [MainThread]: 
[0m19:53:37.366555 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 24.62 seconds (24.62s).
[0m19:53:37.368083 [debug] [MainThread]: Command end result
[0m19:53:37.383352 [info ] [MainThread]: 
[0m19:53:37.384088 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:53:37.384617 [info ] [MainThread]: 
[0m19:53:37.385151 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Syntax error: Expected ")" but got "(" at [57:10]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m19:53:37.385917 [info ] [MainThread]: 
[0m19:53:37.387474 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m19:53:37.388188 [debug] [MainThread]: Command `dbt run` failed at 19:53:37.388065 after 25.38 seconds
[0m19:53:37.388620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f738d3b5e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7373035310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7373035280>]}
[0m19:53:37.389067 [debug] [MainThread]: Flushing usage events
[0m19:55:24.303426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f085faa7c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f085d4b2a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f085d4b2a90>]}


============================== 19:55:24.308033 | e7665e68-5649-4b05-ad8e-aabc47d95cae ==============================
[0m19:55:24.308033 [info ] [MainThread]: Running with dbt=1.6.5
[0m19:55:24.308581 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/includes/dbt/logs', 'profiles_dir': '/opt/airflow/includes/dbt/', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:55:24.866696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7665e68-5649-4b05-ad8e-aabc47d95cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f085d4229d0>]}
[0m19:55:24.878606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7665e68-5649-4b05-ad8e-aabc47d95cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f084581ffd0>]}
[0m19:55:24.879363 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m19:55:24.897073 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m19:55:24.982451 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:55:24.983047 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m19:55:25.024667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7665e68-5649-4b05-ad8e-aabc47d95cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0845623f10>]}
[0m19:55:25.039289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7665e68-5649-4b05-ad8e-aabc47d95cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0845731280>]}
[0m19:55:25.039789 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m19:55:25.040187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7665e68-5649-4b05-ad8e-aabc47d95cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0845731250>]}
[0m19:55:25.041733 [info ] [MainThread]: 
[0m19:55:25.042576 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:55:25.043880 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m19:55:25.044334 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:55:25.642799 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m19:55:25.644965 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:55:26.340453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7665e68-5649-4b05-ad8e-aabc47d95cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0845623f70>]}
[0m19:55:26.341568 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:55:26.342166 [info ] [MainThread]: 
[0m19:55:26.352064 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m19:55:26.353017 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m19:55:26.354268 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m19:55:26.355028 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m19:55:26.368632 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m19:55:26.370063 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 19:55:26.355554 => 19:55:26.369599
[0m19:55:26.370940 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m19:55:26.393782 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:55:27.141278 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m19:55:27.142066 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m19:55:27.835747 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a7e69773-54e8-44be-ae91-e5a3417f9a67&page=queryresults
[0m19:55:30.684808 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 19:55:26.371552 => 19:55:30.684501
[0m19:55:30.685908 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7665e68-5649-4b05-ad8e-aabc47d95cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0844fcbe50>]}
[0m19:55:30.686766 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.33s]
[0m19:55:30.687704 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m19:55:30.688333 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m19:55:30.689064 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m19:55:30.689931 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m19:55:30.690448 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m19:55:30.700298 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m19:55:30.701141 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 19:55:30.690822 => 19:55:30.700920
[0m19:55:30.701573 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m19:55:30.704519 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:55:31.390800 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m19:55:31.391588 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m19:55:31.994540 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d9fdc6a0-1de9-49bd-b9ec-3a0e2abed655&page=queryresults
[0m19:55:34.803925 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 19:55:30.701874 => 19:55:34.803715
[0m19:55:34.804684 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7665e68-5649-4b05-ad8e-aabc47d95cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0844fcbc10>]}
[0m19:55:34.805370 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.12s]
[0m19:55:34.806179 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m19:55:34.806702 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m19:55:34.807221 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m19:55:34.808064 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m19:55:34.808491 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m19:55:34.812137 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m19:55:34.812889 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 19:55:34.808801 => 19:55:34.812677
[0m19:55:34.813316 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m19:55:34.815948 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:55:35.469762 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m19:55:35.470542 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        currency,
        initial_price AS price_original,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        CASE
            WHEN discount_percent > 0 THEN
                initial_price * (discount_percent / 100)  -- Monto del descuento
            ELSE
                0  -- Si no hay descuento, el monto del descuento es cero
        END AS discount_amount,
        CASE
            WHEN discount_percent > 0 THEN
                initial_price * (1 - discount_percent / 100) + (initial_price * (1 - discount_percent / 100)) * 0.75
            ELSE
                initial_price + initial_price * 0.75
        END AS price_with_tax,
        'ARS$ ' || CAST(ROUND(initial_price * 0.75, 2) AS STRING) AS formatted_price_with_tax,  -- Formato ARS$ 400,00
        CASE
            WHEN discount_percent > 0 THEN
                CAST(ROUND(discount_percent, 2) AS STRING)
            ELSE
                0
        END AS formatted_discount_pct  -- Formato del descuento como número decimal
    FROM `pristine-flames-400818`.`games`.`raw_games`
)


SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    currency,
    price_original,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    formatted_price_with_tax,
    ROUND(price_with_tax, 2) AS price_with_tax
FROM price_overview_cte
    );
  
[0m19:55:36.133598 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:fe0c2381-f279-48aa-87fd-721f285dcc0d&page=queryresults
[0m19:55:36.692333 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for operator CASE; all THEN/ELSE arguments must be coercible to a common type but found: INT64, STRING; actual argument types (WHEN THEN) ELSE: (BOOL STRING) INT64 at [37:9]')
[0m19:55:37.646641 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:758cbf9b-589f-4f40-a9a1-18680fe13eec&page=queryresults
[0m19:55:38.178090 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:758cbf9b-589f-4f40-a9a1-18680fe13eec&page=queryresults
[0m19:55:38.178979 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 19:55:34.813614 => 19:55:38.178703
[0m19:55:38.182986 [debug] [Thread-1  ]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  No matching signature for operator CASE; all THEN/ELSE arguments must be coercible to a common type but found: INT64, STRING; actual argument types (WHEN THEN) ELSE: (BOOL STRING) INT64 at [37:9]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m19:55:38.183678 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7665e68-5649-4b05-ad8e-aabc47d95cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08446dcaf0>]}
[0m19:55:38.184394 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 3.38s]
[0m19:55:38.185318 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m19:55:38.185932 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m19:55:38.187309 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m19:55:38.189294 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m19:55:38.189849 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m19:55:38.193848 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m19:55:38.195022 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 19:55:38.190199 => 19:55:38.194469
[0m19:55:38.195571 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m19:55:38.199391 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:55:38.876149 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m19:55:38.877025 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m19:55:39.437598 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:8107b739-6721-4396-97fd-46d89a90875f&page=queryresults
[0m19:55:42.998153 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 19:55:38.195943 => 19:55:42.997928
[0m19:55:42.998985 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7665e68-5649-4b05-ad8e-aabc47d95cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08446e6370>]}
[0m19:55:42.999646 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.81s]
[0m19:55:43.000322 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m19:55:43.000826 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m19:55:43.001733 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m19:55:43.002664 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m19:55:43.003239 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m19:55:43.007379 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m19:55:43.008251 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 19:55:43.003618 => 19:55:43.007980
[0m19:55:43.008786 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m19:55:43.011756 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:55:43.662869 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m19:55:43.663674 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m19:55:44.274637 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5fb7b9dc-d269-49a0-b878-620d86dac759&page=queryresults
[0m19:55:47.341050 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 19:55:43.009133 => 19:55:47.340058
[0m19:55:47.344391 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7665e68-5649-4b05-ad8e-aabc47d95cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08446c9df0>]}
[0m19:55:47.347248 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.34s]
[0m19:55:47.350573 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m19:55:47.352895 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m19:55:47.355672 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m19:55:47.359059 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m19:55:47.361139 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m19:55:47.376177 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m19:55:47.379388 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 19:55:47.362621 => 19:55:47.378367
[0m19:55:47.381331 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m19:55:47.388662 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:55:48.031713 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m19:55:48.034752 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m19:55:48.644781 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d295f30d-1f20-448e-873c-9a1f4ee442a8&page=queryresults
[0m19:55:51.388258 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 19:55:47.382339 => 19:55:51.387949
[0m19:55:51.389389 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7665e68-5649-4b05-ad8e-aabc47d95cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08446e6e80>]}
[0m19:55:51.390267 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.03s]
[0m19:55:51.391189 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m19:55:51.393221 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:55:51.393750 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m19:55:51.394292 [info ] [MainThread]: 
[0m19:55:51.394853 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 26.35 seconds (26.35s).
[0m19:55:51.396967 [debug] [MainThread]: Command end result
[0m19:55:51.414878 [info ] [MainThread]: 
[0m19:55:51.415642 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:55:51.416252 [info ] [MainThread]: 
[0m19:55:51.416762 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  No matching signature for operator CASE; all THEN/ELSE arguments must be coercible to a common type but found: INT64, STRING; actual argument types (WHEN THEN) ELSE: (BOOL STRING) INT64 at [37:9]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m19:55:51.417286 [info ] [MainThread]: 
[0m19:55:51.417794 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m19:55:51.418542 [debug] [MainThread]: Command `dbt run` failed at 19:55:51.418407 after 27.12 seconds
[0m19:55:51.419047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f085faa7c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08457398b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0845739910>]}
[0m19:55:51.419559 [debug] [MainThread]: Flushing usage events
[0m19:57:29.235918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91f1929d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91ef1f1880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91ef1f1070>]}


============================== 19:57:29.240754 | 977d0317-85c5-44ab-8c48-b5cc7d6684b0 ==============================
[0m19:57:29.240754 [info ] [MainThread]: Running with dbt=1.6.5
[0m19:57:29.241380 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/includes/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:57:29.794702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '977d0317-85c5-44ab-8c48-b5cc7d6684b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91ef2a0820>]}
[0m19:57:29.805996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '977d0317-85c5-44ab-8c48-b5cc7d6684b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d765ddf0>]}
[0m19:57:29.806636 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m19:57:29.823476 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m19:57:29.909613 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:57:29.910204 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m19:57:29.952191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '977d0317-85c5-44ab-8c48-b5cc7d6684b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d74b3e50>]}
[0m19:57:29.966829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '977d0317-85c5-44ab-8c48-b5cc7d6684b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d75651f0>]}
[0m19:57:29.967329 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m19:57:29.967760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '977d0317-85c5-44ab-8c48-b5cc7d6684b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d7565040>]}
[0m19:57:29.969257 [info ] [MainThread]: 
[0m19:57:29.970071 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:57:29.971329 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m19:57:29.971815 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:57:30.631802 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m19:57:30.632717 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:57:31.279712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '977d0317-85c5-44ab-8c48-b5cc7d6684b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d749cfd0>]}
[0m19:57:31.283223 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:57:31.285199 [info ] [MainThread]: 
[0m19:57:31.313247 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m19:57:31.314872 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m19:57:31.316588 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m19:57:31.317742 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m19:57:31.332609 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m19:57:31.333631 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 19:57:31.318725 => 19:57:31.333318
[0m19:57:31.334229 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m19:57:31.351642 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:57:32.054748 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m19:57:32.055517 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m19:57:32.715625 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:facc135a-2a29-4181-bad1-77019b957722&page=queryresults
[0m19:57:35.801411 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 19:57:31.334617 => 19:57:35.801193
[0m19:57:35.802290 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '977d0317-85c5-44ab-8c48-b5cc7d6684b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d6bfedc0>]}
[0m19:57:35.803015 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.49s]
[0m19:57:35.803782 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m19:57:35.804282 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m19:57:35.804795 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m19:57:35.805685 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m19:57:35.806154 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m19:57:35.817005 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m19:57:35.817854 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 19:57:35.806471 => 19:57:35.817627
[0m19:57:35.818572 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m19:57:35.821462 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:57:36.451676 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m19:57:36.452374 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m19:57:36.939433 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:26e17bfc-968c-4ec4-a239-a962643df158&page=queryresults
[0m19:57:39.993490 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 19:57:35.818876 => 19:57:39.993270
[0m19:57:39.994306 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '977d0317-85c5-44ab-8c48-b5cc7d6684b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d6bfeb50>]}
[0m19:57:39.994966 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.19s]
[0m19:57:39.995640 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m19:57:39.996129 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m19:57:39.996699 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m19:57:39.997447 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m19:57:39.997881 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m19:57:40.001334 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m19:57:40.002109 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 19:57:39.998201 => 19:57:40.001867
[0m19:57:40.002749 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m19:57:40.006237 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:57:40.642281 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m19:57:40.644078 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        currency,
        initial_price AS price_original,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        CASE
            WHEN discount_percent > 0 THEN
                initial_price * (discount_percent / 100)  -- Monto del descuento
            ELSE
                0  -- Si no hay descuento, el monto del descuento es cero
        END AS discount_amount,
        CASE
            WHEN discount_percent > 0 THEN
                initial_price * (1 - discount_percent / 100) + (initial_price * (1 - discount_percent / 100)) * 0.75
            ELSE
                initial_price + initial_price * 0.75
        END AS price_with_tax,
        'ARS$ ' || CAST(ROUND(initial_price * 0.75, 2) AS STRING) AS formatted_price_with_tax,  -- Formato ARS$ 400,00
        CAST(
            CASE
                WHEN discount_percent > 0 THEN
                    ROUND(discount_percent, 2)
                ELSE
                    0.00
            END AS STRING
        ) AS formatted_discount_pct  -- Formato del descuento como número decimal
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    currency,
    price_original,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    formatted_price_with_tax,
    ROUND(price_with_tax, 2) AS price_with_tax
FROM price_overview_cte
    );
  
[0m19:57:41.106960 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9225ae98-4442-4730-9b2b-fd85d0156f3b&page=queryresults
[0m19:57:43.850566 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 19:57:40.003240 => 19:57:43.849867
[0m19:57:43.853188 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '977d0317-85c5-44ab-8c48-b5cc7d6684b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d6bfe370>]}
[0m19:57:43.855339 [info ] [Thread-1  ]: 3 of 6 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (2.7k rows, 98.5 KiB processed)[0m in 3.86s]
[0m19:57:43.857516 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m19:57:43.858708 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m19:57:43.859990 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m19:57:43.861788 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m19:57:43.862633 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m19:57:43.868887 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m19:57:43.870374 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 19:57:43.863233 => 19:57:43.869911
[0m19:57:43.871142 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m19:57:43.874940 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:57:44.514812 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m19:57:44.515688 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m19:57:45.013493 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:1a6bbc60-c249-42be-8f6d-66e7dbff000c&page=queryresults
[0m19:57:48.670554 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 19:57:43.871623 => 19:57:48.670035
[0m19:57:48.672515 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '977d0317-85c5-44ab-8c48-b5cc7d6684b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d6bfe1f0>]}
[0m19:57:48.674168 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.81s]
[0m19:57:48.675825 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m19:57:48.677062 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m19:57:48.678526 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m19:57:48.680259 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m19:57:48.681332 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m19:57:48.689640 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m19:57:48.691768 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 19:57:48.682086 => 19:57:48.691181
[0m19:57:48.692804 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m19:57:48.697923 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:57:49.383677 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m19:57:49.384497 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m19:57:49.951158 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:4cb7d5bb-60a2-4e98-b26d-169efc8d3bf3&page=queryresults
[0m19:57:53.148903 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 19:57:48.693424 => 19:57:53.148231
[0m19:57:53.151148 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '977d0317-85c5-44ab-8c48-b5cc7d6684b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d6bfe490>]}
[0m19:57:53.153028 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.47s]
[0m19:57:53.155460 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m19:57:53.157311 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m19:57:53.159327 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m19:57:53.161528 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m19:57:53.163056 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m19:57:53.172275 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m19:57:53.173770 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 19:57:53.164220 => 19:57:53.173323
[0m19:57:53.174604 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m19:57:53.179209 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:57:53.883422 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m19:57:53.886507 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m19:57:54.505147 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:307fbaa4-b377-4c16-913c-d4f7d61934ac&page=queryresults
[0m19:57:57.306796 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 19:57:53.175189 => 19:57:57.306446
[0m19:57:57.308051 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '977d0317-85c5-44ab-8c48-b5cc7d6684b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d61f9610>]}
[0m19:57:57.309087 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.15s]
[0m19:57:57.310306 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m19:57:57.312762 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:57:57.313422 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m19:57:57.314069 [info ] [MainThread]: 
[0m19:57:57.314757 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 27.34 seconds (27.34s).
[0m19:57:57.317293 [debug] [MainThread]: Command end result
[0m19:57:57.340303 [info ] [MainThread]: 
[0m19:57:57.340929 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:57:57.341414 [info ] [MainThread]: 
[0m19:57:57.341940 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m19:57:57.342846 [debug] [MainThread]: Command `dbt run` succeeded at 19:57:57.342689 after 28.11 seconds
[0m19:57:57.343348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91f1929d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d749cb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d765d310>]}
[0m19:57:57.343839 [debug] [MainThread]: Flushing usage events
[0m20:02:49.733626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f535887fe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53562029a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5356202070>]}


============================== 20:02:49.738991 | 87fb4707-544e-453b-97cb-0d7ecd564533 ==============================
[0m20:02:49.738991 [info ] [MainThread]: Running with dbt=1.6.5
[0m20:02:49.739532 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/includes/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:02:52.805075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87fb4707-544e-453b-97cb-0d7ecd564533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5356236880>]}
[0m20:02:52.816167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87fb4707-544e-453b-97cb-0d7ecd564533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f533e5e9e80>]}
[0m20:02:52.816884 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m20:02:52.836368 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m20:02:52.982375 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:02:52.983039 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m20:02:53.087837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87fb4707-544e-453b-97cb-0d7ecd564533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f533e3eaee0>]}
[0m20:02:53.188051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87fb4707-544e-453b-97cb-0d7ecd564533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f533e4f5130>]}
[0m20:02:53.188616 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m20:02:53.189082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87fb4707-544e-453b-97cb-0d7ecd564533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f533e4f5100>]}
[0m20:02:53.190631 [info ] [MainThread]: 
[0m20:02:53.191530 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:02:53.192879 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m20:02:53.193360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:02:53.793334 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818_games'
[0m20:02:53.793914 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:02:54.394929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87fb4707-544e-453b-97cb-0d7ecd564533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f533e42dbe0>]}
[0m20:02:54.969008 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:02:54.971062 [info ] [MainThread]: 
[0m20:02:54.978897 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m20:02:54.979523 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m20:02:54.980684 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m20:02:54.981411 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m20:02:54.989896 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m20:02:55.103992 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 20:02:54.981733 => 20:02:55.102846
[0m20:02:55.671291 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m20:02:55.722834 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:02:56.425703 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m20:02:56.490719 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m20:02:57.023783 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9110dd02-373e-4952-ae80-d3bb34028e2c&page=queryresults
[0m20:03:00.318833 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 20:02:55.673185 => 20:03:00.318608
[0m20:03:00.319793 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87fb4707-544e-453b-97cb-0d7ecd564533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f533db91eb0>]}
[0m20:03:00.320461 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 5.34s]
[0m20:03:00.321261 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m20:03:00.321795 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m20:03:00.322508 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m20:03:00.323267 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m20:03:00.323791 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m20:03:00.331156 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m20:03:00.331929 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 20:03:00.324119 => 20:03:00.331712
[0m20:03:00.332400 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m20:03:00.335201 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:03:00.940610 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m20:03:00.946259 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m20:03:01.565981 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:6a2749b8-25a9-48f9-a4ee-80f00dcafe69&page=queryresults
[0m20:03:05.384108 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 20:03:00.332739 => 20:03:05.382816
[0m20:03:05.387573 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87fb4707-544e-453b-97cb-0d7ecd564533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f533db91370>]}
[0m20:03:05.389663 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 5.06s]
[0m20:03:05.391888 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m20:03:05.393357 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m20:03:05.394814 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m20:03:05.396498 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m20:03:05.397609 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m20:03:05.403821 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m20:03:05.458587 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 20:03:05.398253 => 20:03:05.457991
[0m20:03:05.459632 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m20:03:05.466397 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:03:06.264886 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m20:03:06.330802 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        currency,
        initial_price AS price_original,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        CASE
            WHEN discount_percent > 0 THEN
                initial_price * (discount_percent / 100)  -- Monto del descuento
            ELSE
                0  -- Si no hay descuento, el monto del descuento es cero
        END AS discount_amount,
        CASE
            WHEN discount_percent > 0 THEN
                initial_price * (1 - discount_percent / 100) + (initial_price * (1 - discount_percent / 100)) * 0.75
            ELSE
                initial_price + initial_price * 0.75
        END AS price_with_tax,
        'ARS$ ' || CAST(ROUND(price_with_tax) AS STRING) AS formatted_price_with_tax,  -- Formato ARS$ 400,00
        CAST(
            CASE
                WHEN discount_percent > 0 THEN
                    ROUND(discount_percent, 2)
                ELSE
                    0.00
            END AS STRING
        ) AS formatted_discount_pct  -- Formato del descuento como número decimal
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    currency,
    price_original,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    formatted_price_with_tax,
    ROUND(price_with_tax, 2) AS price_with_tax
FROM price_overview_cte
    );
  
[0m20:03:06.839976 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:540fbe04-7faa-40a1-9e13-f8738b38444a&page=queryresults
[0m20:03:07.396400 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: price_with_tax at [36:31]')
[0m20:03:08.638497 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c32aa3e4-0682-4b40-8d4e-5b0611e92559&page=queryresults
[0m20:03:09.225201 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c32aa3e4-0682-4b40-8d4e-5b0611e92559&page=queryresults
[0m20:03:09.228989 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 20:03:05.460340 => 20:03:09.227879
[0m20:03:09.246051 [debug] [Thread-1  ]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Unrecognized name: price_with_tax at [36:31]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m20:03:09.248511 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87fb4707-544e-453b-97cb-0d7ecd564533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f533caaffd0>]}
[0m20:03:09.251450 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 3.85s]
[0m20:03:09.254173 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m20:03:09.255775 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m20:03:09.257865 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m20:03:09.259868 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m20:03:09.261010 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m20:03:09.268037 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m20:03:09.313320 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 20:03:09.261771 => 20:03:09.312830
[0m20:03:09.314138 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m20:03:09.318740 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:03:10.043123 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m20:03:10.189241 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m20:03:10.814594 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f959cc5e-e6f7-4557-ad52-20d4bd5e86ec&page=queryresults
[0m20:03:14.216394 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 20:03:09.314688 => 20:03:14.216156
[0m20:03:14.217291 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87fb4707-544e-453b-97cb-0d7ecd564533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f533c98fb20>]}
[0m20:03:14.217960 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.96s]
[0m20:03:14.218794 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m20:03:14.219356 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m20:03:14.220017 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m20:03:14.220786 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m20:03:14.221272 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m20:03:14.224811 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m20:03:14.225558 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 20:03:14.221649 => 20:03:14.225333
[0m20:03:14.225983 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m20:03:14.228540 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:03:14.898736 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m20:03:14.899587 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m20:03:15.326878 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b6cd15a6-0400-46d7-9f25-b8c157fdb123&page=queryresults
[0m20:03:18.399589 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 20:03:14.226268 => 20:03:18.399195
[0m20:03:18.401012 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87fb4707-544e-453b-97cb-0d7ecd564533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f533c0f0850>]}
[0m20:03:18.402120 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.18s]
[0m20:03:18.403216 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m20:03:18.403989 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m20:03:18.405037 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m20:03:18.406317 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m20:03:18.406989 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m20:03:18.411365 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m20:03:18.457106 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 20:03:18.407399 => 20:03:18.456443
[0m20:03:18.458397 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m20:03:18.466608 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:03:19.186580 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m20:03:19.264023 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m20:03:19.745964 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:66ad53e9-6f03-4671-bd09-d4cae3fdaf7b&page=queryresults
[0m20:03:22.565725 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 20:03:18.459282 => 20:03:22.564730
[0m20:03:22.569157 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87fb4707-544e-453b-97cb-0d7ecd564533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f533caafc10>]}
[0m20:03:22.572001 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.16s]
[0m20:03:22.575138 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m20:03:22.580268 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:03:22.581519 [debug] [MainThread]: Connection 'list_pristine-flames-400818' was properly closed.
[0m20:03:22.582461 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m20:03:22.583398 [info ] [MainThread]: 
[0m20:03:22.584372 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 29.39 seconds (29.39s).
[0m20:03:22.587893 [debug] [MainThread]: Command end result
[0m20:03:22.620127 [info ] [MainThread]: 
[0m20:03:22.620656 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:03:22.621029 [info ] [MainThread]: 
[0m20:03:22.621393 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Unrecognized name: price_with_tax at [36:31]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m20:03:22.621760 [info ] [MainThread]: 
[0m20:03:22.622139 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m20:03:22.622723 [debug] [MainThread]: Command `dbt run` failed at 20:03:22.622618 after 32.89 seconds
[0m20:03:22.623126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f535887fe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f533e4f5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f533e4f5280>]}
[0m20:03:22.623539 [debug] [MainThread]: Flushing usage events
[0m20:05:33.017574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe491ccdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe46b61940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe46b61910>]}


============================== 20:05:33.022790 | 600793ba-160c-4204-8328-039e9622bcde ==============================
[0m20:05:33.022790 [info ] [MainThread]: Running with dbt=1.6.5
[0m20:05:33.023430 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/includes/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:05:33.685538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '600793ba-160c-4204-8328-039e9622bcde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe46bce820>]}
[0m20:05:33.697007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '600793ba-160c-4204-8328-039e9622bcde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe2efb1be0>]}
[0m20:05:33.697739 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m20:05:33.715878 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m20:05:33.808324 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:05:33.809030 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m20:05:33.853960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '600793ba-160c-4204-8328-039e9622bcde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe2ed9de20>]}
[0m20:05:33.869788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '600793ba-160c-4204-8328-039e9622bcde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe2ee54760>]}
[0m20:05:33.870307 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m20:05:33.870711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '600793ba-160c-4204-8328-039e9622bcde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe2ee4d250>]}
[0m20:05:33.872214 [info ] [MainThread]: 
[0m20:05:33.873001 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:05:33.874319 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m20:05:33.874749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:34.541990 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m20:05:34.542574 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:05:35.067322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '600793ba-160c-4204-8328-039e9622bcde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe2ed88b50>]}
[0m20:05:35.070985 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:05:35.072968 [info ] [MainThread]: 
[0m20:05:35.102634 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m20:05:35.105242 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m20:05:35.108591 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m20:05:35.111237 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m20:05:35.150854 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m20:05:35.153346 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 20:05:35.112960 => 20:05:35.152505
[0m20:05:35.154914 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m20:05:35.186307 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:05:35.883742 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m20:05:35.884474 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m20:05:36.393271 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e3720fc7-382d-4222-9951-12900ae0cc0a&page=queryresults
[0m20:05:39.669621 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 20:05:35.155987 => 20:05:39.669319
[0m20:05:39.670707 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '600793ba-160c-4204-8328-039e9622bcde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe2e4ecdc0>]}
[0m20:05:39.671587 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.56s]
[0m20:05:39.672512 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m20:05:39.673116 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m20:05:39.673719 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m20:05:39.674599 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m20:05:39.675219 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m20:05:39.684422 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m20:05:39.685382 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 20:05:39.675632 => 20:05:39.685134
[0m20:05:39.685811 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m20:05:39.688622 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:05:40.339848 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m20:05:40.340694 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m20:05:40.908011 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:dcfa0437-8a70-4659-af5a-5f14967ef87f&page=queryresults
[0m20:05:43.944748 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 20:05:39.686108 => 20:05:43.944531
[0m20:05:43.945485 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '600793ba-160c-4204-8328-039e9622bcde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe2e4ecd60>]}
[0m20:05:43.946076 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.27s]
[0m20:05:43.946776 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m20:05:43.947278 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m20:05:43.947785 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m20:05:43.948574 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m20:05:43.949026 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m20:05:43.952426 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m20:05:43.953224 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 20:05:43.949341 => 20:05:43.952969
[0m20:05:43.953692 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m20:05:43.956677 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:05:44.608891 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m20:05:44.609727 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
    currency,
    initial_price,
    final_price,
    discount_percent,
    formatted_initial_price,
    formatted_final_price,
    (CASE
        WHEN discount_percent IS NOT NULL THEN
            (initial_price - (initial_price * discount_percent / 100))  -- Aplicar descuento si está presente
        ELSE
            initial_price  -- Sin descuento
    END) AS price_with_discount,
    initial_price AS price_original,
    (CASE
        WHEN discount_percent IS NOT NULL THEN
            (initial_price - (initial_price * discount_percent / 100))  -- Aplicar descuento si está presente
        ELSE
            initial_price  -- Sin descuento
    END) / 1.75 AS price_with_tax  -- Aplicar impuesto
    FROM `pristine-flames-400818`.`games`.`raw_games`;
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    currency,
    price_original,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    formatted_price_with_tax,
    ROUND(price_with_tax, 2) AS price_with_tax
FROM price_overview_cte
    );
  
[0m20:05:44.944525 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:98386805-eb79-4455-a17c-618add7d4c01&page=queryresults
[0m20:05:44.945664 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [37:54]')
[0m20:05:45.500829 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d831a358-a955-401c-8bee-1fb57b9705e8&page=queryresults
[0m20:05:45.503575 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d831a358-a955-401c-8bee-1fb57b9705e8&page=queryresults
[0m20:05:45.505850 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 20:05:43.954027 => 20:05:45.505191
[0m20:05:45.518834 [debug] [Thread-1  ]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Syntax error: Expected ")" but got ";" at [37:54]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m20:05:45.520964 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '600793ba-160c-4204-8328-039e9622bcde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe2dc059a0>]}
[0m20:05:45.523363 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 1.57s]
[0m20:05:45.525944 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m20:05:45.527819 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m20:05:45.530105 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m20:05:45.532741 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m20:05:45.533618 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m20:05:45.538439 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m20:05:45.539299 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 20:05:45.533954 => 20:05:45.539006
[0m20:05:45.539772 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m20:05:45.542483 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:05:46.178765 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m20:05:46.179582 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m20:05:46.825506 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:337d72cb-2ebf-44ed-b8b6-7c1aaa61751e&page=queryresults
[0m20:05:50.318393 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 20:05:45.540070 => 20:05:50.318191
[0m20:05:50.319138 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '600793ba-160c-4204-8328-039e9622bcde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe2dbddc10>]}
[0m20:05:50.319762 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.79s]
[0m20:05:50.320501 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m20:05:50.320983 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m20:05:50.321493 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m20:05:50.322331 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m20:05:50.322767 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m20:05:50.325965 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m20:05:50.326634 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 20:05:50.323057 => 20:05:50.326428
[0m20:05:50.327035 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m20:05:50.329471 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:05:50.998834 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m20:05:50.999960 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m20:05:51.599556 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5ff92fef-36cb-42d4-b436-2ab86e135a92&page=queryresults
[0m20:05:55.050384 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 20:05:50.327322 => 20:05:55.049408
[0m20:05:55.053714 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '600793ba-160c-4204-8328-039e9622bcde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe2e4ec490>]}
[0m20:05:55.056546 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.73s]
[0m20:05:55.060059 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m20:05:55.062861 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m20:05:55.066450 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m20:05:55.070101 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m20:05:55.072205 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m20:05:55.081554 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m20:05:55.083135 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 20:05:55.073351 => 20:05:55.082702
[0m20:05:55.083971 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m20:05:55.089050 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:05:55.765231 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m20:05:55.768241 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m20:05:56.228530 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:501c1504-820b-4f08-b89d-75598cf9351b&page=queryresults
[0m20:05:59.061601 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 20:05:55.084585 => 20:05:59.060581
[0m20:05:59.065120 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '600793ba-160c-4204-8328-039e9622bcde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe2dbd4970>]}
[0m20:05:59.067941 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.00s]
[0m20:05:59.072011 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m20:05:59.078493 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:05:59.080231 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m20:05:59.082112 [info ] [MainThread]: 
[0m20:05:59.084040 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 25.21 seconds (25.21s).
[0m20:05:59.087543 [debug] [MainThread]: Command end result
[0m20:05:59.102087 [info ] [MainThread]: 
[0m20:05:59.103017 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:05:59.103490 [info ] [MainThread]: 
[0m20:05:59.103868 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Syntax error: Expected ")" but got ";" at [37:54]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m20:05:59.104251 [info ] [MainThread]: 
[0m20:05:59.104672 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m20:05:59.105303 [debug] [MainThread]: Command `dbt run` failed at 20:05:59.105193 after 26.09 seconds
[0m20:05:59.105711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe491ccdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe2ef37400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe2ef63970>]}
[0m20:05:59.106139 [debug] [MainThread]: Flushing usage events
[0m20:10:11.087102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb796452df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb793dbd910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb793dbd8e0>]}


============================== 20:10:11.091961 | 86018c13-cb11-4f28-8277-ef24cc93136d ==============================
[0m20:10:11.091961 [info ] [MainThread]: Running with dbt=1.6.5
[0m20:10:11.092480 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/includes/dbt/', 'log_path': '/opt/airflow/includes/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:10:11.678256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86018c13-cb11-4f28-8277-ef24cc93136d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb793def880>]}
[0m20:10:11.689665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86018c13-cb11-4f28-8277-ef24cc93136d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb77c18de50>]}
[0m20:10:11.690394 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m20:10:11.707536 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m20:10:11.795870 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:10:11.796487 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m20:10:11.841522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86018c13-cb11-4f28-8277-ef24cc93136d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb77bf8ceb0>]}
[0m20:10:11.857177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86018c13-cb11-4f28-8277-ef24cc93136d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb77c09c100>]}
[0m20:10:11.857718 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m20:10:11.858165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86018c13-cb11-4f28-8277-ef24cc93136d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb77c09c0d0>]}
[0m20:10:11.859892 [info ] [MainThread]: 
[0m20:10:11.860758 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:10:11.862155 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m20:10:11.862583 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:12.623286 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m20:10:12.625805 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:10:13.270704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86018c13-cb11-4f28-8277-ef24cc93136d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb77bfd0bb0>]}
[0m20:10:13.273267 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:10:13.274651 [info ] [MainThread]: 
[0m20:10:13.288910 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m20:10:13.289841 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m20:10:13.290973 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m20:10:13.291713 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m20:10:13.302639 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m20:10:13.303462 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 20:10:13.292174 => 20:10:13.303208
[0m20:10:13.303919 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m20:10:13.321057 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:10:13.984417 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m20:10:13.985292 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m20:10:14.616309 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f698ce26-dacc-4b34-adc9-c0a81682a57a&page=queryresults
[0m20:10:17.822804 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 20:10:13.304241 => 20:10:17.822555
[0m20:10:17.823973 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86018c13-cb11-4f28-8277-ef24cc93136d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb77b933e50>]}
[0m20:10:17.824707 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.53s]
[0m20:10:17.825539 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m20:10:17.826113 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m20:10:17.826755 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m20:10:17.827900 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m20:10:17.828491 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m20:10:17.838851 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m20:10:17.839742 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 20:10:17.829133 => 20:10:17.839471
[0m20:10:17.840231 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m20:10:17.843180 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:10:18.435284 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m20:10:18.436074 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m20:10:19.053777 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:4b12bed6-8405-42c0-8965-3e5f2c07dabb&page=queryresults
[0m20:10:22.257844 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 20:10:17.840556 => 20:10:22.257624
[0m20:10:22.258676 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86018c13-cb11-4f28-8277-ef24cc93136d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb77b00e220>]}
[0m20:10:22.259415 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.43s]
[0m20:10:22.260218 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m20:10:22.260750 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m20:10:22.261321 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m20:10:22.262108 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m20:10:22.262701 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m20:10:22.266315 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m20:10:22.267092 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 20:10:22.263040 => 20:10:22.266866
[0m20:10:22.267518 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m20:10:22.270396 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:10:22.889411 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m20:10:22.890176 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
   SELECT
    currency,
    initial_price,
    final_price,
    discount_percent,
    formatted_initial_price,
    formatted_final_price,
    (CASE
        WHEN discount_percent IS NOT NULL THEN
            CONCAT('ARS$ ', CAST(ROUND(final_price - (final_price * discount_percent / 100) + (final_price - (final_price * discount_percent / 100)) * 0.75, 2) AS STRING))
        ELSE
            CONCAT('ARS$ ', CAST(ROUND(final_price * 0.75, 2) AS STRING))
    END) AS formatted_price  -- Formato ARS$ 400,00 con descuento e impuesto
FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    currency,
    price_original,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    formatted_price_with_tax,
    ROUND(price_with_tax, 2) AS price_with_tax
FROM price_overview_cte
    );
  
[0m20:10:23.342400 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f3989ff3-93ab-4b9e-b357-26dbb37a30c5&page=queryresults
[0m20:10:23.960155 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: price_original at [36:5]')
[0m20:10:24.879102 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:84b8e527-0aae-4de8-89af-92ce8b000b35&page=queryresults
[0m20:10:25.413120 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:84b8e527-0aae-4de8-89af-92ce8b000b35&page=queryresults
[0m20:10:25.416510 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 20:10:22.267816 => 20:10:25.415476
[0m20:10:25.432857 [debug] [Thread-1  ]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Unrecognized name: price_original at [36:5]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m20:10:25.435216 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86018c13-cb11-4f28-8277-ef24cc93136d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb77b04ddf0>]}
[0m20:10:25.438083 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 3.17s]
[0m20:10:25.440857 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m20:10:25.442536 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m20:10:25.445423 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m20:10:25.447249 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m20:10:25.448426 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m20:10:25.455574 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m20:10:25.457020 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 20:10:25.449243 => 20:10:25.456541
[0m20:10:25.457855 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m20:10:25.462702 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:10:26.115328 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m20:10:26.118330 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m20:10:26.772608 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b3ca6341-53e9-49b4-9fb6-4a204b1825af&page=queryresults
[0m20:10:29.847097 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 20:10:25.458444 => 20:10:29.846126
[0m20:10:29.850452 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86018c13-cb11-4f28-8277-ef24cc93136d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb77af33b50>]}
[0m20:10:29.853334 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.40s]
[0m20:10:29.856442 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m20:10:29.859043 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m20:10:29.861932 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m20:10:29.865441 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m20:10:29.867480 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m20:10:29.877162 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m20:10:29.878829 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 20:10:29.868696 => 20:10:29.878334
[0m20:10:29.879708 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m20:10:29.884402 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:10:30.662548 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m20:10:30.663409 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m20:10:31.176553 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:069cfc1a-cf84-450c-8298-76b0e78ce776&page=queryresults
[0m20:10:34.017727 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 20:10:29.880307 => 20:10:34.016748
[0m20:10:34.021121 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86018c13-cb11-4f28-8277-ef24cc93136d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb77b04f9a0>]}
[0m20:10:34.024030 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.16s]
[0m20:10:34.027225 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m20:10:34.029585 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m20:10:34.032285 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m20:10:34.034855 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m20:10:34.036312 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m20:10:34.044593 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m20:10:34.046009 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 20:10:34.037352 => 20:10:34.045567
[0m20:10:34.046908 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m20:10:34.051362 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:10:34.720988 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m20:10:34.721770 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m20:10:35.389834 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:816173d5-4ce2-4737-a537-4bbac56225fb&page=queryresults
[0m20:10:38.221517 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 20:10:34.047512 => 20:10:38.221313
[0m20:10:38.222260 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86018c13-cb11-4f28-8277-ef24cc93136d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb77af15520>]}
[0m20:10:38.222861 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.19s]
[0m20:10:38.223579 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m20:10:38.225160 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:10:38.225510 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m20:10:38.225905 [info ] [MainThread]: 
[0m20:10:38.226370 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 26.37 seconds (26.37s).
[0m20:10:38.227928 [debug] [MainThread]: Command end result
[0m20:10:38.242016 [info ] [MainThread]: 
[0m20:10:38.242537 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:10:38.243012 [info ] [MainThread]: 
[0m20:10:38.243401 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Unrecognized name: price_original at [36:5]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m20:10:38.243768 [info ] [MainThread]: 
[0m20:10:38.244149 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m20:10:38.244743 [debug] [MainThread]: Command `dbt run` failed at 20:10:38.244626 after 27.16 seconds
[0m20:10:38.245158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb796452df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb77c1b3d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb77c09c340>]}
[0m20:10:38.245571 [debug] [MainThread]: Flushing usage events
[0m20:11:15.434137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b821a5df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b7fb72940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b7fb720a0>]}


============================== 20:11:15.438766 | 424a1ec3-cbed-4971-8d50-113e35fc9dca ==============================
[0m20:11:15.438766 [info ] [MainThread]: Running with dbt=1.6.5
[0m20:11:15.439338 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/includes/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'send_anonymous_usage_stats': 'True'}
[0m20:11:15.996475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '424a1ec3-cbed-4971-8d50-113e35fc9dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b7fae7940>]}
[0m20:11:16.007814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '424a1ec3-cbed-4971-8d50-113e35fc9dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b67edde50>]}
[0m20:11:16.008503 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m20:11:16.025253 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m20:11:16.110887 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:11:16.111493 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m20:11:16.153201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '424a1ec3-cbed-4971-8d50-113e35fc9dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b67ce0eb0>]}
[0m20:11:16.167935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '424a1ec3-cbed-4971-8d50-113e35fc9dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b67dec100>]}
[0m20:11:16.168435 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m20:11:16.168955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '424a1ec3-cbed-4971-8d50-113e35fc9dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b67dec0d0>]}
[0m20:11:16.170399 [info ] [MainThread]: 
[0m20:11:16.171148 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:11:16.172416 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m20:11:16.172846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:11:16.744338 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m20:11:16.746645 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:11:17.442028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '424a1ec3-cbed-4971-8d50-113e35fc9dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b67d20bb0>]}
[0m20:11:17.446195 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:11:17.448559 [info ] [MainThread]: 
[0m20:11:17.476802 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m20:11:17.478202 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m20:11:17.480167 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m20:11:17.481212 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m20:11:17.495489 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m20:11:17.496671 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 20:11:17.481851 => 20:11:17.496300
[0m20:11:17.497368 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m20:11:17.517138 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:11:18.179533 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m20:11:18.180228 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m20:11:18.808914 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:072c7ebd-c926-4899-8272-756719d2e595&page=queryresults
[0m20:11:21.873346 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 20:11:17.497860 => 20:11:21.873135
[0m20:11:21.874246 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '424a1ec3-cbed-4971-8d50-113e35fc9dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b67684e50>]}
[0m20:11:21.874897 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.39s]
[0m20:11:21.875645 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m20:11:21.876172 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m20:11:21.876786 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m20:11:21.877574 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m20:11:21.877998 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m20:11:21.887385 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m20:11:21.888415 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 20:11:21.878292 => 20:11:21.888103
[0m20:11:21.889323 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m20:11:21.892456 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:11:22.490726 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m20:11:22.491564 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m20:11:23.054496 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:3296c157-a97d-4153-8320-b415b16a3477&page=queryresults
[0m20:11:26.001486 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 20:11:21.889695 => 20:11:26.001131
[0m20:11:26.002697 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '424a1ec3-cbed-4971-8d50-113e35fc9dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b66e14490>]}
[0m20:11:26.003720 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.13s]
[0m20:11:26.004860 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m20:11:26.005717 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m20:11:26.006711 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m20:11:26.007915 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m20:11:26.008667 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m20:11:26.013044 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m20:11:26.013715 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 20:11:26.009195 => 20:11:26.013504
[0m20:11:26.014119 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m20:11:26.016803 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:11:26.658759 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m20:11:26.661944 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
   SELECT
    currency,
    initial_price,
    final_price,
    discount_percent,
    formatted_initial_price,
    formatted_final_price,
    (CASE
        WHEN discount_percent IS NOT NULL THEN
            CONCAT('ARS$ ', CAST(ROUND(final_price - (final_price * discount_percent / 100) + (final_price - (final_price * discount_percent / 100)) * 0.75, 2) AS STRING))
        ELSE
            CONCAT('ARS$ ', CAST(ROUND(final_price * 0.75, 2) AS STRING))
    END) AS formatted_price  -- Formato ARS$ 400,00 con descuento e impuesto
FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    currency,
    final_price,
    formatted_initial_price,
    formatted_final_price,
    formatted_price,
FROM price_overview_cte
    );
  
[0m20:11:27.250195 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:33af34b9-9bda-455c-913a-d780149bb931&page=queryresults
[0m20:11:30.773832 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 20:11:26.014408 => 20:11:30.772846
[0m20:11:30.777180 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '424a1ec3-cbed-4971-8d50-113e35fc9dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b66c83b50>]}
[0m20:11:30.780054 [info ] [Thread-1  ]: 3 of 6 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (2.7k rows, 77.3 KiB processed)[0m in 4.77s]
[0m20:11:30.783245 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m20:11:30.785554 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m20:11:30.788014 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m20:11:30.790249 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m20:11:30.791672 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m20:11:30.799390 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m20:11:30.800843 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 20:11:30.792663 => 20:11:30.800381
[0m20:11:30.801702 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m20:11:30.806163 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:11:31.493702 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m20:11:31.494544 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m20:11:32.106061 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:4acf84a4-2676-44c6-9619-19f3ef18d2db&page=queryresults
[0m20:11:35.215795 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 20:11:30.802302 => 20:11:35.215580
[0m20:11:35.216595 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '424a1ec3-cbed-4971-8d50-113e35fc9dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b67684550>]}
[0m20:11:35.217267 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.43s]
[0m20:11:35.217973 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m20:11:35.218508 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m20:11:35.219141 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m20:11:35.219987 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m20:11:35.220477 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m20:11:35.224047 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m20:11:35.224837 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 20:11:35.220802 => 20:11:35.224595
[0m20:11:35.225312 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m20:11:35.228265 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:11:35.868704 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m20:11:35.869553 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m20:11:36.365326 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:15889e0b-7bd3-4ec6-84e4-61b0970d5bcc&page=queryresults
[0m20:11:39.229431 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 20:11:35.225670 => 20:11:39.228415
[0m20:11:39.232772 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '424a1ec3-cbed-4971-8d50-113e35fc9dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b676843d0>]}
[0m20:11:39.235595 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.01s]
[0m20:11:39.238753 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m20:11:39.241092 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m20:11:39.243777 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m20:11:39.247033 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m20:11:39.249142 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m20:11:39.255670 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m20:11:39.256511 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 20:11:39.250641 => 20:11:39.256218
[0m20:11:39.257016 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m20:11:39.259581 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:11:39.946611 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m20:11:39.949643 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m20:11:40.541167 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a52a3f5d-04f8-4c00-9edc-7d39e79e5e98&page=queryresults
[0m20:11:43.671454 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 20:11:39.257315 => 20:11:43.670471
[0m20:11:43.674920 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '424a1ec3-cbed-4971-8d50-113e35fc9dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b66c83a90>]}
[0m20:11:43.677763 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.43s]
[0m20:11:43.680935 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m20:11:43.687279 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:11:43.689065 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m20:11:43.690919 [info ] [MainThread]: 
[0m20:11:43.692895 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 27.52 seconds (27.52s).
[0m20:11:43.700305 [debug] [MainThread]: Command end result
[0m20:11:43.723782 [info ] [MainThread]: 
[0m20:11:43.724328 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:11:43.724741 [info ] [MainThread]: 
[0m20:11:43.725129 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m20:11:43.725719 [debug] [MainThread]: Command `dbt run` succeeded at 20:11:43.725616 after 28.30 seconds
[0m20:11:43.726107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b821a5df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b67edde50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b67dec280>]}
[0m20:11:43.726506 [debug] [MainThread]: Flushing usage events
[0m20:12:38.642255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15bdc99f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15bb6229a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15bb6220d0>]}


============================== 20:12:38.647660 | 036f7bfd-9445-4de0-9633-b20feafa0c7d ==============================
[0m20:12:38.647660 [info ] [MainThread]: Running with dbt=1.6.5
[0m20:12:38.648226 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/includes/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'send_anonymous_usage_stats': 'True'}
[0m20:12:39.226423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '036f7bfd-9445-4de0-9633-b20feafa0c7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15bb650970>]}
[0m20:12:39.237605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '036f7bfd-9445-4de0-9633-b20feafa0c7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a3a16f10>]}
[0m20:12:39.238312 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m20:12:39.255242 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m20:12:39.343530 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:12:39.344260 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m20:12:39.387889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '036f7bfd-9445-4de0-9633-b20feafa0c7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a380cee0>]}
[0m20:12:39.403430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '036f7bfd-9445-4de0-9633-b20feafa0c7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a39221c0>]}
[0m20:12:39.404081 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m20:12:39.404661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '036f7bfd-9445-4de0-9633-b20feafa0c7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a3922190>]}
[0m20:12:39.407046 [info ] [MainThread]: 
[0m20:12:39.408068 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:12:39.409677 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m20:12:39.410172 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:12:40.108003 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m20:12:40.108638 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:12:40.699240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '036f7bfd-9445-4de0-9633-b20feafa0c7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a380cf10>]}
[0m20:12:40.702765 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:12:40.705387 [info ] [MainThread]: 
[0m20:12:40.731950 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m20:12:40.733366 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m20:12:40.735085 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m20:12:40.736014 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m20:12:40.750025 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m20:12:40.750953 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 20:12:40.736888 => 20:12:40.750684
[0m20:12:40.751469 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m20:12:40.768458 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:12:41.452632 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m20:12:41.453546 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m20:12:41.965255 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9d104da0-18da-490e-8e61-b9fab4cffe4a&page=queryresults
[0m20:12:44.793292 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 20:12:40.751839 => 20:12:44.793085
[0m20:12:44.794063 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '036f7bfd-9445-4de0-9633-b20feafa0c7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a2fb9f10>]}
[0m20:12:44.794656 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.06s]
[0m20:12:44.795362 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m20:12:44.795858 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m20:12:44.796422 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m20:12:44.797410 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m20:12:44.797834 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m20:12:44.805813 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m20:12:44.806655 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 20:12:44.798125 => 20:12:44.806384
[0m20:12:44.807161 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m20:12:44.810136 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:12:45.468669 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m20:12:45.469447 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m20:12:46.102247 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e4953618-f107-4ea6-bac3-f2c4ba5656f2&page=queryresults
[0m20:12:49.498705 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 20:12:44.807472 => 20:12:49.497739
[0m20:12:49.502042 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '036f7bfd-9445-4de0-9633-b20feafa0c7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a2fb9a30>]}
[0m20:12:49.504852 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.70s]
[0m20:12:49.507957 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m20:12:49.510238 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m20:12:49.512630 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m20:12:49.515943 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m20:12:49.518640 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m20:12:49.528955 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m20:12:49.531056 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 20:12:49.520120 => 20:12:49.530586
[0m20:12:49.532043 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m20:12:49.543817 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:12:50.174095 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m20:12:50.177207 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
   SELECT
    currency,
    initial_price,
    final_price,
    discount_percent,
    formatted_initial_price,
    formatted_final_price,
    (CASE
        WHEN discount_percent IS NOT NULL THEN
            CONCAT('ARS$ ', CAST(ROUND(final_price - (final_price * discount_percent / 100) + (final_price - (final_price * discount_percent / 100)) * 0.75, 2) AS STRING))
        ELSE
            CONCAT('ARS$ ', CAST(ROUND(final_price * 0.75, 2) AS STRING))
    END) AS formatted_price  -- Formato ARS$ 400,00 con descuento e impuesto
FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    currency,
    initial_price,
    discount_percent,
    final_price,
    formatted_initial_price,
    formatted_final_price,
    formatted_price,
FROM price_overview_cte
    );
  
[0m20:12:50.781017 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:1b2459ff-7e49-4de3-b48f-7f7ffd3865bc&page=queryresults
[0m20:12:53.884880 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 20:12:49.532903 => 20:12:53.884633
[0m20:12:53.885875 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '036f7bfd-9445-4de0-9633-b20feafa0c7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a2fb9340>]}
[0m20:12:53.886644 [info ] [Thread-1  ]: 3 of 6 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (2.7k rows, 98.5 KiB processed)[0m in 4.37s]
[0m20:12:53.887453 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m20:12:53.888004 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m20:12:53.888521 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m20:12:53.889377 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m20:12:53.889845 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m20:12:53.893214 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m20:12:53.893923 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 20:12:53.890168 => 20:12:53.893697
[0m20:12:53.894334 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m20:12:53.896775 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:12:54.604038 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m20:12:54.607014 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m20:12:55.172289 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:15b0a823-6c3d-4b1d-85dd-701b747863cc&page=queryresults
[0m20:12:58.359049 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 20:12:53.894630 => 20:12:58.358788
[0m20:12:58.359854 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '036f7bfd-9445-4de0-9633-b20feafa0c7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a26eb220>]}
[0m20:12:58.360479 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.47s]
[0m20:12:58.361232 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m20:12:58.361722 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m20:12:58.362319 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m20:12:58.362995 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m20:12:58.363433 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m20:12:58.366679 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m20:12:58.367434 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 20:12:58.363725 => 20:12:58.367185
[0m20:12:58.367876 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m20:12:58.370351 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:12:59.047086 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m20:12:59.047855 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m20:12:59.755592 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5808395d-2dc5-46a1-8a14-a0719a7af637&page=queryresults
[0m20:13:02.922635 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 20:12:58.368183 => 20:13:02.922422
[0m20:13:02.923405 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '036f7bfd-9445-4de0-9633-b20feafa0c7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a2700fd0>]}
[0m20:13:02.924062 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.56s]
[0m20:13:02.924825 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m20:13:02.925333 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m20:13:02.925847 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m20:13:02.926556 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m20:13:02.926999 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m20:13:02.930612 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m20:13:02.931495 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 20:13:02.927319 => 20:13:02.931226
[0m20:13:02.931977 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m20:13:02.934878 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:13:03.595457 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m20:13:03.598480 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m20:13:04.075293 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:591b6795-0cdf-49bf-a51c-e5b372305cc5&page=queryresults
[0m20:13:07.172491 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 20:13:02.932322 => 20:13:07.172283
[0m20:13:07.173247 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '036f7bfd-9445-4de0-9633-b20feafa0c7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a25bd700>]}
[0m20:13:07.173848 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.25s]
[0m20:13:07.174519 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m20:13:07.176001 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:13:07.176353 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m20:13:07.176758 [info ] [MainThread]: 
[0m20:13:07.177161 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 27.77 seconds (27.77s).
[0m20:13:07.178816 [debug] [MainThread]: Command end result
[0m20:13:07.192600 [info ] [MainThread]: 
[0m20:13:07.193160 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:13:07.193586 [info ] [MainThread]: 
[0m20:13:07.193965 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m20:13:07.194552 [debug] [MainThread]: Command `dbt run` succeeded at 20:13:07.194446 after 28.56 seconds
[0m20:13:07.194959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15bdc99f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a3a04d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a3922310>]}
[0m20:13:07.195394 [debug] [MainThread]: Flushing usage events
[0m20:18:28.653263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf32d5f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf0c59a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf0c599d0>]}


============================== 20:18:28.658703 | c3f6d1f4-1761-4212-9baa-36b787e516bf ==============================
[0m20:18:28.658703 [info ] [MainThread]: Running with dbt=1.6.5
[0m20:18:28.659407 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'log_path': '/opt/airflow/includes/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:18:29.313700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3f6d1f4-1761-4212-9baa-36b787e516bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf0c87910>]}
[0m20:18:29.325326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3f6d1f4-1761-4212-9baa-36b787e516bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd9040ee0>]}
[0m20:18:29.326082 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m20:18:29.344190 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m20:18:29.438479 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:18:29.439187 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m20:18:29.488426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3f6d1f4-1761-4212-9baa-36b787e516bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd8e44eb0>]}
[0m20:18:29.505751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3f6d1f4-1761-4212-9baa-36b787e516bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd8f57130>]}
[0m20:18:29.506355 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m20:18:29.506862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3f6d1f4-1761-4212-9baa-36b787e516bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd8f57190>]}
[0m20:18:29.508659 [info ] [MainThread]: 
[0m20:18:29.509582 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:18:29.511124 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m20:18:29.511704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:18:30.185066 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m20:18:30.185610 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:18:30.838226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3f6d1f4-1761-4212-9baa-36b787e516bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd8e44fd0>]}
[0m20:18:30.841879 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:18:30.843855 [info ] [MainThread]: 
[0m20:18:30.864253 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m20:18:30.865446 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m20:18:30.866790 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m20:18:30.867524 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m20:18:30.879716 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m20:18:30.880657 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 20:18:30.868029 => 20:18:30.880374
[0m20:18:30.881181 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m20:18:30.897318 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:18:31.568781 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m20:18:31.569573 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m20:18:32.359714 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:3ae3171c-0764-42b8-94f3-07bd31ba2bb9&page=queryresults
[0m20:18:35.598313 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 20:18:30.881539 => 20:18:35.598087
[0m20:18:35.599372 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3f6d1f4-1761-4212-9baa-36b787e516bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd87efe50>]}
[0m20:18:35.600101 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.73s]
[0m20:18:35.600808 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m20:18:35.601461 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m20:18:35.602042 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m20:18:35.602857 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m20:18:35.603284 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m20:18:35.613547 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m20:18:35.614460 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 20:18:35.603581 => 20:18:35.614214
[0m20:18:35.614901 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m20:18:35.618382 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:18:36.332018 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m20:18:36.333229 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m20:18:36.903823 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ee8de03e-6722-488a-b619-e09a06184f8b&page=queryresults
[0m20:18:40.021942 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 20:18:35.615216 => 20:18:40.021596
[0m20:18:40.023146 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3f6d1f4-1761-4212-9baa-36b787e516bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd87ef9d0>]}
[0m20:18:40.024189 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.42s]
[0m20:18:40.025497 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m20:18:40.026353 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m20:18:40.027188 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m20:18:40.028526 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m20:18:40.029359 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m20:18:40.034832 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m20:18:40.036067 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 20:18:40.029870 => 20:18:40.035666
[0m20:18:40.036987 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m20:18:40.042358 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:18:40.709349 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m20:18:40.710397 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
   SELECT
    currency,
    initial_price,
    final_price,
    discount_percent,
    formatted_initial_price,
    formatted_final_price,
    (CASE
        WHEN discount_percent IS NOT NULL AND discount_percent > 0 THEN
            CONCAT('ARS$ ', CAST(ROUND(final_price - (final_price * discount_percent / 100), 2) AS STRING)) AS discount_amount_formatted,  -- Formato del monto de descuento
            CONCAT('ARS$ ', CAST(ROUND((final_price - (final_price * discount_percent / 100)) * 0.75, 2) AS STRING)) AS price_with_discount_formatted,  -- Formato del precio con descuento e impuesto
        ELSE
            'ARS$ 0.00' AS discount_amount_formatted,  -- Si no hay descuento, el monto de descuento es 0
            CONCAT('ARS$ ', CAST(ROUND(final_price * 0.75, 2) AS STRING)) AS price_with_tax_formatted  -- Formato del precio con impuesto sin descuento
    END) AS formatted_price  -- Formato ARS$ 400,00 con o sin descuento e impuesto
FROM `pristine-flames-400818`.`games`.`raw_games`;
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    currency,
    initial_price,
    discount_percent,
    final_price,
    formatted_initial_price,
    formatted_final_price,
    formatted_price,
    discount_amount_formatted,
    price_with_tax_formatted
FROM price_overview_cte
    );
  
[0m20:18:41.070384 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:adeedb13-d897-400a-acce-244aec92279f&page=queryresults
[0m20:18:41.071558 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword ELSE or keyword END but got keyword AS at [26:109]')
[0m20:18:41.605742 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:dd8b83e5-5fc5-42df-af90-a45403b6cd5e&page=queryresults
[0m20:18:41.607832 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:dd8b83e5-5fc5-42df-af90-a45403b6cd5e&page=queryresults
[0m20:18:41.609387 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 20:18:40.037790 => 20:18:41.608903
[0m20:18:41.616530 [debug] [Thread-1  ]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Syntax error: Expected keyword ELSE or keyword END but got keyword AS at [26:109]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m20:18:41.617634 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3f6d1f4-1761-4212-9baa-36b787e516bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd8704100>]}
[0m20:18:41.618886 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 1.59s]
[0m20:18:41.620257 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m20:18:41.621340 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m20:18:41.622391 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m20:18:41.623949 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m20:18:41.624849 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m20:18:41.631835 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m20:18:41.633343 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 20:18:41.625498 => 20:18:41.632862
[0m20:18:41.634144 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m20:18:41.638495 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:18:42.415797 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m20:18:42.417339 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m20:18:42.930000 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:8c59c205-1d99-4fdd-94fa-9807e95b4770&page=queryresults
[0m20:18:46.063118 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 20:18:41.634686 => 20:18:46.062771
[0m20:18:46.064353 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3f6d1f4-1761-4212-9baa-36b787e516bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd85d6940>]}
[0m20:18:46.065429 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.44s]
[0m20:18:46.066597 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m20:18:46.067391 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m20:18:46.068196 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m20:18:46.069317 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m20:18:46.070150 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m20:18:46.075490 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m20:18:46.076682 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 20:18:46.070669 => 20:18:46.076312
[0m20:18:46.077396 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m20:18:46.081347 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:18:46.723218 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m20:18:46.725461 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m20:18:47.214676 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:78c74489-1595-4684-8869-2eecc6e0afea&page=queryresults
[0m20:18:50.279714 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 20:18:46.077896 => 20:18:50.278750
[0m20:18:50.283127 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3f6d1f4-1761-4212-9baa-36b787e516bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd85c7fa0>]}
[0m20:18:50.285982 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.21s]
[0m20:18:50.289218 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m20:18:50.291537 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m20:18:50.294730 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m20:18:50.298105 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m20:18:50.299701 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m20:18:50.308529 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m20:18:50.309922 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 20:18:50.300768 => 20:18:50.309489
[0m20:18:50.310747 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m20:18:50.315358 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:18:50.988167 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m20:18:50.991257 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m20:18:51.522494 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:818671ed-7440-43d9-a52f-81d8e51905b7&page=queryresults
[0m20:18:54.646601 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 20:18:50.311345 => 20:18:54.646012
[0m20:18:54.648740 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3f6d1f4-1761-4212-9baa-36b787e516bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd85a0760>]}
[0m20:18:54.650434 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.35s]
[0m20:18:54.652493 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m20:18:54.656611 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:18:54.657680 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m20:18:54.658814 [info ] [MainThread]: 
[0m20:18:54.660150 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 25.15 seconds (25.15s).
[0m20:18:54.664492 [debug] [MainThread]: Command end result
[0m20:18:54.690152 [info ] [MainThread]: 
[0m20:18:54.690766 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:18:54.691252 [info ] [MainThread]: 
[0m20:18:54.691731 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Syntax error: Expected keyword ELSE or keyword END but got keyword AS at [26:109]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m20:18:54.692224 [info ] [MainThread]: 
[0m20:18:54.692745 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m20:18:54.693508 [debug] [MainThread]: Command `dbt run` failed at 20:18:54.693368 after 26.05 seconds
[0m20:18:54.693992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf32d5f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd9040e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd8e98dc0>]}
[0m20:18:54.694468 [debug] [MainThread]: Flushing usage events
[0m20:20:03.368951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02a78dad90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02a5261880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02a52618b0>]}


============================== 20:20:03.373682 | 93d26de9-ff55-458e-9a8a-760fc8623028 ==============================
[0m20:20:03.373682 [info ] [MainThread]: Running with dbt=1.6.5
[0m20:20:03.374253 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/includes/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'send_anonymous_usage_stats': 'True'}
[0m20:20:03.935875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93d26de9-ff55-458e-9a8a-760fc8623028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02a52917f0>]}
[0m20:20:03.946916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93d26de9-ff55-458e-9a8a-760fc8623028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f028d6b1df0>]}
[0m20:20:03.947557 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m20:20:03.963982 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m20:20:04.050552 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:20:04.051155 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m20:20:04.092893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93d26de9-ff55-458e-9a8a-760fc8623028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f028d447e50>]}
[0m20:20:04.107744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93d26de9-ff55-458e-9a8a-760fc8623028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f028d5521f0>]}
[0m20:20:04.108291 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m20:20:04.108718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93d26de9-ff55-458e-9a8a-760fc8623028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f028d552040>]}
[0m20:20:04.110570 [info ] [MainThread]: 
[0m20:20:04.111655 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:20:04.113015 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m20:20:04.113472 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:20:04.768958 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m20:20:04.771152 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:20:05.446423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93d26de9-ff55-458e-9a8a-760fc8623028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f028d48cfd0>]}
[0m20:20:05.447171 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:20:05.447579 [info ] [MainThread]: 
[0m20:20:05.453935 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m20:20:05.454523 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m20:20:05.455541 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m20:20:05.456159 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m20:20:05.465414 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m20:20:05.466151 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 20:20:05.456611 => 20:20:05.465936
[0m20:20:05.466562 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m20:20:05.482180 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:20:06.211947 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m20:20:06.212683 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m20:20:06.819912 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f2a0b2bb-4156-4545-b4a2-a475f5918050&page=queryresults
[0m20:20:09.961759 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 20:20:05.466853 => 20:20:09.961459
[0m20:20:09.962836 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93d26de9-ff55-458e-9a8a-760fc8623028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f028cbefd30>]}
[0m20:20:09.963686 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.51s]
[0m20:20:09.964620 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m20:20:09.965314 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m20:20:09.966000 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m20:20:09.967033 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m20:20:09.967560 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m20:20:09.976875 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m20:20:09.977823 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 20:20:09.967930 => 20:20:09.977565
[0m20:20:09.978254 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m20:20:09.981061 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:20:10.646516 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m20:20:10.649484 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m20:20:11.251851 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c1a1ccc5-00a4-4edf-a555-1837f28fe1a6&page=queryresults
[0m20:20:14.337882 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 20:20:09.978548 => 20:20:14.336892
[0m20:20:14.341291 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93d26de9-ff55-458e-9a8a-760fc8623028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f028c1d0e50>]}
[0m20:20:14.344098 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.37s]
[0m20:20:14.347272 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m20:20:14.349611 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m20:20:14.352251 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m20:20:14.355485 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m20:20:14.357558 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m20:20:14.368636 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m20:20:14.370397 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 20:20:14.359029 => 20:20:14.369851
[0m20:20:14.371409 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m20:20:14.376729 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:20:15.041029 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m20:20:15.044190 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
   SELECT
    currency,
    initial_price,
    final_price,
    discount_percent,
    formatted_initial_price,
    formatted_final_price,
    (CASE
        WHEN discount_percent IS NOT NULL AND discount_percent > 0 THEN
            CONCAT('ARS$ ', CAST(ROUND((initial_price - (initial_price * discount_percent / 100)) * 0.75, 2) AS STRING)) AS discount_amount_formatted,  -- Formato del monto de descuento
            CONCAT('ARS$ ', CAST(ROUND((initial_price - (initial_price * discount_percent / 100)) * 0.75, 2) AS STRING)) AS price_with_discount_formatted,  -- Formato del precio con descuento e impuesto
        ELSE
            'ARS$ 0.00' AS discount_amount_formatted,  -- Si no hay descuento, el monto de descuento es 0
            CONCAT('ARS$ ', CAST(ROUND(initial_price * 0.75, 2) AS STRING)) AS price_with_tax_formatted  -- Formato del precio con impuesto sin descuento
    END) AS formatted_price  -- Formato ARS$ 400,00 con o sin descuento e impuesto
FROM `pristine-flames-400818`.`games`.`raw_games`;
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    currency,
    initial_price,
    discount_percent,
    final_price,
    formatted_initial_price,
    formatted_final_price,
    formatted_price,
    discount_amount_formatted,
    price_with_discount_formatted,
    price_with_tax_formatted
FROM price_overview_cte
    );
  
[0m20:20:15.351821 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:714478de-f02d-4e37-a9b3-13af7d184136&page=queryresults
[0m20:20:15.356479 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword ELSE or keyword END but got keyword AS at [26:122]')
[0m20:20:15.796028 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:30d8905f-cd41-42e1-a8f9-debfcb511c00&page=queryresults
[0m20:20:15.798973 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:30d8905f-cd41-42e1-a8f9-debfcb511c00&page=queryresults
[0m20:20:15.799766 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 20:20:14.372005 => 20:20:15.799516
[0m20:20:15.803218 [debug] [Thread-1  ]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Syntax error: Expected keyword ELSE or keyword END but got keyword AS at [26:122]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m20:20:15.803713 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93d26de9-ff55-458e-9a8a-760fc8623028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f028c3079a0>]}
[0m20:20:15.804330 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 1.45s]
[0m20:20:15.804988 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m20:20:15.805460 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m20:20:15.805938 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m20:20:15.806614 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m20:20:15.807151 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m20:20:15.810623 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m20:20:15.811542 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 20:20:15.807465 => 20:20:15.811194
[0m20:20:15.812360 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m20:20:15.815727 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:20:16.454320 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m20:20:16.455095 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m20:20:16.909706 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ec7f3eb7-348f-4b2a-9b44-a1a49f42d6a5&page=queryresults
[0m20:20:21.298775 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 20:20:15.812872 => 20:20:21.297783
[0m20:20:21.302177 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93d26de9-ff55-458e-9a8a-760fc8623028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f028c1ee430>]}
[0m20:20:21.305044 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 5.50s]
[0m20:20:21.308216 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m20:20:21.310570 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m20:20:21.313494 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m20:20:21.316766 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m20:20:21.318832 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m20:20:21.329478 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m20:20:21.331257 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 20:20:21.320341 => 20:20:21.330692
[0m20:20:21.332169 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m20:20:21.337284 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:20:21.980422 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m20:20:21.983382 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m20:20:22.462069 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c438d0e6-29ba-46a3-a452-556b6aab011a&page=queryresults
[0m20:20:25.535303 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 20:20:21.332805 => 20:20:25.535100
[0m20:20:25.536035 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93d26de9-ff55-458e-9a8a-760fc8623028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f028c1cceb0>]}
[0m20:20:25.536633 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.22s]
[0m20:20:25.537369 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m20:20:25.537856 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m20:20:25.538457 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m20:20:25.539153 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m20:20:25.539555 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m20:20:25.542753 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m20:20:25.543449 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 20:20:25.539843 => 20:20:25.543232
[0m20:20:25.543873 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m20:20:25.546361 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:20:26.226933 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m20:20:26.227766 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m20:20:26.835247 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:bac2c89f-e0eb-4a88-9c2f-92f5d6de4059&page=queryresults
[0m20:20:29.825427 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 20:20:25.544157 => 20:20:29.824870
[0m20:20:29.827374 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93d26de9-ff55-458e-9a8a-760fc8623028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f028c1eef10>]}
[0m20:20:29.829150 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.29s]
[0m20:20:29.831978 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m20:20:29.836483 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:20:29.837719 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m20:20:29.838999 [info ] [MainThread]: 
[0m20:20:29.839759 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 25.73 seconds (25.73s).
[0m20:20:29.841397 [debug] [MainThread]: Command end result
[0m20:20:29.855960 [info ] [MainThread]: 
[0m20:20:29.856493 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:20:29.856947 [info ] [MainThread]: 
[0m20:20:29.857365 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Syntax error: Expected keyword ELSE or keyword END but got keyword AS at [26:122]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m20:20:29.857768 [info ] [MainThread]: 
[0m20:20:29.858174 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m20:20:29.858835 [debug] [MainThread]: Command `dbt run` failed at 20:20:29.858715 after 26.49 seconds
[0m20:20:29.859248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02a78dad90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f028d6b1df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f028d552220>]}
[0m20:20:29.859672 [debug] [MainThread]: Flushing usage events
[0m20:22:08.405874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96a01ddfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f969db67ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f969db67130>]}


============================== 20:22:08.410635 | 81efbfee-3aa9-4715-a85a-bd19b97022c0 ==============================
[0m20:22:08.410635 [info ] [MainThread]: Running with dbt=1.6.5
[0m20:22:08.411196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/includes/dbt/', 'log_path': '/opt/airflow/includes/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:22:08.971041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81efbfee-3aa9-4715-a85a-bd19b97022c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f969db94a30>]}
[0m20:22:08.982194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81efbfee-3aa9-4715-a85a-bd19b97022c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9685f50f70>]}
[0m20:22:08.982837 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m20:22:08.999055 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m20:22:09.084751 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:22:09.085342 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m20:22:09.127084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81efbfee-3aa9-4715-a85a-bd19b97022c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9685d52f40>]}
[0m20:22:09.141696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81efbfee-3aa9-4715-a85a-bd19b97022c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9685e631c0>]}
[0m20:22:09.142192 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m20:22:09.142614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81efbfee-3aa9-4715-a85a-bd19b97022c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9685e63220>]}
[0m20:22:09.144077 [info ] [MainThread]: 
[0m20:22:09.144893 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:22:09.146160 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m20:22:09.146616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:22:09.916517 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m20:22:09.918791 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:22:10.611781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81efbfee-3aa9-4715-a85a-bd19b97022c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9685d97b80>]}
[0m20:22:10.615339 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:22:10.617302 [info ] [MainThread]: 
[0m20:22:10.644010 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m20:22:10.645401 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m20:22:10.647127 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m20:22:10.648245 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m20:22:10.662145 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m20:22:10.663151 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 20:22:10.648917 => 20:22:10.662840
[0m20:22:10.663695 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m20:22:10.681234 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:11.414949 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m20:22:11.415812 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m20:22:11.916106 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:16520269-ca14-42d1-8e2d-29eed997a4a1&page=queryresults
[0m20:22:15.372815 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 20:22:10.664060 => 20:22:15.372421
[0m20:22:15.374080 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81efbfee-3aa9-4715-a85a-bd19b97022c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96854f4e50>]}
[0m20:22:15.375035 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.73s]
[0m20:22:15.376218 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m20:22:15.376953 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m20:22:15.377799 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m20:22:15.379144 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m20:22:15.379728 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m20:22:15.390052 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m20:22:15.390854 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 20:22:15.380118 => 20:22:15.390624
[0m20:22:15.391284 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m20:22:15.394149 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:16.027343 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m20:22:16.030288 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m20:22:16.651699 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:599af018-8418-4e00-bcba-f5476232b15e&page=queryresults
[0m20:22:19.456533 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 20:22:15.391579 => 20:22:19.456117
[0m20:22:19.457971 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81efbfee-3aa9-4715-a85a-bd19b97022c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96854f4310>]}
[0m20:22:19.459141 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.08s]
[0m20:22:19.460559 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m20:22:19.461554 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m20:22:19.462771 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m20:22:19.464312 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m20:22:19.465206 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m20:22:19.471747 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m20:22:19.473252 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 20:22:19.465807 => 20:22:19.472788
[0m20:22:19.474188 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m20:22:19.479863 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:20.142457 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m20:22:20.145765 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
   SELECT
    currency,
    initial_price,
    final_price,
    discount_percent,
    formatted_initial_price,
    formatted_final_price,
    (CASE
        WHEN discount_percent IS NOT NULL AND discount_percent > 0 THEN
            discount_percent * initial_price / 100  -- Monto de descuento
        ELSE
            0  -- No hay descuento
    END) AS discount_amount,  -- Monto de descuento

    (CASE
        WHEN discount_percent IS NOT NULL AND discount_percent > 0 THEN
            CONCAT('ARS$ ', CAST(ROUND((initial_price - (initial_price * discount_percent / 100)) * 0.75, 2) AS STRING))
        ELSE
            CONCAT('ARS$ ', CAST(ROUND(initial_price * 0.75, 2) AS STRING))
    END) AS formatted_price_with_tax,  -- Precio con impuesto formateado

    (CASE
        WHEN discount_percent IS NOT NULL AND discount_percent > 0 THEN
            CONCAT('ARS$ ', CAST(ROUND(initial_price - (initial_price * discount_percent / 100), 2) AS STRING))
        ELSE
            CONCAT('ARS$ ', CAST(ROUND(initial_price, 2) AS STRING))
    END) AS formatted_price  -- Precio formateado

FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    currency,
    initial_price,
    discount_percent,
    final_price,
    formatted_initial_price,
    formatted_final_price,
    formatted_price,
    discount_amount_formatted,
    price_with_discount_formatted,
    price_with_tax_formatted
FROM price_overview_cte
    );
  
[0m20:22:20.742588 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:42491190-463f-41f3-9bd9-b6f6ce5a6311&page=queryresults
[0m20:22:21.260341 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: discount_amount_formatted at [57:5]')
[0m20:22:22.259790 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7ea7f6df-0c61-4dbf-bce5-397feee80429&page=queryresults
[0m20:22:22.790113 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7ea7f6df-0c61-4dbf-bce5-397feee80429&page=queryresults
[0m20:22:22.792355 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 20:22:19.475059 => 20:22:22.791657
[0m20:22:22.802311 [debug] [Thread-1  ]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Unrecognized name: discount_amount_formatted at [57:5]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m20:22:22.804162 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81efbfee-3aa9-4715-a85a-bd19b97022c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9684c0fb20>]}
[0m20:22:22.806509 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 3.34s]
[0m20:22:22.808502 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m20:22:22.809603 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m20:22:22.810900 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m20:22:22.812540 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m20:22:22.813356 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m20:22:22.819174 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m20:22:22.820524 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 20:22:22.813903 => 20:22:22.820081
[0m20:22:22.821452 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m20:22:22.825394 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:23.505513 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m20:22:23.506488 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m20:22:24.228431 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d64776c4-8f66-4fef-a901-04e47ea5fd69&page=queryresults
[0m20:22:27.592943 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 20:22:22.822040 => 20:22:27.592733
[0m20:22:27.593683 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81efbfee-3aa9-4715-a85a-bd19b97022c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9684af4550>]}
[0m20:22:27.594301 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.78s]
[0m20:22:27.594966 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m20:22:27.595444 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m20:22:27.596002 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m20:22:27.596714 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m20:22:27.597138 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m20:22:27.600803 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m20:22:27.601665 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 20:22:27.597438 => 20:22:27.601404
[0m20:22:27.602144 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m20:22:27.604804 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:28.227940 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m20:22:28.228688 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m20:22:28.692579 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:2c8a106f-1ba5-4f64-9f71-a00b2efb99bb&page=queryresults
[0m20:22:32.393818 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 20:22:27.602474 => 20:22:32.393121
[0m20:22:32.395972 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81efbfee-3aa9-4715-a85a-bd19b97022c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f968424feb0>]}
[0m20:22:32.397560 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.80s]
[0m20:22:32.399344 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m20:22:32.400377 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m20:22:32.401568 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m20:22:32.402933 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m20:22:32.403767 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m20:22:32.409408 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m20:22:32.410533 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 20:22:32.404362 => 20:22:32.410185
[0m20:22:32.411186 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m20:22:32.415329 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:33.069232 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m20:22:33.070469 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m20:22:33.653713 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:15ed74e4-202d-485b-aff4-d0f34bf2972c&page=queryresults
[0m20:22:36.737148 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 20:22:32.411664 => 20:22:36.736613
[0m20:22:36.739014 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81efbfee-3aa9-4715-a85a-bd19b97022c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9684c12dc0>]}
[0m20:22:36.740366 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.34s]
[0m20:22:36.741791 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m20:22:36.744921 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:22:36.745709 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m20:22:36.746482 [info ] [MainThread]: 
[0m20:22:36.747279 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 27.60 seconds (27.60s).
[0m20:22:36.750314 [debug] [MainThread]: Command end result
[0m20:22:36.773731 [info ] [MainThread]: 
[0m20:22:36.774477 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:22:36.774939 [info ] [MainThread]: 
[0m20:22:36.775364 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Unrecognized name: discount_amount_formatted at [57:5]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m20:22:36.775800 [info ] [MainThread]: 
[0m20:22:36.776233 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m20:22:36.776921 [debug] [MainThread]: Command `dbt run` failed at 20:22:36.776799 after 28.38 seconds
[0m20:22:36.777373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96a01ddfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9685fbff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9685e633a0>]}
[0m20:22:36.777838 [debug] [MainThread]: Flushing usage events
[0m20:22:53.759729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5408315f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5405ca99a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5405ca90a0>]}


============================== 20:22:53.764942 | 75d0b25b-1245-4ae9-be41-d9dbb4d3819b ==============================
[0m20:22:53.764942 [info ] [MainThread]: Running with dbt=1.6.5
[0m20:22:53.765540 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/includes/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'send_anonymous_usage_stats': 'True'}
[0m20:22:54.360603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75d0b25b-1245-4ae9-be41-d9dbb4d3819b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5405cd8910>]}
[0m20:22:54.372141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75d0b25b-1245-4ae9-be41-d9dbb4d3819b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53ee07eee0>]}
[0m20:22:54.372903 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m20:22:54.390599 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m20:22:54.478475 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:22:54.479128 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m20:22:54.523507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75d0b25b-1245-4ae9-be41-d9dbb4d3819b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53ede79eb0>]}
[0m20:22:54.538660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75d0b25b-1245-4ae9-be41-d9dbb4d3819b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53edf85130>]}
[0m20:22:54.539179 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m20:22:54.539579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75d0b25b-1245-4ae9-be41-d9dbb4d3819b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53edf85190>]}
[0m20:22:54.541088 [info ] [MainThread]: 
[0m20:22:54.541844 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:22:54.543382 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m20:22:54.543988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:22:55.738861 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m20:22:55.739406 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:22:56.362211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75d0b25b-1245-4ae9-be41-d9dbb4d3819b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53ede79fd0>]}
[0m20:22:56.363662 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:22:56.364410 [info ] [MainThread]: 
[0m20:22:56.376459 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m20:22:56.377602 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m20:22:56.379046 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m20:22:56.379862 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m20:22:56.394353 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m20:22:56.395409 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 20:22:56.380427 => 20:22:56.395081
[0m20:22:56.395997 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m20:22:56.413798 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:57.080723 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m20:22:57.081462 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m20:22:57.721015 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:16c2ec39-1dd5-4f2e-9ccc-1e38d8f1ffa3&page=queryresults
[0m20:23:00.559944 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 20:22:56.396426 => 20:23:00.559647
[0m20:23:00.561073 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75d0b25b-1245-4ae9-be41-d9dbb4d3819b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53ed823e20>]}
[0m20:23:00.561927 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.18s]
[0m20:23:00.562852 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m20:23:00.563524 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m20:23:00.564160 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m20:23:00.565117 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m20:23:00.565757 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m20:23:00.575785 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m20:23:00.576584 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 20:23:00.566154 => 20:23:00.576368
[0m20:23:00.577011 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m20:23:00.579856 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:23:01.260099 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m20:23:01.261762 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m20:23:01.875375 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e5053ac3-275a-48f3-b354-86ceea6287f4&page=queryresults
[0m20:23:04.942813 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 20:23:00.577305 => 20:23:04.942295
[0m20:23:04.944923 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75d0b25b-1245-4ae9-be41-d9dbb4d3819b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53ed823bb0>]}
[0m20:23:04.946482 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.38s]
[0m20:23:04.948148 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m20:23:04.949382 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m20:23:04.950850 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m20:23:04.952530 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m20:23:04.953586 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m20:23:04.962865 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m20:23:04.964675 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 20:23:04.954332 => 20:23:04.964104
[0m20:23:04.965732 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m20:23:04.971483 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:23:05.611343 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m20:23:05.612920 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
   SELECT
    currency,
    initial_price,
    final_price,
    discount_percent,
    formatted_initial_price,
    formatted_final_price,
    (CASE
        WHEN discount_percent IS NOT NULL AND discount_percent > 0 THEN
            discount_percent * initial_price / 100  -- Monto de descuento
        ELSE
            0  -- No hay descuento
    END) AS discount_amount,  -- Monto de descuento

    (CASE
        WHEN discount_percent IS NOT NULL AND discount_percent > 0 THEN
            CONCAT('ARS$ ', CAST(ROUND((initial_price - (initial_price * discount_percent / 100)) * 0.75, 2) AS STRING))
        ELSE
            CONCAT('ARS$ ', CAST(ROUND(initial_price * 0.75, 2) AS STRING))
    END) AS formatted_price_with_tax,  -- Precio con impuesto formateado

    (CASE
        WHEN discount_percent IS NOT NULL AND discount_percent > 0 THEN
            CONCAT('ARS$ ', CAST(ROUND(initial_price - (initial_price * discount_percent / 100), 2) AS STRING))
        ELSE
            CONCAT('ARS$ ', CAST(ROUND(initial_price, 2) AS STRING))
    END) AS formatted_price  -- Precio formateado

FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
   *
FROM price_overview_cte
    );
  
[0m20:23:06.333190 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e57a8cbf-5a06-499e-b7d9-93cedd5d6141&page=queryresults
[0m20:23:09.403730 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 20:23:04.966480 => 20:23:09.402947
[0m20:23:09.406227 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75d0b25b-1245-4ae9-be41-d9dbb4d3819b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53ece03730>]}
[0m20:23:09.408368 [info ] [Thread-1  ]: 3 of 6 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (2.7k rows, 98.5 KiB processed)[0m in 4.45s]
[0m20:23:09.411317 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m20:23:09.412789 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m20:23:09.414308 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m20:23:09.416053 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m20:23:09.417149 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m20:23:09.425105 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m20:23:09.426624 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 20:23:09.417921 => 20:23:09.426165
[0m20:23:09.427371 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m20:23:09.431692 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:23:10.062379 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m20:23:10.063661 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m20:23:10.684446 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e3f44592-bdb9-4a8e-adfa-811d4bcf41ed&page=queryresults
[0m20:23:13.636729 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 20:23:09.427886 => 20:23:13.636037
[0m20:23:13.639193 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75d0b25b-1245-4ae9-be41-d9dbb4d3819b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53ecf57220>]}
[0m20:23:13.641229 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.22s]
[0m20:23:13.644041 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m20:23:13.645696 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m20:23:13.647398 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m20:23:13.649295 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m20:23:13.650403 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m20:23:13.657372 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m20:23:13.658778 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 20:23:13.651144 => 20:23:13.658366
[0m20:23:13.659493 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m20:23:13.663521 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:23:14.322026 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m20:23:14.323632 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m20:23:14.790839 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9c1aa47a-31bb-4e15-ad66-850cdbc293f5&page=queryresults
[0m20:23:17.891103 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 20:23:13.660017 => 20:23:17.890700
[0m20:23:17.892503 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75d0b25b-1245-4ae9-be41-d9dbb4d3819b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53ecf69fd0>]}
[0m20:23:17.893681 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.24s]
[0m20:23:17.894987 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m20:23:17.895951 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m20:23:17.897742 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m20:23:17.899149 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m20:23:17.899987 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m20:23:17.905930 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m20:23:17.907285 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 20:23:17.900602 => 20:23:17.906845
[0m20:23:17.908093 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m20:23:17.912367 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:23:18.665426 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m20:23:18.666191 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m20:23:19.259467 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:404f7963-64f0-4b0c-8121-fd9c6e3c904c&page=queryresults
[0m20:23:22.366189 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 20:23:17.908689 => 20:23:22.365986
[0m20:23:22.366961 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75d0b25b-1245-4ae9-be41-d9dbb4d3819b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53ecf3ed00>]}
[0m20:23:22.367566 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.47s]
[0m20:23:22.368268 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m20:23:22.369773 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:23:22.370131 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m20:23:22.370522 [info ] [MainThread]: 
[0m20:23:22.370981 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 27.83 seconds (27.83s).
[0m20:23:22.372603 [debug] [MainThread]: Command end result
[0m20:23:22.392653 [info ] [MainThread]: 
[0m20:23:22.393242 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:23:22.393698 [info ] [MainThread]: 
[0m20:23:22.394139 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m20:23:22.394800 [debug] [MainThread]: Command `dbt run` succeeded at 20:23:22.394686 after 28.64 seconds
[0m20:23:22.395279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5408315f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53ee06ceb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53edecbd30>]}
[0m20:23:22.395760 [debug] [MainThread]: Flushing usage events
[0m20:43:58.625726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f547faabe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f547d395970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f547d3959a0>]}


============================== 20:43:58.630540 | 9de36924-b7c1-41cb-9ae3-0dd0b110a7e6 ==============================
[0m20:43:58.630540 [info ] [MainThread]: Running with dbt=1.6.5
[0m20:43:58.631058 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/includes/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:43:59.234550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9de36924-b7c1-41cb-9ae3-0dd0b110a7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f547d4488b0>]}
[0m20:43:59.246422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9de36924-b7c1-41cb-9ae3-0dd0b110a7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54657e3e80>]}
[0m20:43:59.247206 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m20:43:59.264964 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m20:43:59.355838 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:43:59.356488 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m20:43:59.401441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9de36924-b7c1-41cb-9ae3-0dd0b110a7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54655dfee0>]}
[0m20:43:59.418266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9de36924-b7c1-41cb-9ae3-0dd0b110a7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54656ec130>]}
[0m20:43:59.418778 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m20:43:59.419249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9de36924-b7c1-41cb-9ae3-0dd0b110a7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54656ec100>]}
[0m20:43:59.421229 [info ] [MainThread]: 
[0m20:43:59.422220 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:43:59.423528 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m20:43:59.423943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:44:00.104511 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m20:44:00.106753 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:44:00.791078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9de36924-b7c1-41cb-9ae3-0dd0b110a7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5465625be0>]}
[0m20:44:00.794538 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:44:00.796393 [info ] [MainThread]: 
[0m20:44:00.820789 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m20:44:00.822144 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m20:44:00.823629 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m20:44:00.824545 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m20:44:00.837929 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m20:44:00.838815 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 20:44:00.825185 => 20:44:00.838545
[0m20:44:00.839329 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m20:44:00.855592 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:44:01.580412 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m20:44:01.581208 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m20:44:02.125628 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:694862de-b8f2-4d21-a293-c28f0808e7c3&page=queryresults
[0m20:44:05.300470 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 20:44:00.839692 => 20:44:05.300171
[0m20:44:05.301579 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9de36924-b7c1-41cb-9ae3-0dd0b110a7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5464f89dc0>]}
[0m20:44:05.302444 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.48s]
[0m20:44:05.303377 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m20:44:05.304048 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m20:44:05.304834 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m20:44:05.305709 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m20:44:05.306231 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m20:44:05.316453 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m20:44:05.317361 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 20:44:05.306605 => 20:44:05.317123
[0m20:44:05.317797 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m20:44:05.321136 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:44:06.006759 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m20:44:06.009718 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m20:44:06.629957 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:3b97bc7d-ff43-48ff-99d8-51b4e520955a&page=queryresults
[0m20:44:09.437767 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 20:44:05.318101 => 20:44:09.437561
[0m20:44:09.438515 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9de36924-b7c1-41cb-9ae3-0dd0b110a7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f546456b970>]}
[0m20:44:09.439154 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.13s]
[0m20:44:09.439882 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m20:44:09.440385 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m20:44:09.440920 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m20:44:09.441748 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m20:44:09.442206 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m20:44:09.445611 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m20:44:09.446340 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 20:44:09.442530 => 20:44:09.446112
[0m20:44:09.446781 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m20:44:09.449506 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:44:10.129476 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m20:44:10.130390 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
   SELECT
    *,
    initial_price * (1 - discount_percent / 100) AS discounted_price,
    (initial_price * (1 - discount_percent / 100)) * 1.75 AS price_with_tax,
    CONCAT('ARS$ ', FORMAT(initial_price * (1 - discount_percent / 100), 2)) AS formatted_discounted_price,
    CONCAT('ARS$ ', FORMAT((initial_price * (1 - discount_percent / 100)) * 1.75, 2)) AS formatted_price_with_tax
FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    *
FROM price_overview_cte
    );
  
[0m20:44:10.647979 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:54090a75-64f1-48e6-8c63-ef03f23d26bc&page=queryresults
[0m20:44:11.188495 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for function FORMAT for argument types: FLOAT64, INT64. Supported signature: FORMAT(STRING, [ANY, ...]) at [21:21]')
[0m20:44:11.720868 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ae7ea2a3-774a-4024-b0f4-33bba285acf5&page=queryresults
[0m20:44:12.262606 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ae7ea2a3-774a-4024-b0f4-33bba285acf5&page=queryresults
[0m20:44:12.266013 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 20:44:09.447098 => 20:44:12.264984
[0m20:44:12.282407 [debug] [Thread-1  ]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  No matching signature for function FORMAT for argument types: FLOAT64, INT64. Supported signature: FORMAT(STRING, [ANY, ...]) at [21:21]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m20:44:12.284798 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9de36924-b7c1-41cb-9ae3-0dd0b110a7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54646a2f10>]}
[0m20:44:12.287649 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 2.84s]
[0m20:44:12.290819 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m20:44:12.293160 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m20:44:12.295624 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m20:44:12.297968 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m20:44:12.299467 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m20:44:12.307576 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m20:44:12.309030 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 20:44:12.300304 => 20:44:12.308576
[0m20:44:12.309860 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m20:44:12.313977 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:44:13.015490 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m20:44:13.018440 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m20:44:13.513232 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:1f02b8cf-19a5-4282-8dfc-87c9136540da&page=queryresults
[0m20:44:16.945448 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 20:44:12.310358 => 20:44:16.944449
[0m20:44:16.948802 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9de36924-b7c1-41cb-9ae3-0dd0b110a7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54645728b0>]}
[0m20:44:16.951631 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.65s]
[0m20:44:16.954772 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m20:44:16.957083 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m20:44:16.959714 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m20:44:16.962944 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m20:44:16.964926 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m20:44:16.974183 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m20:44:16.975712 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 20:44:16.965954 => 20:44:16.975259
[0m20:44:16.976539 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m20:44:16.981478 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:44:17.662897 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m20:44:17.665829 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m20:44:18.139625 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f565b9f4-7844-4219-8480-92bdd97e7173&page=queryresults
[0m20:44:22.150606 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 20:44:16.977148 => 20:44:22.149634
[0m20:44:22.154010 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9de36924-b7c1-41cb-9ae3-0dd0b110a7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54644e4d60>]}
[0m20:44:22.156918 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 5.19s]
[0m20:44:22.160056 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m20:44:22.162351 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m20:44:22.165071 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m20:44:22.168342 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m20:44:22.170504 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m20:44:22.182053 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m20:44:22.183869 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 20:44:22.172023 => 20:44:22.183267
[0m20:44:22.184946 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m20:44:22.190446 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:44:22.886230 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m20:44:22.887031 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m20:44:23.520613 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9f0ff062-6878-4dcd-93c6-4c1c4f4cee6d&page=queryresults
[0m20:44:26.656483 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 20:44:22.185565 => 20:44:26.655505
[0m20:44:26.659816 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9de36924-b7c1-41cb-9ae3-0dd0b110a7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54646a6820>]}
[0m20:44:26.662653 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.49s]
[0m20:44:26.665874 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m20:44:26.672480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:44:26.674249 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m20:44:26.676114 [info ] [MainThread]: 
[0m20:44:26.678139 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 27.25 seconds (27.25s).
[0m20:44:26.685690 [debug] [MainThread]: Command end result
[0m20:44:26.717098 [info ] [MainThread]: 
[0m20:44:26.717746 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:44:26.718268 [info ] [MainThread]: 
[0m20:44:26.718787 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  No matching signature for function FORMAT for argument types: FLOAT64, INT64. Supported signature: FORMAT(STRING, [ANY, ...]) at [21:21]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m20:44:26.719332 [info ] [MainThread]: 
[0m20:44:26.719871 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m20:44:26.720581 [debug] [MainThread]: Command `dbt run` failed at 20:44:26.720452 after 28.10 seconds
[0m20:44:26.721087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f547faabe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f546580cd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54656ec370>]}
[0m20:44:26.721594 [debug] [MainThread]: Flushing usage events
[0m20:45:28.459659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0625a34d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f062336d880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f062336d8b0>]}


============================== 20:45:28.464511 | 13165e42-25c2-419b-8b9a-0234e881c539 ==============================
[0m20:45:28.464511 [info ] [MainThread]: Running with dbt=1.6.5
[0m20:45:28.465107 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/includes/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:45:29.041066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13165e42-25c2-419b-8b9a-0234e881c539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06233db7f0>]}
[0m20:45:29.051876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13165e42-25c2-419b-8b9a-0234e881c539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f060b7addf0>]}
[0m20:45:29.052481 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m20:45:29.068898 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m20:45:29.153911 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:45:29.154564 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m20:45:29.196474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13165e42-25c2-419b-8b9a-0234e881c539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f060b60ce50>]}
[0m20:45:29.211198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13165e42-25c2-419b-8b9a-0234e881c539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f060b6b61f0>]}
[0m20:45:29.211701 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m20:45:29.212120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13165e42-25c2-419b-8b9a-0234e881c539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f060b6b6040>]}
[0m20:45:29.213632 [info ] [MainThread]: 
[0m20:45:29.214435 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:45:29.215669 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m20:45:29.216074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:45:29.885868 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m20:45:29.888047 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:45:30.538520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13165e42-25c2-419b-8b9a-0234e881c539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f060b5f0fd0>]}
[0m20:45:30.542070 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:45:30.543967 [info ] [MainThread]: 
[0m20:45:30.570759 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m20:45:30.572213 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m20:45:30.574016 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m20:45:30.575113 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m20:45:30.589125 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m20:45:30.590243 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 20:45:30.575773 => 20:45:30.589905
[0m20:45:30.590837 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m20:45:30.608123 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:45:31.257820 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m20:45:31.258612 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m20:45:31.977428 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a203e9ed-fc08-4b74-99bf-cbe9be501edb&page=queryresults
[0m20:45:35.085862 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 20:45:30.591243 => 20:45:35.085565
[0m20:45:35.086990 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13165e42-25c2-419b-8b9a-0234e881c539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f060af53e20>]}
[0m20:45:35.087933 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.51s]
[0m20:45:35.088908 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m20:45:35.089598 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m20:45:35.090342 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m20:45:35.091350 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m20:45:35.092039 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m20:45:35.101211 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m20:45:35.101967 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 20:45:35.092456 => 20:45:35.101749
[0m20:45:35.102378 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m20:45:35.104903 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:45:35.721089 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m20:45:35.724020 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m20:45:36.197259 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f2a32984-96d0-4fad-b5bf-6b0c72cc2c59&page=queryresults
[0m20:45:39.277374 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 20:45:35.102670 => 20:45:39.277175
[0m20:45:39.278130 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13165e42-25c2-419b-8b9a-0234e881c539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f060af53dc0>]}
[0m20:45:39.278751 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.19s]
[0m20:45:39.279491 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m20:45:39.279963 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m20:45:39.280577 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m20:45:39.281308 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m20:45:39.281742 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m20:45:39.285059 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m20:45:39.285758 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 20:45:39.282053 => 20:45:39.285539
[0m20:45:39.286192 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m20:45:39.288941 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:45:39.935742 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m20:45:39.938849 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
   SELECT
    *,
    initial_price * (1 - discount_percent / 100) AS discounted_price,
    (initial_price * (1 - discount_percent / 100)) * 1.75 AS price_with_tax,
    CONCAT('ARS$ ', FORMAT(CAST(initial_price * (1 - discount_percent / 100) AS STRING), 2)) AS formatted_discounted_price,
    CONCAT('ARS$ ', FORMAT(CAST((initial_price * (1 - discount_percent / 100)) * 1.75 AS STRING), 2)) AS formatted_price_with_tax
FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    *
FROM price_overview_cte
    );
  
[0m20:45:40.523857 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:8ed37d8a-a862-4aba-955c-d8d7d33bc34f&page=queryresults
[0m20:45:41.093143 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Too many arguments to FORMAT for pattern "0"; Expected 1; Got 2')
[0m20:45:41.714368 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:40b30161-a72e-42b1-a13e-02c6b307d55c&page=queryresults
[0m20:45:42.548620 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:40b30161-a72e-42b1-a13e-02c6b307d55c&page=queryresults
[0m20:45:42.549521 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 20:45:39.286499 => 20:45:42.549251
[0m20:45:42.553335 [debug] [Thread-1  ]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Too many arguments to FORMAT for pattern "0"; Expected 1; Got 2
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m20:45:42.553972 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13165e42-25c2-419b-8b9a-0234e881c539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f060a678ee0>]}
[0m20:45:42.554743 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 3.27s]
[0m20:45:42.555431 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m20:45:42.555923 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m20:45:42.556483 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m20:45:42.557211 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m20:45:42.557640 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m20:45:42.561249 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m20:45:42.562135 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 20:45:42.557941 => 20:45:42.561846
[0m20:45:42.563190 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m20:45:42.566451 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:45:43.205350 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m20:45:43.207520 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m20:45:43.812159 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:0101a527-beb1-43cd-8de3-b90817028c1c&page=queryresults
[0m20:45:46.742523 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 20:45:42.563603 => 20:45:46.742319
[0m20:45:46.743246 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13165e42-25c2-419b-8b9a-0234e881c539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f060a640df0>]}
[0m20:45:46.743830 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.19s]
[0m20:45:46.744493 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m20:45:46.744988 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m20:45:46.745449 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m20:45:46.746299 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m20:45:46.746703 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m20:45:46.749873 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m20:45:46.750540 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 20:45:46.746989 => 20:45:46.750326
[0m20:45:46.750934 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m20:45:46.753346 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:45:47.409973 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m20:45:47.410796 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m20:45:47.874673 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f9abdf1a-39ae-4757-933d-05c0e6c65825&page=queryresults
[0m20:45:50.670331 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 20:45:46.751217 => 20:45:50.669356
[0m20:45:50.673678 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13165e42-25c2-419b-8b9a-0234e881c539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06084b5e50>]}
[0m20:45:50.676499 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 3.93s]
[0m20:45:50.679646 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m20:45:50.681936 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m20:45:50.684557 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m20:45:50.687844 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m20:45:50.689986 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m20:45:50.700283 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m20:45:50.701999 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 20:45:50.691470 => 20:45:50.701459
[0m20:45:50.702914 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m20:45:50.708042 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:45:51.375002 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m20:45:51.375800 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m20:45:51.988756 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e3f794f3-7321-4d8a-a2af-f08346f4a37d&page=queryresults
[0m20:45:54.518139 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 20:45:50.703501 => 20:45:54.517182
[0m20:45:54.521516 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13165e42-25c2-419b-8b9a-0234e881c539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f060a67a820>]}
[0m20:45:54.524328 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 3.83s]
[0m20:45:54.525187 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m20:45:54.526856 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:45:54.527233 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m20:45:54.527652 [info ] [MainThread]: 
[0m20:45:54.528058 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 25.31 seconds (25.31s).
[0m20:45:54.529575 [debug] [MainThread]: Command end result
[0m20:45:54.542883 [info ] [MainThread]: 
[0m20:45:54.543375 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:45:54.543776 [info ] [MainThread]: 
[0m20:45:54.544172 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Too many arguments to FORMAT for pattern "0"; Expected 1; Got 2
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m20:45:54.544574 [info ] [MainThread]: 
[0m20:45:54.544996 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m20:45:54.545623 [debug] [MainThread]: Command `dbt run` failed at 20:45:54.545520 after 26.09 seconds
[0m20:45:54.546049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0625a34d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f060b7addf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f060b6b61f0>]}
[0m20:45:54.546478 [debug] [MainThread]: Flushing usage events
[0m20:47:12.408841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44ba05de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44b79f49d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44b79f49a0>]}


============================== 20:47:12.414583 | 11dd7da2-6229-4fdf-813d-5002cb9211a8 ==============================
[0m20:47:12.414583 [info ] [MainThread]: Running with dbt=1.6.5
[0m20:47:12.415196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/includes/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:47:12.991931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11dd7da2-6229-4fdf-813d-5002cb9211a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44b7a228e0>]}
[0m20:47:13.002926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11dd7da2-6229-4fdf-813d-5002cb9211a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f449fde4eb0>]}
[0m20:47:13.003561 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m20:47:13.019430 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m20:47:13.104942 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:47:13.105532 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m20:47:13.147152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11dd7da2-6229-4fdf-813d-5002cb9211a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f449fbdee80>]}
[0m20:47:13.161976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11dd7da2-6229-4fdf-813d-5002cb9211a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f449fcf1100>]}
[0m20:47:13.162475 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m20:47:13.162869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11dd7da2-6229-4fdf-813d-5002cb9211a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f449fcf1160>]}
[0m20:47:13.164393 [info ] [MainThread]: 
[0m20:47:13.165223 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:47:13.166482 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m20:47:13.166981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:47:13.860264 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m20:47:13.862493 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:47:14.534415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11dd7da2-6229-4fdf-813d-5002cb9211a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f449fc25c10>]}
[0m20:47:14.535167 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:47:14.535606 [info ] [MainThread]: 
[0m20:47:14.542260 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m20:47:14.542894 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m20:47:14.543653 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m20:47:14.544108 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m20:47:14.552403 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m20:47:14.553132 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 20:47:14.544430 => 20:47:14.552922
[0m20:47:14.553536 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m20:47:14.568911 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:47:15.283051 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m20:47:15.283791 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m20:47:15.914083 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:40774189-0fa8-447f-afb0-aed1a8c4f947&page=queryresults
[0m20:47:18.480779 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 20:47:14.553824 => 20:47:18.480465
[0m20:47:18.481878 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11dd7da2-6229-4fdf-813d-5002cb9211a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f449f387e20>]}
[0m20:47:18.482738 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 3.94s]
[0m20:47:18.483620 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m20:47:18.484208 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m20:47:18.484814 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m20:47:18.485831 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m20:47:18.486361 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m20:47:18.495171 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m20:47:18.495934 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 20:47:18.486740 => 20:47:18.495714
[0m20:47:18.496354 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m20:47:18.498936 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:47:19.153652 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m20:47:19.156611 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m20:47:19.696458 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:bcf18638-bc73-45de-8652-061470d0673f&page=queryresults
[0m20:47:22.796738 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 20:47:18.496659 => 20:47:22.796199
[0m20:47:22.798813 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11dd7da2-6229-4fdf-813d-5002cb9211a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f449f387970>]}
[0m20:47:22.800029 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.31s]
[0m20:47:22.801391 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m20:47:22.802464 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m20:47:22.803595 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m20:47:22.804797 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m20:47:22.805506 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m20:47:22.810390 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m20:47:22.811738 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 20:47:22.806018 => 20:47:22.811425
[0m20:47:22.812403 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m20:47:22.815884 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:47:23.433504 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m20:47:23.434346 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
   SELECT
    *,
    initial_price * (1 - discount_percent / 100) AS discounted_price,
    (initial_price * (1 - discount_percent / 100)) * 1.75 AS price_with_tax,
    CONCAT('ARS$ ', ROUND(initial_price * (1 - discount_percent / 100), 2)) AS formatted_discounted_price,
    CONCAT('ARS$ ', ROUND((initial_price * (1 - discount_percent / 100)) * 1.75, 2)) AS formatted_price_with_tax
FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    *
FROM price_overview_cte
    );
  
[0m20:47:24.020967 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:3b7c1f20-d583-4279-a733-08e49d2d2e54&page=queryresults
[0m20:47:27.066080 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 20:47:22.812918 => 20:47:27.065872
[0m20:47:27.066921 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11dd7da2-6229-4fdf-813d-5002cb9211a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f449e964760>]}
[0m20:47:27.067554 [info ] [Thread-1  ]: 3 of 6 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (2.7k rows, 1.4 MiB processed)[0m in 4.26s]
[0m20:47:27.068360 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m20:47:27.068912 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m20:47:27.069446 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m20:47:27.070227 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m20:47:27.070670 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m20:47:27.074108 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m20:47:27.074968 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 20:47:27.070975 => 20:47:27.074708
[0m20:47:27.075423 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m20:47:27.078106 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:47:27.735255 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m20:47:27.736704 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m20:47:28.217902 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a37c6705-9fcd-469c-893e-c71592fa4c0f&page=queryresults
[0m20:47:31.320396 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 20:47:27.075764 => 20:47:31.319879
[0m20:47:31.322249 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11dd7da2-6229-4fdf-813d-5002cb9211a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f449eac0160>]}
[0m20:47:31.323785 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.25s]
[0m20:47:31.325401 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m20:47:31.326377 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m20:47:31.327539 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m20:47:31.328868 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m20:47:31.329605 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m20:47:31.334888 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m20:47:31.335975 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 20:47:31.330118 => 20:47:31.335639
[0m20:47:31.336745 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m20:47:31.341762 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:47:32.002740 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m20:47:32.004389 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m20:47:32.616081 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:93906c17-d59e-4838-9dd2-8221644703ec&page=queryresults
[0m20:47:35.454816 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 20:47:31.338906 => 20:47:35.453840
[0m20:47:35.458168 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11dd7da2-6229-4fdf-813d-5002cb9211a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f449ead1fa0>]}
[0m20:47:35.461038 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.13s]
[0m20:47:35.464171 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m20:47:35.466455 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m20:47:35.469129 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m20:47:35.472341 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m20:47:35.474409 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m20:47:35.485190 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m20:47:35.486854 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 20:47:35.475881 => 20:47:35.486314
[0m20:47:35.487901 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m20:47:35.493394 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:47:36.152593 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m20:47:36.153381 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m20:47:36.700813 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:aab1d31b-e34f-42aa-a710-15cdc08b13dc&page=queryresults
[0m20:47:39.616009 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 20:47:35.488627 => 20:47:39.615798
[0m20:47:39.616858 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11dd7da2-6229-4fdf-813d-5002cb9211a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f449eaaf970>]}
[0m20:47:39.617507 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.15s]
[0m20:47:39.618235 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m20:47:39.619781 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:47:39.620154 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m20:47:39.620564 [info ] [MainThread]: 
[0m20:47:39.620993 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 26.46 seconds (26.46s).
[0m20:47:39.622515 [debug] [MainThread]: Command end result
[0m20:47:39.636238 [info ] [MainThread]: 
[0m20:47:39.636763 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:47:39.637223 [info ] [MainThread]: 
[0m20:47:39.637611 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m20:47:39.638248 [debug] [MainThread]: Command `dbt run` succeeded at 20:47:39.638144 after 27.23 seconds
[0m20:47:39.638654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44ba05de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f449fdd4cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f449fcf1340>]}
[0m20:47:39.639075 [debug] [MainThread]: Flushing usage events
[0m20:49:02.082243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2fe01ddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2fb95f970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2fb95f940>]}


============================== 20:49:02.087267 | b626be34-6627-4036-b818-085c2bf05d3e ==============================
[0m20:49:02.087267 [info ] [MainThread]: Running with dbt=1.6.5
[0m20:49:02.087905 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/includes/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:49:02.682715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b626be34-6627-4036-b818-085c2bf05d3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2fb993850>]}
[0m20:49:02.694401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b626be34-6627-4036-b818-085c2bf05d3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2e3d4de50>]}
[0m20:49:02.695148 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m20:49:02.712432 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m20:49:02.799114 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:49:02.799754 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m20:49:02.844384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b626be34-6627-4036-b818-085c2bf05d3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2e3b58eb0>]}
[0m20:49:02.859751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b626be34-6627-4036-b818-085c2bf05d3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2e3c69100>]}
[0m20:49:02.860277 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m20:49:02.860697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b626be34-6627-4036-b818-085c2bf05d3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2e3c690d0>]}
[0m20:49:02.862259 [info ] [MainThread]: 
[0m20:49:02.863063 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:49:02.864403 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m20:49:02.864988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:03.580820 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m20:49:03.582078 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:49:04.164331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b626be34-6627-4036-b818-085c2bf05d3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2e3b9ebb0>]}
[0m20:49:04.168001 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:49:04.171342 [info ] [MainThread]: 
[0m20:49:04.196150 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m20:49:04.197361 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m20:49:04.198821 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m20:49:04.199588 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m20:49:04.210570 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m20:49:04.211588 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 20:49:04.200140 => 20:49:04.211280
[0m20:49:04.212172 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m20:49:04.229315 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:49:04.904223 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m20:49:04.905047 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m20:49:05.461537 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:8f4870bb-101c-45ee-8ee0-c58e613e0aeb&page=queryresults
[0m20:49:08.253111 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 20:49:04.212532 => 20:49:08.252811
[0m20:49:08.254211 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b626be34-6627-4036-b818-085c2bf05d3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2e3301dc0>]}
[0m20:49:08.255100 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.06s]
[0m20:49:08.255959 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m20:49:08.256563 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m20:49:08.257181 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m20:49:08.258069 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m20:49:08.258712 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m20:49:08.267581 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m20:49:08.268354 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 20:49:08.259101 => 20:49:08.268123
[0m20:49:08.268770 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m20:49:08.271300 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:49:08.907552 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m20:49:08.910538 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m20:49:09.383775 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:4e58e5c0-5b7f-4753-bfab-a857998b6d65&page=queryresults
[0m20:49:12.132217 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 20:49:08.269065 => 20:49:12.131985
[0m20:49:12.133128 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b626be34-6627-4036-b818-085c2bf05d3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2e3301dc0>]}
[0m20:49:12.133816 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 3.88s]
[0m20:49:12.134483 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m20:49:12.134960 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m20:49:12.135448 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m20:49:12.136213 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m20:49:12.136630 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m20:49:12.139960 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m20:49:12.140721 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 20:49:12.136949 => 20:49:12.140479
[0m20:49:12.141137 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m20:49:12.143704 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:49:12.790587 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m20:49:12.791383 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
   SELECT
    currency,
    initial_price,
    final_price,
    discount_percent,
    formatted_initial_price,
    formatted_final_price,
    initial_price * (1 - discount_percent / 100) AS discounted_price,
    (initial_price * (1 - discount_percent / 100)) * 1.75 AS price_with_tax,
    CONCAT('ARS$ ', ROUND(initial_price * (1 - discount_percent / 100), 2)) AS formatted_discounted_price,
    CONCAT('ARS$ ', ROUND((initial_price * (1 - discount_percent / 100)) * 1.75, 2)) AS formatted_price_with_tax
FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    *
FROM price_overview_cte
    );
  
[0m20:49:13.412032 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:8195aa36-82c8-4970-b315-f8fc8994f5a2&page=queryresults
[0m20:49:16.484136 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 20:49:12.141432 => 20:49:16.483169
[0m20:49:16.487464 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b626be34-6627-4036-b818-085c2bf05d3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2e3301b50>]}
[0m20:49:16.490302 [info ] [Thread-1  ]: 3 of 6 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (2.7k rows, 98.5 KiB processed)[0m in 4.35s]
[0m20:49:16.493456 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m20:49:16.495701 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m20:49:16.498366 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m20:49:16.501595 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m20:49:16.503607 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m20:49:16.513322 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m20:49:16.514958 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 20:49:16.505093 => 20:49:16.514414
[0m20:49:16.515798 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m20:49:16.520445 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:49:17.189752 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m20:49:17.192746 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m20:49:17.805636 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:3a413124-7531-417a-be99-3080b952fd19&page=queryresults
[0m20:49:20.868123 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 20:49:16.516380 => 20:49:20.867156
[0m20:49:20.871430 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b626be34-6627-4036-b818-085c2bf05d3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2e3bac0d0>]}
[0m20:49:20.874231 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.37s]
[0m20:49:20.877333 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m20:49:20.879572 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m20:49:20.882193 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m20:49:20.885389 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m20:49:20.887377 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m20:49:20.900022 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m20:49:20.901712 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 20:49:20.888841 => 20:49:20.901171
[0m20:49:20.902724 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m20:49:20.907886 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:49:21.754205 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m20:49:21.755831 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m20:49:22.297131 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c4c324fe-0724-4d09-8cd3-160615904740&page=queryresults
[0m20:49:25.469977 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 20:49:20.903468 => 20:49:25.469012
[0m20:49:25.473289 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b626be34-6627-4036-b818-085c2bf05d3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2e2a48c40>]}
[0m20:49:25.476071 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.59s]
[0m20:49:25.479197 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m20:49:25.481472 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m20:49:25.484114 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m20:49:25.487329 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m20:49:25.489397 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m20:49:25.498769 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m20:49:25.500373 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 20:49:25.490641 => 20:49:25.499870
[0m20:49:25.501199 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m20:49:25.505914 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:49:26.198689 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m20:49:26.201800 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m20:49:26.871520 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a55c672b-3557-4547-b00c-80898103176a&page=queryresults
[0m20:49:29.690254 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 20:49:25.501783 => 20:49:29.689578
[0m20:49:29.692162 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b626be34-6627-4036-b818-085c2bf05d3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2e28e88b0>]}
[0m20:49:29.693801 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.21s]
[0m20:49:29.695529 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m20:49:29.698490 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:49:29.699303 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m20:49:29.700126 [info ] [MainThread]: 
[0m20:49:29.700983 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 26.84 seconds (26.84s).
[0m20:49:29.703562 [debug] [MainThread]: Command end result
[0m20:49:29.720810 [info ] [MainThread]: 
[0m20:49:29.721294 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:49:29.721671 [info ] [MainThread]: 
[0m20:49:29.722054 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m20:49:29.722642 [debug] [MainThread]: Command `dbt run` succeeded at 20:49:29.722532 after 27.65 seconds
[0m20:49:29.723047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2fe01ddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2e3d4de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2e3c692e0>]}
[0m20:49:29.723467 [debug] [MainThread]: Flushing usage events
[0m20:58:12.732694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f308c496f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3089e21a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3089e21a30>]}


============================== 20:58:12.737515 | e4c18a20-6f65-4faf-831e-6131cb2a7aab ==============================
[0m20:58:12.737515 [info ] [MainThread]: Running with dbt=1.6.5
[0m20:58:12.738103 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/includes/dbt/logs', 'profiles_dir': '/opt/airflow/includes/dbt/', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:58:13.315414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4c18a20-6f65-4faf-831e-6131cb2a7aab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3089e4d970>]}
[0m20:58:13.326798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4c18a20-6f65-4faf-831e-6131cb2a7aab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f307220af10>]}
[0m20:58:13.327502 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m20:58:13.344996 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m20:58:13.433282 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:58:13.433888 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m20:58:13.477380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4c18a20-6f65-4faf-831e-6131cb2a7aab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3072009ee0>]}
[0m20:58:13.492761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4c18a20-6f65-4faf-831e-6131cb2a7aab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30721181c0>]}
[0m20:58:13.493276 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m20:58:13.493713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4c18a20-6f65-4faf-831e-6131cb2a7aab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3072118190>]}
[0m20:58:13.495201 [info ] [MainThread]: 
[0m20:58:13.495980 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:58:13.497287 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m20:58:13.497743 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:58:14.216076 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m20:58:14.217115 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:58:14.822283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4c18a20-6f65-4faf-831e-6131cb2a7aab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3072009f10>]}
[0m20:58:14.825891 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:58:14.828021 [info ] [MainThread]: 
[0m20:58:14.856464 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m20:58:14.858824 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m20:58:14.861111 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m20:58:14.862628 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m20:58:14.877396 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m20:58:14.878399 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 20:58:14.863733 => 20:58:14.878095
[0m20:58:14.878961 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m20:58:14.896562 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:58:15.522504 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m20:58:15.523383 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m20:58:16.144656 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:80aca27c-187f-457c-9c88-9502f89f414b&page=queryresults
[0m20:58:19.126713 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 20:58:14.879329 => 20:58:19.126410
[0m20:58:19.127812 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4c18a20-6f65-4faf-831e-6131cb2a7aab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30719b0fa0>]}
[0m20:58:19.128657 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.27s]
[0m20:58:19.129547 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m20:58:19.130133 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m20:58:19.130846 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m20:58:19.131714 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m20:58:19.132229 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m20:58:19.141517 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m20:58:19.142278 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 20:58:19.132602 => 20:58:19.142056
[0m20:58:19.142698 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m20:58:19.145304 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:58:19.840069 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m20:58:19.841794 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m20:58:20.450513 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:bb7b9c67-781b-43e6-a16f-ac6192b22503&page=queryresults
[0m20:58:23.557069 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 20:58:19.142996 => 20:58:23.556634
[0m20:58:23.558475 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4c18a20-6f65-4faf-831e-6131cb2a7aab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30719b0d30>]}
[0m20:58:23.559676 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.43s]
[0m20:58:23.561145 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m20:58:23.562163 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m20:58:23.563392 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m20:58:23.564974 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m20:58:23.565867 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m20:58:23.572195 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m20:58:23.573651 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 20:58:23.566478 => 20:58:23.573172
[0m20:58:23.574508 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m20:58:23.579466 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:58:24.226696 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m20:58:24.228379 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
   SELECT
    currency,
    initial_price,
    final_price,
    discount_percent,
    formatted_initial_price
    CASE
        WHEN discount_percent > 0 THEN initial_price * (1 - discount_percent / 100)
        ELSE 0
    END AS discounted_price,
    CONCAT('ARS$ ',
        CASE
            WHEN discount_percent > 0 THEN ROUND(initial_price * (1 - discount_percent / 100), 2)
            ELSE '0.00'  -- Formato 0 para descuento nulo
        END
    ) AS formatted_discounted_price,
    CONCAT('ARS$ ', ROUND((initial_price * (1 - discount_percent / 100)) * 1.75, 2)) AS formatted_price_with_tax
FROM
   `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    *
FROM price_overview_cte
    );
  
[0m20:58:24.572980 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:2e680fd6-889f-4bbf-b730-61baf2fd7f69&page=queryresults
[0m20:58:24.574301 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword CASE at [23:5]')
[0m20:58:25.847475 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:1b5f7271-79e8-467e-b7a5-d026a26cf7b7&page=queryresults
[0m20:58:25.852150 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:1b5f7271-79e8-467e-b7a5-d026a26cf7b7&page=queryresults
[0m20:58:25.855572 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 20:58:23.575106 => 20:58:25.854515
[0m20:58:25.871320 [debug] [Thread-1  ]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Syntax error: Expected ")" but got keyword CASE at [23:5]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m20:58:25.873054 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4c18a20-6f65-4faf-831e-6131cb2a7aab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30710d2b20>]}
[0m20:58:25.874692 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 2.31s]
[0m20:58:25.876294 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m20:58:25.877754 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m20:58:25.879398 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m20:58:25.881518 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m20:58:25.882756 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m20:58:25.890134 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m20:58:25.891162 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 20:58:25.883768 => 20:58:25.890854
[0m20:58:25.891751 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m20:58:25.895332 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:58:26.530619 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m20:58:26.531702 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m20:58:26.994607 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:dcdcbfd5-7071-4f75-8d10-160b09a4f471&page=queryresults
[0m20:58:30.373975 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 20:58:25.892171 => 20:58:30.373559
[0m20:58:30.375388 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4c18a20-6f65-4faf-831e-6131cb2a7aab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3070fa2a90>]}
[0m20:58:30.376564 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.49s]
[0m20:58:30.377882 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m20:58:30.378812 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m20:58:30.379802 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m20:58:30.381367 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m20:58:30.382281 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m20:58:30.388833 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m20:58:30.390329 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 20:58:30.382922 => 20:58:30.389796
[0m20:58:30.391211 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m20:58:30.396144 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:58:30.995721 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m20:58:30.997584 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m20:58:31.525842 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:8168144c-db72-4685-b69b-2bc16d4812ef&page=queryresults
[0m20:58:34.424976 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 20:58:30.391812 => 20:58:34.424534
[0m20:58:34.426512 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4c18a20-6f65-4faf-831e-6131cb2a7aab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30719b0640>]}
[0m20:58:34.427777 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.05s]
[0m20:58:34.429100 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m20:58:34.430046 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m20:58:34.431163 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m20:58:34.432525 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m20:58:34.433382 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m20:58:34.439582 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m20:58:34.441415 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 20:58:34.433976 => 20:58:34.440906
[0m20:58:34.442304 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m20:58:34.447416 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:58:35.077398 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m20:58:35.080464 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m20:58:35.657596 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:621da803-db84-40da-a76a-98cd3fd1592b&page=queryresults
[0m20:58:38.499398 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 20:58:34.442912 => 20:58:38.499187
[0m20:58:38.500220 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4c18a20-6f65-4faf-831e-6131cb2a7aab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3070fa0880>]}
[0m20:58:38.500863 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.07s]
[0m20:58:38.501810 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m20:58:38.503266 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:58:38.503614 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m20:58:38.504016 [info ] [MainThread]: 
[0m20:58:38.504465 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 25.01 seconds (25.01s).
[0m20:58:38.506135 [debug] [MainThread]: Command end result
[0m20:58:38.519660 [info ] [MainThread]: 
[0m20:58:38.520285 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:58:38.521015 [info ] [MainThread]: 
[0m20:58:38.521387 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Syntax error: Expected ")" but got keyword CASE at [23:5]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m20:58:38.521758 [info ] [MainThread]: 
[0m20:58:38.522136 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m20:58:38.522719 [debug] [MainThread]: Command `dbt run` failed at 20:58:38.522613 after 25.80 seconds
[0m20:58:38.523119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f308c496f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30721182e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3072118400>]}
[0m20:58:38.523531 [debug] [MainThread]: Flushing usage events
[0m21:00:57.373283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ebd5dcf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ebaf60a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ebaf600a0>]}


============================== 21:00:57.378036 | 93bce7a4-615f-46e6-89ad-2ded7be4cc9b ==============================
[0m21:00:57.378036 [info ] [MainThread]: Running with dbt=1.6.5
[0m21:00:57.378624 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/includes/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:00:58.731223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93bce7a4-615f-46e6-89ad-2ded7be4cc9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ebaf8d940>]}
[0m21:00:58.742680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93bce7a4-615f-46e6-89ad-2ded7be4cc9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ea334eee0>]}
[0m21:00:58.743428 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m21:00:58.760604 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m21:00:58.853901 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:00:58.854559 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m21:00:58.899075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93bce7a4-615f-46e6-89ad-2ded7be4cc9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ea31aaeb0>]}
[0m21:00:58.914217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93bce7a4-615f-46e6-89ad-2ded7be4cc9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ea325e130>]}
[0m21:00:58.914753 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m21:00:58.915165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93bce7a4-615f-46e6-89ad-2ded7be4cc9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ea325e190>]}
[0m21:00:58.916637 [info ] [MainThread]: 
[0m21:00:58.917464 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:00:58.918906 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m21:00:58.919351 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:59.590742 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m21:00:59.591314 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:01:00.210489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93bce7a4-615f-46e6-89ad-2ded7be4cc9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ea31aafd0>]}
[0m21:01:00.212376 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:01:00.213518 [info ] [MainThread]: 
[0m21:01:00.227106 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m21:01:00.228017 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m21:01:00.229187 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m21:01:00.229944 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m21:01:00.241313 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m21:01:00.242407 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 21:01:00.230453 => 21:01:00.242076
[0m21:01:00.242961 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m21:01:00.262911 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:01:00.912010 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m21:01:00.912753 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m21:01:01.610908 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:44756dce-67ba-43df-ba7b-23b7f7f13cf4&page=queryresults
[0m21:01:05.912134 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 21:01:00.243336 => 21:01:05.911913
[0m21:01:05.913176 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93bce7a4-615f-46e6-89ad-2ded7be4cc9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ea28fae50>]}
[0m21:01:05.913875 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 5.68s]
[0m21:01:05.914572 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m21:01:05.915052 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m21:01:05.915599 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m21:01:05.916315 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m21:01:05.916741 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m21:01:05.925004 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m21:01:05.931487 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 21:01:05.917043 => 21:01:05.931188
[0m21:01:05.931968 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m21:01:05.934619 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:01:06.540881 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m21:01:06.545898 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m21:01:07.176581 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:05a46376-fde1-4ca3-b2a5-28b2b196560f&page=queryresults
[0m21:01:10.887371 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 21:01:05.932271 => 21:01:10.886396
[0m21:01:10.890766 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93bce7a4-615f-46e6-89ad-2ded7be4cc9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ea1fd31c0>]}
[0m21:01:10.893581 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.97s]
[0m21:01:10.896777 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m21:01:10.899067 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m21:01:10.901714 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m21:01:10.904980 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m21:01:10.907092 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m21:01:10.918379 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m21:01:10.920122 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 21:01:10.908598 => 21:01:10.919582
[0m21:01:10.921163 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m21:01:10.926362 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:01:11.541920 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m21:01:11.546166 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
   SELECT
    *,
    CASE
        WHEN discount_percent > 0 THEN initial_price * (1 - discount_percent / 100)
        ELSE 0
    END AS discounted_price,
    CONCAT('ARS$ ',
        CASE
            WHEN discount_percent > 0 THEN ROUND(initial_price * (1 - discount_percent / 100), 2)
            ELSE '0.00'  -- Formato 0 para descuento nulo
        END
    ) AS formatted_discounted_price,
    CONCAT('ARS$ ', ROUND((initial_price * (1 - discount_percent / 100)) * 1.75, 2)) AS formatted_price_with_tax
FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    *
FROM price_overview_cte
    );
  
[0m21:01:12.191854 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:cd145481-d4ec-404c-9466-94b89a2a9a13&page=queryresults
[0m21:01:12.844455 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for operator CASE; all THEN/ELSE arguments must be coercible to a common type but found: FLOAT64, STRING; actual argument types (WHEN THEN) ELSE: (BOOL FLOAT64) STRING at [24:9]')
[0m21:01:13.395812 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b1f76802-9e37-4343-ab9b-b4c1ad482b65&page=queryresults
[0m21:01:13.932363 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b1f76802-9e37-4343-ab9b-b4c1ad482b65&page=queryresults
[0m21:01:13.933145 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 21:01:10.921783 => 21:01:13.932912
[0m21:01:13.937945 [debug] [Thread-1  ]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  No matching signature for operator CASE; all THEN/ELSE arguments must be coercible to a common type but found: FLOAT64, STRING; actual argument types (WHEN THEN) ELSE: (BOOL FLOAT64) STRING at [24:9]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m21:01:13.938504 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93bce7a4-615f-46e6-89ad-2ded7be4cc9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ea200ef40>]}
[0m21:01:13.939131 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 3.03s]
[0m21:01:13.939787 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m21:01:13.940269 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m21:01:13.940758 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m21:01:13.941588 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m21:01:13.942005 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m21:01:13.945721 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m21:01:13.946476 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 21:01:13.942312 => 21:01:13.946252
[0m21:01:13.946900 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m21:01:13.950322 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:01:14.641570 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m21:01:14.642871 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m21:01:15.220005 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d35ac3f9-b04d-48b7-bfc0-b78740e8b5b0&page=queryresults
[0m21:01:18.281017 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 21:01:13.947201 => 21:01:18.280809
[0m21:01:18.281789 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93bce7a4-615f-46e6-89ad-2ded7be4cc9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ea31a0310>]}
[0m21:01:18.282416 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.34s]
[0m21:01:18.283169 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m21:01:18.283684 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m21:01:18.284213 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m21:01:18.284983 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m21:01:18.285562 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m21:01:18.288844 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m21:01:18.289597 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 21:01:18.285856 => 21:01:18.289373
[0m21:01:18.290029 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m21:01:18.292466 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:01:18.927681 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m21:01:18.928413 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m21:01:19.415018 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:38bb1112-da83-472d-9e2d-9e7f37bedbe3&page=queryresults
[0m21:01:22.189602 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 21:01:18.290317 => 21:01:22.189081
[0m21:01:22.191667 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93bce7a4-615f-46e6-89ad-2ded7be4cc9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ea064edf0>]}
[0m21:01:22.192906 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 3.91s]
[0m21:01:22.195058 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m21:01:22.196799 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m21:01:22.198093 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m21:01:22.199329 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m21:01:22.200054 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m21:01:22.204839 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m21:01:22.205991 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 21:01:22.200557 => 21:01:22.205679
[0m21:01:22.206614 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m21:01:22.210488 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:01:22.865391 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m21:01:22.866199 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m21:01:23.516840 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:cd289d11-cf89-4fbe-b5e8-ff01b38a33d8&page=queryresults
[0m21:01:26.665093 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 21:01:22.207082 => 21:01:26.664884
[0m21:01:26.665819 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93bce7a4-615f-46e6-89ad-2ded7be4cc9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ea2012af0>]}
[0m21:01:26.666409 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.47s]
[0m21:01:26.667106 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m21:01:26.668699 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:01:26.669052 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m21:01:26.669425 [info ] [MainThread]: 
[0m21:01:26.669831 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 27.75 seconds (27.75s).
[0m21:01:26.671375 [debug] [MainThread]: Command end result
[0m21:01:26.911298 [info ] [MainThread]: 
[0m21:01:26.913411 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:01:26.915201 [info ] [MainThread]: 
[0m21:01:26.917151 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  No matching signature for operator CASE; all THEN/ELSE arguments must be coercible to a common type but found: FLOAT64, STRING; actual argument types (WHEN THEN) ELSE: (BOOL FLOAT64) STRING at [24:9]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m21:01:26.919027 [info ] [MainThread]: 
[0m21:01:26.920937 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m21:01:26.923654 [debug] [MainThread]: Command `dbt run` failed at 21:01:26.923158 after 29.56 seconds
[0m21:01:26.925601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ebd5dcf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ea334ef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ea32686d0>]}
[0m21:01:26.927563 [debug] [MainThread]: Flushing usage events
[0m21:03:36.007215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f572bd7de20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57296ff940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57296ff910>]}


============================== 21:03:36.012682 | 19a85c9e-50b7-4f90-967a-da611dcc8f70 ==============================
[0m21:03:36.012682 [info ] [MainThread]: Running with dbt=1.6.5
[0m21:03:36.013240 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/includes/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:03:36.864947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19a85c9e-50b7-4f90-967a-da611dcc8f70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5729734880>]}
[0m21:03:36.876057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19a85c9e-50b7-4f90-967a-da611dcc8f70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5711ae8e80>]}
[0m21:03:36.876865 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m21:03:36.893936 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m21:03:36.984934 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:03:36.985564 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m21:03:37.029434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19a85c9e-50b7-4f90-967a-da611dcc8f70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57118e7ee0>]}
[0m21:03:37.044688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19a85c9e-50b7-4f90-967a-da611dcc8f70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57119f5130>]}
[0m21:03:37.045204 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m21:03:37.045598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19a85c9e-50b7-4f90-967a-da611dcc8f70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57119f5100>]}
[0m21:03:37.047074 [info ] [MainThread]: 
[0m21:03:37.047812 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:03:37.049094 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m21:03:37.049540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:03:37.732841 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m21:03:37.733438 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:03:38.396330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19a85c9e-50b7-4f90-967a-da611dcc8f70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f571192abe0>]}
[0m21:03:38.399342 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:03:38.401923 [info ] [MainThread]: 
[0m21:03:38.421384 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m21:03:38.422525 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m21:03:38.423885 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m21:03:38.424814 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m21:03:38.436889 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m21:03:38.437752 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 21:03:38.425328 => 21:03:38.437496
[0m21:03:38.438212 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m21:03:38.453984 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:03:39.052690 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m21:03:39.053461 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m21:03:39.584282 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a67f4a2c-834d-4828-8112-d280b808397e&page=queryresults
[0m21:03:42.577807 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 21:03:38.438537 => 21:03:42.577478
[0m21:03:42.578902 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19a85c9e-50b7-4f90-967a-da611dcc8f70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f571108ddc0>]}
[0m21:03:42.579757 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.16s]
[0m21:03:42.580698 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m21:03:42.581372 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m21:03:42.582176 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m21:03:42.583118 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m21:03:42.583636 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m21:03:42.593064 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m21:03:42.593979 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 21:03:42.584007 => 21:03:42.593720
[0m21:03:42.594433 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m21:03:42.597478 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:03:43.265839 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m21:03:43.267412 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m21:03:43.922888 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:35bcc2a6-0843-49c1-9d20-68fe3d457e32&page=queryresults
[0m21:03:46.447744 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 21:03:42.594733 => 21:03:46.446767
[0m21:03:46.451078 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19a85c9e-50b7-4f90-967a-da611dcc8f70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f571108db50>]}
[0m21:03:46.453991 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 3.87s]
[0m21:03:46.457198 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m21:03:46.459480 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m21:03:46.462148 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m21:03:46.465373 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m21:03:46.467398 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m21:03:46.476841 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m21:03:46.478423 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 21:03:46.468505 => 21:03:46.477995
[0m21:03:46.479274 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m21:03:46.484417 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:03:47.155542 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m21:03:47.158745 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
   SELECT
    *,
    CASE
        WHEN discount_percent > 0 THEN CAST(initial_price * (1 - discount_percent / 100) AS INTEGER)
        ELSE 0 
    END AS discounted_price,
    CONCAT('ARS$ ',
        CASE
            WHEN discount_percent > 0 THEN CONCAT(FORMAT(ROUND(initial_price * (1 - discount_percent / 100), 2), '0.00'))
            ELSE 'ARS$ 0.00'  -- Formato 0 para descuento nulo
        END
    ) AS formatted_discounted_price,
    CONCAT('ARS$ ', FORMAT(ROUND((initial_price * (1 - discount_percent / 100)) * 1.75, 2), '0.00')) AS formatted_price_with_tax
FROM
   `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    *
FROM price_overview_cte
    );
  
[0m21:03:47.803743 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:31122d18-2d98-42af-9a2e-891645f0cb94&page=queryresults
[0m21:03:48.551347 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for function FORMAT for argument types: FLOAT64, STRING. Supported signature: FORMAT(STRING, [ANY, ...]) at [25:51]')
[0m21:03:49.189351 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5b799d9d-b1fb-4219-8534-4c14008cdf9b&page=queryresults
[0m21:03:49.714370 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5b799d9d-b1fb-4219-8534-4c14008cdf9b&page=queryresults
[0m21:03:49.716248 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 21:03:46.479872 => 21:03:49.715711
[0m21:03:49.724629 [debug] [Thread-1  ]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  No matching signature for function FORMAT for argument types: FLOAT64, STRING. Supported signature: FORMAT(STRING, [ANY, ...]) at [25:51]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m21:03:49.725853 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19a85c9e-50b7-4f90-967a-da611dcc8f70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5710781af0>]}
[0m21:03:49.727350 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 3.26s]
[0m21:03:49.729030 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m21:03:49.730262 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m21:03:49.731722 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m21:03:49.733415 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m21:03:49.734459 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m21:03:49.742732 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m21:03:49.744573 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 21:03:49.735213 => 21:03:49.743986
[0m21:03:49.745717 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m21:03:49.751334 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:03:50.425327 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m21:03:50.426922 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m21:03:50.888449 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7752ffa3-6c60-4333-9e17-9351a4d186a7&page=queryresults
[0m21:03:53.721929 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 21:03:49.746467 => 21:03:53.720949
[0m21:03:53.725270 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19a85c9e-50b7-4f90-967a-da611dcc8f70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5711939190>]}
[0m21:03:53.727985 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 3.99s]
[0m21:03:53.730201 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m21:03:53.731794 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m21:03:53.733473 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m21:03:53.735194 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m21:03:53.736269 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m21:03:53.743080 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m21:03:53.744283 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 21:03:53.737089 => 21:03:53.743927
[0m21:03:53.744946 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m21:03:53.748052 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:03:54.436418 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m21:03:54.439451 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m21:03:55.019942 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5416426d-798f-4b41-b3be-5f1839ebaa65&page=queryresults
[0m21:03:57.518605 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 21:03:53.745238 => 21:03:57.517628
[0m21:03:57.521950 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19a85c9e-50b7-4f90-967a-da611dcc8f70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57105e8eb0>]}
[0m21:03:57.524792 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 3.79s]
[0m21:03:57.528141 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m21:03:57.530552 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m21:03:57.533219 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m21:03:57.536419 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m21:03:57.538478 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m21:03:57.549839 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m21:03:57.551621 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 21:03:57.539944 => 21:03:57.551067
[0m21:03:57.552703 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m21:03:57.558140 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:03:58.238884 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m21:03:58.242116 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m21:03:58.832193 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e64e4160-08ba-4299-985c-7dbdb74596c8&page=queryresults
[0m21:04:01.929789 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 21:03:57.553358 => 21:04:01.929468
[0m21:04:01.930873 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19a85c9e-50b7-4f90-967a-da611dcc8f70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57107ab310>]}
[0m21:04:01.931461 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.40s]
[0m21:04:01.932150 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m21:04:01.933640 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:04:01.934026 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m21:04:01.934429 [info ] [MainThread]: 
[0m21:04:01.934842 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 24.89 seconds (24.89s).
[0m21:04:01.936394 [debug] [MainThread]: Command end result
[0m21:04:01.953256 [info ] [MainThread]: 
[0m21:04:01.955607 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:04:01.956109 [info ] [MainThread]: 
[0m21:04:01.957095 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  No matching signature for function FORMAT for argument types: FLOAT64, STRING. Supported signature: FORMAT(STRING, [ANY, ...]) at [25:51]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m21:04:01.957569 [info ] [MainThread]: 
[0m21:04:01.958041 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m21:04:01.958759 [debug] [MainThread]: Command `dbt run` failed at 21:04:01.958624 after 25.96 seconds
[0m21:04:01.959307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f572bd7de20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5711b0fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57119f5370>]}
[0m21:04:01.959941 [debug] [MainThread]: Flushing usage events
[0m21:05:26.976344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f248e12df70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f248bab3a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f248bab3a00>]}


============================== 21:05:26.981134 | 9143e2de-f1cf-4c6d-993b-30d5874f13f4 ==============================
[0m21:05:26.981134 [info ] [MainThread]: Running with dbt=1.6.5
[0m21:05:26.981740 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/includes/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:05:27.543564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9143e2de-f1cf-4c6d-993b-30d5874f13f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f248badf970>]}
[0m21:05:27.554496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9143e2de-f1cf-4c6d-993b-30d5874f13f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2473e93f10>]}
[0m21:05:27.555127 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m21:05:27.571204 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m21:05:27.656713 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:05:27.657310 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m21:05:27.700252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9143e2de-f1cf-4c6d-993b-30d5874f13f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2473c94ee0>]}
[0m21:05:27.714976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9143e2de-f1cf-4c6d-993b-30d5874f13f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2473daa1c0>]}
[0m21:05:27.715481 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m21:05:27.715879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9143e2de-f1cf-4c6d-993b-30d5874f13f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2473daa190>]}
[0m21:05:27.717421 [info ] [MainThread]: 
[0m21:05:27.718266 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:05:27.719582 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m21:05:27.720079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:05:28.470211 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m21:05:28.472408 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:05:29.144037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9143e2de-f1cf-4c6d-993b-30d5874f13f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2473c94f10>]}
[0m21:05:29.147570 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:05:29.149503 [info ] [MainThread]: 
[0m21:05:29.176046 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m21:05:29.177454 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m21:05:29.179174 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m21:05:29.180205 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m21:05:29.194240 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m21:05:29.195207 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 21:05:29.180854 => 21:05:29.194934
[0m21:05:29.195725 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m21:05:29.212954 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:05:30.057300 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m21:05:30.058102 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m21:05:30.742168 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b591a3b8-fd54-4321-b344-351a4dde0328&page=queryresults
[0m21:05:33.781079 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 21:05:29.196093 => 21:05:33.780784
[0m21:05:33.782156 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9143e2de-f1cf-4c6d-993b-30d5874f13f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2473441e50>]}
[0m21:05:33.783007 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.60s]
[0m21:05:33.783955 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m21:05:33.784629 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m21:05:33.785271 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m21:05:33.786283 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m21:05:33.786827 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m21:05:33.796908 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m21:05:33.797710 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 21:05:33.787204 => 21:05:33.797477
[0m21:05:33.798179 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m21:05:33.801182 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:05:34.455960 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m21:05:34.458977 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m21:05:34.945304 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c1920d0e-88bb-4c4c-a072-84ff830253c9&page=queryresults
[0m21:05:38.087910 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 21:05:33.798507 => 21:05:38.086926
[0m21:05:38.091300 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9143e2de-f1cf-4c6d-993b-30d5874f13f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2473441df0>]}
[0m21:05:38.094259 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.30s]
[0m21:05:38.097502 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m21:05:38.099830 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m21:05:38.102572 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m21:05:38.105564 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m21:05:38.107059 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m21:05:38.115767 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m21:05:38.117299 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 21:05:38.108115 => 21:05:38.116778
[0m21:05:38.118173 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m21:05:38.123163 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:05:38.785308 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m21:05:38.786095 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
 SELECT
    *,
    CASE
        WHEN discount_percent > 0 THEN initial_price * (1 - discount_percent / 100)
        ELSE CAST(0 AS FLOAT64)  -- Convertir 0 a FLOAT64 para que coincida con el tipo de datos
    END AS discounted_price,
    CONCAT('ARS$ ',
        CASE
            WHEN discount_percent > 0 THEN ROUND(initial_price * (1 - discount_percent / 100), 2)
            ELSE 'ARS$ 0.00'  -- Formato 0 para descuento nulo
        END
    ) AS formatted_discounted_price,
    CONCAT('ARS$ ', ROUND((initial_price * (1 - discount_percent / 100)) * 1.75, 2)) AS formatted_price_with_tax
FROM
   `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    *
FROM price_overview_cte
    );
  
[0m21:05:39.291250 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:61632171-c56b-4702-ba3e-f4d00a03d705&page=queryresults
[0m21:05:39.815822 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for operator CASE; all THEN/ELSE arguments must be coercible to a common type but found: FLOAT64, STRING; actual argument types (WHEN THEN) ELSE: (BOOL FLOAT64) STRING at [24:9]')
[0m21:05:41.112019 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b626b687-26c9-4817-969c-5cdbd4ea5ed7&page=queryresults
[0m21:05:41.659960 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b626b687-26c9-4817-969c-5cdbd4ea5ed7&page=queryresults
[0m21:05:41.660909 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 21:05:38.118790 => 21:05:41.660668
[0m21:05:41.664333 [debug] [Thread-1  ]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  No matching signature for operator CASE; all THEN/ELSE arguments must be coercible to a common type but found: FLOAT64, STRING; actual argument types (WHEN THEN) ELSE: (BOOL FLOAT64) STRING at [24:9]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m21:05:41.664997 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9143e2de-f1cf-4c6d-993b-30d5874f13f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2472b63f70>]}
[0m21:05:41.665672 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 3.56s]
[0m21:05:41.666399 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m21:05:41.666887 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m21:05:41.667378 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m21:05:41.668212 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m21:05:41.668638 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m21:05:41.672362 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m21:05:41.673420 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 21:05:41.668981 => 21:05:41.673095
[0m21:05:41.673928 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m21:05:41.676832 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:05:42.342051 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m21:05:42.342806 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m21:05:42.950474 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d53a05a8-74a8-4754-8c12-b0d6b0707ab7&page=queryresults
[0m21:05:45.723884 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 21:05:41.674246 => 21:05:45.722921
[0m21:05:45.727215 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9143e2de-f1cf-4c6d-993b-30d5874f13f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2472b36f40>]}
[0m21:05:45.730073 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.06s]
[0m21:05:45.733240 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m21:05:45.735511 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m21:05:45.738189 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m21:05:45.741388 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m21:05:45.743397 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m21:05:45.753419 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m21:05:45.755125 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 21:05:45.744881 => 21:05:45.754608
[0m21:05:45.755979 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m21:05:45.761128 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:05:46.435183 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m21:05:46.437584 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m21:05:46.951862 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:035fa60d-de06-4e58-8064-a9a8b61d3d99&page=queryresults
[0m21:05:52.382976 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 21:05:45.756579 => 21:05:52.382674
[0m21:05:52.383887 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9143e2de-f1cf-4c6d-993b-30d5874f13f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f247099eeb0>]}
[0m21:05:52.384640 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 6.64s]
[0m21:05:52.385488 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m21:05:52.386106 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m21:05:52.386735 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m21:05:52.387704 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m21:05:52.388222 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m21:05:52.391943 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m21:05:52.392764 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 21:05:52.388564 => 21:05:52.392502
[0m21:05:52.393227 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m21:05:52.395961 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:05:53.082269 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m21:05:53.083004 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m21:05:53.551424 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ba911b4e-6348-4e3b-9554-04c0b399bccc&page=queryresults
[0m21:05:56.403818 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 21:05:52.393527 => 21:05:56.402780
[0m21:05:56.407476 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9143e2de-f1cf-4c6d-993b-30d5874f13f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f247099ed60>]}
[0m21:05:56.410600 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.02s]
[0m21:05:56.414071 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m21:05:56.420097 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:05:56.421659 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m21:05:56.423249 [info ] [MainThread]: 
[0m21:05:56.424350 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 28.71 seconds (28.71s).
[0m21:05:56.428517 [debug] [MainThread]: Command end result
[0m21:05:56.449671 [info ] [MainThread]: 
[0m21:05:56.450506 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:05:56.450936 [info ] [MainThread]: 
[0m21:05:56.451350 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  No matching signature for operator CASE; all THEN/ELSE arguments must be coercible to a common type but found: FLOAT64, STRING; actual argument types (WHEN THEN) ELSE: (BOOL FLOAT64) STRING at [24:9]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m21:05:56.451796 [info ] [MainThread]: 
[0m21:05:56.452224 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m21:05:56.452912 [debug] [MainThread]: Command `dbt run` failed at 21:05:56.452793 after 29.48 seconds
[0m21:05:56.453337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f248e12df70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2473daa2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2473daa400>]}
[0m21:05:56.453769 [debug] [MainThread]: Flushing usage events
[0m21:07:18.329195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aa461adf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aa1fc9850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aa1fc9070>]}


============================== 21:07:18.333992 | cdae7ae5-87ce-4996-901f-5799a4e31ac9 ==============================
[0m21:07:18.333992 [info ] [MainThread]: Running with dbt=1.6.5
[0m21:07:18.334607 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/includes/dbt/logs', 'profiles_dir': '/opt/airflow/includes/dbt/', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:07:18.894523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cdae7ae5-87ce-4996-901f-5799a4e31ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aa2037820>]}
[0m21:07:18.906308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cdae7ae5-87ce-4996-901f-5799a4e31ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a8a402bb0>]}
[0m21:07:18.907114 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m21:07:18.925336 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m21:07:19.015154 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:07:19.015770 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m21:07:19.058378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdae7ae5-87ce-4996-901f-5799a4e31ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a8a195e20>]}
[0m21:07:19.073119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cdae7ae5-87ce-4996-901f-5799a4e31ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a8a2ab760>]}
[0m21:07:19.073641 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m21:07:19.074068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdae7ae5-87ce-4996-901f-5799a4e31ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a8a29e250>]}
[0m21:07:19.075509 [info ] [MainThread]: 
[0m21:07:19.076268 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:07:19.077552 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m21:07:19.077963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:07:19.902809 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m21:07:19.903320 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:07:20.535054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdae7ae5-87ce-4996-901f-5799a4e31ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a8a1d8b50>]}
[0m21:07:20.535907 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:07:20.536387 [info ] [MainThread]: 
[0m21:07:20.543384 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m21:07:20.543997 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m21:07:20.545282 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m21:07:20.545913 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m21:07:20.557446 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m21:07:20.558357 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 21:07:20.546374 => 21:07:20.558103
[0m21:07:20.558839 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m21:07:20.575835 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:07:21.307681 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m21:07:21.308428 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m21:07:21.772639 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5996912a-f254-483f-a455-6754b0d3d7c5&page=queryresults
[0m21:07:24.937374 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 21:07:20.559151 => 21:07:24.937028
[0m21:07:24.938535 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdae7ae5-87ce-4996-901f-5799a4e31ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a89b3ae80>]}
[0m21:07:24.939388 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.39s]
[0m21:07:24.940316 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m21:07:24.940991 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m21:07:24.941798 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m21:07:24.942796 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m21:07:24.943326 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m21:07:24.952717 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m21:07:24.953685 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 21:07:24.943698 => 21:07:24.953432
[0m21:07:24.954162 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m21:07:24.957037 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:07:25.635065 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m21:07:25.638159 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m21:07:26.252807 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:2ea652dc-246e-499a-bd26-11fecad52d9e&page=queryresults
[0m21:07:28.972965 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 21:07:24.954466 => 21:07:28.971932
[0m21:07:28.976266 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdae7ae5-87ce-4996-901f-5799a4e31ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a89b3a340>]}
[0m21:07:28.979127 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.03s]
[0m21:07:28.982442 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m21:07:28.984723 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m21:07:28.987365 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m21:07:28.990587 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m21:07:28.992621 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m21:07:29.002034 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m21:07:29.003636 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 21:07:28.993732 => 21:07:29.003193
[0m21:07:29.004477 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m21:07:29.009738 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:07:29.663229 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m21:07:29.666925 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
SELECT
    *,
    CASE
        WHEN discount_percent > 0 THEN CAST(initial_price * (1 - discount_percent / 100) AS FLOAT64)
        ELSE 0.0  -- 0.0 para descuento nulo
    END AS discounted_price,
    CONCAT('ARS$ ',
        CASE
            WHEN discount_percent > 0 THEN FORMAT(ROUND(initial_price * (1 - discount_percent / 100), 2))
            ELSE 'ARS$ 0.00'  -- Formato "ARS$ 0.00" para descuento nulo
        END
    ) AS formatted_discounted_price,
    CONCAT('ARS$ ', FORMAT(ROUND((initial_price * (1 - discount_percent / 100)) * 1.75, 2))) AS formatted_price_with_tax
FROM
   `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    *
FROM price_overview_cte
    );
  
[0m21:07:30.134473 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ee084daf-3b70-4629-87eb-b6a4e29ca638&page=queryresults
[0m21:07:30.677328 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for function FORMAT for argument types: FLOAT64. Supported signature: FORMAT(STRING, [ANY, ...]) at [25:44]')
[0m21:07:31.881321 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:2ac00b8d-7aec-4f1b-acb0-583e8830ccd7&page=queryresults
[0m21:07:32.412379 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:2ac00b8d-7aec-4f1b-acb0-583e8830ccd7&page=queryresults
[0m21:07:32.415861 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 21:07:29.005097 => 21:07:32.414826
[0m21:07:32.420977 [debug] [Thread-1  ]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  No matching signature for function FORMAT for argument types: FLOAT64. Supported signature: FORMAT(STRING, [ANY, ...]) at [25:44]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m21:07:32.421577 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdae7ae5-87ce-4996-901f-5799a4e31ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a89255f10>]}
[0m21:07:32.422291 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 3.43s]
[0m21:07:32.423013 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m21:07:32.423516 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m21:07:32.424037 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m21:07:32.424893 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m21:07:32.425364 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m21:07:32.429704 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m21:07:32.430566 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 21:07:32.425700 => 21:07:32.430303
[0m21:07:32.431038 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m21:07:32.433907 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:07:33.068831 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m21:07:33.071837 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m21:07:33.687081 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:aae2d6fe-b57c-4ffe-9535-bb118471a550&page=queryresults
[0m21:07:36.626031 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 21:07:32.431363 => 21:07:36.625675
[0m21:07:36.626861 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdae7ae5-87ce-4996-901f-5799a4e31ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a89b3a520>]}
[0m21:07:36.627552 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.20s]
[0m21:07:36.628290 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m21:07:36.628809 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m21:07:36.629376 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m21:07:36.630154 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m21:07:36.630621 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m21:07:36.634631 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m21:07:36.635464 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 21:07:36.630937 => 21:07:36.635216
[0m21:07:36.636054 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m21:07:36.639040 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:07:37.307572 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m21:07:37.308291 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m21:07:37.890653 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:267232d4-df89-4cd3-abe5-66f9e8d61ca3&page=queryresults
[0m21:07:40.414997 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 21:07:36.636416 => 21:07:40.414016
[0m21:07:40.418397 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdae7ae5-87ce-4996-901f-5799a4e31ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a88096910>]}
[0m21:07:40.421421 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 3.79s]
[0m21:07:40.424714 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m21:07:40.427079 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m21:07:40.429882 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m21:07:40.433143 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m21:07:40.435188 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m21:07:40.446065 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m21:07:40.447768 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 21:07:40.436683 => 21:07:40.447210
[0m21:07:40.448859 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m21:07:40.454017 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:07:41.136777 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m21:07:41.139830 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m21:07:41.653132 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:968e11db-f0c1-4004-b9e7-18a0daa60258&page=queryresults
[0m21:07:44.461296 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 21:07:40.449518 => 21:07:44.461048
[0m21:07:44.462194 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdae7ae5-87ce-4996-901f-5799a4e31ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a89258820>]}
[0m21:07:44.462941 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.03s]
[0m21:07:44.463780 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m21:07:44.469585 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:07:44.470034 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m21:07:44.470448 [info ] [MainThread]: 
[0m21:07:44.470871 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 25.39 seconds (25.39s).
[0m21:07:44.472415 [debug] [MainThread]: Command end result
[0m21:07:44.488267 [info ] [MainThread]: 
[0m21:07:44.488818 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:07:44.489414 [info ] [MainThread]: 
[0m21:07:44.489827 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  No matching signature for function FORMAT for argument types: FLOAT64. Supported signature: FORMAT(STRING, [ANY, ...]) at [25:44]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m21:07:44.490243 [info ] [MainThread]: 
[0m21:07:44.490684 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m21:07:44.491322 [debug] [MainThread]: Command `dbt run` failed at 21:07:44.491202 after 26.17 seconds
[0m21:07:44.491746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aa461adf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a8a402bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a8a3b1070>]}
[0m21:07:44.492198 [debug] [MainThread]: Flushing usage events
[0m21:08:44.334803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f781a5bce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7817f4ba00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7817f4b070>]}


============================== 21:08:44.339535 | bc8843a1-ca22-4df2-a280-597c18864941 ==============================
[0m21:08:44.339535 [info ] [MainThread]: Running with dbt=1.6.5
[0m21:08:44.340101 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/includes/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:08:44.898362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc8843a1-ca22-4df2-a280-597c18864941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7817f78910>]}
[0m21:08:44.909366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc8843a1-ca22-4df2-a280-597c18864941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f780031feb0>]}
[0m21:08:44.909999 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m21:08:44.926448 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m21:08:45.012708 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:08:45.013415 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m21:08:45.056300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc8843a1-ca22-4df2-a280-597c18864941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7800183e80>]}
[0m21:08:45.071025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc8843a1-ca22-4df2-a280-597c18864941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7800236100>]}
[0m21:08:45.071530 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m21:08:45.071936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc8843a1-ca22-4df2-a280-597c18864941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7800236160>]}
[0m21:08:45.073457 [info ] [MainThread]: 
[0m21:08:45.074250 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:08:45.075539 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m21:08:45.076022 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:08:45.762485 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m21:08:45.764748 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:08:46.423651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc8843a1-ca22-4df2-a280-597c18864941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f780016bc10>]}
[0m21:08:46.427145 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:08:46.429087 [info ] [MainThread]: 
[0m21:08:46.455500 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m21:08:46.456879 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m21:08:46.458739 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m21:08:46.459842 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m21:08:46.474233 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m21:08:46.475382 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 21:08:46.460467 => 21:08:46.475025
[0m21:08:46.476060 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m21:08:46.497752 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:08:47.186909 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m21:08:47.187633 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m21:08:47.826161 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a8afca53-10ba-487d-958e-3d1588e04828&page=queryresults
[0m21:08:50.620813 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 21:08:46.476545 => 21:08:50.620571
[0m21:08:50.621596 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc8843a1-ca22-4df2-a280-597c18864941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77ffacbeb0>]}
[0m21:08:50.622206 [info ] [Thread-1  ]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.16s]
[0m21:08:50.622921 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m21:08:50.623379 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m21:08:50.623966 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m21:08:50.624754 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m21:08:50.625185 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m21:08:50.633992 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m21:08:50.635000 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 21:08:50.625483 => 21:08:50.634706
[0m21:08:50.635541 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m21:08:50.638451 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:08:51.256253 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m21:08:51.257055 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m21:08:51.761214 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7a317964-4436-42ed-b756-e944866bd2a7&page=queryresults
[0m21:08:54.577537 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 21:08:50.635880 => 21:08:54.576507
[0m21:08:54.581001 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc8843a1-ca22-4df2-a280-597c18864941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77ff0d6bb0>]}
[0m21:08:54.583912 [info ] [Thread-1  ]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 3.96s]
[0m21:08:54.587219 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m21:08:54.589772 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m21:08:54.591785 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m21:08:54.594341 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m21:08:54.595562 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m21:08:54.603167 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m21:08:54.604683 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 21:08:54.596345 => 21:08:54.604162
[0m21:08:54.605469 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m21:08:54.609779 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:08:55.247045 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m21:08:55.247765 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        *,
        CASE
            WHEN discount_percent > 0 THEN initial_price * (1 - discount_percent / 100)
            ELSE 0.0  -- Cambiamos 0 a 0.0 para que coincida con FLOAT64
        END AS discounted_price,
        CONCAT('ARS$ ',
            CASE
                WHEN discount_percent > 0 THEN CAST(ROUND(initial_price * (1 - discount_percent / 100), 2) AS STRING)
                ELSE 'ARS$ 0.00'  -- Formato 0 para descuento nulo
            END
        ) AS formatted_discounted_price,
        CONCAT('ARS$ ', CAST(ROUND((initial_price * (1 - discount_percent / 100)) * 1.75, 2) AS STRING)) AS formatted_price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    *
FROM price_overview_cte
    );
  
[0m21:08:55.738610 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:618e9bd8-0479-4fbb-aebd-e583c7953349&page=queryresults
[0m21:08:59.067404 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 21:08:54.605984 => 21:08:59.067126
[0m21:08:59.068384 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc8843a1-ca22-4df2-a280-597c18864941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77ff0b97c0>]}
[0m21:08:59.069217 [info ] [Thread-1  ]: 3 of 6 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (2.7k rows, 1.4 MiB processed)[0m in 4.47s]
[0m21:08:59.070168 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m21:08:59.070799 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m21:08:59.071510 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m21:08:59.072483 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m21:08:59.073064 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m21:08:59.076969 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m21:08:59.077771 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 21:08:59.073422 => 21:08:59.077518
[0m21:08:59.078224 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m21:08:59.080782 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:08:59.705252 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m21:08:59.706906 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m21:09:00.520785 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:fe1ee108-7ac4-4c2d-83ba-ae68323cf730&page=queryresults
[0m21:09:04.032141 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 21:08:59.078530 => 21:09:04.031935
[0m21:09:04.032898 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc8843a1-ca22-4df2-a280-597c18864941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77ff0d65b0>]}
[0m21:09:04.033522 [info ] [Thread-1  ]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.96s]
[0m21:09:04.034227 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m21:09:04.034756 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m21:09:04.035368 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m21:09:04.036307 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m21:09:04.036819 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m21:09:04.040102 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m21:09:04.040845 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 21:09:04.037112 => 21:09:04.040583
[0m21:09:04.041305 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m21:09:04.043856 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:09:04.715751 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m21:09:04.716617 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m21:09:05.249000 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ed1e3d0e-cbfe-4493-9729-65cdf88e031a&page=queryresults
[0m21:09:08.367796 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 21:09:04.041607 => 21:09:08.366972
[0m21:09:08.370546 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc8843a1-ca22-4df2-a280-597c18864941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77ffacb520>]}
[0m21:09:08.372902 [info ] [Thread-1  ]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.33s]
[0m21:09:08.375658 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m21:09:08.377561 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m21:09:08.379744 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m21:09:08.382395 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m21:09:08.384069 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m21:09:08.393442 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m21:09:08.395019 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 21:09:08.385299 => 21:09:08.394529
[0m21:09:08.395962 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m21:09:08.400963 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:09:09.063469 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m21:09:09.066455 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m21:09:09.679127 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:83c233de-393f-4323-bc7b-ff42fec9eea0&page=queryresults
[0m21:09:13.027232 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 21:09:08.396636 => 21:09:13.026240
[0m21:09:13.030857 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc8843a1-ca22-4df2-a280-597c18864941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77ff209220>]}
[0m21:09:13.033769 [info ] [Thread-1  ]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.65s]
[0m21:09:13.037226 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m21:09:13.043717 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:09:13.045565 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m21:09:13.047447 [info ] [MainThread]: 
[0m21:09:13.049855 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 27.97 seconds (27.97s).
[0m21:09:13.055957 [debug] [MainThread]: Command end result
[0m21:09:13.078948 [info ] [MainThread]: 
[0m21:09:13.079528 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:09:13.079991 [info ] [MainThread]: 
[0m21:09:13.080465 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m21:09:13.081187 [debug] [MainThread]: Command `dbt run` succeeded at 21:09:13.081057 after 28.75 seconds
[0m21:09:13.081669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f781a5bce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f780023e730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f780031ffa0>]}
[0m21:09:13.082147 [debug] [MainThread]: Flushing usage events
[0m03:53:43.138823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef0400de20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef0199d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef0199d070>]}


============================== 03:53:43.144141 | 63f636e4-23b0-4ffc-b715-a98e0c77aac0 ==============================
[0m03:53:43.144141 [info ] [MainThread]: Running with dbt=1.6.5
[0m03:53:43.144712 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/includes/dbt/logs', 'profiles_dir': '/opt/airflow/includes/dbt/', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:53:44.078629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63f636e4-23b0-4ffc-b715-a98e0c77aac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef019d1880>]}
[0m03:53:44.089778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63f636e4-23b0-4ffc-b715-a98e0c77aac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feee9d7ce80>]}
[0m03:53:44.090510 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m03:53:44.107293 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m03:53:44.192972 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:53:44.193561 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m03:53:44.235391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63f636e4-23b0-4ffc-b715-a98e0c77aac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feee9b84ee0>]}
[0m03:53:44.251721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63f636e4-23b0-4ffc-b715-a98e0c77aac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feee9c95130>]}
[0m03:53:44.252221 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m03:53:44.252651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63f636e4-23b0-4ffc-b715-a98e0c77aac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feee9c95100>]}
[0m03:53:44.254143 [info ] [MainThread]: 
[0m03:53:44.254968 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:53:44.256220 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m03:53:44.256635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:53:44.947744 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m03:53:44.949953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:53:45.613327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63f636e4-23b0-4ffc-b715-a98e0c77aac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feee9bcabe0>]}
[0m03:53:45.614137 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:53:45.614590 [info ] [MainThread]: 
[0m03:53:45.621172 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m03:53:45.621763 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m03:53:45.622486 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m03:53:45.622924 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m03:53:45.631596 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m03:53:45.632403 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 03:53:45.623235 => 03:53:45.632137
[0m03:53:45.632829 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m03:53:45.648444 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:53:46.336933 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m03:53:46.337755 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m03:53:46.750886 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:333c2068-086f-49cc-a97a-4861db38d9c6&page=queryresults
[0m03:53:46.755982 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m03:53:46.758381 [debug] [Thread-1  ]: BigQuery adapter: 404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US

Location: US
Job ID: 333c2068-086f-49cc-a97a-4861db38d9c6

[0m03:53:46.761347 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 03:53:45.633171 => 03:53:46.760320
[0m03:53:46.779745 [debug] [Thread-1  ]: Runtime Error in model dim_developers (models/transform/dim_developers.sql)
  404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US
  
  Location: US
  Job ID: 333c2068-086f-49cc-a97a-4861db38d9c6
  
[0m03:53:46.782060 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63f636e4-23b0-4ffc-b715-a98e0c77aac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feee8b2fc10>]}
[0m03:53:46.784087 [error] [Thread-1  ]: 1 of 6 ERROR creating sql table model games.dim_developers ..................... [[31mERROR[0m in 1.16s]
[0m03:53:46.786322 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m03:53:46.787742 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m03:53:46.789191 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m03:53:46.790969 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m03:53:46.792008 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m03:53:46.805878 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m03:53:46.806919 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 03:53:46.792674 => 03:53:46.806608
[0m03:53:46.807498 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m03:53:46.810658 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:53:47.440902 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m03:53:47.441713 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m03:53:47.830734 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7bbd5899-815c-4c14-ad36-5964999efc2f&page=queryresults
[0m03:53:47.833860 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m03:53:47.834346 [debug] [Thread-1  ]: BigQuery adapter: 404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US

Location: US
Job ID: 7bbd5899-815c-4c14-ad36-5964999efc2f

[0m03:53:47.834953 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 03:53:46.807866 => 03:53:47.834745
[0m03:53:47.836178 [debug] [Thread-1  ]: Runtime Error in model dim_platforms (models/transform/dim_platforms.sql)
  404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US
  
  Location: US
  Job ID: 7bbd5899-815c-4c14-ad36-5964999efc2f
  
[0m03:53:47.836634 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63f636e4-23b0-4ffc-b715-a98e0c77aac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feee9530160>]}
[0m03:53:47.837281 [error] [Thread-1  ]: 2 of 6 ERROR creating sql table model games.dim_platforms ...................... [[31mERROR[0m in 1.05s]
[0m03:53:47.837968 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m03:53:47.838443 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m03:53:47.839055 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m03:53:47.839763 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m03:53:47.840191 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m03:53:47.843408 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m03:53:47.844115 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 03:53:47.840478 => 03:53:47.843862
[0m03:53:47.844557 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m03:53:47.847039 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:53:48.475965 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m03:53:48.477093 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
    *,
    CASE
        WHEN discount_percent > 0 THEN initial_price * (1 - discount_percent / 100)
        ELSE 0.0  -- Cambiamos 0 a 0.0 para que coincida con FLOAT64
    END AS discounted_price,
    CONCAT('ARS$ ',
        CASE
            WHEN discount_percent > 0 THEN FORMAT(ROUND(initial_price * (1 - discount_percent / 100), 2), 'N')
            ELSE 'ARS$ 0.00'  -- Formato 0 para descuento nulo
        END
    ) AS formatted_discounted_price,
    CONCAT('ARS$ ', FORMAT(ROUND((initial_price * (1 - discount_percent / 100)) * 1.75, 2), 'N')) AS formatted_price_with_tax
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    *
FROM price_overview_cte
    );
  
[0m03:53:48.925011 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:4bfab9c1-337a-4441-b54a-edb0dceb0069&page=queryresults
[0m03:53:48.929818 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
    *,
    CASE
        WHEN discount_percent > 0 THEN initial_price * (1 - discount_percent / 100)
        ELSE 0.0  -- Cambiamos 0 a 0.0 para que coincida con FLOAT64
    END AS discounted_price,
    CONCAT('ARS$ ',
        CASE
            WHEN discount_percent > 0 THEN FORMAT(ROUND(initial_price * (1 - discount_percent / 100), 2), 'N')
            ELSE 'ARS$ 0.00'  -- Formato 0 para descuento nulo
        END
    ) AS formatted_discounted_price,
    CONCAT('ARS$ ', FORMAT(ROUND((initial_price * (1 - discount_percent / 100)) * 1.75, 2), 'N')) AS formatted_price_with_tax
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    *
FROM price_overview_cte
    );
  
[0m03:53:48.932234 [debug] [Thread-1  ]: BigQuery adapter: 404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US

Location: US
Job ID: 4bfab9c1-337a-4441-b54a-edb0dceb0069

[0m03:53:48.935231 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 03:53:47.844875 => 03:53:48.934235
[0m03:53:48.941170 [debug] [Thread-1  ]: Runtime Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US
  
  Location: US
  Job ID: 4bfab9c1-337a-4441-b54a-edb0dceb0069
  
[0m03:53:48.943302 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63f636e4-23b0-4ffc-b715-a98e0c77aac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feee8b66a90>]}
[0m03:53:48.946082 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 1.10s]
[0m03:53:48.948604 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m03:53:48.950176 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m03:53:48.952049 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m03:53:48.953795 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m03:53:48.954824 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m03:53:48.961520 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m03:53:48.962917 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 03:53:48.955563 => 03:53:48.962542
[0m03:53:48.963565 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m03:53:48.966372 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:53:49.614164 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m03:53:49.614845 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m03:53:50.018542 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d5b4e7ec-a7a5-4b8b-ac5d-6e212e34f36f&page=queryresults
[0m03:53:50.019650 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m03:53:50.020118 [debug] [Thread-1  ]: BigQuery adapter: 404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US

Location: US
Job ID: d5b4e7ec-a7a5-4b8b-ac5d-6e212e34f36f

[0m03:53:50.020725 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 03:53:48.963860 => 03:53:50.020521
[0m03:53:50.022072 [debug] [Thread-1  ]: Runtime Error in model dim_publishers (models/transform/dim_publishers.sql)
  404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US
  
  Location: US
  Job ID: d5b4e7ec-a7a5-4b8b-ac5d-6e212e34f36f
  
[0m03:53:50.022549 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63f636e4-23b0-4ffc-b715-a98e0c77aac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feee82d5e20>]}
[0m03:53:50.023169 [error] [Thread-1  ]: 4 of 6 ERROR creating sql table model games.dim_publishers ..................... [[31mERROR[0m in 1.07s]
[0m03:53:50.023838 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m03:53:50.024319 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m03:53:50.024815 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m03:53:50.025663 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m03:53:50.026104 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m03:53:50.035866 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m03:53:50.036968 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 03:53:50.026416 => 03:53:50.036643
[0m03:53:50.037557 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m03:53:50.041251 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:53:50.635611 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m03:53:50.636369 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m03:53:51.045161 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:51ff8460-7790-4c73-bd99-c25f8a44dc1c&page=queryresults
[0m03:53:51.048064 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m03:53:51.048649 [debug] [Thread-1  ]: BigQuery adapter: 404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US

Location: US
Job ID: 51ff8460-7790-4c73-bd99-c25f8a44dc1c

[0m03:53:51.049347 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 03:53:50.037937 => 03:53:51.049133
[0m03:53:51.050649 [debug] [Thread-1  ]: Runtime Error in model dim_release (models/transform/dim_release.sql)
  404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US
  
  Location: US
  Job ID: 51ff8460-7790-4c73-bd99-c25f8a44dc1c
  
[0m03:53:51.051170 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63f636e4-23b0-4ffc-b715-a98e0c77aac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feee82fb8e0>]}
[0m03:53:51.051822 [error] [Thread-1  ]: 5 of 6 ERROR creating sql table model games.dim_release ........................ [[31mERROR[0m in 1.03s]
[0m03:53:51.052583 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m03:53:51.053110 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m03:53:51.053647 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m03:53:51.054545 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m03:53:51.055009 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m03:53:51.058492 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m03:53:51.059209 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 03:53:51.055322 => 03:53:51.058984
[0m03:53:51.059642 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m03:53:51.062193 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:53:51.674782 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m03:53:51.675572 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m03:53:52.068406 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:42cb52b4-b0e0-4c31-bf0d-3e163adabbc9&page=queryresults
[0m03:53:52.073161 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m03:53:52.075508 [debug] [Thread-1  ]: BigQuery adapter: 404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US

Location: US
Job ID: 42cb52b4-b0e0-4c31-bf0d-3e163adabbc9

[0m03:53:52.078505 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 03:53:51.059951 => 03:53:52.077488
[0m03:53:52.084432 [debug] [Thread-1  ]: Runtime Error in model dim_support_language (models/transform/dim_support_language.sql)
  404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US
  
  Location: US
  Job ID: 42cb52b4-b0e0-4c31-bf0d-3e163adabbc9
  
[0m03:53:52.086649 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63f636e4-23b0-4ffc-b715-a98e0c77aac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feee95305b0>]}
[0m03:53:52.089466 [error] [Thread-1  ]: 6 of 6 ERROR creating sql table model games.dim_support_language ............... [[31mERROR[0m in 1.03s]
[0m03:53:52.092598 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m03:53:52.099017 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:53:52.100748 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m03:53:52.102633 [info ] [MainThread]: 
[0m03:53:52.104483 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 7.85 seconds (7.85s).
[0m03:53:52.111977 [debug] [MainThread]: Command end result
[0m03:53:52.144716 [info ] [MainThread]: 
[0m03:53:52.145398 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m03:53:52.145951 [info ] [MainThread]: 
[0m03:53:52.146872 [error] [MainThread]:   Runtime Error in model dim_developers (models/transform/dim_developers.sql)
  404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US
  
  Location: US
  Job ID: 333c2068-086f-49cc-a97a-4861db38d9c6
  
[0m03:53:52.147437 [info ] [MainThread]: 
[0m03:53:52.147919 [error] [MainThread]:   Runtime Error in model dim_platforms (models/transform/dim_platforms.sql)
  404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US
  
  Location: US
  Job ID: 7bbd5899-815c-4c14-ad36-5964999efc2f
  
[0m03:53:52.148586 [info ] [MainThread]: 
[0m03:53:52.149263 [error] [MainThread]:   Runtime Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US
  
  Location: US
  Job ID: 4bfab9c1-337a-4441-b54a-edb0dceb0069
  
[0m03:53:52.149926 [info ] [MainThread]: 
[0m03:53:52.150582 [error] [MainThread]:   Runtime Error in model dim_publishers (models/transform/dim_publishers.sql)
  404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US
  
  Location: US
  Job ID: d5b4e7ec-a7a5-4b8b-ac5d-6e212e34f36f
  
[0m03:53:52.151313 [info ] [MainThread]: 
[0m03:53:52.152027 [error] [MainThread]:   Runtime Error in model dim_release (models/transform/dim_release.sql)
  404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US
  
  Location: US
  Job ID: 51ff8460-7790-4c73-bd99-c25f8a44dc1c
  
[0m03:53:52.153346 [info ] [MainThread]: 
[0m03:53:52.154277 [error] [MainThread]:   Runtime Error in model dim_support_language (models/transform/dim_support_language.sql)
  404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US
  
  Location: US
  Job ID: 42cb52b4-b0e0-4c31-bf0d-3e163adabbc9
  
[0m03:53:52.155405 [info ] [MainThread]: 
[0m03:53:52.156174 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=6 SKIP=0 TOTAL=6
[0m03:53:52.157098 [debug] [MainThread]: Command `dbt run` failed at 03:53:52.156944 after 9.02 seconds
[0m03:53:52.163076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef0400de20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feee9c95310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feee9c95370>]}
[0m03:53:52.163552 [debug] [MainThread]: Flushing usage events
[0m03:54:35.389424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58ac70d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5885e2880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5885e2850>]}


============================== 03:54:35.394103 | c2ed5596-cf0d-4499-a8c8-aae338999f55 ==============================
[0m03:54:35.394103 [info ] [MainThread]: Running with dbt=1.6.5
[0m03:54:35.394707 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/includes/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:54:35.948369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2ed5596-cf0d-4499-a8c8-aae338999f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff588650820>]}
[0m03:54:35.959313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2ed5596-cf0d-4499-a8c8-aae338999f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff570a30e20>]}
[0m03:54:35.959948 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m03:54:35.977235 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m03:54:36.062128 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:54:36.062531 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:54:36.068811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2ed5596-cf0d-4499-a8c8-aae338999f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff570829a30>]}
[0m03:54:36.083992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2ed5596-cf0d-4499-a8c8-aae338999f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff570804fa0>]}
[0m03:54:36.084490 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m03:54:36.085033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2ed5596-cf0d-4499-a8c8-aae338999f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5708d85e0>]}
[0m03:54:36.086486 [info ] [MainThread]: 
[0m03:54:36.087245 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:54:36.088494 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m03:54:36.088991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:54:36.778359 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m03:54:36.780595 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:54:37.403425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2ed5596-cf0d-4499-a8c8-aae338999f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5709e30d0>]}
[0m03:54:37.406922 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:54:37.408779 [info ] [MainThread]: 
[0m03:54:37.436275 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m03:54:37.437782 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m03:54:37.439614 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m03:54:37.440735 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m03:54:37.455567 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m03:54:37.456565 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 03:54:37.441887 => 03:54:37.456258
[0m03:54:37.457114 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m03:54:37.474289 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:54:38.169838 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m03:54:38.170614 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m03:54:38.607253 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:0b29397e-160c-409b-9216-ea64dda59713&page=queryresults
[0m03:54:38.610395 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m03:54:38.610993 [debug] [Thread-1  ]: BigQuery adapter: 404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US

Location: US
Job ID: 0b29397e-160c-409b-9216-ea64dda59713

[0m03:54:38.611836 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 03:54:37.457493 => 03:54:38.611473
[0m03:54:38.615591 [debug] [Thread-1  ]: Runtime Error in model dim_developers (models/transform/dim_developers.sql)
  404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US
  
  Location: US
  Job ID: 0b29397e-160c-409b-9216-ea64dda59713
  
[0m03:54:38.616207 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2ed5596-cf0d-4499-a8c8-aae338999f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff56fd86f70>]}
[0m03:54:38.616902 [error] [Thread-1  ]: 1 of 6 ERROR creating sql table model games.dim_developers ..................... [[31mERROR[0m in 1.18s]
[0m03:54:38.617643 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m03:54:38.618169 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m03:54:38.618860 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m03:54:38.619692 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m03:54:38.620175 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m03:54:38.629220 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m03:54:38.630209 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 03:54:38.620507 => 03:54:38.629925
[0m03:54:38.630705 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m03:54:38.633728 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:54:39.274260 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m03:54:39.275035 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m03:54:39.743135 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:32e4119c-6883-46ed-84b8-b22eed54e0e7&page=queryresults
[0m03:54:39.747821 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m03:54:39.750190 [debug] [Thread-1  ]: BigQuery adapter: 404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US

Location: US
Job ID: 32e4119c-6883-46ed-84b8-b22eed54e0e7

[0m03:54:39.753146 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 03:54:38.631040 => 03:54:39.752122
[0m03:54:39.758998 [debug] [Thread-1  ]: Runtime Error in model dim_platforms (models/transform/dim_platforms.sql)
  404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US
  
  Location: US
  Job ID: 32e4119c-6883-46ed-84b8-b22eed54e0e7
  
[0m03:54:39.761173 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2ed5596-cf0d-4499-a8c8-aae338999f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff570830c70>]}
[0m03:54:39.763971 [error] [Thread-1  ]: 2 of 6 ERROR creating sql table model games.dim_platforms ...................... [[31mERROR[0m in 1.14s]
[0m03:54:39.767132 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m03:54:39.769407 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m03:54:39.771962 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m03:54:39.774235 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m03:54:39.775631 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m03:54:39.782670 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m03:54:39.783546 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 03:54:39.776652 => 03:54:39.783262
[0m03:54:39.784000 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m03:54:39.786704 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:54:40.398175 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m03:54:40.398996 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
    *,
    CASE
        WHEN discount_percent > 0 THEN initial_price * (1 - discount_percent / 100)
        ELSE 0.0  -- Cambiamos 0 a 0.0 para que coincida con FLOAT64
    END AS discounted_price,
    CONCAT('ARS$ ',
        CASE
            WHEN discount_percent > 0 THEN FORMAT(ROUND(initial_price * (1 - discount_percent / 100), 2), 'N')
            ELSE 'ARS$ 0.00'  -- Formato 0 para descuento nulo
        END
    ) AS formatted_discounted_price,
    CONCAT('ARS$ ', FORMAT(ROUND((initial_price * (1 - discount_percent / 100)) * 1.75, 2), 'N')) AS formatted_price_with_tax
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    *
FROM price_overview_cte
    );
  
[0m03:54:40.828019 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:13c6bcc7-796d-4763-9ca5-aa9f93fc7148&page=queryresults
[0m03:54:40.832835 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
    *,
    CASE
        WHEN discount_percent > 0 THEN initial_price * (1 - discount_percent / 100)
        ELSE 0.0  -- Cambiamos 0 a 0.0 para que coincida con FLOAT64
    END AS discounted_price,
    CONCAT('ARS$ ',
        CASE
            WHEN discount_percent > 0 THEN FORMAT(ROUND(initial_price * (1 - discount_percent / 100), 2), 'N')
            ELSE 'ARS$ 0.00'  -- Formato 0 para descuento nulo
        END
    ) AS formatted_discounted_price,
    CONCAT('ARS$ ', FORMAT(ROUND((initial_price * (1 - discount_percent / 100)) * 1.75, 2), 'N')) AS formatted_price_with_tax
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    *
FROM price_overview_cte
    );
  
[0m03:54:40.835393 [debug] [Thread-1  ]: BigQuery adapter: 404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US

Location: US
Job ID: 13c6bcc7-796d-4763-9ca5-aa9f93fc7148

[0m03:54:40.838374 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 03:54:39.784297 => 03:54:40.837370
[0m03:54:40.844257 [debug] [Thread-1  ]: Runtime Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US
  
  Location: US
  Job ID: 13c6bcc7-796d-4763-9ca5-aa9f93fc7148
  
[0m03:54:40.846422 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2ed5596-cf0d-4499-a8c8-aae338999f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff56dd4fc10>]}
[0m03:54:40.849216 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 1.07s]
[0m03:54:40.852266 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m03:54:40.854507 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m03:54:40.857051 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m03:54:40.859301 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m03:54:40.860739 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m03:54:40.868532 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m03:54:40.870012 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 03:54:40.861758 => 03:54:40.869578
[0m03:54:40.870855 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m03:54:40.875245 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:54:41.497304 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m03:54:41.498076 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m03:54:41.878653 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:94bc7d38-901d-436d-a39f-f367b58bfdf5&page=queryresults
[0m03:54:41.883331 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m03:54:41.885828 [debug] [Thread-1  ]: BigQuery adapter: 404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US

Location: US
Job ID: 94bc7d38-901d-436d-a39f-f367b58bfdf5

[0m03:54:41.888835 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 03:54:40.871453 => 03:54:41.887830
[0m03:54:41.894944 [debug] [Thread-1  ]: Runtime Error in model dim_publishers (models/transform/dim_publishers.sql)
  404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US
  
  Location: US
  Job ID: 94bc7d38-901d-436d-a39f-f367b58bfdf5
  
[0m03:54:41.897113 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2ed5596-cf0d-4499-a8c8-aae338999f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff56dd03e20>]}
[0m03:54:41.899869 [error] [Thread-1  ]: 4 of 6 ERROR creating sql table model games.dim_publishers ..................... [[31mERROR[0m in 1.04s]
[0m03:54:41.902935 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m03:54:41.905173 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m03:54:41.907493 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m03:54:41.909850 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m03:54:41.911257 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m03:54:41.923767 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m03:54:41.924496 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 03:54:41.912120 => 03:54:41.924289
[0m03:54:41.924952 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m03:54:41.927403 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:54:42.557036 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m03:54:42.557806 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m03:54:42.971870 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7fa491e6-1a53-40a6-b5c4-050bf3f368bd&page=queryresults
[0m03:54:42.973134 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m03:54:42.973623 [debug] [Thread-1  ]: BigQuery adapter: 404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US

Location: US
Job ID: 7fa491e6-1a53-40a6-b5c4-050bf3f368bd

[0m03:54:42.974243 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 03:54:41.925242 => 03:54:42.974041
[0m03:54:42.975491 [debug] [Thread-1  ]: Runtime Error in model dim_release (models/transform/dim_release.sql)
  404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US
  
  Location: US
  Job ID: 7fa491e6-1a53-40a6-b5c4-050bf3f368bd
  
[0m03:54:42.976006 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2ed5596-cf0d-4499-a8c8-aae338999f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff56ff16820>]}
[0m03:54:42.976771 [error] [Thread-1  ]: 5 of 6 ERROR creating sql table model games.dim_release ........................ [[31mERROR[0m in 1.07s]
[0m03:54:42.977547 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m03:54:42.978044 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m03:54:42.978512 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m03:54:42.979213 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m03:54:42.979616 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m03:54:42.982927 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m03:54:42.983741 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 03:54:42.979906 => 03:54:42.983505
[0m03:54:42.984183 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m03:54:42.986725 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:54:43.628946 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m03:54:43.629802 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m03:54:44.056066 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f58a0262-a00d-42e4-be17-7747aff9654d&page=queryresults
[0m03:54:44.060758 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m03:54:44.063106 [debug] [Thread-1  ]: BigQuery adapter: 404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US

Location: US
Job ID: f58a0262-a00d-42e4-be17-7747aff9654d

[0m03:54:44.066041 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 03:54:42.984494 => 03:54:44.065052
[0m03:54:44.071906 [debug] [Thread-1  ]: Runtime Error in model dim_support_language (models/transform/dim_support_language.sql)
  404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US
  
  Location: US
  Job ID: f58a0262-a00d-42e4-be17-7747aff9654d
  
[0m03:54:44.074066 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2ed5596-cf0d-4499-a8c8-aae338999f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff56fdfc7c0>]}
[0m03:54:44.076817 [error] [Thread-1  ]: 6 of 6 ERROR creating sql table model games.dim_support_language ............... [[31mERROR[0m in 1.09s]
[0m03:54:44.079911 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m03:54:44.086596 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:54:44.087820 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m03:54:44.089113 [info ] [MainThread]: 
[0m03:54:44.090402 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 8.00 seconds (8.00s).
[0m03:54:44.094006 [debug] [MainThread]: Command end result
[0m03:54:44.107603 [info ] [MainThread]: 
[0m03:54:44.108187 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m03:54:44.108563 [info ] [MainThread]: 
[0m03:54:44.108941 [error] [MainThread]:   Runtime Error in model dim_developers (models/transform/dim_developers.sql)
  404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US
  
  Location: US
  Job ID: 0b29397e-160c-409b-9216-ea64dda59713
  
[0m03:54:44.109344 [info ] [MainThread]: 
[0m03:54:44.109825 [error] [MainThread]:   Runtime Error in model dim_platforms (models/transform/dim_platforms.sql)
  404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US
  
  Location: US
  Job ID: 32e4119c-6883-46ed-84b8-b22eed54e0e7
  
[0m03:54:44.110308 [info ] [MainThread]: 
[0m03:54:44.110678 [error] [MainThread]:   Runtime Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US
  
  Location: US
  Job ID: 13c6bcc7-796d-4763-9ca5-aa9f93fc7148
  
[0m03:54:44.111043 [info ] [MainThread]: 
[0m03:54:44.111401 [error] [MainThread]:   Runtime Error in model dim_publishers (models/transform/dim_publishers.sql)
  404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US
  
  Location: US
  Job ID: 94bc7d38-901d-436d-a39f-f367b58bfdf5
  
[0m03:54:44.111763 [info ] [MainThread]: 
[0m03:54:44.112135 [error] [MainThread]:   Runtime Error in model dim_release (models/transform/dim_release.sql)
  404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US
  
  Location: US
  Job ID: 7fa491e6-1a53-40a6-b5c4-050bf3f368bd
  
[0m03:54:44.112555 [info ] [MainThread]: 
[0m03:54:44.112957 [error] [MainThread]:   Runtime Error in model dim_support_language (models/transform/dim_support_language.sql)
  404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US
  
  Location: US
  Job ID: f58a0262-a00d-42e4-be17-7747aff9654d
  
[0m03:54:44.113328 [info ] [MainThread]: 
[0m03:54:44.113720 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=6 SKIP=0 TOTAL=6
[0m03:54:44.114394 [debug] [MainThread]: Command `dbt run` failed at 03:54:44.114260 after 8.73 seconds
[0m03:54:44.114790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58ac70d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff570a30e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff56ff24490>]}
[0m03:54:44.115197 [debug] [MainThread]: Flushing usage events
[0m03:55:09.100660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc141aa4e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc13f44f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc13f44f9a0>]}


============================== 03:55:09.105476 | 296c338b-0649-4d48-a34f-bd9bdb617952 ==============================
[0m03:55:09.105476 [info ] [MainThread]: Running with dbt=1.6.5
[0m03:55:09.106133 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/includes/dbt/', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/includes/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/includes/dbt/', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:55:09.655411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '296c338b-0649-4d48-a34f-bd9bdb617952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc13f47b910>]}
[0m03:55:09.666059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '296c338b-0649-4d48-a34f-bd9bdb617952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc127821eb0>]}
[0m03:55:09.666686 [info ] [MainThread]: Registered adapter: bigquery=1.6.6
[0m03:55:09.683063 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m03:55:09.767586 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:55:09.767996 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:55:09.774252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '296c338b-0649-4d48-a34f-bd9bdb617952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc127689b20>]}
[0m03:55:09.790307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '296c338b-0649-4d48-a34f-bd9bdb617952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc127737730>]}
[0m03:55:09.790809 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m03:55:09.791262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '296c338b-0649-4d48-a34f-bd9bdb617952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc127730340>]}
[0m03:55:09.792719 [info ] [MainThread]: 
[0m03:55:09.793561 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:55:09.794848 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m03:55:09.795306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:55:10.455292 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m03:55:10.457533 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:55:11.079375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '296c338b-0649-4d48-a34f-bd9bdb617952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc127664c10>]}
[0m03:55:11.082914 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:55:11.084808 [info ] [MainThread]: 
[0m03:55:11.111966 [debug] [Thread-1  ]: Began running node model.games.dim_developers
[0m03:55:11.113446 [info ] [Thread-1  ]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m03:55:11.115265 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m03:55:11.116349 [debug] [Thread-1  ]: Began compiling node model.games.dim_developers
[0m03:55:11.130383 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_developers"
[0m03:55:11.131382 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (compile): 03:55:11.117091 => 03:55:11.131075
[0m03:55:11.131965 [debug] [Thread-1  ]: Began executing node model.games.dim_developers
[0m03:55:11.149566 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:55:11.782590 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_developers"
[0m03:55:11.783394 [debug] [Thread-1  ]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m03:55:12.185906 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:48d615b7-5539-45c1-9000-b606990b096e&page=queryresults
[0m03:55:12.191016 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m03:55:12.193410 [debug] [Thread-1  ]: BigQuery adapter: 404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US

Location: US
Job ID: 48d615b7-5539-45c1-9000-b606990b096e

[0m03:55:12.196884 [debug] [Thread-1  ]: Timing info for model.games.dim_developers (execute): 03:55:11.132335 => 03:55:12.195387
[0m03:55:12.213071 [debug] [Thread-1  ]: Runtime Error in model dim_developers (models/transform/dim_developers.sql)
  404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US
  
  Location: US
  Job ID: 48d615b7-5539-45c1-9000-b606990b096e
  
[0m03:55:12.215381 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '296c338b-0649-4d48-a34f-bd9bdb617952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc126bdef10>]}
[0m03:55:12.217851 [error] [Thread-1  ]: 1 of 6 ERROR creating sql table model games.dim_developers ..................... [[31mERROR[0m in 1.10s]
[0m03:55:12.220075 [debug] [Thread-1  ]: Finished running node model.games.dim_developers
[0m03:55:12.221657 [debug] [Thread-1  ]: Began running node model.games.dim_platforms
[0m03:55:12.223148 [info ] [Thread-1  ]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m03:55:12.224946 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m03:55:12.226000 [debug] [Thread-1  ]: Began compiling node model.games.dim_platforms
[0m03:55:12.239452 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_platforms"
[0m03:55:12.240480 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (compile): 03:55:12.226756 => 03:55:12.240171
[0m03:55:12.241081 [debug] [Thread-1  ]: Began executing node model.games.dim_platforms
[0m03:55:12.244303 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:55:12.854284 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_platforms"
[0m03:55:12.855516 [debug] [Thread-1  ]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m03:55:13.262412 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5c0f52eb-98d4-4c91-a908-2da1fcf0b885&page=queryresults
[0m03:55:13.263595 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m03:55:13.264093 [debug] [Thread-1  ]: BigQuery adapter: 404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US

Location: US
Job ID: 5c0f52eb-98d4-4c91-a908-2da1fcf0b885

[0m03:55:13.264703 [debug] [Thread-1  ]: Timing info for model.games.dim_platforms (execute): 03:55:12.241508 => 03:55:13.264494
[0m03:55:13.265994 [debug] [Thread-1  ]: Runtime Error in model dim_platforms (models/transform/dim_platforms.sql)
  404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US
  
  Location: US
  Job ID: 5c0f52eb-98d4-4c91-a908-2da1fcf0b885
  
[0m03:55:13.266457 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '296c338b-0649-4d48-a34f-bd9bdb617952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc126be7a00>]}
[0m03:55:13.267073 [error] [Thread-1  ]: 2 of 6 ERROR creating sql table model games.dim_platforms ...................... [[31mERROR[0m in 1.04s]
[0m03:55:13.267757 [debug] [Thread-1  ]: Finished running node model.games.dim_platforms
[0m03:55:13.268245 [debug] [Thread-1  ]: Began running node model.games.dim_price_overview
[0m03:55:13.268746 [info ] [Thread-1  ]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m03:55:13.269448 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m03:55:13.269898 [debug] [Thread-1  ]: Began compiling node model.games.dim_price_overview
[0m03:55:13.273363 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_price_overview"
[0m03:55:13.274233 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (compile): 03:55:13.270214 => 03:55:13.273983
[0m03:55:13.274708 [debug] [Thread-1  ]: Began executing node model.games.dim_price_overview
[0m03:55:13.277595 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:55:13.891430 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_price_overview"
[0m03:55:13.892241 [debug] [Thread-1  ]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
    *,
    CASE
        WHEN discount_percent > 0 THEN initial_price * (1 - discount_percent / 100)
        ELSE 0.0  -- Cambiamos 0 a 0.0 para que coincida con FLOAT64
    END AS discounted_price,
    CONCAT('ARS$ ',
        CASE
            WHEN discount_percent > 0 THEN FORMAT(ROUND(initial_price * (1 - discount_percent / 100), 2), 'N')
            ELSE 'ARS$ 0.00'  -- Formato 0 para descuento nulo
        END
    ) AS formatted_discounted_price,
    CONCAT('ARS$ ', FORMAT(ROUND((initial_price * (1 - discount_percent / 100)) * 1.75, 2), 'N')) AS formatted_price_with_tax
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    *
FROM price_overview_cte
    );
  
[0m03:55:14.258059 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c9dafc49-550f-4fb0-8e10-ed43879476cc&page=queryresults
[0m03:55:14.263179 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
    *,
    CASE
        WHEN discount_percent > 0 THEN initial_price * (1 - discount_percent / 100)
        ELSE 0.0  -- Cambiamos 0 a 0.0 para que coincida con FLOAT64
    END AS discounted_price,
    CONCAT('ARS$ ',
        CASE
            WHEN discount_percent > 0 THEN FORMAT(ROUND(initial_price * (1 - discount_percent / 100), 2), 'N')
            ELSE 'ARS$ 0.00'  -- Formato 0 para descuento nulo
        END
    ) AS formatted_discounted_price,
    CONCAT('ARS$ ', FORMAT(ROUND((initial_price * (1 - discount_percent / 100)) * 1.75, 2), 'N')) AS formatted_price_with_tax
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    *
FROM price_overview_cte
    );
  
[0m03:55:14.265229 [debug] [Thread-1  ]: BigQuery adapter: 404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US

Location: US
Job ID: c9dafc49-550f-4fb0-8e10-ed43879476cc

[0m03:55:14.265888 [debug] [Thread-1  ]: Timing info for model.games.dim_price_overview (execute): 03:55:13.275049 => 03:55:14.265680
[0m03:55:14.267163 [debug] [Thread-1  ]: Runtime Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US
  
  Location: US
  Job ID: c9dafc49-550f-4fb0-8e10-ed43879476cc
  
[0m03:55:14.267638 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '296c338b-0649-4d48-a34f-bd9bdb617952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc126d66760>]}
[0m03:55:14.268258 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 1.00s]
[0m03:55:14.268955 [debug] [Thread-1  ]: Finished running node model.games.dim_price_overview
[0m03:55:14.269467 [debug] [Thread-1  ]: Began running node model.games.dim_publishers
[0m03:55:14.269998 [info ] [Thread-1  ]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m03:55:14.270721 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m03:55:14.271326 [debug] [Thread-1  ]: Began compiling node model.games.dim_publishers
[0m03:55:14.274699 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_publishers"
[0m03:55:14.275445 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (compile): 03:55:14.271740 => 03:55:14.275206
[0m03:55:14.275848 [debug] [Thread-1  ]: Began executing node model.games.dim_publishers
[0m03:55:14.278478 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:55:14.906350 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_publishers"
[0m03:55:14.907142 [debug] [Thread-1  ]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m03:55:15.321985 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:0de6490a-f4a8-4e3d-9138-3740a22338d0&page=queryresults
[0m03:55:15.326655 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m03:55:15.329008 [debug] [Thread-1  ]: BigQuery adapter: 404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US

Location: US
Job ID: 0de6490a-f4a8-4e3d-9138-3740a22338d0

[0m03:55:15.331956 [debug] [Thread-1  ]: Timing info for model.games.dim_publishers (execute): 03:55:14.276139 => 03:55:15.330953
[0m03:55:15.338082 [debug] [Thread-1  ]: Runtime Error in model dim_publishers (models/transform/dim_publishers.sql)
  404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US
  
  Location: US
  Job ID: 0de6490a-f4a8-4e3d-9138-3740a22338d0
  
[0m03:55:15.340227 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '296c338b-0649-4d48-a34f-bd9bdb617952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc124bd4ee0>]}
[0m03:55:15.342998 [error] [Thread-1  ]: 4 of 6 ERROR creating sql table model games.dim_publishers ..................... [[31mERROR[0m in 1.07s]
[0m03:55:15.346171 [debug] [Thread-1  ]: Finished running node model.games.dim_publishers
[0m03:55:15.348384 [debug] [Thread-1  ]: Began running node model.games.dim_release
[0m03:55:15.351071 [info ] [Thread-1  ]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m03:55:15.353702 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m03:55:15.355096 [debug] [Thread-1  ]: Began compiling node model.games.dim_release
[0m03:55:15.371671 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_release"
[0m03:55:15.372887 [debug] [Thread-1  ]: Timing info for model.games.dim_release (compile): 03:55:15.356102 => 03:55:15.372532
[0m03:55:15.373537 [debug] [Thread-1  ]: Began executing node model.games.dim_release
[0m03:55:15.377249 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:55:16.006343 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_release"
[0m03:55:16.007118 [debug] [Thread-1  ]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m03:55:16.487472 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c0edb2b2-c543-43e1-b4a7-976a6fd786b2&page=queryresults
[0m03:55:16.492108 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m03:55:16.494462 [debug] [Thread-1  ]: BigQuery adapter: 404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US

Location: US
Job ID: c0edb2b2-c543-43e1-b4a7-976a6fd786b2

[0m03:55:16.497418 [debug] [Thread-1  ]: Timing info for model.games.dim_release (execute): 03:55:15.373985 => 03:55:16.496401
[0m03:55:16.503256 [debug] [Thread-1  ]: Runtime Error in model dim_release (models/transform/dim_release.sql)
  404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US
  
  Location: US
  Job ID: c0edb2b2-c543-43e1-b4a7-976a6fd786b2
  
[0m03:55:16.505418 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '296c338b-0649-4d48-a34f-bd9bdb617952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc126d7ebb0>]}
[0m03:55:16.508172 [error] [Thread-1  ]: 5 of 6 ERROR creating sql table model games.dim_release ........................ [[31mERROR[0m in 1.15s]
[0m03:55:16.511251 [debug] [Thread-1  ]: Finished running node model.games.dim_release
[0m03:55:16.513563 [debug] [Thread-1  ]: Began running node model.games.dim_support_language
[0m03:55:16.516240 [info ] [Thread-1  ]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m03:55:16.518670 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m03:55:16.520067 [debug] [Thread-1  ]: Began compiling node model.games.dim_support_language
[0m03:55:16.528157 [debug] [Thread-1  ]: Writing injected SQL for node "model.games.dim_support_language"
[0m03:55:16.529580 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (compile): 03:55:16.521129 => 03:55:16.529154
[0m03:55:16.530405 [debug] [Thread-1  ]: Began executing node model.games.dim_support_language
[0m03:55:16.534330 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:55:17.159185 [debug] [Thread-1  ]: Writing runtime sql for node "model.games.dim_support_language"
[0m03:55:17.161985 [debug] [Thread-1  ]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m03:55:17.533940 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:281b3cb2-b540-4c64-bef3-5880ebe618c2&page=queryresults
[0m03:55:17.538606 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m03:55:17.540973 [debug] [Thread-1  ]: BigQuery adapter: 404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US

Location: US
Job ID: 281b3cb2-b540-4c64-bef3-5880ebe618c2

[0m03:55:17.542367 [debug] [Thread-1  ]: Timing info for model.games.dim_support_language (execute): 03:55:16.531013 => 03:55:17.542158
[0m03:55:17.543585 [debug] [Thread-1  ]: Runtime Error in model dim_support_language (models/transform/dim_support_language.sql)
  404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US
  
  Location: US
  Job ID: 281b3cb2-b540-4c64-bef3-5880ebe618c2
  
[0m03:55:17.544046 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '296c338b-0649-4d48-a34f-bd9bdb617952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc126d66ac0>]}
[0m03:55:17.544637 [error] [Thread-1  ]: 6 of 6 ERROR creating sql table model games.dim_support_language ............... [[31mERROR[0m in 1.03s]
[0m03:55:17.545364 [debug] [Thread-1  ]: Finished running node model.games.dim_support_language
[0m03:55:17.546841 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:55:17.547202 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m03:55:17.547598 [info ] [MainThread]: 
[0m03:55:17.548014 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 7.75 seconds (7.75s).
[0m03:55:17.549508 [debug] [MainThread]: Command end result
[0m03:55:17.562723 [info ] [MainThread]: 
[0m03:55:17.563232 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m03:55:17.563622 [info ] [MainThread]: 
[0m03:55:17.564011 [error] [MainThread]:   Runtime Error in model dim_developers (models/transform/dim_developers.sql)
  404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US
  
  Location: US
  Job ID: 48d615b7-5539-45c1-9000-b606990b096e
  
[0m03:55:17.564399 [info ] [MainThread]: 
[0m03:55:17.564778 [error] [MainThread]:   Runtime Error in model dim_platforms (models/transform/dim_platforms.sql)
  404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US
  
  Location: US
  Job ID: 5c0f52eb-98d4-4c91-a908-2da1fcf0b885
  
[0m03:55:17.565178 [info ] [MainThread]: 
[0m03:55:17.565562 [error] [MainThread]:   Runtime Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US
  
  Location: US
  Job ID: c9dafc49-550f-4fb0-8e10-ed43879476cc
  
[0m03:55:17.565947 [info ] [MainThread]: 
[0m03:55:17.566328 [error] [MainThread]:   Runtime Error in model dim_publishers (models/transform/dim_publishers.sql)
  404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US
  
  Location: US
  Job ID: 0de6490a-f4a8-4e3d-9138-3740a22338d0
  
[0m03:55:17.566712 [info ] [MainThread]: 
[0m03:55:17.567092 [error] [MainThread]:   Runtime Error in model dim_release (models/transform/dim_release.sql)
  404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US
  
  Location: US
  Job ID: c0edb2b2-c543-43e1-b4a7-976a6fd786b2
  
[0m03:55:17.567475 [info ] [MainThread]: 
[0m03:55:17.567853 [error] [MainThread]:   Runtime Error in model dim_support_language (models/transform/dim_support_language.sql)
  404 Not found: Table pristine-flames-400818:games.raw_games was not found in location US
  
  Location: US
  Job ID: 281b3cb2-b540-4c64-bef3-5880ebe618c2
  
[0m03:55:17.568241 [info ] [MainThread]: 
[0m03:55:17.568644 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=6 SKIP=0 TOTAL=6
[0m03:55:17.569275 [debug] [MainThread]: Command `dbt run` failed at 03:55:17.569164 after 8.47 seconds
[0m03:55:17.569700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc141aa4e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc127821e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc126d93af0>]}
[0m03:55:17.570137 [debug] [MainThread]: Flushing usage events
[0m17:21:48.253897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc272a21180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc270bb4100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc270bb4160>]}


============================== 17:21:48.257076 | 386e9c5c-4c9d-4648-9801-c9db955f8181 ==============================
[0m17:21:48.257076 [info ] [MainThread]: Running with dbt=1.6.5
[0m17:21:48.257574 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'profiles_dir': '/home/tomi/GCPSteamAnalytics/includes/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:21:48.309582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '386e9c5c-4c9d-4648-9801-c9db955f8181', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc270bb4070>]}
[0m17:21:48.310342 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ik6lpmf7'
[0m17:21:48.310778 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:21:48.582369 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:21:48.587069 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:21:48.805394 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:21:48.839738 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:21:49.362847 [info ] [MainThread]: Installed from version 1.1.1
[0m17:21:49.363273 [info ] [MainThread]: Up to date!
[0m17:21:49.363708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '386e9c5c-4c9d-4648-9801-c9db955f8181', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc270c3ca60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc270c3cca0>]}
[0m17:21:49.364396 [debug] [MainThread]: Command `dbt deps` succeeded at 17:21:49.364299 after 1.12 seconds
[0m17:21:49.364728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc272a21180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc270bb4070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc270bb4640>]}
[0m17:21:49.365073 [debug] [MainThread]: Flushing usage events
[0m17:22:45.971967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdcda291b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdcbab8070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdcbab80d0>]}


============================== 17:22:45.974022 | d147c208-a2e6-4fc8-bd4b-6ca704165a79 ==============================
[0m17:22:45.974022 [info ] [MainThread]: Running with dbt=1.6.5
[0m17:22:45.974587 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:22:46.343894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd147c208-a2e6-4fc8-bd4b-6ca704165a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdccfa4e50>]}
[0m17:22:46.359334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd147c208-a2e6-4fc8-bd4b-6ca704165a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdc9a589d0>]}
[0m17:22:46.359925 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m17:22:46.373423 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m17:22:46.440217 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:22:46.440783 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m17:22:46.483688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd147c208-a2e6-4fc8-bd4b-6ca704165a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdc98980d0>]}
[0m17:22:46.491962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd147c208-a2e6-4fc8-bd4b-6ca704165a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdc9863d00>]}
[0m17:22:46.492454 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m17:22:46.492794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd147c208-a2e6-4fc8-bd4b-6ca704165a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdc9863df0>]}
[0m17:22:46.494052 [info ] [MainThread]: 
[0m17:22:46.494697 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:22:46.495941 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m17:22:46.496402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:22:46.496784 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: '/opt/airflow/credentials.json''
[0m17:22:46.497782 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:22:46.498084 [debug] [MainThread]: Connection 'list_pristine-flames-400818' was properly closed.
[0m17:22:46.498383 [info ] [MainThread]: 
[0m17:22:46.498707 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.00 seconds (0.00s).
[0m17:22:46.499116 [error] [MainThread]: Encountered an error:
Database Error
  [Errno 2] No such file or directory: '/opt/airflow/credentials.json'
[0m17:22:46.499672 [debug] [MainThread]: Command `dbt run` failed at 17:22:46.499563 after 0.53 seconds
[0m17:22:46.500090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdcda291b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdc9863d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdc9862080>]}
[0m17:22:46.500531 [debug] [MainThread]: Flushing usage events
[0m17:23:30.658413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db3132b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db12c0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db12c00d0>]}


============================== 17:23:30.660504 | 5f55154b-768d-4763-b878-687930a6300a ==============================
[0m17:23:30.660504 [info ] [MainThread]: Running with dbt=1.6.5
[0m17:23:30.660999 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'send_anonymous_usage_stats': 'True'}
[0m17:23:30.934105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f55154b-768d-4763-b878-687930a6300a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db27841f0>]}
[0m17:23:30.949835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f55154b-768d-4763-b878-687930a6300a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0daf263490>]}
[0m17:23:30.950394 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m17:23:30.964194 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m17:23:31.007124 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:23:31.007601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5f55154b-768d-4763-b878-687930a6300a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db2787070>]}
[0m17:23:31.948333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f55154b-768d-4763-b878-687930a6300a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dae7dbf70>]}
[0m17:23:31.957016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f55154b-768d-4763-b878-687930a6300a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0daf26ec20>]}
[0m17:23:31.957467 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m17:23:31.957809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f55154b-768d-4763-b878-687930a6300a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0daf26ed40>]}
[0m17:23:31.959071 [info ] [MainThread]: 
[0m17:23:31.959749 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:23:31.960957 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m17:23:31.961398 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:23:32.808929 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m17:23:32.811047 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:23:33.584767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f55154b-768d-4763-b878-687930a6300a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0daf26f7f0>]}
[0m17:23:33.588050 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:23:33.588752 [info ] [MainThread]: 
[0m17:23:33.591263 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m17:23:33.591767 [info ] [Thread-1 (]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m17:23:33.592403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m17:23:33.592785 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m17:23:33.600315 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m17:23:33.601152 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 17:23:33.593052 => 17:23:33.600897
[0m17:23:33.601616 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m17:23:33.639275 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m17:23:33.640004 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:23:33.671519 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m17:23:34.804177 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a1648a40-267c-4794-971c-cd6d651888c0&page=queryresults
[0m17:23:38.533005 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 17:23:33.601938 => 17:23:38.532823
[0m17:23:38.533739 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f55154b-768d-4763-b878-687930a6300a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dae65b2e0>]}
[0m17:23:38.534330 [info ] [Thread-1 (]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.94s]
[0m17:23:38.534964 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m17:23:38.535444 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m17:23:38.535909 [info ] [Thread-1 (]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m17:23:38.536527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m17:23:38.536897 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m17:23:38.544807 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m17:23:38.545601 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 17:23:38.537161 => 17:23:38.545369
[0m17:23:38.546018 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m17:23:38.549206 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m17:23:38.549837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:23:38.582525 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m17:23:39.503707 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ec312b92-7d9e-4da9-9099-bf83087906ce&page=queryresults
[0m17:23:42.870098 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 17:23:38.546298 => 17:23:42.869485
[0m17:23:42.872891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f55154b-768d-4763-b878-687930a6300a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dae662170>]}
[0m17:23:42.875230 [info ] [Thread-1 (]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.34s]
[0m17:23:42.878075 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m17:23:42.880130 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m17:23:42.882573 [info ] [Thread-1 (]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m17:23:42.885623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m17:23:42.887462 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m17:23:42.900249 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m17:23:42.902332 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 17:23:42.888799 => 17:23:42.901685
[0m17:23:42.903646 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m17:23:42.911240 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m17:23:42.912378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:23:42.950787 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
    *,
    -- Monto del Descuento formateado como decimal con dos decimales
    CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
        WHEN discount_percent > 0 THEN (initial_price * (1 - discount_percent / 100))
        ELSE initial_price
    END) * 1.75 AS price_with_tax     
FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    *
FROM price_overview_cte
    );
  
[0m17:23:43.974577 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c78b984c-1a75-4292-841a-1124386ecfbc&page=queryresults
[0m17:23:47.823213 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 17:23:42.904584 => 17:23:47.822347
[0m17:23:47.826371 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f55154b-768d-4763-b878-687930a6300a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dae7ee6e0>]}
[0m17:23:47.828974 [info ] [Thread-1 (]: 3 of 6 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (2.7k rows, 1.4 MiB processed)[0m in 4.94s]
[0m17:23:47.831802 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m17:23:47.833838 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m17:23:47.836296 [info ] [Thread-1 (]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m17:23:47.839242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m17:23:47.841099 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m17:23:47.852919 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m17:23:47.854929 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 17:23:47.842398 => 17:23:47.854290
[0m17:23:47.855999 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m17:23:47.869384 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m17:23:47.870354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:23:47.905362 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m17:23:48.890359 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a6d37e90-09ce-4c54-8245-fd3ce024a907&page=queryresults
[0m17:23:52.547589 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 17:23:47.856672 => 17:23:52.547279
[0m17:23:52.548689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f55154b-768d-4763-b878-687930a6300a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dae5106a0>]}
[0m17:23:52.549659 [info ] [Thread-1 (]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.71s]
[0m17:23:52.550644 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m17:23:52.551370 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m17:23:52.552240 [info ] [Thread-1 (]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m17:23:52.553274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m17:23:52.553901 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m17:23:52.561165 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m17:23:52.562195 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 17:23:52.554701 => 17:23:52.561886
[0m17:23:52.562789 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m17:23:52.567461 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m17:23:52.568319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:23:52.604282 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m17:23:53.606911 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a14803a5-7344-4822-a8e2-edafc978af18&page=queryresults
[0m17:23:57.015102 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 17:23:52.563213 => 17:23:57.014234
[0m17:23:57.018324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f55154b-768d-4763-b878-687930a6300a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dae6eaad0>]}
[0m17:23:57.021018 [info ] [Thread-1 (]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.47s]
[0m17:23:57.023992 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m17:23:57.026072 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m17:23:57.028278 [info ] [Thread-1 (]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m17:23:57.031591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m17:23:57.033508 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m17:23:57.046012 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m17:23:57.047377 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 17:23:57.034810 => 17:23:57.046962
[0m17:23:57.048146 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m17:23:57.053784 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m17:23:57.054791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:23:57.090200 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m17:23:58.020118 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5ac8e293-2d9c-49d8-b823-20ede74b56a2&page=queryresults
[0m17:24:01.298329 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 17:23:57.048680 => 17:24:01.297461
[0m17:24:01.301467 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f55154b-768d-4763-b878-687930a6300a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dae6f14b0>]}
[0m17:24:01.304057 [info ] [Thread-1 (]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.27s]
[0m17:24:01.306835 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m17:24:01.312822 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:24:01.314413 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m17:24:01.316118 [info ] [MainThread]: 
[0m17:24:01.317817 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 29.36 seconds (29.36s).
[0m17:24:01.324339 [debug] [MainThread]: Command end result
[0m17:24:01.345046 [info ] [MainThread]: 
[0m17:24:01.345521 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:24:01.345896 [info ] [MainThread]: 
[0m17:24:01.346309 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m17:24:01.346940 [debug] [MainThread]: Command `dbt run` succeeded at 17:24:01.346816 after 30.70 seconds
[0m17:24:01.347329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db3132b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db12c13f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db290d930>]}
[0m17:24:01.347763 [debug] [MainThread]: Flushing usage events
[0m17:34:02.660813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1948d2a020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1946d84070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1946d840d0>]}


============================== 17:34:02.662893 | 1bef847b-21f2-43f3-b9b5-7dde0517b976 ==============================
[0m17:34:02.662893 [info ] [MainThread]: Running with dbt=1.6.5
[0m17:34:02.663389 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:34:02.942384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1bef847b-21f2-43f3-b9b5-7dde0517b976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1944d06c50>]}
[0m17:34:02.958542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1bef847b-21f2-43f3-b9b5-7dde0517b976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1944d207c0>]}
[0m17:34:02.959230 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m17:34:02.973412 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m17:34:03.036015 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:34:03.036387 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:34:03.041708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1bef847b-21f2-43f3-b9b5-7dde0517b976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1944b75ab0>]}
[0m17:34:03.050393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1bef847b-21f2-43f3-b9b5-7dde0517b976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1944b45a50>]}
[0m17:34:03.050847 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m17:34:03.051193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bef847b-21f2-43f3-b9b5-7dde0517b976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1944b45a80>]}
[0m17:34:03.052494 [info ] [MainThread]: 
[0m17:34:03.053142 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:34:03.054357 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m17:34:03.054768 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:03.849623 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m17:34:03.851669 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:34:04.641564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bef847b-21f2-43f3-b9b5-7dde0517b976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1944b2b1c0>]}
[0m17:34:04.642282 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:34:04.642657 [info ] [MainThread]: 
[0m17:34:04.644851 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m17:34:04.645343 [info ] [Thread-1 (]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m17:34:04.645963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m17:34:04.646345 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m17:34:04.653562 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m17:34:04.654244 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 17:34:04.646597 => 17:34:04.654003
[0m17:34:04.654626 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m17:34:04.667004 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:05.438371 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m17:34:05.439209 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m17:34:06.181158 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c0d34206-7dd1-40d0-a3fb-3e6150efefa0&page=queryresults
[0m17:34:09.956208 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 17:34:04.654887 => 17:34:09.956028
[0m17:34:09.956916 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bef847b-21f2-43f3-b9b5-7dde0517b976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1944d044c0>]}
[0m17:34:09.957477 [info ] [Thread-1 (]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 5.31s]
[0m17:34:09.958060 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m17:34:09.958522 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m17:34:09.959108 [info ] [Thread-1 (]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m17:34:09.959751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m17:34:09.960131 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m17:34:09.962674 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m17:34:09.963328 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 17:34:09.960393 => 17:34:09.963093
[0m17:34:09.963706 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m17:34:09.969575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:10.758867 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m17:34:10.759791 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m17:34:11.369622 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:38caebbe-9284-485f-b9eb-ee687ee9ca0b&page=queryresults
[0m17:34:15.701782 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 17:34:09.963984 => 17:34:15.700919
[0m17:34:15.704919 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bef847b-21f2-43f3-b9b5-7dde0517b976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1944a45810>]}
[0m17:34:15.707446 [info ] [Thread-1 (]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 5.75s]
[0m17:34:15.710250 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m17:34:15.712277 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m17:34:15.714629 [info ] [Thread-1 (]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m17:34:15.717552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m17:34:15.719353 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m17:34:15.730752 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m17:34:15.732685 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 17:34:15.720671 => 17:34:15.732075
[0m17:34:15.733603 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m17:34:15.738390 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:16.524904 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m17:34:16.525547 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
    *,
    -- Monto del Descuento formateado como decimal con dos decimales
    CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
        WHEN discount_percent > 0 THEN (initial_price * (1 - discount_percent / 100))
        ELSE initial_price
    END) * 1.75 AS price_with_tax     
FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    *
FROM price_overview_cte
    );
  
[0m17:34:17.112104 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:1cf875bd-554c-4297-bc46-abf14521778d&page=queryresults
[0m17:34:20.933849 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 17:34:15.734275 => 17:34:20.933653
[0m17:34:20.934616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bef847b-21f2-43f3-b9b5-7dde0517b976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1944a30370>]}
[0m17:34:20.935192 [info ] [Thread-1 (]: 3 of 6 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (2.7k rows, 1.4 MiB processed)[0m in 5.22s]
[0m17:34:20.935804 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m17:34:20.936244 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m17:34:20.936787 [info ] [Thread-1 (]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m17:34:20.937476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m17:34:20.937849 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m17:34:20.940639 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m17:34:20.941298 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 17:34:20.938114 => 17:34:20.941062
[0m17:34:20.941675 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m17:34:20.943862 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:21.731834 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m17:34:21.732833 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m17:34:22.327297 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:657f3a40-efd1-47ee-8047-8208b3e80c5e&page=queryresults
[0m17:34:26.915375 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 17:34:20.941934 => 17:34:26.915187
[0m17:34:26.916289 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bef847b-21f2-43f3-b9b5-7dde0517b976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1944a455a0>]}
[0m17:34:26.916857 [info ] [Thread-1 (]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 5.98s]
[0m17:34:26.917494 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m17:34:26.917936 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m17:34:26.918396 [info ] [Thread-1 (]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m17:34:26.919070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m17:34:26.919457 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m17:34:26.922559 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m17:34:26.923329 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 17:34:26.919821 => 17:34:26.923087
[0m17:34:26.923781 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m17:34:26.931971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:27.686898 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m17:34:27.687630 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m17:34:28.283536 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9fd0e614-c9b1-4dc1-91c2-296de0e9e904&page=queryresults
[0m17:34:32.047046 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 17:34:26.924069 => 17:34:32.046181
[0m17:34:32.050181 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bef847b-21f2-43f3-b9b5-7dde0517b976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1944d06080>]}
[0m17:34:32.052742 [info ] [Thread-1 (]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 5.13s]
[0m17:34:32.055516 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m17:34:32.057569 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m17:34:32.059956 [info ] [Thread-1 (]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m17:34:32.062857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m17:34:32.064678 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m17:34:32.075842 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m17:34:32.077725 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 17:34:32.065960 => 17:34:32.077150
[0m17:34:32.078637 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m17:34:32.083378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:32.904807 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m17:34:32.905485 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m17:34:33.480593 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5881dc06-56a9-42a2-9a27-0e5d8be33b90&page=queryresults
[0m17:34:36.699112 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 17:34:32.079286 => 17:34:36.698241
[0m17:34:36.702217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bef847b-21f2-43f3-b9b5-7dde0517b976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1944a47bb0>]}
[0m17:34:36.704767 [info ] [Thread-1 (]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.64s]
[0m17:34:36.707546 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m17:34:36.713550 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:34:36.715103 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m17:34:36.716781 [info ] [MainThread]: 
[0m17:34:36.718497 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 33.66 seconds (33.66s).
[0m17:34:36.724900 [debug] [MainThread]: Command end result
[0m17:34:36.744024 [info ] [MainThread]: 
[0m17:34:36.744689 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:34:36.745233 [info ] [MainThread]: 
[0m17:34:36.745796 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m17:34:36.746662 [debug] [MainThread]: Command `dbt run` succeeded at 17:34:36.746505 after 34.09 seconds
[0m17:34:36.747242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1948d2a020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1944a47bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1944b2bd60>]}
[0m17:34:36.747812 [debug] [MainThread]: Flushing usage events
[0m17:50:13.420802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee701111b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee6e1a4070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee6e1a40d0>]}


============================== 17:50:13.423524 | 1b1ec2b5-df2c-4e05-82e7-24075ba0d0bd ==============================
[0m17:50:13.423524 [info ] [MainThread]: Running with dbt=1.6.5
[0m17:50:13.424171 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:50:13.725319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b1ec2b5-df2c-4e05-82e7-24075ba0d0bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee6f6b8e50>]}
[0m17:50:13.743148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b1ec2b5-df2c-4e05-82e7-24075ba0d0bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee6c1409d0>]}
[0m17:50:13.744009 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m17:50:13.760837 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m17:50:13.831275 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:50:13.831935 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m17:50:13.878245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b1ec2b5-df2c-4e05-82e7-24075ba0d0bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee6bff00d0>]}
[0m17:50:13.887160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b1ec2b5-df2c-4e05-82e7-24075ba0d0bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee6bf4bd90>]}
[0m17:50:13.887721 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m17:50:13.888122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b1ec2b5-df2c-4e05-82e7-24075ba0d0bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee6bf4bd00>]}
[0m17:50:13.889646 [info ] [MainThread]: 
[0m17:50:13.890500 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:50:13.892114 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m17:50:13.892625 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:14.715675 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m17:50:14.716849 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:50:15.445782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b1ec2b5-df2c-4e05-82e7-24075ba0d0bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee6bf49f90>]}
[0m17:50:15.446490 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:50:15.446874 [info ] [MainThread]: 
[0m17:50:15.448830 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m17:50:15.449313 [info ] [Thread-1 (]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m17:50:15.449929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m17:50:15.450308 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m17:50:15.457547 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m17:50:15.458338 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 17:50:15.450576 => 17:50:15.458008
[0m17:50:15.458726 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m17:50:15.471177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:16.294934 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m17:50:16.295753 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m17:50:16.907495 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:251b0097-23f7-4393-b9b1-00555a29d5c0&page=queryresults
[0m17:50:20.933355 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 17:50:15.458986 => 17:50:20.933038
[0m17:50:20.934476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b1ec2b5-df2c-4e05-82e7-24075ba0d0bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee6c140520>]}
[0m17:50:20.935379 [info ] [Thread-1 (]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 5.48s]
[0m17:50:20.936364 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m17:50:20.937008 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m17:50:20.937715 [info ] [Thread-1 (]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m17:50:20.938567 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m17:50:20.939097 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m17:50:20.942616 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m17:50:20.943389 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 17:50:20.939474 => 17:50:20.943137
[0m17:50:20.943863 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m17:50:20.950521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:21.682079 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m17:50:21.682833 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m17:50:22.207338 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:51e655e4-885b-4d42-9015-ece90066024f&page=queryresults
[0m17:50:26.064765 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 17:50:20.944192 => 17:50:26.063891
[0m17:50:26.067849 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b1ec2b5-df2c-4e05-82e7-24075ba0d0bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee6b6a61a0>]}
[0m17:50:26.070383 [info ] [Thread-1 (]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 5.13s]
[0m17:50:26.073197 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m17:50:26.075225 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m17:50:26.077651 [info ] [Thread-1 (]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m17:50:26.080556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m17:50:26.082374 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m17:50:26.092911 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m17:50:26.094431 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 17:50:26.083685 => 17:50:26.093930
[0m17:50:26.095346 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m17:50:26.099818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:26.822006 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m17:50:26.822737 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
    initial_price,
    final_price,
    discount_percent AS discount_pct,
    formatted_initial_price,
    formatted_final_price,
    -- Monto del Descuento formateado como decimal con dos decimales
    CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
        WHEN discount_percent > 0 THEN (initial_price * (1 - discount_percent / 100))
        ELSE initial_price
    END) * 1.75 AS price_with_tax     
FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE COALESCE(initial_price, final_price, discount_pct, discount_amount, formatted_initial_price, formatted_final_price, price_with_tax) IS NOT NULL;
    );
  
[0m17:50:27.113989 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:6b63af87-bf8f-46db-8803-0fb1fe324c57&page=queryresults
[0m17:50:27.116398 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [51:150]')
[0m17:50:28.303839 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5539b755-0a6c-407b-a90d-4dc97a8e4ad6&page=queryresults
[0m17:50:28.307998 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5539b755-0a6c-407b-a90d-4dc97a8e4ad6&page=queryresults
[0m17:50:28.310961 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 17:50:26.096021 => 17:50:28.310049
[0m17:50:28.316713 [debug] [Thread-1 (]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Syntax error: Expected ")" but got ";" at [51:150]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m17:50:28.317183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b1ec2b5-df2c-4e05-82e7-24075ba0d0bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee6b698790>]}
[0m17:50:28.317744 [error] [Thread-1 (]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 2.24s]
[0m17:50:28.318343 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m17:50:28.318805 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m17:50:28.319384 [info ] [Thread-1 (]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m17:50:28.320136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m17:50:28.320528 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m17:50:28.323377 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m17:50:28.324075 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 17:50:28.320795 => 17:50:28.323862
[0m17:50:28.324454 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m17:50:28.326557 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:29.096136 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m17:50:29.096833 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m17:50:29.711654 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:83c1bb5a-7b13-44f8-91fa-c1060f673ec6&page=queryresults
[0m17:50:33.689365 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 17:50:28.324715 => 17:50:33.688484
[0m17:50:33.692633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b1ec2b5-df2c-4e05-82e7-24075ba0d0bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee6b6889a0>]}
[0m17:50:33.695186 [info ] [Thread-1 (]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 5.37s]
[0m17:50:33.698012 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m17:50:33.700047 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m17:50:33.702447 [info ] [Thread-1 (]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m17:50:33.705567 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m17:50:33.707384 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m17:50:33.729246 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m17:50:33.730319 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 17:50:33.708718 => 17:50:33.729996
[0m17:50:33.732084 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m17:50:33.735146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:34.470421 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m17:50:34.471299 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m17:50:35.043271 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:2a09ee12-7b21-40a9-a1bb-29a77a9d3683&page=queryresults
[0m17:50:38.129475 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 17:50:33.732521 => 17:50:38.128592
[0m17:50:38.132603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b1ec2b5-df2c-4e05-82e7-24075ba0d0bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee6bff3310>]}
[0m17:50:38.135211 [info ] [Thread-1 (]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.43s]
[0m17:50:38.138160 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m17:50:38.140256 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m17:50:38.142650 [info ] [Thread-1 (]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m17:50:38.145588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m17:50:38.147419 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m17:50:38.158278 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m17:50:38.159938 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 17:50:38.148805 => 17:50:38.159438
[0m17:50:38.160871 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m17:50:38.165713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:38.926171 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m17:50:38.926952 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m17:50:39.548521 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9d766d60-5fac-4b22-8d44-f00248f230a7&page=queryresults
[0m17:50:43.265841 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 17:50:38.161534 => 17:50:43.265658
[0m17:50:43.266520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b1ec2b5-df2c-4e05-82e7-24075ba0d0bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee6b689c60>]}
[0m17:50:43.267116 [info ] [Thread-1 (]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 5.12s]
[0m17:50:43.267738 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m17:50:43.269260 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:43.269596 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m17:50:43.269949 [info ] [MainThread]: 
[0m17:50:43.270314 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 29.38 seconds (29.38s).
[0m17:50:43.271667 [debug] [MainThread]: Command end result
[0m17:50:43.279727 [info ] [MainThread]: 
[0m17:50:43.280177 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:50:43.280542 [info ] [MainThread]: 
[0m17:50:43.280906 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Syntax error: Expected ")" but got ";" at [51:150]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m17:50:43.281276 [info ] [MainThread]: 
[0m17:50:43.281656 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m17:50:43.282235 [debug] [MainThread]: Command `dbt run` failed at 17:50:43.282143 after 29.87 seconds
[0m17:50:43.282614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee701111b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee6b6a75e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee6bf4b400>]}
[0m17:50:43.282993 [debug] [MainThread]: Flushing usage events
[0m17:51:10.107065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f957b029180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95790b8070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95790b80d0>]}


============================== 17:51:10.109242 | dc17b124-68d7-4aac-9fa7-58aadae27523 ==============================
[0m17:51:10.109242 [info ] [MainThread]: Running with dbt=1.6.5
[0m17:51:10.109840 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:51:10.385562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc17b124-68d7-4aac-9fa7-58aadae27523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f957a58c7c0>]}
[0m17:51:10.401238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc17b124-68d7-4aac-9fa7-58aadae27523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95770589d0>]}
[0m17:51:10.401878 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m17:51:10.415401 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m17:51:10.478313 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:51:10.478860 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m17:51:10.522191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc17b124-68d7-4aac-9fa7-58aadae27523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9576ea00d0>]}
[0m17:51:10.530590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc17b124-68d7-4aac-9fa7-58aadae27523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9576e63df0>]}
[0m17:51:10.531037 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m17:51:10.531376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc17b124-68d7-4aac-9fa7-58aadae27523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9576e63d60>]}
[0m17:51:10.532687 [info ] [MainThread]: 
[0m17:51:10.533323 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:51:10.534515 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m17:51:10.534923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:11.272088 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m17:51:11.274279 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:51:11.995851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc17b124-68d7-4aac-9fa7-58aadae27523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9576e61ff0>]}
[0m17:51:11.998991 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:51:12.000695 [info ] [MainThread]: 
[0m17:51:12.008980 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m17:51:12.011192 [info ] [Thread-1 (]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m17:51:12.014127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m17:51:12.015933 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m17:51:12.037815 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m17:51:12.039103 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 17:51:12.017203 => 17:51:12.038686
[0m17:51:12.039776 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m17:51:12.057014 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:12.840213 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m17:51:12.841050 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m17:51:13.437951 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d6bef35a-9a16-4d75-a86e-55dfa7f0e97f&page=queryresults
[0m17:51:17.129030 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 17:51:12.040214 => 17:51:17.128696
[0m17:51:17.130213 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc17b124-68d7-4aac-9fa7-58aadae27523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9577058b80>]}
[0m17:51:17.131036 [info ] [Thread-1 (]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 5.12s]
[0m17:51:17.131885 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m17:51:17.132487 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m17:51:17.133204 [info ] [Thread-1 (]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m17:51:17.134084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m17:51:17.134596 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m17:51:17.138176 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m17:51:17.139005 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 17:51:17.134934 => 17:51:17.138757
[0m17:51:17.139459 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m17:51:17.145993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:17.916606 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m17:51:17.917253 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m17:51:18.527805 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:00cf5ab3-e2d8-47e5-b2b4-5f0be7d03f76&page=queryresults
[0m17:51:22.270262 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 17:51:17.139762 => 17:51:22.270076
[0m17:51:22.271097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc17b124-68d7-4aac-9fa7-58aadae27523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95767c61a0>]}
[0m17:51:22.271709 [info ] [Thread-1 (]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 5.14s]
[0m17:51:22.272339 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m17:51:22.272826 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m17:51:22.273321 [info ] [Thread-1 (]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m17:51:22.274052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m17:51:22.274582 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m17:51:22.277962 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m17:51:22.278663 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 17:51:22.274940 => 17:51:22.278458
[0m17:51:22.279051 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m17:51:22.281300 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:22.996423 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m17:51:22.999337 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
    initial_price,
    final_price,
    discount_percent AS discount_pct,
    formatted_initial_price,
    formatted_final_price,
    -- Monto del Descuento formateado como decimal con dos decimales
    CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
        WHEN discount_percent > 0 THEN (initial_price * (1 - discount_percent / 100))
        ELSE initial_price
    END) * 1.75 AS price_with_tax     
FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE COALESCE(initial_price, final_price, discount_pct, discount_amount, formatted_initial_price, formatted_final_price, price_with_tax) IS NOT NULL
    );
  
[0m17:51:23.714872 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:539d5a21-fbd0-40b9-baaf-be87f596a578&page=queryresults
[0m17:51:24.266604 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for function COALESCE for argument types: INT64, INT64, INT64, NUMERIC, STRING, STRING, FLOAT64. Supported signature: COALESCE([ANY, ...]) at [51:7]')
[0m17:51:25.240886 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:452c1688-e065-421e-b806-c31ad5dd41c6&page=queryresults
[0m17:51:25.807346 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:452c1688-e065-421e-b806-c31ad5dd41c6&page=queryresults
[0m17:51:25.810471 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 17:51:22.279326 => 17:51:25.809516
[0m17:51:25.823626 [debug] [Thread-1 (]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  No matching signature for function COALESCE for argument types: INT64, INT64, INT64, NUMERIC, STRING, STRING, FLOAT64. Supported signature: COALESCE([ANY, ...]) at [51:7]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m17:51:25.825817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc17b124-68d7-4aac-9fa7-58aadae27523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95767b8490>]}
[0m17:51:25.828566 [error] [Thread-1 (]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 3.55s]
[0m17:51:25.831619 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m17:51:25.833703 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m17:51:25.836236 [info ] [Thread-1 (]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m17:51:25.839389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m17:51:25.840868 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m17:51:25.848815 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m17:51:25.850146 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 17:51:25.841836 => 17:51:25.849761
[0m17:51:25.850882 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m17:51:25.855088 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:26.595858 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m17:51:26.596669 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m17:51:27.216528 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:67f6fa12-613b-407f-892b-b66eb824490b&page=queryresults
[0m17:51:30.892484 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 17:51:25.851447 => 17:51:30.892213
[0m17:51:30.893509 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc17b124-68d7-4aac-9fa7-58aadae27523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9574507c70>]}
[0m17:51:30.894293 [info ] [Thread-1 (]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 5.06s]
[0m17:51:30.895279 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m17:51:30.895981 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m17:51:30.896807 [info ] [Thread-1 (]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m17:51:30.897872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m17:51:30.898493 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m17:51:30.911386 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m17:51:30.912454 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 17:51:30.898930 => 17:51:30.912135
[0m17:51:30.913065 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m17:51:30.916462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:31.647790 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m17:51:31.648574 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m17:51:32.126154 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:eccb17ff-1c4f-47ce-ac52-7fb9c78f344b&page=queryresults
[0m17:51:36.071451 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 17:51:30.913495 => 17:51:36.071260
[0m17:51:36.072383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc17b124-68d7-4aac-9fa7-58aadae27523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f957703f010>]}
[0m17:51:36.072996 [info ] [Thread-1 (]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 5.17s]
[0m17:51:36.073665 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m17:51:36.074163 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m17:51:36.074748 [info ] [Thread-1 (]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m17:51:36.075515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m17:51:36.075939 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m17:51:36.078718 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m17:51:36.079322 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 17:51:36.076201 => 17:51:36.079131
[0m17:51:36.079724 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m17:51:36.081855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:36.816727 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m17:51:36.817423 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m17:51:37.287164 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b241f1f2-b12f-4c2a-9785-8c892f038137&page=queryresults
[0m17:51:40.062662 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 17:51:36.079979 => 17:51:40.061773
[0m17:51:40.065842 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc17b124-68d7-4aac-9fa7-58aadae27523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95767748b0>]}
[0m17:51:40.068426 [info ] [Thread-1 (]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 3.99s]
[0m17:51:40.071259 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m17:51:40.077187 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:51:40.078739 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m17:51:40.080409 [info ] [MainThread]: 
[0m17:51:40.082116 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 29.55 seconds (29.55s).
[0m17:51:40.088968 [debug] [MainThread]: Command end result
[0m17:51:40.116556 [info ] [MainThread]: 
[0m17:51:40.117373 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:51:40.118017 [info ] [MainThread]: 
[0m17:51:40.118665 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  No matching signature for function COALESCE for argument types: INT64, INT64, INT64, NUMERIC, STRING, STRING, FLOAT64. Supported signature: COALESCE([ANY, ...]) at [51:7]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m17:51:40.119336 [info ] [MainThread]: 
[0m17:51:40.119945 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m17:51:40.120814 [debug] [MainThread]: Command `dbt run` failed at 17:51:40.120657 after 30.02 seconds
[0m17:51:40.121401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f957b029180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f957a7747f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f957908feb0>]}
[0m17:51:40.122011 [debug] [MainThread]: Flushing usage events
[0m17:53:23.721262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0274e2ab60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0272f88070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0272f880d0>]}


============================== 17:53:23.723446 | 05a0f513-c37d-402b-8aee-83fd037a054c ==============================
[0m17:53:23.723446 [info ] [MainThread]: Running with dbt=1.6.5
[0m17:53:23.723938 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'profiles_dir': '../dbt/', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:53:24.010391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05a0f513-c37d-402b-8aee-83fd037a054c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f027446c1f0>]}
[0m17:53:24.026820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05a0f513-c37d-402b-8aee-83fd037a054c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0270f27490>]}
[0m17:53:24.027481 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m17:53:24.041894 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m17:53:24.106947 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:53:24.107525 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m17:53:24.152716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05a0f513-c37d-402b-8aee-83fd037a054c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0270dd40d0>]}
[0m17:53:24.161687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05a0f513-c37d-402b-8aee-83fd037a054c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0270d2fdf0>]}
[0m17:53:24.162179 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m17:53:24.162536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05a0f513-c37d-402b-8aee-83fd037a054c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0270d2fd60>]}
[0m17:53:24.163901 [info ] [MainThread]: 
[0m17:53:24.164606 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:53:24.165913 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m17:53:24.166339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:24.929235 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m17:53:24.929713 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:53:25.618999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05a0f513-c37d-402b-8aee-83fd037a054c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0270d2dff0>]}
[0m17:53:25.622247 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:53:25.623959 [info ] [MainThread]: 
[0m17:53:25.632057 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m17:53:25.634235 [info ] [Thread-1 (]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m17:53:25.637105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m17:53:25.638874 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m17:53:25.669961 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m17:53:25.671648 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 17:53:25.640162 => 17:53:25.671113
[0m17:53:25.672586 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m17:53:25.693562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:26.496832 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m17:53:26.497601 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m17:53:26.996839 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5c225e6d-7cc5-47b0-8ee6-be37693c6f59&page=queryresults
[0m17:53:31.202735 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 17:53:25.673238 => 17:53:31.202544
[0m17:53:31.203475 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05a0f513-c37d-402b-8aee-83fd037a054c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f027048ee00>]}
[0m17:53:31.204094 [info ] [Thread-1 (]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 5.57s]
[0m17:53:31.204695 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m17:53:31.205134 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m17:53:31.205677 [info ] [Thread-1 (]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m17:53:31.206435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m17:53:31.206883 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m17:53:31.209965 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m17:53:31.210701 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 17:53:31.207170 => 17:53:31.210475
[0m17:53:31.211112 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m17:53:31.217355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:32.008340 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m17:53:32.011005 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m17:53:32.619454 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:2b249735-6243-4b3c-be0d-c2915a9c5a19&page=queryresults
[0m17:53:37.260553 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 17:53:31.211382 => 17:53:37.260375
[0m17:53:37.261251 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05a0f513-c37d-402b-8aee-83fd037a054c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f027048e2f0>]}
[0m17:53:37.261804 [info ] [Thread-1 (]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 6.06s]
[0m17:53:37.262412 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m17:53:37.262874 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m17:53:37.263440 [info ] [Thread-1 (]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m17:53:37.264121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m17:53:37.264490 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m17:53:37.267305 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m17:53:37.267988 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 17:53:37.264776 => 17:53:37.267792
[0m17:53:37.268369 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m17:53:37.270504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:38.010878 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m17:53:38.011649 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
    initial_price,
    final_price,
    discount_percent AS discount_pct,
    formatted_initial_price,
    formatted_final_price,
    -- Monto del Descuento formateado como decimal con dos decimales
    CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
        WHEN discount_percent > 0 THEN (initial_price * (1 - discount_percent / 100))
        ELSE initial_price
    END) * 1.75 AS price_with_tax     
FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL);
    );
  
[0m17:53:38.329570 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:4c129ba1-af9c-427c-9f0d-d637fefaa0d1&page=queryresults
[0m17:53:38.333788 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [58:37]')
[0m17:53:39.032657 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ae48dd76-f737-46ec-80b2-9e92def28a37&page=queryresults
[0m17:53:39.033757 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ae48dd76-f737-46ec-80b2-9e92def28a37&page=queryresults
[0m17:53:39.034377 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 17:53:37.268631 => 17:53:39.034181
[0m17:53:39.037083 [debug] [Thread-1 (]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Syntax error: Expected ")" but got ";" at [58:37]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m17:53:39.037548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05a0f513-c37d-402b-8aee-83fd037a054c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02704590f0>]}
[0m17:53:39.038106 [error] [Thread-1 (]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 1.77s]
[0m17:53:39.038705 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m17:53:39.039168 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m17:53:39.039712 [info ] [Thread-1 (]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m17:53:39.040433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m17:53:39.040815 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m17:53:39.043767 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m17:53:39.044386 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 17:53:39.041078 => 17:53:39.044191
[0m17:53:39.044764 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m17:53:39.046905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:39.741583 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m17:53:39.742438 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m17:53:40.341245 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5c2d5489-7114-48b4-a2cb-d5d69f6a1b3a&page=queryresults
[0m17:53:44.345809 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 17:53:39.045022 => 17:53:44.345601
[0m17:53:44.346573 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05a0f513-c37d-402b-8aee-83fd037a054c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0270468b50>]}
[0m17:53:44.347241 [info ] [Thread-1 (]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 5.31s]
[0m17:53:44.347886 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m17:53:44.348339 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m17:53:44.348801 [info ] [Thread-1 (]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m17:53:44.349542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m17:53:44.349951 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m17:53:44.360749 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m17:53:44.361449 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 17:53:44.350225 => 17:53:44.361253
[0m17:53:44.361837 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m17:53:44.364064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:45.112039 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m17:53:45.112858 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m17:53:45.688117 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:1cd9856e-dea9-4c3e-9fae-69c8993c1ea6&page=queryresults
[0m17:53:50.096248 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 17:53:44.362104 => 17:53:50.096051
[0m17:53:50.097229 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05a0f513-c37d-402b-8aee-83fd037a054c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0270f0a200>]}
[0m17:53:50.097878 [info ] [Thread-1 (]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 5.75s]
[0m17:53:50.098490 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m17:53:50.098923 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m17:53:50.099452 [info ] [Thread-1 (]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m17:53:50.100082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m17:53:50.100452 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m17:53:50.103283 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m17:53:50.103935 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 17:53:50.100714 => 17:53:50.103729
[0m17:53:50.104353 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m17:53:50.106939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:50.829483 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m17:53:50.830220 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m17:53:51.266815 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ca1d6a7e-7f92-4085-84fd-ce45d68924c2&page=queryresults
[0m17:53:55.065676 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 17:53:50.104641 => 17:53:55.065489
[0m17:53:55.066359 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05a0f513-c37d-402b-8aee-83fd037a054c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f027046a380>]}
[0m17:53:55.066904 [info ] [Thread-1 (]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.97s]
[0m17:53:55.067471 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m17:53:55.069306 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:53:55.069673 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m17:53:55.070034 [info ] [MainThread]: 
[0m17:53:55.070429 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 30.91 seconds (30.91s).
[0m17:53:55.071784 [debug] [MainThread]: Command end result
[0m17:53:55.079770 [info ] [MainThread]: 
[0m17:53:55.080197 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:53:55.080521 [info ] [MainThread]: 
[0m17:53:55.080841 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Syntax error: Expected ")" but got ";" at [58:37]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m17:53:55.081178 [info ] [MainThread]: 
[0m17:53:55.081518 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m17:53:55.082053 [debug] [MainThread]: Command `dbt run` failed at 17:53:55.081958 after 31.37 seconds
[0m17:53:55.082414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0274e2ab60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0270d5e620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0270d2f280>]}
[0m17:53:55.082782 [debug] [MainThread]: Flushing usage events
[0m17:54:01.172821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60b7f1ead0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60b60b0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60b60b00d0>]}


============================== 17:54:01.174864 | 7dbecca5-7c7a-4d8a-b332-991a3f4e3f5e ==============================
[0m17:54:01.174864 [info ] [MainThread]: Running with dbt=1.6.5
[0m17:54:01.175351 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'profiles_dir': '../dbt/', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:54:01.449799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7dbecca5-7c7a-4d8a-b332-991a3f4e3f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60b756fdc0>]}
[0m17:54:01.465410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7dbecca5-7c7a-4d8a-b332-991a3f4e3f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60b40509d0>]}
[0m17:54:01.465950 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m17:54:01.479507 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m17:54:01.543014 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:54:01.543568 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m17:54:01.587247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7dbecca5-7c7a-4d8a-b332-991a3f4e3f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60b3e900d0>]}
[0m17:54:01.595775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7dbecca5-7c7a-4d8a-b332-991a3f4e3f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60b3e5fdc0>]}
[0m17:54:01.596235 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m17:54:01.596579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dbecca5-7c7a-4d8a-b332-991a3f4e3f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60b3e5fd30>]}
[0m17:54:01.597850 [info ] [MainThread]: 
[0m17:54:01.598492 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:54:01.599748 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m17:54:01.600171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:02.382611 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m17:54:02.384406 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:54:03.078955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dbecca5-7c7a-4d8a-b332-991a3f4e3f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60b3e5dfc0>]}
[0m17:54:03.079728 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:54:03.080127 [info ] [MainThread]: 
[0m17:54:03.082160 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m17:54:03.082635 [info ] [Thread-1 (]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m17:54:03.083258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m17:54:03.083643 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m17:54:03.090733 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m17:54:03.091437 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 17:54:03.083916 => 17:54:03.091200
[0m17:54:03.091867 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m17:54:03.104809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:03.877519 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m17:54:03.878253 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m17:54:04.705988 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e8e96db7-df19-4a02-af18-6196dfffadbb&page=queryresults
[0m17:54:08.419157 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 17:54:03.092157 => 17:54:08.418972
[0m17:54:08.419919 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dbecca5-7c7a-4d8a-b332-991a3f4e3f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60b4050340>]}
[0m17:54:08.420495 [info ] [Thread-1 (]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 5.34s]
[0m17:54:08.421119 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m17:54:08.421583 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m17:54:08.422022 [info ] [Thread-1 (]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m17:54:08.422761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m17:54:08.423150 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m17:54:08.425711 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m17:54:08.426369 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 17:54:08.423420 => 17:54:08.426130
[0m17:54:08.426755 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m17:54:08.432823 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:09.174172 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m17:54:09.176919 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m17:54:09.763797 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ad4e11a1-1b67-4212-9b18-df07014b8255&page=queryresults
[0m17:54:13.078453 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 17:54:08.427031 => 17:54:13.078269
[0m17:54:13.079189 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dbecca5-7c7a-4d8a-b332-991a3f4e3f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60b35ba1a0>]}
[0m17:54:13.079760 [info ] [Thread-1 (]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.66s]
[0m17:54:13.080351 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m17:54:13.080788 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m17:54:13.081335 [info ] [Thread-1 (]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m17:54:13.081967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m17:54:13.082355 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m17:54:13.085357 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m17:54:13.086019 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 17:54:13.082631 => 17:54:13.085805
[0m17:54:13.086410 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m17:54:13.088606 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:13.847280 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m17:54:13.848149 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
    initial_price,
    final_price,
    discount_percent AS discount_pct,
    formatted_initial_price,
    formatted_final_price,
    -- Monto del Descuento formateado como decimal con dos decimales
    CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
        WHEN discount_percent > 0 THEN (initial_price * (1 - discount_percent / 100))
        ELSE initial_price
    END) * 1.75 AS price_with_tax     
FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m17:54:14.510507 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:0ce85b28-36ea-4290-ad36-121c60c2dd55&page=queryresults
[0m17:54:17.933079 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 17:54:13.086686 => 17:54:17.932210
[0m17:54:17.936374 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dbecca5-7c7a-4d8a-b332-991a3f4e3f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60b35aec20>]}
[0m17:54:17.938947 [info ] [Thread-1 (]: 3 of 6 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (1.1k rows, 92.9 KiB processed)[0m in 4.85s]
[0m17:54:17.941795 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m17:54:17.943855 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m17:54:17.946254 [info ] [Thread-1 (]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m17:54:17.949376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m17:54:17.951214 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m17:54:17.961433 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m17:54:17.962993 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 17:54:17.952550 => 17:54:17.962481
[0m17:54:17.963944 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m17:54:17.966705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:18.731363 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m17:54:18.732129 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m17:54:19.137236 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:41386ffd-67fa-4fdf-9fe0-a52986cf45d3&page=queryresults
[0m17:54:22.836549 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 17:54:17.964609 => 17:54:22.835665
[0m17:54:22.839860 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dbecca5-7c7a-4d8a-b332-991a3f4e3f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60b35ace20>]}
[0m17:54:22.842415 [info ] [Thread-1 (]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.89s]
[0m17:54:22.845234 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m17:54:22.847280 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m17:54:22.849717 [info ] [Thread-1 (]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m17:54:22.852856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m17:54:22.854685 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m17:54:22.865350 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m17:54:22.867057 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 17:54:22.856051 => 17:54:22.866550
[0m17:54:22.868005 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m17:54:22.882277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:23.612428 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m17:54:23.613176 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m17:54:24.217106 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:32a72931-90f9-41c8-9d48-3f38ae58412e&page=queryresults
[0m17:54:28.241690 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 17:54:22.868664 => 17:54:28.240814
[0m17:54:28.244795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dbecca5-7c7a-4d8a-b332-991a3f4e3f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60b4053850>]}
[0m17:54:28.247338 [info ] [Thread-1 (]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 5.39s]
[0m17:54:28.250160 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m17:54:28.252215 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m17:54:28.254602 [info ] [Thread-1 (]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m17:54:28.257548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m17:54:28.259381 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m17:54:28.270407 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m17:54:28.272085 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 17:54:28.260731 => 17:54:28.271624
[0m17:54:28.272485 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m17:54:28.274583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:29.012354 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m17:54:29.013079 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m17:54:29.550006 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c9c0d1fc-6cad-4a93-9d92-3abddbd5e6f8&page=queryresults
[0m17:54:33.221959 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 17:54:28.272740 => 17:54:33.221079
[0m17:54:33.225121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dbecca5-7c7a-4d8a-b332-991a3f4e3f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60b3ee7e80>]}
[0m17:54:33.227796 [info ] [Thread-1 (]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.97s]
[0m17:54:33.230678 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m17:54:33.236842 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:54:33.238454 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m17:54:33.240205 [info ] [MainThread]: 
[0m17:54:33.241963 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 31.64 seconds (31.64s).
[0m17:54:33.248486 [debug] [MainThread]: Command end result
[0m17:54:33.271379 [info ] [MainThread]: 
[0m17:54:33.272089 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:54:33.272666 [info ] [MainThread]: 
[0m17:54:33.273246 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m17:54:33.274137 [debug] [MainThread]: Command `dbt run` succeeded at 17:54:33.273976 after 32.11 seconds
[0m17:54:33.274726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60b7f1ead0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60b3e8a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60b608bf70>]}
[0m17:54:33.275458 [debug] [MainThread]: Flushing usage events
[0m18:01:58.473652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb91132b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb8f2c4070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb8f2c40d0>]}


============================== 18:01:58.475857 | 204faeeb-b952-4a93-9f1f-bdfae0add90d ==============================
[0m18:01:58.475857 [info ] [MainThread]: Running with dbt=1.6.5
[0m18:01:58.476450 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'debug': 'False', 'profiles_dir': '../dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:01:58.769600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '204faeeb-b952-4a93-9f1f-bdfae0add90d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb9074c7c0>]}
[0m18:01:58.785841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '204faeeb-b952-4a93-9f1f-bdfae0add90d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb8d2649d0>]}
[0m18:01:58.786462 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m18:01:58.800429 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m18:01:58.865586 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:01:58.866118 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:01:58.872124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '204faeeb-b952-4a93-9f1f-bdfae0add90d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb8d0b9b40>]}
[0m18:01:58.881409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '204faeeb-b952-4a93-9f1f-bdfae0add90d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb8d091ab0>]}
[0m18:01:58.881926 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m18:01:58.882303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '204faeeb-b952-4a93-9f1f-bdfae0add90d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb8d091b70>]}
[0m18:01:58.883628 [info ] [MainThread]: 
[0m18:01:58.884315 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:01:58.885560 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m18:01:58.885995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:59.687757 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m18:01:59.688652 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:02:00.426273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '204faeeb-b952-4a93-9f1f-bdfae0add90d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb8d0902b0>]}
[0m18:02:00.427406 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:02:00.428010 [info ] [MainThread]: 
[0m18:02:00.430757 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m18:02:00.431534 [info ] [Thread-1 (]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m18:02:00.432542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m18:02:00.433147 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m18:02:00.444961 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m18:02:00.445964 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 18:02:00.433569 => 18:02:00.445650
[0m18:02:00.446564 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m18:02:00.465919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:02:01.224085 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m18:02:01.224864 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m18:02:01.718428 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a974fb23-8330-4e1e-ab38-97a9628fb416&page=queryresults
[0m18:02:05.394157 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 18:02:00.446983 => 18:02:05.393954
[0m18:02:05.395098 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '204faeeb-b952-4a93-9f1f-bdfae0add90d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb8d24b310>]}
[0m18:02:05.396021 [info ] [Thread-1 (]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.96s]
[0m18:02:05.396925 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m18:02:05.397410 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m18:02:05.398010 [info ] [Thread-1 (]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m18:02:05.398695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m18:02:05.399134 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m18:02:05.401906 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m18:02:05.402538 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 18:02:05.399406 => 18:02:05.402342
[0m18:02:05.402988 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m18:02:05.411125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:02:06.171847 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m18:02:06.172590 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m18:02:06.689370 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7c5f1e53-99da-42e7-814d-aa4d7c0cc290&page=queryresults
[0m18:02:10.631249 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 18:02:05.403282 => 18:02:10.631058
[0m18:02:10.632027 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '204faeeb-b952-4a93-9f1f-bdfae0add90d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb8cfa2260>]}
[0m18:02:10.632690 [info ] [Thread-1 (]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 5.23s]
[0m18:02:10.633315 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m18:02:10.633759 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m18:02:10.634273 [info ] [Thread-1 (]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m18:02:10.634932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m18:02:10.635331 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m18:02:10.638739 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m18:02:10.639904 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 18:02:10.635675 => 18:02:10.639576
[0m18:02:10.640446 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m18:02:10.642982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:02:11.351790 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m18:02:11.477330 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
    initial_price,
    final_price,
    discount_percent AS discount_pct,
    formatted_initial_price,
    formatted_final_price,
    -- Monto del Descuento formateado como decimal con dos decimales
    CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
        WHEN discount_percent > 0 THEN (initial_price * (1 - discount_percent / 100))
        ELSE initial_price
    END) * 1.75 AS price_with_tax     
FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m18:02:12.116616 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:89af91e2-4c9d-40df-b14c-b43d3a2c6cf3&page=queryresults
[0m18:02:16.234241 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 18:02:10.640838 => 18:02:16.233336
[0m18:02:16.237525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '204faeeb-b952-4a93-9f1f-bdfae0add90d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb8cf8a320>]}
[0m18:02:16.239944 [info ] [Thread-1 (]: 3 of 6 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (1.1k rows, 92.9 KiB processed)[0m in 5.60s]
[0m18:02:16.241992 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m18:02:16.243621 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m18:02:16.245418 [info ] [Thread-1 (]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m18:02:16.247711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m18:02:16.249041 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m18:02:16.258576 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m18:02:16.264258 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 18:02:16.249961 => 18:02:16.263519
[0m18:02:16.265569 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m18:02:16.272737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:02:17.116870 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m18:02:17.119104 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m18:02:17.698653 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d9e0bf8f-7e50-4820-a1ae-14b938eb7e04&page=queryresults
[0m18:02:22.692347 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 18:02:16.266476 => 18:02:22.691453
[0m18:02:22.695628 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '204faeeb-b952-4a93-9f1f-bdfae0add90d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb8cf8ace0>]}
[0m18:02:22.698257 [info ] [Thread-1 (]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 6.45s]
[0m18:02:22.701080 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m18:02:22.703099 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m18:02:22.705531 [info ] [Thread-1 (]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m18:02:22.708647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m18:02:22.710470 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m18:02:22.719268 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m18:02:22.758619 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 18:02:22.711797 => 18:02:22.757552
[0m18:02:22.760547 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m18:02:22.791373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:02:23.566895 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m18:02:23.686958 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m18:02:24.299368 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:bf4f265c-7a0c-43b7-857d-e6eea25a38cf&page=queryresults
[0m18:02:28.335729 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 18:02:22.761848 => 18:02:28.335520
[0m18:02:28.336489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '204faeeb-b952-4a93-9f1f-bdfae0add90d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb8d24ac80>]}
[0m18:02:28.337190 [info ] [Thread-1 (]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 5.63s]
[0m18:02:28.338038 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m18:02:28.338694 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m18:02:28.339397 [info ] [Thread-1 (]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m18:02:28.340226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m18:02:28.340742 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m18:02:28.343990 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m18:02:28.491956 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 18:02:28.341111 => 18:02:28.491673
[0m18:02:28.492395 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m18:02:28.494608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:02:29.260276 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m18:02:29.853033 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m18:02:30.288952 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:20b9f1dd-c352-4a80-a096-ea1ddf6bbd55&page=queryresults
[0m18:02:34.299416 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 18:02:28.492661 => 18:02:34.299220
[0m18:02:34.300228 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '204faeeb-b952-4a93-9f1f-bdfae0add90d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb8cf8beb0>]}
[0m18:02:34.300877 [info ] [Thread-1 (]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 5.96s]
[0m18:02:34.301587 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m18:02:34.303077 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:02:34.303477 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m18:02:34.303866 [info ] [MainThread]: 
[0m18:02:34.304260 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 35.42 seconds (35.42s).
[0m18:02:34.305799 [debug] [MainThread]: Command end result
[0m18:02:34.317155 [info ] [MainThread]: 
[0m18:02:34.317931 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:02:34.318610 [info ] [MainThread]: 
[0m18:02:34.319167 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:02:34.320077 [debug] [MainThread]: Command `dbt run` succeeded at 18:02:34.319955 after 35.85 seconds
[0m18:02:34.320662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb91132b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb8cf8beb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb909447f0>]}
[0m18:02:34.321123 [debug] [MainThread]: Flushing usage events
[0m18:03:32.993711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcdb12dbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd918c070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd918c0d0>]}


============================== 18:03:32.996144 | b7e34ac9-781c-47b1-83e3-3fcd7f83f336 ==============================
[0m18:03:32.996144 [info ] [MainThread]: Running with dbt=1.6.5
[0m18:03:32.996715 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:03:33.549191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7e34ac9-781c-47b1-83e3-3fcd7f83f336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd710ec50>]}
[0m18:03:33.566621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7e34ac9-781c-47b1-83e3-3fcd7f83f336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd71287c0>]}
[0m18:03:33.567324 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m18:03:33.582889 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m18:03:33.674182 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:03:33.674835 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m18:03:33.753529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7e34ac9-781c-47b1-83e3-3fcd7f83f336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd6fe00d0>]}
[0m18:03:34.025132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7e34ac9-781c-47b1-83e3-3fcd7f83f336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd6f33d60>]}
[0m18:03:34.025666 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m18:03:34.026111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7e34ac9-781c-47b1-83e3-3fcd7f83f336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd6f33cd0>]}
[0m18:03:34.027613 [info ] [MainThread]: 
[0m18:03:34.028443 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:03:34.030018 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m18:03:34.030509 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:34.783566 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m18:03:34.784054 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:03:35.483470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7e34ac9-781c-47b1-83e3-3fcd7f83f336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd6f31f60>]}
[0m18:03:35.484409 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:03:35.484852 [info ] [MainThread]: 
[0m18:03:35.487125 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m18:03:35.487720 [info ] [Thread-1 (]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m18:03:35.488486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m18:03:35.488913 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m18:03:35.496818 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m18:03:35.503140 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 18:03:35.489202 => 18:03:35.502817
[0m18:03:35.503716 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m18:03:35.518359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:36.260460 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m18:03:36.429024 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m18:03:37.042652 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b5efd21e-569d-4608-a52d-836320377998&page=queryresults
[0m18:03:40.750610 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 18:03:35.504159 => 18:03:40.750407
[0m18:03:40.751694 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7e34ac9-781c-47b1-83e3-3fcd7f83f336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd7128d30>]}
[0m18:03:40.752427 [info ] [Thread-1 (]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 5.26s]
[0m18:03:40.753222 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m18:03:40.753774 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m18:03:40.754376 [info ] [Thread-1 (]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m18:03:40.755188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m18:03:40.755686 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m18:03:40.758827 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m18:03:40.759880 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 18:03:40.756035 => 18:03:40.759623
[0m18:03:40.760385 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m18:03:40.768149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:41.568097 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m18:03:41.572300 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m18:03:42.158588 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7d8c618e-1672-4ff1-b5d0-0ad33a6e3d3c&page=queryresults
[0m18:03:46.217853 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 18:03:40.760743 => 18:03:46.217512
[0m18:03:46.219011 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7e34ac9-781c-47b1-83e3-3fcd7f83f336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd68921a0>]}
[0m18:03:46.219966 [info ] [Thread-1 (]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 5.46s]
[0m18:03:46.220961 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m18:03:46.221693 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m18:03:46.222549 [info ] [Thread-1 (]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m18:03:46.223579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m18:03:46.224209 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m18:03:46.228441 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m18:03:46.342682 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 18:03:46.224630 => 18:03:46.342211
[0m18:03:46.343391 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m18:03:46.346609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:47.072226 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m18:03:47.113807 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        *,
        -- Monto del Descuento formateado como decimal con dos decimales
        CAST(
            (CASE
                WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
                ELSE 0.0
            END) / 100 AS NUMERIC
        ) AS discount_amount,

        -- Precio del Juego con Impuesto (75%)
        (CASE
            WHEN discount_percent > 0 THEN (initial_price * (1 - discount_percent / 100))
            ELSE initial_price
        END) * 1.75 AS price_with_tax     
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m18:03:47.734828 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:363c32d1-f1ae-413c-9ecf-9998a1e95761&page=queryresults
[0m18:03:48.262761 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: discount_pct; Did you mean discount_percent? at [50:10]')
[0m18:03:48.988105 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:41949227-0791-4f4d-bfa1-1571a7599d4b&page=queryresults
[0m18:03:49.525325 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:41949227-0791-4f4d-bfa1-1571a7599d4b&page=queryresults
[0m18:03:49.528441 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 18:03:46.343805 => 18:03:49.527464
[0m18:03:49.541486 [debug] [Thread-1 (]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Unrecognized name: discount_pct; Did you mean discount_percent? at [50:10]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m18:03:49.543650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7e34ac9-781c-47b1-83e3-3fcd7f83f336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd6884e80>]}
[0m18:03:49.546268 [error] [Thread-1 (]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 3.32s]
[0m18:03:49.549139 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m18:03:49.550719 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m18:03:49.552540 [info ] [Thread-1 (]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m18:03:49.554737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m18:03:49.555790 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m18:03:49.561952 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m18:03:49.657382 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 18:03:49.556471 => 18:03:49.657040
[0m18:03:49.657947 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m18:03:49.660683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:50.390186 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m18:03:50.395492 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m18:03:51.019211 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a8010362-ac7b-45e8-85d7-12e02fcf180e&page=queryresults
[0m18:03:54.866118 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 18:03:49.658321 => 18:03:54.865920
[0m18:03:54.866918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7e34ac9-781c-47b1-83e3-3fcd7f83f336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcda6befb0>]}
[0m18:03:54.867495 [info ] [Thread-1 (]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 5.31s]
[0m18:03:54.868195 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m18:03:54.868644 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m18:03:54.869345 [info ] [Thread-1 (]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m18:03:54.870171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m18:03:54.870717 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m18:03:54.881673 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m18:03:54.892272 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 18:03:54.871010 => 18:03:54.891934
[0m18:03:54.892716 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m18:03:54.895104 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:55.603669 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m18:03:55.636494 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m18:03:56.261928 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:6a6fe2b2-fd07-4780-98d0-c13ddfc9fcc6&page=queryresults
[0m18:03:59.939906 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 18:03:54.893009 => 18:03:59.939715
[0m18:03:59.940635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7e34ac9-781c-47b1-83e3-3fcd7f83f336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd6874be0>]}
[0m18:03:59.941211 [info ] [Thread-1 (]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 5.07s]
[0m18:03:59.941820 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m18:03:59.942269 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m18:03:59.942804 [info ] [Thread-1 (]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m18:03:59.943513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m18:03:59.943945 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m18:03:59.947001 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m18:03:59.976779 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 18:03:59.944232 => 18:03:59.976480
[0m18:03:59.977242 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m18:03:59.979622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:00.676710 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m18:04:00.745577 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m18:04:01.377909 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:6cfe2e5b-1efc-40a4-9a97-ef6196c551c5&page=queryresults
[0m18:04:05.173402 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 18:03:59.977523 => 18:04:05.173205
[0m18:04:05.174133 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7e34ac9-781c-47b1-83e3-3fcd7f83f336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd68411e0>]}
[0m18:04:05.174724 [info ] [Thread-1 (]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 5.23s]
[0m18:04:05.175332 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m18:04:05.176750 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:04:05.177150 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m18:04:05.177511 [info ] [MainThread]: 
[0m18:04:05.177862 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 31.15 seconds (31.15s).
[0m18:04:05.179190 [debug] [MainThread]: Command end result
[0m18:04:05.188656 [info ] [MainThread]: 
[0m18:04:05.189110 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:04:05.189442 [info ] [MainThread]: 
[0m18:04:05.189768 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Unrecognized name: discount_pct; Did you mean discount_percent? at [50:10]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m18:04:05.190098 [info ] [MainThread]: 
[0m18:04:05.190474 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m18:04:05.191050 [debug] [MainThread]: Command `dbt run` failed at 18:04:05.190947 after 32.20 seconds
[0m18:04:05.191428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcdb12dbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd9363f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcd6f331f0>]}
[0m18:04:05.191817 [debug] [MainThread]: Flushing usage events
[0m18:05:05.964235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9d19335b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9cfa94070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9cfa940d0>]}


============================== 18:05:05.966379 | 7fa5e25e-f643-451e-904e-41b669e000a1 ==============================
[0m18:05:05.966379 [info ] [MainThread]: Running with dbt=1.6.5
[0m18:05:05.966845 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:05:06.266016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7fa5e25e-f643-451e-904e-41b669e000a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9cda1ac50>]}
[0m18:05:06.282237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7fa5e25e-f643-451e-904e-41b669e000a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9d0ddaad0>]}
[0m18:05:06.282867 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m18:05:06.297594 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m18:05:06.362713 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:05:06.363299 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m18:05:06.408217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7fa5e25e-f643-451e-904e-41b669e000a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9cd8e80d0>]}
[0m18:05:06.417011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7fa5e25e-f643-451e-904e-41b669e000a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9cd83fd30>]}
[0m18:05:06.417578 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m18:05:06.417992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fa5e25e-f643-451e-904e-41b669e000a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9cd83fe20>]}
[0m18:05:06.419413 [info ] [MainThread]: 
[0m18:05:06.420136 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:05:06.421379 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m18:05:06.421892 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:05:12.243660 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m18:05:12.245840 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:05:12.955924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fa5e25e-f643-451e-904e-41b669e000a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9cd83dff0>]}
[0m18:05:12.959066 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:05:12.960737 [info ] [MainThread]: 
[0m18:05:12.968802 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m18:05:12.970991 [info ] [Thread-1 (]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m18:05:12.973900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m18:05:12.975708 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m18:05:13.003689 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m18:05:13.005168 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 18:05:12.976980 => 18:05:13.004696
[0m18:05:13.005904 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m18:05:13.025397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:05:13.785762 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m18:05:13.786571 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m18:05:14.398233 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:32050d6b-02c4-4d01-9aad-0d1251e1f605&page=queryresults
[0m18:05:18.252593 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 18:05:13.006432 => 18:05:18.252295
[0m18:05:18.253675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fa5e25e-f643-451e-904e-41b669e000a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9cda34f10>]}
[0m18:05:18.254546 [info ] [Thread-1 (]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 5.28s]
[0m18:05:18.255433 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m18:05:18.256019 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m18:05:18.256703 [info ] [Thread-1 (]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m18:05:18.257531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m18:05:18.258044 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m18:05:18.261402 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m18:05:18.262123 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 18:05:18.258407 => 18:05:18.261896
[0m18:05:18.262572 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m18:05:18.269063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:05:19.022610 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m18:05:19.023363 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m18:05:19.653283 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:2cf54561-7187-4f57-9c9a-d7a9b9e86550&page=queryresults
[0m18:05:23.191148 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 18:05:18.262890 => 18:05:23.190783
[0m18:05:23.192469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fa5e25e-f643-451e-904e-41b669e000a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9d0f5b8e0>]}
[0m18:05:23.193537 [info ] [Thread-1 (]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.94s]
[0m18:05:23.194688 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m18:05:23.195464 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m18:05:23.196300 [info ] [Thread-1 (]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m18:05:23.197388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m18:05:23.198027 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m18:05:23.202325 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m18:05:23.203189 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 18:05:23.198464 => 18:05:23.202905
[0m18:05:23.203719 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m18:05:23.206595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:05:23.965758 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m18:05:23.966467 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        -- Monto del Descuento formateado como decimal con dos decimales
        CAST(
            (CASE
                WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
                ELSE 0.0
            END) / 100 AS NUMERIC
        ) AS discount_amount,

        -- Precio del Juego con Impuesto (75%)
        (CASE
            WHEN discount_percent > 0 THEN (initial_price * (1 - discount_percent / 100))
            ELSE initial_price
        END) * 1.75 AS price_with_tax     
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m18:05:24.511388 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:71950917-daf2-46e0-91dc-9aa55274c520&page=queryresults
[0m18:05:28.419862 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 18:05:23.204088 => 18:05:28.418967
[0m18:05:28.423062 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fa5e25e-f643-451e-904e-41b669e000a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9cd1962c0>]}
[0m18:05:28.425673 [info ] [Thread-1 (]: 3 of 6 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (1.1k rows, 92.9 KiB processed)[0m in 5.23s]
[0m18:05:28.428483 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m18:05:28.430514 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m18:05:28.432901 [info ] [Thread-1 (]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m18:05:28.436083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m18:05:28.437910 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m18:05:28.448233 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m18:05:28.449686 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 18:05:28.439192 => 18:05:28.449215
[0m18:05:28.450599 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m18:05:28.455176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:05:29.223911 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m18:05:29.225190 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m18:05:29.827297 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:4a2a1f7c-cb4a-4ade-9bbb-3a1360c0e7e2&page=queryresults
[0m18:05:33.287063 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 18:05:28.451249 => 18:05:33.286877
[0m18:05:33.287891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fa5e25e-f643-451e-904e-41b669e000a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9cda34790>]}
[0m18:05:33.288472 [info ] [Thread-1 (]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.85s]
[0m18:05:33.289092 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m18:05:33.289557 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m18:05:33.290032 [info ] [Thread-1 (]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m18:05:33.290741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m18:05:33.291157 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m18:05:33.293956 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m18:05:33.294764 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 18:05:33.291428 => 18:05:33.294526
[0m18:05:33.295158 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m18:05:33.303159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:05:34.042259 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m18:05:34.042948 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m18:05:34.596168 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b25dbc8e-82f6-442e-a7eb-52bfa5584533&page=queryresults
[0m18:05:38.576183 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 18:05:33.295414 => 18:05:38.576003
[0m18:05:38.576875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fa5e25e-f643-451e-904e-41b669e000a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9cd8eadd0>]}
[0m18:05:38.577429 [info ] [Thread-1 (]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 5.29s]
[0m18:05:38.578035 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m18:05:38.578499 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m18:05:38.579049 [info ] [Thread-1 (]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m18:05:38.579696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m18:05:38.580060 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m18:05:38.582765 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m18:05:38.583365 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 18:05:38.580334 => 18:05:38.583181
[0m18:05:38.583766 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m18:05:38.585776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:05:39.334411 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m18:05:39.335035 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m18:05:39.943028 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:0e379d42-253d-4a49-8bf3-ca25e5e78abb&page=queryresults
[0m18:05:43.303775 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 18:05:38.584020 => 18:05:43.303512
[0m18:05:43.304743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fa5e25e-f643-451e-904e-41b669e000a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9cd8a8b50>]}
[0m18:05:43.305553 [info ] [Thread-1 (]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.73s]
[0m18:05:43.306386 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m18:05:43.308405 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:05:43.308962 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m18:05:43.309499 [info ] [MainThread]: 
[0m18:05:43.310043 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 36.89 seconds (36.89s).
[0m18:05:43.311946 [debug] [MainThread]: Command end result
[0m18:05:43.322968 [info ] [MainThread]: 
[0m18:05:43.323563 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:05:43.324039 [info ] [MainThread]: 
[0m18:05:43.324526 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:05:43.325296 [debug] [MainThread]: Command `dbt run` succeeded at 18:05:43.325161 after 37.37 seconds
[0m18:05:43.325796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9d19335b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9cd1514e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9cd83f640>]}
[0m18:05:43.326318 [debug] [MainThread]: Flushing usage events
[0m18:07:45.792957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa197e2aad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa195fc0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa195fc00d0>]}


============================== 18:07:45.795208 | 80791280-3c12-48c8-ab36-d86e8482fb33 ==============================
[0m18:07:45.795208 [info ] [MainThread]: Running with dbt=1.6.5
[0m18:07:45.795737 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:07:46.082792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80791280-3c12-48c8-ab36-d86e8482fb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa19740bdc0>]}
[0m18:07:46.098307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80791280-3c12-48c8-ab36-d86e8482fb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa193f5c9d0>]}
[0m18:07:46.098861 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m18:07:46.112219 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m18:07:46.176406 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:07:46.177224 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m18:07:46.224665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80791280-3c12-48c8-ab36-d86e8482fb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa193da00d0>]}
[0m18:07:46.233368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80791280-3c12-48c8-ab36-d86e8482fb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa193d67dc0>]}
[0m18:07:46.233844 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m18:07:46.234225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80791280-3c12-48c8-ab36-d86e8482fb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa193d67d30>]}
[0m18:07:46.235648 [info ] [MainThread]: 
[0m18:07:46.236371 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:07:46.237612 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m18:07:46.238005 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:07:46.978141 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m18:07:46.979292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:07:47.651385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80791280-3c12-48c8-ab36-d86e8482fb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa193d65fc0>]}
[0m18:07:47.652083 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:07:47.652428 [info ] [MainThread]: 
[0m18:07:47.654745 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m18:07:47.655314 [info ] [Thread-1 (]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m18:07:47.656076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m18:07:47.656542 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m18:07:47.663784 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m18:07:47.664468 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 18:07:47.656816 => 18:07:47.664251
[0m18:07:47.664862 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m18:07:47.678738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:07:48.409246 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m18:07:48.410074 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m18:07:49.009321 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:37b091ed-6ae7-4832-83f5-532ac0090dcb&page=queryresults
[0m18:07:53.041765 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 18:07:47.665115 => 18:07:53.041454
[0m18:07:53.042906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80791280-3c12-48c8-ab36-d86e8482fb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa193f5c4f0>]}
[0m18:07:53.043833 [info ] [Thread-1 (]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 5.39s]
[0m18:07:53.044839 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m18:07:53.045438 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m18:07:53.046152 [info ] [Thread-1 (]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m18:07:53.047020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m18:07:53.047565 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m18:07:53.051061 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m18:07:53.051820 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 18:07:53.047952 => 18:07:53.051583
[0m18:07:53.052287 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m18:07:53.059394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:07:53.843016 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m18:07:53.845728 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m18:07:54.449713 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b113b594-02aa-4715-8b4d-94dae861a0ab&page=queryresults
[0m18:07:57.528306 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 18:07:53.052619 => 18:07:57.528107
[0m18:07:57.529158 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80791280-3c12-48c8-ab36-d86e8482fb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1934c61a0>]}
[0m18:07:57.529828 [info ] [Thread-1 (]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.48s]
[0m18:07:57.530682 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m18:07:57.531205 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m18:07:57.531761 [info ] [Thread-1 (]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m18:07:57.532567 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m18:07:57.533053 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m18:07:57.536455 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m18:07:57.537198 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 18:07:57.533466 => 18:07:57.536928
[0m18:07:57.537658 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m18:07:57.540020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:07:58.411391 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m18:07:58.412338 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        -- Monto del Descuento formateado como decimal con dos decimales
        CAST(
            (CASE
                WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
                ELSE 0.0
            END) / 100 AS NUMERIC
        ) AS discount_amount,

        -- Precio del Juego con Impuesto (75%)
        (CASE
        WHEN discount_percent > 0 THEN
            CAST((initial_price * (1 - discount_percent / 100)) * 1.75 AS NUMERIC)
        ELSE
            CAST(initial_price * 1.75 AS NUMERIC)
        END) AS price_with_tax      
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m18:07:58.974894 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:268b42e7-b62b-4e39-881e-2b7c6b4b3f3d&page=queryresults
[0m18:08:03.311312 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 18:07:57.537915 => 18:08:03.310438
[0m18:08:03.314687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80791280-3c12-48c8-ab36-d86e8482fb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1934bbfa0>]}
[0m18:08:03.317329 [info ] [Thread-1 (]: 3 of 6 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (1.1k rows, 92.9 KiB processed)[0m in 5.78s]
[0m18:08:03.320196 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m18:08:03.322236 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m18:08:03.324666 [info ] [Thread-1 (]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m18:08:03.327800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m18:08:03.329631 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m18:08:03.340101 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m18:08:03.341628 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 18:08:03.330929 => 18:08:03.341157
[0m18:08:03.342562 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m18:08:03.345079 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:04.141035 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m18:08:04.143728 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m18:08:04.801283 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c4493641-5e50-4148-8c05-643764d7f799&page=queryresults
[0m18:08:08.179935 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 18:08:03.343060 => 18:08:08.179645
[0m18:08:08.181110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80791280-3c12-48c8-ab36-d86e8482fb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1934b9900>]}
[0m18:08:08.182009 [info ] [Thread-1 (]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.85s]
[0m18:08:08.182973 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m18:08:08.183680 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m18:08:08.184511 [info ] [Thread-1 (]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m18:08:08.185577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m18:08:08.186191 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m18:08:08.190529 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m18:08:08.191504 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 18:08:08.186630 => 18:08:08.191192
[0m18:08:08.192132 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m18:08:08.203846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:08.997432 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m18:08:08.998166 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m18:08:09.688013 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:66affa53-2909-4441-8a48-d1b6efcc07ab&page=queryresults
[0m18:08:13.307040 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 18:08:08.192566 => 18:08:13.306843
[0m18:08:13.307808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80791280-3c12-48c8-ab36-d86e8482fb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa193f5ff40>]}
[0m18:08:13.308392 [info ] [Thread-1 (]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 5.12s]
[0m18:08:13.309050 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m18:08:13.309645 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m18:08:13.310354 [info ] [Thread-1 (]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m18:08:13.311335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m18:08:13.311925 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m18:08:13.315319 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m18:08:13.316349 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 18:08:13.312309 => 18:08:13.316116
[0m18:08:13.316815 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m18:08:13.319184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:14.053421 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m18:08:14.056240 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m18:08:14.654787 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:02974a29-904a-44f6-b651-0f658bb8ad03&page=queryresults
[0m18:08:18.310727 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 18:08:13.317142 => 18:08:18.310195
[0m18:08:18.312637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80791280-3c12-48c8-ab36-d86e8482fb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa193dd4610>]}
[0m18:08:18.371732 [info ] [Thread-1 (]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 5.00s]
[0m18:08:18.373316 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m18:08:18.376245 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:08:18.376904 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m18:08:18.377594 [info ] [MainThread]: 
[0m18:08:18.378304 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 32.14 seconds (32.14s).
[0m18:08:18.380455 [debug] [MainThread]: Command end result
[0m18:08:18.388321 [info ] [MainThread]: 
[0m18:08:18.388794 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:08:18.389163 [info ] [MainThread]: 
[0m18:08:18.389500 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:08:18.390033 [debug] [MainThread]: Command `dbt run` succeeded at 18:08:18.389939 after 32.60 seconds
[0m18:08:18.390378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa197e2aad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa193d9a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa195f9bf70>]}
[0m18:08:18.390742 [debug] [MainThread]: Flushing usage events
[0m20:17:44.506408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0842fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c065c0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c065c00d0>]}


============================== 20:17:44.509138 | 680db0e4-d35d-4453-ae5c-c5df3549d049 ==============================
[0m20:17:44.509138 [info ] [MainThread]: Running with dbt=1.6.5
[0m20:17:44.509670 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '../dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:17:44.809797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '680db0e4-d35d-4453-ae5c-c5df3549d049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c07a44940>]}
[0m20:17:44.826008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '680db0e4-d35d-4453-ae5c-c5df3549d049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0455ca30>]}
[0m20:17:44.826711 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m20:17:44.841648 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m20:17:44.909543 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:17:44.910099 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m20:17:44.953148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '680db0e4-d35d-4453-ae5c-c5df3549d049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c043a80d0>]}
[0m20:17:44.961608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '680db0e4-d35d-4453-ae5c-c5df3549d049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c04367d30>]}
[0m20:17:44.962062 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m20:17:44.962404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '680db0e4-d35d-4453-ae5c-c5df3549d049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c04367ca0>]}
[0m20:17:44.963724 [info ] [MainThread]: 
[0m20:17:44.964376 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:17:44.965587 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m20:17:44.966009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:17:45.805414 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m20:17:45.805922 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:17:46.519362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '680db0e4-d35d-4453-ae5c-c5df3549d049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0659bb50>]}
[0m20:17:46.520120 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:17:46.520500 [info ] [MainThread]: 
[0m20:17:46.522489 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m20:17:46.523058 [info ] [Thread-1 (]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m20:17:46.523831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m20:17:46.524419 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m20:17:46.531497 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m20:17:46.532165 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 20:17:46.524693 => 20:17:46.531964
[0m20:17:46.532543 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m20:17:46.546387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:47.285187 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m20:17:47.286034 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m20:17:47.947858 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e3c7f9a1-88b6-40e2-949c-8b03edf592c1&page=queryresults
[0m20:17:51.050194 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 20:17:46.532802 => 20:17:51.050012
[0m20:17:51.050904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '680db0e4-d35d-4453-ae5c-c5df3549d049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0455e530>]}
[0m20:17:51.051467 [info ] [Thread-1 (]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.53s]
[0m20:17:51.052117 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m20:17:51.052574 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m20:17:51.053088 [info ] [Thread-1 (]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m20:17:51.053722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m20:17:51.054103 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m20:17:51.056705 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m20:17:51.057335 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 20:17:51.054367 => 20:17:51.057125
[0m20:17:51.057733 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m20:17:51.063986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:51.827304 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m20:17:51.828070 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m20:17:52.428153 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:028bc719-3089-476b-8a43-d92579ddcb4a&page=queryresults
[0m20:17:55.271083 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 20:17:51.057999 => 20:17:55.270224
[0m20:17:55.274158 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '680db0e4-d35d-4453-ae5c-c5df3549d049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c03aca1a0>]}
[0m20:17:55.276688 [info ] [Thread-1 (]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.22s]
[0m20:17:55.279472 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m20:17:55.281503 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m20:17:55.283909 [info ] [Thread-1 (]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m20:17:55.286798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m20:17:55.288631 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m20:17:55.302143 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m20:17:55.304980 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 20:17:55.289953 => 20:17:55.304064
[0m20:17:55.306749 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m20:17:55.313077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:56.059106 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m20:17:56.061012 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%) formateado como decimal con dos decimales
    (CASE
        WHEN discount_percent > 0 THEN
            CAST(FORMAT('%2.2f', initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
        ELSE
            CAST(FORMAT('%2.2f', initial_price * 1.75) AS NUMERIC)
        END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m20:17:56.564707 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:96f24a3d-8ea9-422d-8fe0-3ea9604e2900&page=queryresults
[0m20:17:59.643162 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 20:17:55.308069 => 20:17:59.642300
[0m20:17:59.646508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '680db0e4-d35d-4453-ae5c-c5df3549d049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c03abff40>]}
[0m20:17:59.649195 [info ] [Thread-1 (]: 3 of 6 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (1.1k rows, 92.9 KiB processed)[0m in 4.36s]
[0m20:17:59.652037 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m20:17:59.654079 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m20:17:59.656449 [info ] [Thread-1 (]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m20:17:59.659483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m20:17:59.661353 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m20:17:59.671972 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m20:17:59.673223 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 20:17:59.662659 => 20:17:59.672992
[0m20:17:59.673615 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m20:17:59.675858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:18:00.435288 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m20:18:00.436051 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m20:18:00.924473 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:1336dde7-a1a8-47d8-9053-99e7c0b2d5fa&page=queryresults
[0m20:18:04.386910 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 20:17:59.673874 => 20:18:04.386730
[0m20:18:04.387646 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '680db0e4-d35d-4453-ae5c-c5df3549d049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c03abe0b0>]}
[0m20:18:04.388204 [info ] [Thread-1 (]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.73s]
[0m20:18:04.388817 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m20:18:04.389287 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m20:18:04.389844 [info ] [Thread-1 (]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m20:18:04.390544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m20:18:04.390912 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m20:18:04.393724 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m20:18:04.394339 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 20:18:04.391192 => 20:18:04.394148
[0m20:18:04.394711 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m20:18:04.403050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:18:05.146808 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m20:18:05.147700 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m20:18:05.719318 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:59c48101-cd76-445f-8e9a-1bea0e88cbe2&page=queryresults
[0m20:18:09.082331 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 20:18:04.394977 => 20:18:09.081871
[0m20:18:09.083413 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '680db0e4-d35d-4453-ae5c-c5df3549d049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0455e9b0>]}
[0m20:18:09.083965 [info ] [Thread-1 (]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.69s]
[0m20:18:09.084535 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m20:18:09.085004 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m20:18:09.085512 [info ] [Thread-1 (]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m20:18:09.086246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m20:18:09.086635 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m20:18:09.089446 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m20:18:09.090041 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 20:18:09.086900 => 20:18:09.089853
[0m20:18:09.090404 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m20:18:09.092489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:18:09.819180 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m20:18:09.819868 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m20:18:10.279854 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:60a9eb82-52f8-4df4-85dd-8e0dbe6961f4&page=queryresults
[0m20:18:13.931351 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 20:18:09.090662 => 20:18:13.930476
[0m20:18:13.934468 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '680db0e4-d35d-4453-ae5c-c5df3549d049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c03a79270>]}
[0m20:18:13.937044 [info ] [Thread-1 (]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.85s]
[0m20:18:13.939887 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m20:18:13.945738 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:18:13.947281 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m20:18:13.948961 [info ] [MainThread]: 
[0m20:18:13.950672 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 28.98 seconds (28.98s).
[0m20:18:13.957286 [debug] [MainThread]: Command end result
[0m20:18:13.982513 [info ] [MainThread]: 
[0m20:18:13.982964 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:18:13.983344 [info ] [MainThread]: 
[0m20:18:13.983745 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m20:18:13.984326 [debug] [MainThread]: Command `dbt run` succeeded at 20:18:13.984232 after 29.49 seconds
[0m20:18:13.984683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0842fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c04540a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c045409d0>]}
[0m20:18:13.985082 [debug] [MainThread]: Flushing usage events
[0m20:29:59.942779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa80390d180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa801b64070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa801b640d0>]}


============================== 20:29:59.944860 | dfea7824-3708-443a-8148-acf3c03d26fc ==============================
[0m20:29:59.944860 [info ] [MainThread]: Running with dbt=1.6.5
[0m20:29:59.945347 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'send_anonymous_usage_stats': 'True'}
[0m20:30:00.221159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dfea7824-3708-443a-8148-acf3c03d26fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa802e2c7c0>]}
[0m20:30:00.236660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dfea7824-3708-443a-8148-acf3c03d26fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ff9049d0>]}
[0m20:30:00.237210 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m20:30:00.250571 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m20:30:00.319796 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:30:00.320594 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m20:30:00.373015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dfea7824-3708-443a-8148-acf3c03d26fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ff7b80d0>]}
[0m20:30:00.383710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dfea7824-3708-443a-8148-acf3c03d26fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ff70fdf0>]}
[0m20:30:00.384295 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m20:30:00.384660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfea7824-3708-443a-8148-acf3c03d26fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ff70fd60>]}
[0m20:30:00.386065 [info ] [MainThread]: 
[0m20:30:00.386780 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:30:00.388334 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m20:30:00.388884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:30:01.189421 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m20:30:01.191537 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:30:01.926972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfea7824-3708-443a-8148-acf3c03d26fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ff70dff0>]}
[0m20:30:01.930235 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:30:01.931934 [info ] [MainThread]: 
[0m20:30:01.940013 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m20:30:01.942233 [info ] [Thread-1 (]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m20:30:01.944882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m20:30:01.945248 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m20:30:01.952119 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m20:30:01.952729 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 20:30:01.945500 => 20:30:01.952539
[0m20:30:01.953090 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m20:30:01.965946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:30:02.773442 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m20:30:02.774199 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m20:30:03.463060 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:0410392d-f80d-4464-a5c0-5c792558426e&page=queryresults
[0m20:30:06.631179 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 20:30:01.953342 => 20:30:06.630872
[0m20:30:06.632320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfea7824-3708-443a-8148-acf3c03d26fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ff906b30>]}
[0m20:30:06.633231 [info ] [Thread-1 (]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.69s]
[0m20:30:06.634174 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m20:30:06.634769 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m20:30:06.635478 [info ] [Thread-1 (]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m20:30:06.636357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m20:30:06.636889 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m20:30:06.640339 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m20:30:06.641086 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 20:30:06.637265 => 20:30:06.640850
[0m20:30:06.641545 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m20:30:06.648199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:30:07.374651 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m20:30:07.377375 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m20:30:07.862857 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:87ce5758-b4d1-4e3c-ab23-c67f2e1d6bf1&page=queryresults
[0m20:30:10.613105 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 20:30:06.641872 => 20:30:10.612920
[0m20:30:10.613792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfea7824-3708-443a-8148-acf3c03d26fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ff0721a0>]}
[0m20:30:10.614327 [info ] [Thread-1 (]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 3.98s]
[0m20:30:10.614891 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m20:30:10.615330 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m20:30:10.615875 [info ] [Thread-1 (]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m20:30:10.616465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m20:30:10.616823 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m20:30:10.619670 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m20:30:10.620265 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 20:30:10.617077 => 20:30:10.620079
[0m20:30:10.620617 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m20:30:10.622640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:30:11.378394 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m20:30:11.379050 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        *,
        -- Monto del Descuento formateado como decimal con dos decimales
        CAST(
            (CASE
                WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
                ELSE 0.0
            END) / 100 AS DECIMAL
        ) AS discount_amount,

        -- Precio del Juego con Impuesto (75%) formateado como decimal con dos decimales
        (CASE
            WHEN discount_percent > 0 THEN
                CAST(FORMAT('%2.2f', CAST(initial_price AS DECIMAL) * (1 - discount_percent / 100) * 1.75) AS DECIMAL)
            ELSE
                CAST(FORMAT('%2.2f', CAST(initial_price AS DECIMAL) * 1.75) AS DECIMAL)
            END) AS price_with_tax
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m20:30:12.033082 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:de5991d5-a106-4654-845d-441a2c71ff92&page=queryresults
[0m20:30:12.584388 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: discount_pct; Did you mean discount_percent? at [52:10]')
[0m20:30:13.702080 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:66385b2b-354f-4f2d-849c-60687a3daef1&page=queryresults
[0m20:30:14.252901 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:66385b2b-354f-4f2d-849c-60687a3daef1&page=queryresults
[0m20:30:14.255924 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 20:30:10.620869 => 20:30:14.254948
[0m20:30:14.269072 [debug] [Thread-1 (]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Unrecognized name: discount_pct; Did you mean discount_percent? at [52:10]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m20:30:14.271117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfea7824-3708-443a-8148-acf3c03d26fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ff064a60>]}
[0m20:30:14.273722 [error] [Thread-1 (]: 3 of 6 ERROR creating sql table model games.dim_price_overview ................. [[31mERROR[0m in 3.65s]
[0m20:30:14.276552 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m20:30:14.278604 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m20:30:14.280572 [info ] [Thread-1 (]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m20:30:14.282690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m20:30:14.283997 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m20:30:14.292837 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m20:30:14.294822 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 20:30:14.284901 => 20:30:14.294151
[0m20:30:14.296073 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m20:30:14.302881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:30:15.058532 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m20:30:15.059405 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m20:30:15.664859 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:2c2687a7-acb0-4ace-a044-5c5f332f3ed2&page=queryresults
[0m20:30:18.852278 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 20:30:14.296954 => 20:30:18.851945
[0m20:30:18.853553 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfea7824-3708-443a-8148-acf3c03d26fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7fc7abca0>]}
[0m20:30:18.854542 [info ] [Thread-1 (]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.57s]
[0m20:30:18.855602 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m20:30:18.856366 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m20:30:18.857218 [info ] [Thread-1 (]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m20:30:18.858366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m20:30:18.859067 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m20:30:18.873091 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m20:30:18.874031 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 20:30:18.859576 => 20:30:18.873733
[0m20:30:18.874563 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m20:30:18.877581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:30:19.578544 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m20:30:19.581324 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m20:30:20.068188 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:dd66e362-7721-46e9-90ef-d691b463c425&page=queryresults
[0m20:30:22.972293 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 20:30:18.874938 => 20:30:22.971372
[0m20:30:22.975434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfea7824-3708-443a-8148-acf3c03d26fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8030c4ca0>]}
[0m20:30:22.978055 [info ] [Thread-1 (]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.12s]
[0m20:30:22.981041 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m20:30:22.983195 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m20:30:22.985744 [info ] [Thread-1 (]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m20:30:22.988925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m20:30:22.990698 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m20:30:22.994241 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m20:30:22.995103 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 20:30:22.991028 => 20:30:22.994807
[0m20:30:22.995535 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m20:30:22.997821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:30:23.717846 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m20:30:23.718547 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m20:30:24.304020 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:289ac0dd-a8b4-4bd9-a077-b454fd960c5f&page=queryresults
[0m20:30:27.977483 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 20:30:22.995835 => 20:30:27.976604
[0m20:30:27.980631 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfea7824-3708-443a-8148-acf3c03d26fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ff9072b0>]}
[0m20:30:27.983248 [info ] [Thread-1 (]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.99s]
[0m20:30:27.986101 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m20:30:27.992142 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:30:27.993716 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m20:30:27.994936 [info ] [MainThread]: 
[0m20:30:27.995280 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 27.61 seconds (27.61s).
[0m20:30:27.996636 [debug] [MainThread]: Command end result
[0m20:30:28.004387 [info ] [MainThread]: 
[0m20:30:28.004822 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:30:28.005136 [info ] [MainThread]: 
[0m20:30:28.005446 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Unrecognized name: discount_pct; Did you mean discount_percent? at [52:10]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m20:30:28.005764 [info ] [MainThread]: 
[0m20:30:28.006091 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m20:30:28.006637 [debug] [MainThread]: Command `dbt run` failed at 20:30:28.006544 after 28.07 seconds
[0m20:30:28.006986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa80390d180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8030187f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa801b3beb0>]}
[0m20:30:28.007344 [debug] [MainThread]: Flushing usage events
[0m20:31:30.018992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dc391ea70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dc1ab0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dc1ab00d0>]}


============================== 20:31:30.021436 | a3fa081a-054f-4a60-a38d-3c79dde6faec ==============================
[0m20:31:30.021436 [info ] [MainThread]: Running with dbt=1.6.5
[0m20:31:30.021994 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'send_anonymous_usage_stats': 'True'}
[0m20:31:30.325711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3fa081a-054f-4a60-a38d-3c79dde6faec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dc2f54e50>]}
[0m20:31:30.343187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3fa081a-054f-4a60-a38d-3c79dde6faec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbfa509d0>]}
[0m20:31:30.343944 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m20:31:30.360921 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m20:31:30.433853 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:31:30.434500 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m20:31:30.482271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3fa081a-054f-4a60-a38d-3c79dde6faec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbf8800d0>]}
[0m20:31:30.491875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3fa081a-054f-4a60-a38d-3c79dde6faec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbf857d00>]}
[0m20:31:30.492438 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m20:31:30.492887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3fa081a-054f-4a60-a38d-3c79dde6faec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbf857df0>]}
[0m20:31:30.494356 [info ] [MainThread]: 
[0m20:31:30.495104 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:31:30.496418 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m20:31:30.496864 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:31:31.224580 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m20:31:31.225080 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:31:31.927386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3fa081a-054f-4a60-a38d-3c79dde6faec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbf855fc0>]}
[0m20:31:31.930672 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:31:31.931912 [info ] [MainThread]: 
[0m20:31:31.936842 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m20:31:31.938104 [info ] [Thread-1 (]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m20:31:31.939661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m20:31:31.940487 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m20:31:31.952798 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m20:31:31.953774 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 20:31:31.941028 => 20:31:31.953473
[0m20:31:31.954318 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m20:31:31.969636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:31:32.762466 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m20:31:32.763261 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m20:31:33.337097 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:60802fe8-3316-4b9f-bf4b-c4e1e5c8de0c&page=queryresults
[0m20:31:35.857141 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 20:31:31.954709 => 20:31:35.856869
[0m20:31:35.858128 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3fa081a-054f-4a60-a38d-3c79dde6faec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbfa50460>]}
[0m20:31:35.858927 [info ] [Thread-1 (]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 3.92s]
[0m20:31:35.859718 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m20:31:35.860304 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m20:31:35.861048 [info ] [Thread-1 (]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m20:31:35.861988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m20:31:35.862512 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m20:31:35.865727 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m20:31:35.866472 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 20:31:35.862848 => 20:31:35.866229
[0m20:31:35.866898 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m20:31:35.873570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:31:36.678370 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m20:31:36.682063 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m20:31:37.295735 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a0dbe2de-7001-41ec-ba5c-f974310a9614&page=queryresults
[0m20:31:40.696353 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 20:31:35.867195 => 20:31:40.695377
[0m20:31:40.699521 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3fa081a-054f-4a60-a38d-3c79dde6faec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbefb61a0>]}
[0m20:31:40.701351 [info ] [Thread-1 (]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.84s]
[0m20:31:40.703352 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m20:31:40.704725 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m20:31:40.705844 [info ] [Thread-1 (]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m20:31:40.707533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m20:31:40.708522 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m20:31:40.714307 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m20:31:40.715392 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 20:31:40.709199 => 20:31:40.715063
[0m20:31:40.716056 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m20:31:40.719533 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:31:41.573691 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m20:31:41.576676 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        -- Monto del Descuento formateado como decimal con dos decimales
        CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS DECIMAL
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%) formateado como decimal con dos decimales
    (CASE
        WHEN discount_percent > 0 THEN
            CAST(FORMAT('%2.2f', CAST(initial_price AS DECIMAL) * (1 - discount_percent / 100) * 1.75) AS DECIMAL)
        ELSE
            CAST(FORMAT('%2.2f', CAST(initial_price AS DECIMAL) * 1.75) AS DECIMAL)
        END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m20:31:42.165603 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c2d6ca5a-5d74-4004-9f09-1a110f807173&page=queryresults
[0m20:31:45.187700 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 20:31:40.716514 => 20:31:45.187498
[0m20:31:45.188418 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3fa081a-054f-4a60-a38d-3c79dde6faec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbefab100>]}
[0m20:31:45.188981 [info ] [Thread-1 (]: 3 of 6 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (1.1k rows, 92.9 KiB processed)[0m in 4.48s]
[0m20:31:45.189573 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m20:31:45.190046 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m20:31:45.190684 [info ] [Thread-1 (]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m20:31:45.191503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m20:31:45.191967 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m20:31:45.194877 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m20:31:45.195527 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 20:31:45.192258 => 20:31:45.195324
[0m20:31:45.195915 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m20:31:45.198099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:31:45.976160 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m20:31:45.978837 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m20:31:46.573160 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:fb1c561d-18be-4464-894a-71606967228f&page=queryresults
[0m20:31:50.311617 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 20:31:45.196180 => 20:31:50.311396
[0m20:31:50.312355 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3fa081a-054f-4a60-a38d-3c79dde6faec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbefa9900>]}
[0m20:31:50.312912 [info ] [Thread-1 (]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 5.12s]
[0m20:31:50.313495 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m20:31:50.313919 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m20:31:50.314442 [info ] [Thread-1 (]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m20:31:50.315087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m20:31:50.315459 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m20:31:50.318387 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m20:31:50.319241 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 20:31:50.315732 => 20:31:50.318993
[0m20:31:50.319657 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m20:31:50.327585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:31:51.057337 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m20:31:51.057995 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m20:31:51.640298 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:874b72ad-7512-4f4c-b917-8905f94c71b9&page=queryresults
[0m20:31:54.995434 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 20:31:50.319932 => 20:31:54.995245
[0m20:31:54.996206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3fa081a-054f-4a60-a38d-3c79dde6faec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbfa52f20>]}
[0m20:31:54.996787 [info ] [Thread-1 (]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.68s]
[0m20:31:54.997413 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m20:31:54.997885 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m20:31:54.998424 [info ] [Thread-1 (]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m20:31:54.999081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m20:31:54.999461 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m20:31:55.002496 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m20:31:55.003216 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 20:31:54.999747 => 20:31:55.002959
[0m20:31:55.003632 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m20:31:55.005719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:31:55.757025 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m20:31:55.759937 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m20:31:56.422772 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:916f48b4-b074-4e6f-99e8-4feb92a2d1a9&page=queryresults
[0m20:31:59.201160 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 20:31:55.003893 => 20:31:59.200943
[0m20:31:59.201917 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3fa081a-054f-4a60-a38d-3c79dde6faec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbf8c7640>]}
[0m20:31:59.202515 [info ] [Thread-1 (]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.20s]
[0m20:31:59.203156 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m20:31:59.205299 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:31:59.205810 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m20:31:59.206329 [info ] [MainThread]: 
[0m20:31:59.206756 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 28.71 seconds (28.71s).
[0m20:31:59.208432 [debug] [MainThread]: Command end result
[0m20:31:59.217609 [info ] [MainThread]: 
[0m20:31:59.218169 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:31:59.218595 [info ] [MainThread]: 
[0m20:31:59.219021 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m20:31:59.219831 [debug] [MainThread]: Command `dbt run` succeeded at 20:31:59.219724 after 29.21 seconds
[0m20:31:59.220248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dc391ea70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbf88a560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dc1a8bf70>]}
[0m20:31:59.220962 [debug] [MainThread]: Flushing usage events
[0m20:39:53.734012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dbdd32ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dbbd94070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dbbd940d0>]}


============================== 20:39:53.736113 | f3443577-c192-4756-aef2-7afbdd10bb70 ==============================
[0m20:39:53.736113 [info ] [MainThread]: Running with dbt=1.6.5
[0m20:39:53.736643 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'profiles_dir': '../dbt/', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:39:54.008856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3443577-c192-4756-aef2-7afbdd10bb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dbd2e3dc0>]}
[0m20:39:54.024109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3443577-c192-4756-aef2-7afbdd10bb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1db9d309d0>]}
[0m20:39:54.024682 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m20:39:54.039135 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m20:39:54.102943 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:39:54.103487 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m20:39:54.146689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3443577-c192-4756-aef2-7afbdd10bb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1db9be40d0>]}
[0m20:39:54.155820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3443577-c192-4756-aef2-7afbdd10bb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1db9b3bdc0>]}
[0m20:39:54.156273 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m20:39:54.156614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3443577-c192-4756-aef2-7afbdd10bb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1db9b3bd30>]}
[0m20:39:54.157880 [info ] [MainThread]: 
[0m20:39:54.158525 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:39:54.159762 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m20:39:54.160102 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:39:55.041410 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m20:39:55.041852 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:39:55.722981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3443577-c192-4756-aef2-7afbdd10bb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1db9b39fc0>]}
[0m20:39:55.725007 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:39:55.726166 [info ] [MainThread]: 
[0m20:39:55.732515 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m20:39:55.734430 [info ] [Thread-1 (]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m20:39:55.736915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m20:39:55.738651 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m20:39:55.761942 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m20:39:55.763369 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 20:39:55.739766 => 20:39:55.762918
[0m20:39:55.764132 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m20:39:55.782854 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:56.559068 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m20:39:56.559835 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m20:39:57.055762 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a171c2d2-157c-45b3-8ea3-7e7ce0dcfb3e&page=queryresults
[0m20:40:00.594245 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 20:39:55.764632 => 20:40:00.594062
[0m20:40:00.594953 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3443577-c192-4756-aef2-7afbdd10bb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1db949ed40>]}
[0m20:40:00.595520 [info ] [Thread-1 (]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.86s]
[0m20:40:00.596192 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m20:40:00.596660 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m20:40:00.597182 [info ] [Thread-1 (]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m20:40:00.597818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m20:40:00.598204 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m20:40:00.600793 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m20:40:00.601411 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 20:40:00.598470 => 20:40:00.601213
[0m20:40:00.601773 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m20:40:00.607618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:01.355570 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m20:40:01.358269 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m20:40:02.191730 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f2ca1966-e557-421d-9a98-3583a172c362&page=queryresults
[0m20:40:06.017240 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 20:40:00.602030 => 20:40:06.016369
[0m20:40:06.020409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3443577-c192-4756-aef2-7afbdd10bb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1db949c3d0>]}
[0m20:40:06.022966 [info ] [Thread-1 (]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 5.42s]
[0m20:40:06.025806 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m20:40:06.027867 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m20:40:06.030325 [info ] [Thread-1 (]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m20:40:06.033260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m20:40:06.035083 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m20:40:06.046214 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m20:40:06.047895 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 20:40:06.036405 => 20:40:06.047370
[0m20:40:06.048824 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m20:40:06.053400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:06.875139 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m20:40:06.875925 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        -- Monto del Descuento formateado como decimal con dos decimales
        CAST(
        (CASE
            WHEN discount_percent > 0 THEN CAST(initial_price AS NUMERIC) * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%) formateado como decimal con dos decimales
    (CASE
        WHEN discount_percent > 0 THEN
            CAST(FORMAT('%2.2f', CAST(initial_price AS NUMERIC) * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
        ELSE
            CAST(FORMAT('%2.2f', CAST(initial_price AS NUMERIC) * 1.75) AS NUMERIC)
        END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m20:40:07.442501 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:8373bdd4-9052-4106-90e0-e51d498dc2bf&page=queryresults
[0m20:40:11.479871 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 20:40:06.049481 => 20:40:11.479688
[0m20:40:11.480587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3443577-c192-4756-aef2-7afbdd10bb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1db949d990>]}
[0m20:40:11.481169 [info ] [Thread-1 (]: 3 of 6 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (1.1k rows, 92.9 KiB processed)[0m in 5.45s]
[0m20:40:11.481789 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m20:40:11.482255 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m20:40:11.482813 [info ] [Thread-1 (]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m20:40:11.483478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m20:40:11.483899 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m20:40:11.486590 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m20:40:11.487244 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 20:40:11.484177 => 20:40:11.487007
[0m20:40:11.487669 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m20:40:11.489733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:12.272295 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m20:40:12.273342 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m20:40:12.706749 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f5b850da-215a-4f46-b799-29bb3987d7e3&page=queryresults
[0m20:40:15.861949 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 20:40:11.487930 => 20:40:15.861713
[0m20:40:15.862830 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3443577-c192-4756-aef2-7afbdd10bb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1db949c3d0>]}
[0m20:40:15.863586 [info ] [Thread-1 (]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.38s]
[0m20:40:15.864393 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m20:40:15.864969 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m20:40:15.865406 [info ] [Thread-1 (]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m20:40:15.866022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m20:40:15.866466 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m20:40:15.869122 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m20:40:15.869712 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 20:40:15.866735 => 20:40:15.869525
[0m20:40:15.870068 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m20:40:15.877766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:16.620481 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m20:40:16.621451 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m20:40:17.169239 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:2c0b359b-fd86-4463-8b9f-f54c41206404&page=queryresults
[0m20:40:19.982571 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 20:40:15.870319 => 20:40:19.981682
[0m20:40:19.985703 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3443577-c192-4756-aef2-7afbdd10bb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1db9be4b80>]}
[0m20:40:19.988336 [info ] [Thread-1 (]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.12s]
[0m20:40:19.991183 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m20:40:19.993241 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m20:40:19.995660 [info ] [Thread-1 (]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m20:40:19.998617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m20:40:20.000496 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m20:40:20.011380 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m20:40:20.013085 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 20:40:20.001814 => 20:40:20.012591
[0m20:40:20.014029 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m20:40:20.018631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:20.745438 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m20:40:20.746172 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m20:40:21.462619 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:546dbbbe-1099-411f-9f75-21c388e2f418&page=queryresults
[0m20:40:24.218971 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 20:40:20.014705 => 20:40:24.218437
[0m20:40:24.220857 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3443577-c192-4756-aef2-7afbdd10bb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1db9bc45e0>]}
[0m20:40:24.222507 [info ] [Thread-1 (]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.22s]
[0m20:40:24.224701 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m20:40:24.229343 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:40:24.230524 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m20:40:24.231800 [info ] [MainThread]: 
[0m20:40:24.233121 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 30.07 seconds (30.07s).
[0m20:40:24.238002 [debug] [MainThread]: Command end result
[0m20:40:24.260884 [info ] [MainThread]: 
[0m20:40:24.261714 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:40:24.262379 [info ] [MainThread]: 
[0m20:40:24.262970 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m20:40:24.263892 [debug] [MainThread]: Command `dbt run` succeeded at 20:40:24.263726 after 30.54 seconds
[0m20:40:24.264497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dbdd32ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1db9b6a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dbbf6bf70>]}
[0m20:40:24.265141 [debug] [MainThread]: Flushing usage events
[0m20:41:19.246035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88b7f0d180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88b6164070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88b61640d0>]}


============================== 20:41:19.248140 | b1fb7ffd-03c3-4ced-af1f-3a84e1d5d7eb ==============================
[0m20:41:19.248140 [info ] [MainThread]: Running with dbt=1.6.5
[0m20:41:19.248604 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:41:19.518571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1fb7ffd-03c3-4ced-af1f-3a84e1d5d7eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88b742fdc0>]}
[0m20:41:19.533848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1fb7ffd-03c3-4ced-af1f-3a84e1d5d7eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88b3f049d0>]}
[0m20:41:19.534392 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m20:41:19.547640 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m20:41:19.610556 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:41:19.611102 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m20:41:19.653512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1fb7ffd-03c3-4ced-af1f-3a84e1d5d7eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88b3db40d0>]}
[0m20:41:19.661892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1fb7ffd-03c3-4ced-af1f-3a84e1d5d7eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88b3d0fdc0>]}
[0m20:41:19.662350 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m20:41:19.662692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1fb7ffd-03c3-4ced-af1f-3a84e1d5d7eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88b3d0fd30>]}
[0m20:41:19.663964 [info ] [MainThread]: 
[0m20:41:19.664606 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:41:19.665799 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m20:41:19.666214 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:20.476781 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m20:41:20.478828 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:41:21.215430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1fb7ffd-03c3-4ced-af1f-3a84e1d5d7eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88b3d0dfc0>]}
[0m20:41:21.217267 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:41:21.217723 [info ] [MainThread]: 
[0m20:41:21.219767 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m20:41:21.220261 [info ] [Thread-1 (]: 1 of 6 START sql table model games.dim_developers .............................. [RUN]
[0m20:41:21.220913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m20:41:21.221322 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m20:41:21.228371 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m20:41:21.229044 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 20:41:21.221619 => 20:41:21.228814
[0m20:41:21.229433 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m20:41:21.242050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:21.997325 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m20:41:21.998098 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m20:41:22.657520 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:025619e5-00d2-4be9-bc6c-cba32231a410&page=queryresults
[0m20:41:25.793114 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 20:41:21.229696 => 20:41:25.792797
[0m20:41:25.794238 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1fb7ffd-03c3-4ced-af1f-3a84e1d5d7eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88b3f04340>]}
[0m20:41:25.795163 [info ] [Thread-1 (]: 1 of 6 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.57s]
[0m20:41:25.796159 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m20:41:25.796865 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m20:41:25.797672 [info ] [Thread-1 (]: 2 of 6 START sql table model games.dim_platforms ............................... [RUN]
[0m20:41:25.798533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m20:41:25.799070 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m20:41:25.802681 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m20:41:25.803440 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 20:41:25.799454 => 20:41:25.803200
[0m20:41:25.803925 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m20:41:25.811045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:26.533729 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m20:41:26.534342 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m20:41:27.245201 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e3b9070e-555d-4370-9728-e105af7038a2&page=queryresults
[0m20:41:30.596285 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 20:41:25.804259 => 20:41:30.596012
[0m20:41:30.597541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1fb7ffd-03c3-4ced-af1f-3a84e1d5d7eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88b346e1a0>]}
[0m20:41:30.598350 [info ] [Thread-1 (]: 2 of 6 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.80s]
[0m20:41:30.599220 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m20:41:30.599856 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m20:41:30.600557 [info ] [Thread-1 (]: 3 of 6 START sql table model games.dim_price_overview .......................... [RUN]
[0m20:41:30.601396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m20:41:30.601879 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m20:41:30.605170 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m20:41:30.606088 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 20:41:30.602171 => 20:41:30.605842
[0m20:41:30.606509 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m20:41:30.609664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:31.404899 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m20:41:31.405619 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m20:41:31.989070 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:86ee0b7d-6168-472e-a7bc-45292324ff33&page=queryresults
[0m20:41:35.191988 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 20:41:30.606872 => 20:41:35.191612
[0m20:41:35.193297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1fb7ffd-03c3-4ced-af1f-3a84e1d5d7eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88b3462170>]}
[0m20:41:35.194021 [info ] [Thread-1 (]: 3 of 6 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (1.1k rows, 92.9 KiB processed)[0m in 4.59s]
[0m20:41:35.194667 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m20:41:35.195138 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m20:41:35.195662 [info ] [Thread-1 (]: 4 of 6 START sql table model games.dim_publishers .............................. [RUN]
[0m20:41:35.196323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m20:41:35.196711 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m20:41:35.199401 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m20:41:35.200101 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 20:41:35.196981 => 20:41:35.199884
[0m20:41:35.200498 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m20:41:35.202618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:35.956135 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m20:41:35.956810 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m20:41:36.556192 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:45c12eb8-f43f-4838-a149-13cfb491cd98&page=queryresults
[0m20:41:39.706602 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 20:41:35.200762 => 20:41:39.706418
[0m20:41:39.707339 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1fb7ffd-03c3-4ced-af1f-3a84e1d5d7eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88b3461060>]}
[0m20:41:39.707917 [info ] [Thread-1 (]: 4 of 6 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.51s]
[0m20:41:39.708535 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m20:41:39.709009 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m20:41:39.709567 [info ] [Thread-1 (]: 5 of 6 START sql table model games.dim_release ................................. [RUN]
[0m20:41:39.710240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m20:41:39.710615 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m20:41:39.713280 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m20:41:39.713909 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 20:41:39.710897 => 20:41:39.713695
[0m20:41:39.714304 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m20:41:39.722485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:40.505619 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m20:41:40.506594 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m20:41:40.972453 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ee30e9ad-6095-4ac6-96b8-989f14fe4f14&page=queryresults
[0m20:41:43.930554 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 20:41:39.714568 => 20:41:43.929685
[0m20:41:43.933639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1fb7ffd-03c3-4ced-af1f-3a84e1d5d7eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88b3f078e0>]}
[0m20:41:43.936217 [info ] [Thread-1 (]: 5 of 6 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.22s]
[0m20:41:43.939023 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m20:41:43.941087 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m20:41:43.943482 [info ] [Thread-1 (]: 6 of 6 START sql table model games.dim_support_language ........................ [RUN]
[0m20:41:43.946437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m20:41:43.948313 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m20:41:43.954816 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m20:41:43.955522 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 20:41:43.949630 => 20:41:43.955307
[0m20:41:43.956001 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m20:41:43.958148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:44.677145 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m20:41:44.677870 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m20:41:45.311125 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7d9a0632-ba8e-449d-9e1a-dc8c42dcb6cc&page=queryresults
[0m20:41:48.462080 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 20:41:43.956267 => 20:41:48.461188
[0m20:41:48.465215 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1fb7ffd-03c3-4ced-af1f-3a84e1d5d7eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88b3d9aa70>]}
[0m20:41:48.467861 [info ] [Thread-1 (]: 6 of 6 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.52s]
[0m20:41:48.470691 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m20:41:48.476701 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:41:48.478263 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m20:41:48.479941 [info ] [MainThread]: 
[0m20:41:48.481688 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 28.82 seconds (28.82s).
[0m20:41:48.485545 [debug] [MainThread]: Command end result
[0m20:41:48.493326 [info ] [MainThread]: 
[0m20:41:48.493776 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:41:48.494100 [info ] [MainThread]: 
[0m20:41:48.494455 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m20:41:48.495062 [debug] [MainThread]: Command `dbt run` succeeded at 20:41:48.494963 after 29.26 seconds
[0m20:41:48.495472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88b7f0d180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88b3d3e590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88b613ff70>]}
[0m20:41:48.495930 [debug] [MainThread]: Flushing usage events
[0m22:14:22.850153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97a7a2ab00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97a5a88070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97a5a880d0>]}


============================== 22:14:22.853974 | f77a3110-284b-4d19-8d2c-d181ebfd7bbd ==============================
[0m22:14:22.853974 [info ] [MainThread]: Running with dbt=1.6.5
[0m22:14:22.854476 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:14:23.441285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f77a3110-284b-4d19-8d2c-d181ebfd7bbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97a3a0ec50>]}
[0m22:14:23.457179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f77a3110-284b-4d19-8d2c-d181ebfd7bbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97a3a287c0>]}
[0m22:14:23.458080 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m22:14:23.472295 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m22:14:23.518611 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:14:23.519060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f77a3110-284b-4d19-8d2c-d181ebfd7bbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97a3a2bf70>]}
[0m22:14:24.495021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f77a3110-284b-4d19-8d2c-d181ebfd7bbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97a2fccd60>]}
[0m22:14:24.517277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f77a3110-284b-4d19-8d2c-d181ebfd7bbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97a3a36230>]}
[0m22:14:24.517788 [info ] [MainThread]: Found 7 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m22:14:24.518172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f77a3110-284b-4d19-8d2c-d181ebfd7bbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97a38a8070>]}
[0m22:14:24.519669 [info ] [MainThread]: 
[0m22:14:24.520490 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:14:24.528926 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m22:14:24.531914 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:14:24.532512 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: '/opt/airflow/credentials.json''
[0m22:14:24.536394 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:14:24.536809 [debug] [MainThread]: Connection 'list_pristine-flames-400818' was properly closed.
[0m22:14:24.537138 [info ] [MainThread]: 
[0m22:14:24.537501 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.02 seconds (0.02s).
[0m22:14:24.537982 [error] [MainThread]: Encountered an error:
Database Error
  [Errno 2] No such file or directory: '/opt/airflow/credentials.json'
[0m22:14:24.538566 [debug] [MainThread]: Command `dbt run` failed at 22:14:24.538472 after 1.70 seconds
[0m22:14:24.538947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97a7a2ab00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97a2fcfd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97a2fccd90>]}
[0m22:14:24.539346 [debug] [MainThread]: Flushing usage events
[0m22:14:34.755377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81d31fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81b4b0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81b4b00d0>]}


============================== 22:14:34.757510 | 0fa73ca5-7161-46a8-9a1a-22bf5492df53 ==============================
[0m22:14:34.757510 [info ] [MainThread]: Running with dbt=1.6.5
[0m22:14:34.757964 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'profiles_dir': '../dbt/', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'send_anonymous_usage_stats': 'True'}
[0m22:14:35.037682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0fa73ca5-7161-46a8-9a1a-22bf5492df53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81c964940>]}
[0m22:14:35.053302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0fa73ca5-7161-46a8-9a1a-22bf5492df53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff819450a30>]}
[0m22:14:35.053923 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m22:14:35.067745 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m22:14:35.113886 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:14:35.114427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0fa73ca5-7161-46a8-9a1a-22bf5492df53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81c965840>]}
[0m22:14:36.068142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0fa73ca5-7161-46a8-9a1a-22bf5492df53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8189dcca0>]}
[0m22:14:36.077180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fa73ca5-7161-46a8-9a1a-22bf5492df53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8192cc070>]}
[0m22:14:36.077636 [info ] [MainThread]: Found 7 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m22:14:36.077977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fa73ca5-7161-46a8-9a1a-22bf5492df53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81945d9f0>]}
[0m22:14:36.079291 [info ] [MainThread]: 
[0m22:14:36.079987 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:14:36.081344 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m22:14:36.081774 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:14:37.002982 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m22:14:37.005022 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:14:37.747311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fa73ca5-7161-46a8-9a1a-22bf5492df53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8192ce800>]}
[0m22:14:37.750763 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:14:37.752545 [info ] [MainThread]: 
[0m22:14:37.761234 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m22:14:37.763470 [info ] [Thread-1 (]: 1 of 7 START sql table model games.dim_developers .............................. [RUN]
[0m22:14:37.766759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m22:14:37.768626 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m22:14:37.796966 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m22:14:37.798494 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 22:14:37.769922 => 22:14:37.798039
[0m22:14:37.799228 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m22:14:37.818589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:14:38.641765 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m22:14:38.642635 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m22:14:39.337325 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7d0dc1aa-9260-4d52-b2ad-fd6fd18e77f7&page=queryresults
[0m22:14:42.834969 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 22:14:37.799760 => 22:14:42.834654
[0m22:14:42.836177 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fa73ca5-7161-46a8-9a1a-22bf5492df53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81884fbe0>]}
[0m22:14:42.837078 [info ] [Thread-1 (]: 1 of 7 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 5.07s]
[0m22:14:42.837944 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m22:14:42.838563 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m22:14:42.839304 [info ] [Thread-1 (]: 2 of 7 START sql table model games.dim_platforms ............................... [RUN]
[0m22:14:42.840229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m22:14:42.840771 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m22:14:42.844193 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m22:14:42.844940 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 22:14:42.841153 => 22:14:42.844704
[0m22:14:42.845400 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m22:14:42.847899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:14:43.619433 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m22:14:43.622240 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m22:14:44.135600 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:52a0b788-04e3-445b-aa17-d672c63e7720&page=queryresults
[0m22:14:47.489124 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 22:14:42.845729 => 22:14:47.488927
[0m22:14:47.489948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fa73ca5-7161-46a8-9a1a-22bf5492df53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8188c7d30>]}
[0m22:14:47.490534 [info ] [Thread-1 (]: 2 of 7 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.65s]
[0m22:14:47.491227 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m22:14:47.491834 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m22:14:47.492297 [info ] [Thread-1 (]: 3 of 7 START sql table model games.dim_price_overview .......................... [RUN]
[0m22:14:47.493002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m22:14:47.493385 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m22:14:47.496730 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m22:14:47.497429 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 22:14:47.493737 => 22:14:47.497215
[0m22:14:47.497905 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m22:14:47.500341 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:14:48.201436 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m22:14:48.202128 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m22:14:49.142800 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c0e909c1-515d-4249-9b89-e8c3d7541dab&page=queryresults
[0m22:14:52.376716 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 22:14:47.498190 => 22:14:52.376363
[0m22:14:52.377945 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fa73ca5-7161-46a8-9a1a-22bf5492df53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8188901f0>]}
[0m22:14:52.378951 [info ] [Thread-1 (]: 3 of 7 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (1.1k rows, 92.9 KiB processed)[0m in 4.89s]
[0m22:14:52.380003 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m22:14:52.380791 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m22:14:52.381945 [info ] [Thread-1 (]: 4 of 7 START sql table model games.dim_publishers .............................. [RUN]
[0m22:14:52.383371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m22:14:52.384227 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m22:14:52.388968 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m22:14:52.390051 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 22:14:52.384737 => 22:14:52.389704
[0m22:14:52.390726 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m22:14:52.401412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:14:53.136169 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m22:14:53.136915 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m22:14:53.623876 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5f531486-cabe-4ea5-ae80-60e72abcb168&page=queryresults
[0m22:14:56.730114 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 22:14:52.391219 => 22:14:56.729652
[0m22:14:56.732058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fa73ca5-7161-46a8-9a1a-22bf5492df53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8188c6260>]}
[0m22:14:56.733536 [info ] [Thread-1 (]: 4 of 7 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.35s]
[0m22:14:56.735035 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m22:14:56.736113 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m22:14:56.737199 [info ] [Thread-1 (]: 5 of 7 START sql table model games.dim_release ................................. [RUN]
[0m22:14:56.738867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m22:14:56.739834 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m22:14:56.745636 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m22:14:56.746909 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 22:14:56.740506 => 22:14:56.746499
[0m22:14:56.747639 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m22:14:56.751291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:14:57.538699 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m22:14:57.542385 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m22:14:58.053761 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:157b07b8-97fd-4be1-9da6-ca32361fd31e&page=queryresults
[0m22:15:00.950202 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 22:14:56.748091 => 22:15:00.950010
[0m22:15:00.950985 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fa73ca5-7161-46a8-9a1a-22bf5492df53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8188f5f60>]}
[0m22:15:00.951584 [info ] [Thread-1 (]: 5 of 7 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.21s]
[0m22:15:00.952288 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m22:15:00.952727 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m22:15:00.953176 [info ] [Thread-1 (]: 6 of 7 START sql table model games.dim_support_language ........................ [RUN]
[0m22:15:00.953880 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m22:15:00.954412 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m22:15:00.957375 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m22:15:00.958017 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 22:15:00.954722 => 22:15:00.957819
[0m22:15:00.958394 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m22:15:00.960523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:15:01.720402 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m22:15:01.721212 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m22:15:02.192138 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:65fe130d-25b6-43d4-8ab9-7fadfdb0a7f1&page=queryresults
[0m22:15:05.933322 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 22:15:00.958653 => 22:15:05.933057
[0m22:15:05.934345 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fa73ca5-7161-46a8-9a1a-22bf5492df53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff818866d40>]}
[0m22:15:05.935125 [info ] [Thread-1 (]: 6 of 7 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.98s]
[0m22:15:05.935962 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m22:15:05.936567 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m22:15:05.937235 [info ] [Thread-1 (]: 7 of 7 START sql table model games.fct_game_pricing ............................ [RUN]
[0m22:15:05.938342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m22:15:05.938904 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m22:15:05.951916 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m22:15:05.953145 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 22:15:05.939287 => 22:15:05.952864
[0m22:15:05.953672 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m22:15:05.957962 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m22:15:05.958938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:15:05.994851 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Agregar un campo de ingresos totales
WITH total_revenue AS (
    SELECT
        SUM(price_with_tax) AS revenue
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),


-- Agregar un campo de descuentos totales
total_discounts AS (
    SELECT
        SUM(discount_amount) AS total_discount
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),


-- Calcular ganancias totales
total_gross_profit AS (
    SELECT
        (total_revenue.revenue - total_discounts.total_discount) AS gross_profit
    FROM total_revenue, total_discounts
)

-- Calcular el precio promedio de juego vendido
WITH avg_game_price AS (
    SELECT
        AVG(price_with_tax) AS avg_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
)

-- Encontrar el juego con el precio más alto
max_game_price AS (
    SELECT
        MAX(price_with_tax) AS max_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Encontrar el juego con el precio más bajo
min_game_price AS (
    SELECT
        MIN(price_with_tax) AS min_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),


-- Combinar todas las medidas en la tabla de hechos
SELECT
    ROW_NUMBER() OVER () AS fct_id,
    avg_price,
    max_price,
    min_price,
    total_discount,
    gross_profit
FROM
    avg_game_price, max_game_price, min_game_price, total_discounts, total_gross_profit
    );
  
[0m22:15:06.684445 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f05a2bea-2de6-42b3-a30e-d40d139f8805&page=queryresults
[0m22:15:06.686604 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword WITH at [39:1]')
[0m22:15:07.877183 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:fdc4a963-0410-4239-b003-df3477151013&page=queryresults
[0m22:15:07.878276 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:fdc4a963-0410-4239-b003-df3477151013&page=queryresults
[0m22:15:07.878901 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 22:15:05.954044 => 22:15:07.878709
[0m22:15:07.881848 [debug] [Thread-1 (]: Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Syntax error: Unexpected keyword WITH at [39:1]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m22:15:07.882411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fa73ca5-7161-46a8-9a1a-22bf5492df53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8188f7ac0>]}
[0m22:15:07.883003 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model games.fct_game_pricing ................... [[31mERROR[0m in 1.94s]
[0m22:15:07.883578 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m22:15:07.884974 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:15:07.885310 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m22:15:07.885655 [info ] [MainThread]: 
[0m22:15:07.885998 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 31.81 seconds (31.81s).
[0m22:15:07.887456 [debug] [MainThread]: Command end result
[0m22:15:07.896791 [info ] [MainThread]: 
[0m22:15:07.897217 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:15:07.897540 [info ] [MainThread]: 
[0m22:15:07.897862 [error] [MainThread]:   Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Syntax error: Unexpected keyword WITH at [39:1]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m22:15:07.898190 [info ] [MainThread]: 
[0m22:15:07.898528 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m22:15:07.899060 [debug] [MainThread]: Command `dbt run` failed at 22:15:07.898963 after 33.15 seconds
[0m22:15:07.899423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81d31fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8188f3730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81884fbe0>]}
[0m22:15:07.899805 [debug] [MainThread]: Flushing usage events
[0m22:16:25.047630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f967231ea70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96704b0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96704b00d0>]}


============================== 22:16:25.049700 | bf16216b-e23c-4221-866c-b0b5f53a0228 ==============================
[0m22:16:25.049700 [info ] [MainThread]: Running with dbt=1.6.5
[0m22:16:25.050182 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'debug': 'False', 'profiles_dir': '../dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:16:25.362105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf16216b-e23c-4221-866c-b0b5f53a0228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9671954e50>]}
[0m22:16:25.378596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf16216b-e23c-4221-866c-b0b5f53a0228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f966e4509d0>]}
[0m22:16:25.379237 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m22:16:25.394547 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m22:16:25.466005 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:16:25.466579 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m22:16:25.513386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf16216b-e23c-4221-866c-b0b5f53a0228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f966e2940d0>]}
[0m22:16:25.522156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf16216b-e23c-4221-866c-b0b5f53a0228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f966e25bdf0>]}
[0m22:16:25.522630 [info ] [MainThread]: Found 7 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m22:16:25.522982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf16216b-e23c-4221-866c-b0b5f53a0228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f966e25bd60>]}
[0m22:16:25.524395 [info ] [MainThread]: 
[0m22:16:25.525127 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:16:25.526426 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m22:16:25.526853 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:16:26.341802 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m22:16:26.343626 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:16:27.110419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf16216b-e23c-4221-866c-b0b5f53a0228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f967048b910>]}
[0m22:16:27.114809 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:16:27.116251 [info ] [MainThread]: 
[0m22:16:27.121813 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m22:16:27.123062 [info ] [Thread-1 (]: 1 of 7 START sql table model games.dim_developers .............................. [RUN]
[0m22:16:27.124614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m22:16:27.125517 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m22:16:27.137447 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m22:16:27.138359 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 22:16:27.126203 => 22:16:27.138081
[0m22:16:27.138888 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m22:16:27.153840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:16:27.984296 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m22:16:27.985548 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m22:16:28.659470 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:78e10bac-dd49-4970-a3f8-7e4290521a5e&page=queryresults
[0m22:16:32.158085 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 22:16:27.139269 => 22:16:32.157773
[0m22:16:32.159261 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf16216b-e23c-4221-866c-b0b5f53a0228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f966d96ffa0>]}
[0m22:16:32.160104 [info ] [Thread-1 (]: 1 of 7 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 5.04s]
[0m22:16:32.160948 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m22:16:32.161546 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m22:16:32.162255 [info ] [Thread-1 (]: 2 of 7 START sql table model games.dim_platforms ............................... [RUN]
[0m22:16:32.163138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m22:16:32.163682 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m22:16:32.167061 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m22:16:32.167846 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 22:16:32.164062 => 22:16:32.167604
[0m22:16:32.168309 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m22:16:32.175323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:16:32.949346 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m22:16:32.952105 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m22:16:33.434453 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:1657aeaf-55d1-4740-8b75-5c97f37f6f98&page=queryresults
[0m22:16:37.115981 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 22:16:32.168640 => 22:16:37.115070
[0m22:16:37.119209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf16216b-e23c-4221-866c-b0b5f53a0228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f966d9b2bf0>]}
[0m22:16:37.121934 [info ] [Thread-1 (]: 2 of 7 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.96s]
[0m22:16:37.125303 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m22:16:37.127589 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m22:16:37.130047 [info ] [Thread-1 (]: 3 of 7 START sql table model games.dim_price_overview .......................... [RUN]
[0m22:16:37.133066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m22:16:37.134906 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m22:16:37.145215 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m22:16:37.146741 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 22:16:37.136258 => 22:16:37.146256
[0m22:16:37.147670 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m22:16:37.152344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:16:37.899181 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m22:16:37.902121 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m22:16:38.388929 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e0653128-3773-41af-92cc-358f11bfad74&page=queryresults
[0m22:16:42.107039 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 22:16:37.148330 => 22:16:42.106098
[0m22:16:42.123736 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf16216b-e23c-4221-866c-b0b5f53a0228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f966d97e890>]}
[0m22:16:42.129080 [info ] [Thread-1 (]: 3 of 7 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (1.1k rows, 92.9 KiB processed)[0m in 4.99s]
[0m22:16:42.135781 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m22:16:42.136912 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m22:16:42.141769 [info ] [Thread-1 (]: 4 of 7 START sql table model games.dim_publishers .............................. [RUN]
[0m22:16:42.143231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m22:16:42.144110 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m22:16:42.148411 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m22:16:42.156229 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 22:16:42.144635 => 22:16:42.155918
[0m22:16:42.156846 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m22:16:42.160020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:16:42.936460 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m22:16:42.939192 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m22:16:43.675740 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:38711e36-6cf9-4cc2-952d-ae9a6b5c6369&page=queryresults
[0m22:16:46.897685 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 22:16:42.157296 => 22:16:46.897430
[0m22:16:46.898786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf16216b-e23c-4221-866c-b0b5f53a0228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f966d97ee30>]}
[0m22:16:46.899545 [info ] [Thread-1 (]: 4 of 7 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.76s]
[0m22:16:46.900499 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m22:16:46.901048 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m22:16:46.901639 [info ] [Thread-1 (]: 5 of 7 START sql table model games.dim_release ................................. [RUN]
[0m22:16:46.902396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m22:16:46.902817 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m22:16:46.906027 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m22:16:46.906672 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 22:16:46.903260 => 22:16:46.906479
[0m22:16:46.907042 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m22:16:46.916975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:16:47.679239 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m22:16:47.682032 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m22:16:48.199271 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ceb03ecd-0dbd-4d31-b3f5-7b8560fe7178&page=queryresults
[0m22:16:51.575219 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 22:16:46.907343 => 22:16:51.574290
[0m22:16:51.578464 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf16216b-e23c-4221-866c-b0b5f53a0228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f966e4530a0>]}
[0m22:16:51.581125 [info ] [Thread-1 (]: 5 of 7 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.68s]
[0m22:16:51.584080 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m22:16:51.586160 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m22:16:51.588650 [info ] [Thread-1 (]: 6 of 7 START sql table model games.dim_support_language ........................ [RUN]
[0m22:16:51.591646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m22:16:51.593461 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m22:16:51.606490 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m22:16:51.609447 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 22:16:51.594742 => 22:16:51.608459
[0m22:16:51.611012 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m22:16:51.617354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:16:52.429179 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m22:16:52.432286 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m22:16:52.987155 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5c3bb644-2bbf-4b2e-906e-e02ef2a32f90&page=queryresults
[0m22:16:56.757394 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 22:16:51.611971 => 22:16:56.756515
[0m22:16:56.760564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf16216b-e23c-4221-866c-b0b5f53a0228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f966e2c6d70>]}
[0m22:16:56.763117 [info ] [Thread-1 (]: 6 of 7 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 5.17s]
[0m22:16:56.765970 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m22:16:56.768033 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m22:16:56.770445 [info ] [Thread-1 (]: 7 of 7 START sql table model games.fct_game_pricing ............................ [RUN]
[0m22:16:56.773466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m22:16:56.775291 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m22:16:56.787584 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m22:16:56.789171 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 22:16:56.776624 => 22:16:56.788661
[0m22:16:56.790101 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m22:16:56.796029 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m22:16:56.797028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:16:56.833211 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Agregar un campo de ingresos totales
WITH total_revenue AS (
    SELECT
        SUM(price_with_tax) AS revenue
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),


-- Agregar un campo de descuentos totales
total_discounts AS (
    SELECT
        SUM(discount_amount) AS total_discount
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),


-- Calcular ganancias totales
total_gross_profit AS (
    SELECT
        (total_revenue.revenue - total_discounts.total_discount) AS gross_profit
    FROM total_revenue, total_discounts
),

-- Calcular el precio promedio de juego vendido
WITH avg_game_price AS (
    SELECT
        AVG(price_with_tax) AS avg_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Encontrar el juego con el precio más alto
max_game_price AS (
    SELECT
        MAX(price_with_tax) AS max_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Encontrar el juego con el precio más bajo
min_game_price AS (
    SELECT
        MIN(price_with_tax) AS min_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),


-- Combinar todas las medidas en la tabla de hechos
SELECT
    ROW_NUMBER() OVER () AS fct_id,
    avg_price,
    max_price,
    min_price,
    total_discount,
    gross_profit
FROM
    avg_game_price, max_game_price, min_game_price, total_discounts, total_gross_profit
    );
  
[0m22:16:57.558244 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:549dc55a-9410-4bdc-97d1-7f9a2738ed1a&page=queryresults
[0m22:16:57.562501 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword SELECT but got keyword WITH at [39:1]')
[0m22:16:58.107958 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:650f9f1e-6dc0-4d58-a4da-60d4b9feab17&page=queryresults
[0m22:16:58.112289 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:650f9f1e-6dc0-4d58-a4da-60d4b9feab17&page=queryresults
[0m22:16:58.115431 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 22:16:56.790668 => 22:16:58.114472
[0m22:16:58.128941 [debug] [Thread-1 (]: Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Syntax error: Expected keyword SELECT but got keyword WITH at [39:1]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m22:16:58.131094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf16216b-e23c-4221-866c-b0b5f53a0228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f966e453160>]}
[0m22:16:58.133715 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model games.fct_game_pricing ................... [[31mERROR[0m in 1.36s]
[0m22:16:58.136139 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m22:16:58.140479 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:16:58.141371 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m22:16:58.142292 [info ] [MainThread]: 
[0m22:16:58.143193 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 32.62 seconds (32.62s).
[0m22:16:58.146559 [debug] [MainThread]: Command end result
[0m22:16:58.168042 [info ] [MainThread]: 
[0m22:16:58.168621 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:16:58.169027 [info ] [MainThread]: 
[0m22:16:58.169428 [error] [MainThread]:   Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Syntax error: Expected keyword SELECT but got keyword WITH at [39:1]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m22:16:58.169841 [info ] [MainThread]: 
[0m22:16:58.170278 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m22:16:58.170881 [debug] [MainThread]: Command `dbt run` failed at 22:16:58.170772 after 33.13 seconds
[0m22:16:58.171290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f967231ea70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f967048bf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f967048bb20>]}
[0m22:16:58.171723 [debug] [MainThread]: Flushing usage events
[0m22:18:07.987701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f294002aa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293e088070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293e0880d0>]}


============================== 22:18:07.990235 | 88fdea40-a14d-472e-8660-3952ef26a2b2 ==============================
[0m22:18:07.990235 [info ] [MainThread]: Running with dbt=1.6.5
[0m22:18:07.990790 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:18:08.328809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88fdea40-a14d-472e-8660-3952ef26a2b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293f5d0e50>]}
[0m22:18:08.345524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88fdea40-a14d-472e-8660-3952ef26a2b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293c0289d0>]}
[0m22:18:08.346272 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m22:18:08.362519 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m22:18:08.434448 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:18:08.435031 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m22:18:08.483423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88fdea40-a14d-472e-8660-3952ef26a2b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293bedc0d0>]}
[0m22:18:08.493513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88fdea40-a14d-472e-8660-3952ef26a2b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293be33df0>]}
[0m22:18:08.494161 [info ] [MainThread]: Found 7 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m22:18:08.494764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88fdea40-a14d-472e-8660-3952ef26a2b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293be33d60>]}
[0m22:18:08.496415 [info ] [MainThread]: 
[0m22:18:08.497216 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:18:08.503585 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m22:18:08.504177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:18:09.250972 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m22:18:09.251974 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:18:09.932213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88fdea40-a14d-472e-8660-3952ef26a2b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293be31f90>]}
[0m22:18:09.933203 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:18:09.933603 [info ] [MainThread]: 
[0m22:18:09.935617 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m22:18:09.936140 [info ] [Thread-1 (]: 1 of 7 START sql table model games.dim_developers .............................. [RUN]
[0m22:18:09.936819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m22:18:09.937366 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m22:18:09.944435 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m22:18:09.945258 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 22:18:09.937680 => 22:18:09.944979
[0m22:18:09.945672 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m22:18:09.959346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:18:10.730325 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m22:18:10.730987 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m22:18:11.384630 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:18d3b439-8dc8-40ed-8e3f-4c06005efb8e&page=queryresults
[0m22:18:15.083061 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 22:18:09.946024 => 22:18:15.082854
[0m22:18:15.084163 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88fdea40-a14d-472e-8660-3952ef26a2b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293b547e50>]}
[0m22:18:15.084980 [info ] [Thread-1 (]: 1 of 7 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 5.15s]
[0m22:18:15.085844 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m22:18:15.086339 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m22:18:15.086912 [info ] [Thread-1 (]: 2 of 7 START sql table model games.dim_platforms ............................... [RUN]
[0m22:18:15.087734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m22:18:15.088134 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m22:18:15.091565 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m22:18:15.092415 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 22:18:15.088413 => 22:18:15.092083
[0m22:18:15.092845 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m22:18:15.100737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:18:15.867121 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m22:18:15.868079 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m22:18:16.572399 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:4ebf3dfa-12b3-4d90-96af-798cb81dd7ac&page=queryresults
[0m22:18:20.763438 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 22:18:15.093379 => 22:18:20.762569
[0m22:18:20.766722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88fdea40-a14d-472e-8660-3952ef26a2b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293b5961d0>]}
[0m22:18:20.769428 [info ] [Thread-1 (]: 2 of 7 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 5.68s]
[0m22:18:20.772919 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m22:18:20.775456 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m22:18:20.778359 [info ] [Thread-1 (]: 3 of 7 START sql table model games.dim_price_overview .......................... [RUN]
[0m22:18:20.784307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m22:18:20.786194 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m22:18:20.794542 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m22:18:20.796509 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 22:18:20.787308 => 22:18:20.796079
[0m22:18:20.797543 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m22:18:20.801688 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:18:21.592991 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m22:18:21.595916 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m22:18:22.190090 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:881d1642-7882-4e0c-9799-1a5bd015a1db&page=queryresults
[0m22:18:25.289665 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 22:18:20.798209 => 22:18:25.288793
[0m22:18:25.293033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88fdea40-a14d-472e-8660-3952ef26a2b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293b58be80>]}
[0m22:18:25.295620 [info ] [Thread-1 (]: 3 of 7 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (1.1k rows, 92.9 KiB processed)[0m in 4.51s]
[0m22:18:25.298441 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m22:18:25.300517 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m22:18:25.303296 [info ] [Thread-1 (]: 4 of 7 START sql table model games.dim_publishers .............................. [RUN]
[0m22:18:25.306490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m22:18:25.308369 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m22:18:25.321256 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m22:18:25.324120 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 22:18:25.309673 => 22:18:25.323177
[0m22:18:25.325933 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m22:18:25.334752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:18:26.097644 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m22:18:26.098261 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m22:18:26.673305 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:3554f9ce-0790-4e19-b83f-5f11db21f5f4&page=queryresults
[0m22:18:30.933825 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 22:18:25.327228 => 22:18:30.932940
[0m22:18:30.937208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88fdea40-a14d-472e-8660-3952ef26a2b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293b589ff0>]}
[0m22:18:30.939829 [info ] [Thread-1 (]: 4 of 7 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 5.63s]
[0m22:18:30.942659 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m22:18:30.944728 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m22:18:30.947137 [info ] [Thread-1 (]: 5 of 7 START sql table model games.dim_release ................................. [RUN]
[0m22:18:30.950339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m22:18:30.952234 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m22:18:30.961423 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m22:18:30.962958 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 22:18:30.953548 => 22:18:30.962470
[0m22:18:30.963905 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m22:18:30.977484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:18:31.732956 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m22:18:31.734131 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m22:18:32.240500 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e106ec67-0807-4147-9f47-c35500946af9&page=queryresults
[0m22:18:35.649113 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 22:18:30.964567 => 22:18:35.648926
[0m22:18:35.649799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88fdea40-a14d-472e-8660-3952ef26a2b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293c029480>]}
[0m22:18:35.650342 [info ] [Thread-1 (]: 5 of 7 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.70s]
[0m22:18:35.650910 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m22:18:35.651331 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m22:18:35.651801 [info ] [Thread-1 (]: 6 of 7 START sql table model games.dim_support_language ........................ [RUN]
[0m22:18:35.652393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m22:18:35.652842 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m22:18:35.655679 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m22:18:35.656286 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 22:18:35.653115 => 22:18:35.656100
[0m22:18:35.656651 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m22:18:35.658699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:18:36.434314 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m22:18:36.437091 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m22:18:37.014717 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:8f70b60a-976f-43aa-8b8b-85cfea1f2291&page=queryresults
[0m22:18:40.427137 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 22:18:35.656907 => 22:18:40.426813
[0m22:18:40.428337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88fdea40-a14d-472e-8660-3952ef26a2b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293be9ee00>]}
[0m22:18:40.429284 [info ] [Thread-1 (]: 6 of 7 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.78s]
[0m22:18:40.430303 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m22:18:40.431043 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m22:18:40.431924 [info ] [Thread-1 (]: 7 of 7 START sql table model games.fct_game_pricing ............................ [RUN]
[0m22:18:40.432976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m22:18:40.433630 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m22:18:40.439601 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m22:18:40.440702 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 22:18:40.434098 => 22:18:40.440360
[0m22:18:40.441358 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m22:18:40.446432 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m22:18:40.447404 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:18:40.484226 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Agregar un campo de ingresos totales
WITH total_revenue AS (
    SELECT
        SUM(price_with_tax) AS revenue
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),


-- Agregar un campo de descuentos totales
total_discounts AS (
    SELECT
        SUM(discount_amount) AS total_discount
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),


-- Calcular ganancias totales
total_gross_profit AS (
    SELECT
        (total_revenue.revenue - total_discounts.total_discount) AS gross_profit
    FROM total_revenue, total_discounts
),

-- Calcular el precio promedio de juego vendido
WITH avg_game_price AS (
    SELECT
        AVG(price_with_tax) AS avg_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Encontrar el juego con el precio más alto
max_game_price AS (
    SELECT
        MAX(price_with_tax) AS max_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Encontrar el juego con el precio más bajo
min_game_price AS (
    SELECT
        MIN(price_with_tax) AS min_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),


-- Combinar todas las medidas en la tabla de hechos
SELECT
    ROW_NUMBER() OVER () AS fct_id,
    avg_price,
    max_price,
    min_price,
    total_discount,
    gross_profit,
FROM
    avg_game_price, max_game_price, min_game_price, total_discounts, total_gross_profit
    );
  
[0m22:18:41.264160 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9e6d1847-2729-4732-b58e-4f729a54f5b6&page=queryresults
[0m22:18:41.268479 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword SELECT but got keyword WITH at [39:1]')
[0m22:18:42.318332 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f6f9d76a-a4ef-4471-986c-3c520fb3f713&page=queryresults
[0m22:18:42.322634 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f6f9d76a-a4ef-4471-986c-3c520fb3f713&page=queryresults
[0m22:18:42.325722 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 22:18:40.441823 => 22:18:42.324792
[0m22:18:42.339031 [debug] [Thread-1 (]: Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Syntax error: Expected keyword SELECT but got keyword WITH at [39:1]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m22:18:42.341260 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88fdea40-a14d-472e-8660-3952ef26a2b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293c02bbb0>]}
[0m22:18:42.343900 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model games.fct_game_pricing ................... [[31mERROR[0m in 1.91s]
[0m22:18:42.346290 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m22:18:42.350534 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:18:42.351409 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m22:18:42.352344 [info ] [MainThread]: 
[0m22:18:42.353239 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 33.86 seconds (33.86s).
[0m22:18:42.356636 [debug] [MainThread]: Command end result
[0m22:18:42.375061 [info ] [MainThread]: 
[0m22:18:42.375580 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:18:42.375971 [info ] [MainThread]: 
[0m22:18:42.376344 [error] [MainThread]:   Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Syntax error: Expected keyword SELECT but got keyword WITH at [39:1]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m22:18:42.376718 [info ] [MainThread]: 
[0m22:18:42.377102 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m22:18:42.377704 [debug] [MainThread]: Command `dbt run` failed at 22:18:42.377598 after 34.41 seconds
[0m22:18:42.378111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f294002aa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293f7c08b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293b5d8dc0>]}
[0m22:18:42.378521 [debug] [MainThread]: Flushing usage events
[0m22:19:15.546657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8d2025180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8d0080070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8d00800d0>]}


============================== 22:19:15.548755 | f9ef3056-f8cc-4c5d-9f0b-cac4905680cb ==============================
[0m22:19:15.548755 [info ] [MainThread]: Running with dbt=1.6.5
[0m22:19:15.549246 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'profiles_dir': '../dbt/', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:19:15.845681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9ef3056-f8cc-4c5d-9f0b-cac4905680cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8d15b07c0>]}
[0m22:19:15.861756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9ef3056-f8cc-4c5d-9f0b-cac4905680cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8ce0209d0>]}
[0m22:19:15.862354 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m22:19:15.876301 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m22:19:15.941289 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:19:15.941861 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m22:19:15.985620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9ef3056-f8cc-4c5d-9f0b-cac4905680cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8cded80d0>]}
[0m22:19:15.994808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9ef3056-f8cc-4c5d-9f0b-cac4905680cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8cde2bdf0>]}
[0m22:19:15.995262 [info ] [MainThread]: Found 7 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m22:19:15.995651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9ef3056-f8cc-4c5d-9f0b-cac4905680cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8cde2bd60>]}
[0m22:19:15.996955 [info ] [MainThread]: 
[0m22:19:15.997600 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:19:15.998894 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m22:19:15.999323 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:19:16.749942 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m22:19:16.752001 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:19:17.478073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9ef3056-f8cc-4c5d-9f0b-cac4905680cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8cde2a020>]}
[0m22:19:17.481300 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:19:17.482965 [info ] [MainThread]: 
[0m22:19:17.491065 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m22:19:17.493307 [info ] [Thread-1 (]: 1 of 7 START sql table model games.dim_developers .............................. [RUN]
[0m22:19:17.496267 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m22:19:17.498095 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m22:19:17.526576 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m22:19:17.528211 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 22:19:17.499385 => 22:19:17.527683
[0m22:19:17.529043 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m22:19:17.548660 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:19:18.332888 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m22:19:18.333666 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m22:19:18.975256 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a9fb6cdc-5176-44e7-b25e-6f40421fe0d2&page=queryresults
[0m22:19:22.961653 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 22:19:17.529587 => 22:19:22.961460
[0m22:19:22.962374 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9ef3056-f8cc-4c5d-9f0b-cac4905680cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8d1848ca0>]}
[0m22:19:22.962931 [info ] [Thread-1 (]: 1 of 7 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 5.47s]
[0m22:19:22.963514 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m22:19:22.963949 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m22:19:22.964464 [info ] [Thread-1 (]: 2 of 7 START sql table model games.dim_platforms ............................... [RUN]
[0m22:19:22.965071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m22:19:22.965442 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m22:19:22.968110 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m22:19:22.968722 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 22:19:22.965706 => 22:19:22.968530
[0m22:19:22.969095 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m22:19:22.976603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:19:23.707041 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m22:19:23.710118 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m22:19:24.369333 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:bd0a2350-dd1a-48f3-b130-e4e706b7496f&page=queryresults
[0m22:19:27.230777 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 22:19:22.969362 => 22:19:27.229903
[0m22:19:27.233914 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9ef3056-f8cc-4c5d-9f0b-cac4905680cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8cd58e1d0>]}
[0m22:19:27.236488 [info ] [Thread-1 (]: 2 of 7 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.27s]
[0m22:19:27.239297 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m22:19:27.241380 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m22:19:27.243811 [info ] [Thread-1 (]: 3 of 7 START sql table model games.dim_price_overview .......................... [RUN]
[0m22:19:27.246764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m22:19:27.248631 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m22:19:27.259434 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m22:19:27.260941 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 22:19:27.249931 => 22:19:27.260453
[0m22:19:27.261899 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m22:19:27.266496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:19:28.054919 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m22:19:28.057894 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m22:19:28.696891 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:0c1b3a8e-84ee-4767-9def-142d0b111ae6&page=queryresults
[0m22:19:32.353680 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 22:19:27.262572 => 22:19:32.353490
[0m22:19:32.354607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9ef3056-f8cc-4c5d-9f0b-cac4905680cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8cd582440>]}
[0m22:19:32.355515 [info ] [Thread-1 (]: 3 of 7 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (1.1k rows, 92.9 KiB processed)[0m in 5.11s]
[0m22:19:32.356489 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m22:19:32.357126 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m22:19:32.357720 [info ] [Thread-1 (]: 4 of 7 START sql table model games.dim_publishers .............................. [RUN]
[0m22:19:32.358561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m22:19:32.358967 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m22:19:32.361842 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m22:19:32.362538 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 22:19:32.359229 => 22:19:32.362283
[0m22:19:32.362937 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m22:19:32.365156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:19:33.002032 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m22:19:33.004774 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m22:19:33.519856 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:04d7b26f-6346-40ee-ba4d-2922f51e8c60&page=queryresults
[0m22:19:37.286123 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 22:19:32.363194 => 22:19:37.285919
[0m22:19:37.287050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9ef3056-f8cc-4c5d-9f0b-cac4905680cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8cd580eb0>]}
[0m22:19:37.287886 [info ] [Thread-1 (]: 4 of 7 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.93s]
[0m22:19:37.288561 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m22:19:37.289051 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m22:19:37.289549 [info ] [Thread-1 (]: 5 of 7 START sql table model games.dim_release ................................. [RUN]
[0m22:19:37.290260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m22:19:37.290685 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m22:19:37.295175 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m22:19:37.296025 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 22:19:37.291001 => 22:19:37.295783
[0m22:19:37.296577 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m22:19:37.309188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:19:38.097729 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m22:19:38.098439 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m22:19:38.654562 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:6134a95b-5a0c-40a1-bdd4-c64400680099&page=queryresults
[0m22:19:41.867597 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 22:19:37.296887 => 22:19:41.867399
[0m22:19:41.868292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9ef3056-f8cc-4c5d-9f0b-cac4905680cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8d1848ca0>]}
[0m22:19:41.868841 [info ] [Thread-1 (]: 5 of 7 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.58s]
[0m22:19:41.869442 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m22:19:41.869872 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m22:19:41.870399 [info ] [Thread-1 (]: 6 of 7 START sql table model games.dim_support_language ........................ [RUN]
[0m22:19:41.871137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m22:19:41.871618 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m22:19:41.875299 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m22:19:41.876063 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 22:19:41.871921 => 22:19:41.875836
[0m22:19:41.876514 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m22:19:41.878733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:19:42.600934 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m22:19:42.601633 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m22:19:43.198288 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:638e31fc-13d8-4d52-9283-17a9a78047e0&page=queryresults
[0m22:19:46.579208 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 22:19:41.876800 => 22:19:46.578990
[0m22:19:46.580093 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9ef3056-f8cc-4c5d-9f0b-cac4905680cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8ce004670>]}
[0m22:19:46.580758 [info ] [Thread-1 (]: 6 of 7 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.71s]
[0m22:19:46.581458 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m22:19:46.582151 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m22:19:46.582734 [info ] [Thread-1 (]: 7 of 7 START sql table model games.fct_game_pricing ............................ [RUN]
[0m22:19:46.583446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m22:19:46.583885 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m22:19:46.588182 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m22:19:46.588874 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 22:19:46.584203 => 22:19:46.588661
[0m22:19:46.589256 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m22:19:46.592181 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m22:19:46.592979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:19:46.626320 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Calcular el precio promedio de juego vendido
WITH avg_game_price AS (
    SELECT
        AVG(price_with_tax) AS avg_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Encontrar el juego con el precio más alto
max_game_price AS (
    SELECT
        MAX(price_with_tax) AS max_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Encontrar el juego con el precio más bajo
min_game_price AS (
    SELECT
        MIN(price_with_tax) AS min_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Agregar un campo de ingresos totales
total_revenue AS (
    SELECT
        SUM(price_with_tax) AS revenue
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Agregar un campo de descuentos totales
total_discounts AS (
    SELECT
        SUM(discount_amount) AS total_discount
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Calcular ganancias totales
total_gross_profit AS (
    SELECT
        (total_revenue.revenue - total_discounts.total_discount) AS gross_profit
    FROM total_revenue, total_discounts
)

-- Combinar todas las medidas en la tabla de hechos
SELECT
    ROW_NUMBER() OVER () AS fct_id,
    avg_price,
    max_price,
    min_price,
    total_discount,
    gross_profit
FROM
    avg_game_price, max_game_price, min_game_price, total_discounts, total_gross_profit;
    );
  
[0m22:19:47.309925 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:8a02acee-76ea-45cb-b72b-de5e0cf88727&page=queryresults
[0m22:19:47.311162 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [66:88]')
[0m22:19:47.658549 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7a6b8d5f-d1eb-4a1b-a1de-2f8c653cfa65&page=queryresults
[0m22:19:47.659731 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7a6b8d5f-d1eb-4a1b-a1de-2f8c653cfa65&page=queryresults
[0m22:19:47.660410 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 22:19:46.589520 => 22:19:47.660223
[0m22:19:47.663194 [debug] [Thread-1 (]: Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Syntax error: Expected ")" but got ";" at [66:88]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m22:19:47.663735 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9ef3056-f8cc-4c5d-9f0b-cac4905680cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8ce0042e0>]}
[0m22:19:47.664313 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model games.fct_game_pricing ................... [[31mERROR[0m in 1.08s]
[0m22:19:47.664923 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m22:19:47.666386 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:19:47.666823 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m22:19:47.667228 [info ] [MainThread]: 
[0m22:19:47.667635 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 31.67 seconds (31.67s).
[0m22:19:47.669106 [debug] [MainThread]: Command end result
[0m22:19:47.684027 [info ] [MainThread]: 
[0m22:19:47.684545 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:19:47.684905 [info ] [MainThread]: 
[0m22:19:47.685290 [error] [MainThread]:   Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Syntax error: Expected ")" but got ";" at [66:88]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m22:19:47.685727 [info ] [MainThread]: 
[0m22:19:47.686133 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m22:19:47.686746 [debug] [MainThread]: Command `dbt run` failed at 22:19:47.686638 after 32.15 seconds
[0m22:19:47.687137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8d2025180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8d179c7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8cd5d2620>]}
[0m22:19:47.687523 [debug] [MainThread]: Flushing usage events
[0m22:20:02.132869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facb432eb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facb24bc070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facb24bc0d0>]}


============================== 22:20:02.134959 | 12aa2bae-779c-4bd6-9a3d-79b34b864c20 ==============================
[0m22:20:02.134959 [info ] [MainThread]: Running with dbt=1.6.5
[0m22:20:02.135459 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '../dbt/', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'send_anonymous_usage_stats': 'True'}
[0m22:20:02.433845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12aa2bae-779c-4bd6-9a3d-79b34b864c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facb0442c50>]}
[0m22:20:02.449941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12aa2bae-779c-4bd6-9a3d-79b34b864c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facb045c640>]}
[0m22:20:02.450597 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m22:20:02.464909 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m22:20:02.529572 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:20:02.530147 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m22:20:02.574398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12aa2bae-779c-4bd6-9a3d-79b34b864c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facb02ac0d0>]}
[0m22:20:02.583063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12aa2bae-779c-4bd6-9a3d-79b34b864c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facb0267d30>]}
[0m22:20:02.583518 [info ] [MainThread]: Found 7 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m22:20:02.583900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12aa2bae-779c-4bd6-9a3d-79b34b864c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facb0267e20>]}
[0m22:20:02.585198 [info ] [MainThread]: 
[0m22:20:02.585843 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:20:02.587099 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m22:20:02.587505 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:20:03.362807 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m22:20:03.364819 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:20:04.128767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12aa2bae-779c-4bd6-9a3d-79b34b864c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facb0265f90>]}
[0m22:20:04.132016 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:20:04.133673 [info ] [MainThread]: 
[0m22:20:04.141823 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m22:20:04.144088 [info ] [Thread-1 (]: 1 of 7 START sql table model games.dim_developers .............................. [RUN]
[0m22:20:04.147086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m22:20:04.148922 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m22:20:04.178065 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m22:20:04.179645 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 22:20:04.150190 => 22:20:04.179123
[0m22:20:04.180557 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m22:20:04.200225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:20:05.024799 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m22:20:05.025619 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m22:20:05.629385 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:1adb85db-5cc0-4b9c-b81a-adca338ae990&page=queryresults
[0m22:20:09.149917 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 22:20:04.181097 => 22:20:09.149599
[0m22:20:09.151060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12aa2bae-779c-4bd6-9a3d-79b34b864c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facb3bc1ea0>]}
[0m22:20:09.151913 [info ] [Thread-1 (]: 1 of 7 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 5.01s]
[0m22:20:09.152756 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m22:20:09.153363 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m22:20:09.154083 [info ] [Thread-1 (]: 2 of 7 START sql table model games.dim_platforms ............................... [RUN]
[0m22:20:09.154949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m22:20:09.155485 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m22:20:09.158852 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m22:20:09.159615 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 22:20:09.155879 => 22:20:09.159366
[0m22:20:09.160077 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m22:20:09.166954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:20:09.904314 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m22:20:09.906981 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m22:20:10.501697 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:16763cf9-654d-413f-9c3f-29551a5f519a&page=queryresults
[0m22:20:13.642220 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 22:20:09.160412 => 22:20:13.641323
[0m22:20:13.645374 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12aa2bae-779c-4bd6-9a3d-79b34b864c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facaf9c61d0>]}
[0m22:20:13.648117 [info ] [Thread-1 (]: 2 of 7 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.49s]
[0m22:20:13.651020 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m22:20:13.653123 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m22:20:13.655522 [info ] [Thread-1 (]: 3 of 7 START sql table model games.dim_price_overview .......................... [RUN]
[0m22:20:13.658540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m22:20:13.660152 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m22:20:13.668353 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m22:20:13.669797 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 22:20:13.661086 => 22:20:13.669410
[0m22:20:13.670537 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m22:20:13.674731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:20:14.436807 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m22:20:14.439800 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m22:20:14.921803 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:54df32bd-05db-4850-b283-556bb52a353a&page=queryresults
[0m22:20:18.331004 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 22:20:13.671063 => 22:20:18.330065
[0m22:20:18.334391 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12aa2bae-779c-4bd6-9a3d-79b34b864c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facaf9b9cf0>]}
[0m22:20:18.337044 [info ] [Thread-1 (]: 3 of 7 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (1.1k rows, 92.9 KiB processed)[0m in 4.68s]
[0m22:20:18.339901 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m22:20:18.341962 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m22:20:18.344655 [info ] [Thread-1 (]: 4 of 7 START sql table model games.dim_publishers .............................. [RUN]
[0m22:20:18.347829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m22:20:18.349688 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m22:20:18.362657 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m22:20:18.365627 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 22:20:18.350982 => 22:20:18.364628
[0m22:20:18.367518 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m22:20:18.376503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:20:19.508965 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m22:20:19.511685 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m22:20:20.145122 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:844326c5-e986-4780-aa24-ab09882e0719&page=queryresults
[0m22:20:23.872561 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 22:20:18.368886 => 22:20:23.871670
[0m22:20:23.875940 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12aa2bae-779c-4bd6-9a3d-79b34b864c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facb045e8c0>]}
[0m22:20:23.878578 [info ] [Thread-1 (]: 4 of 7 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 5.53s]
[0m22:20:23.881556 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m22:20:23.883634 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m22:20:23.886053 [info ] [Thread-1 (]: 5 of 7 START sql table model games.dim_release ................................. [RUN]
[0m22:20:23.889222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m22:20:23.891081 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m22:20:23.900023 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m22:20:23.901587 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 22:20:23.892409 => 22:20:23.901095
[0m22:20:23.902522 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m22:20:23.916960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:20:24.683964 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m22:20:24.686644 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m22:20:25.154351 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:8e96db43-36c5-4cdf-a231-2f9b406e1bd8&page=queryresults
[0m22:20:28.768948 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 22:20:23.903192 => 22:20:28.768071
[0m22:20:28.772082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12aa2bae-779c-4bd6-9a3d-79b34b864c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facb3bc09d0>]}
[0m22:20:28.774702 [info ] [Thread-1 (]: 5 of 7 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.88s]
[0m22:20:28.777545 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m22:20:28.779614 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m22:20:28.781998 [info ] [Thread-1 (]: 6 of 7 START sql table model games.dim_support_language ........................ [RUN]
[0m22:20:28.784959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m22:20:28.786820 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m22:20:28.796601 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m22:20:28.798181 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 22:20:28.788158 => 22:20:28.797685
[0m22:20:28.799212 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m22:20:28.803737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:20:29.547782 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m22:20:29.550667 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m22:20:30.209989 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:33021557-268c-4d09-adc1-3b24549d13ca&page=queryresults
[0m22:20:33.288831 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 22:20:28.799933 => 22:20:33.287888
[0m22:20:33.292058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12aa2bae-779c-4bd6-9a3d-79b34b864c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facb02f1480>]}
[0m22:20:33.294779 [info ] [Thread-1 (]: 6 of 7 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.51s]
[0m22:20:33.297821 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m22:20:33.299989 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m22:20:33.302208 [info ] [Thread-1 (]: 7 of 7 START sql table model games.fct_game_pricing ............................ [RUN]
[0m22:20:33.305452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m22:20:33.307333 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m22:20:33.318837 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m22:20:33.320444 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 22:20:33.308680 => 22:20:33.319937
[0m22:20:33.321196 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m22:20:33.326889 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m22:20:33.327888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:20:33.363931 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Calcular el precio promedio de juego vendido
WITH avg_game_price AS (
    SELECT
        AVG(price_with_tax) AS avg_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Encontrar el juego con el precio más alto
max_game_price AS (
    SELECT
        MAX(price_with_tax) AS max_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Encontrar el juego con el precio más bajo
min_game_price AS (
    SELECT
        MIN(price_with_tax) AS min_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Agregar un campo de ingresos totales
total_revenue AS (
    SELECT
        SUM(price_with_tax) AS revenue
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Agregar un campo de descuentos totales
total_discounts AS (
    SELECT
        SUM(discount_amount) AS total_discount
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Calcular ganancias totales
total_gross_profit AS (
    SELECT
        (total_revenue.revenue - total_discounts.total_discount) AS gross_profit
    FROM total_revenue, total_discounts
)

-- Combinar todas las medidas en la tabla de hechos
SELECT
    ROW_NUMBER() OVER () AS fct_id,
    avg_price,
    max_price,
    min_price,
    total_discount,
    gross_profit
FROM
    avg_game_price, max_game_price, min_game_price, total_discounts, total_gross_profit
    );
  
[0m22:20:34.415106 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:8970304c-bf5a-41d7-a202-43ce1efa7c48&page=queryresults
[0m22:20:38.259180 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 22:20:33.321720 => 22:20:38.258994
[0m22:20:38.259917 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12aa2bae-779c-4bd6-9a3d-79b34b864c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facb0440310>]}
[0m22:20:38.260472 [info ] [Thread-1 (]: 7 of 7 OK created sql table model games.fct_game_pricing ....................... [[32mCREATE TABLE (1.0 rows, 35.7 KiB processed)[0m in 4.96s]
[0m22:20:38.261037 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m22:20:38.262363 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:20:38.262687 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m22:20:38.263049 [info ] [MainThread]: 
[0m22:20:38.263444 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 35.68 seconds (35.68s).
[0m22:20:38.265021 [debug] [MainThread]: Command end result
[0m22:20:38.280721 [info ] [MainThread]: 
[0m22:20:38.281204 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:20:38.281584 [info ] [MainThread]: 
[0m22:20:38.281976 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m22:20:38.282585 [debug] [MainThread]: Command `dbt run` succeeded at 22:20:38.282475 after 36.16 seconds
[0m22:20:38.282986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facb432eb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facb2493f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facb24900d0>]}
[0m22:20:38.283404 [debug] [MainThread]: Flushing usage events
[0m22:24:32.211212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24b2c16b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24b0c80070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24b0c800d0>]}


============================== 22:24:32.213942 | 709a5781-c723-4ad1-9a8e-875a765bd5ed ==============================
[0m22:24:32.213942 [info ] [MainThread]: Running with dbt=1.6.5
[0m22:24:32.214456 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:24:32.503700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '709a5781-c723-4ad1-9a8e-875a765bd5ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24b21c87c0>]}
[0m22:24:32.519718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '709a5781-c723-4ad1-9a8e-875a765bd5ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24aec209d0>]}
[0m22:24:32.520382 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m22:24:32.534933 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m22:24:32.601504 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:24:32.602186 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m22:24:32.602684 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m22:24:32.657076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '709a5781-c723-4ad1-9a8e-875a765bd5ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24aead40d0>]}
[0m22:24:32.666356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '709a5781-c723-4ad1-9a8e-875a765bd5ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24aea2fd00>]}
[0m22:24:32.666842 [info ] [MainThread]: Found 7 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m22:24:32.667211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '709a5781-c723-4ad1-9a8e-875a765bd5ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24aea2fdf0>]}
[0m22:24:32.668607 [info ] [MainThread]: 
[0m22:24:32.669313 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:24:32.670759 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m22:24:32.671222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:24:33.447181 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m22:24:33.449240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:24:34.196639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '709a5781-c723-4ad1-9a8e-875a765bd5ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24aea2ded0>]}
[0m22:24:34.199877 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:24:34.201551 [info ] [MainThread]: 
[0m22:24:34.209536 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m22:24:34.211792 [info ] [Thread-1 (]: 1 of 7 START sql table model games.dim_developers .............................. [RUN]
[0m22:24:34.214700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m22:24:34.216541 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m22:24:34.224507 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m22:24:34.225202 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 22:24:34.217500 => 22:24:34.224986
[0m22:24:34.225589 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m22:24:34.239278 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:34.979297 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m22:24:34.980068 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m22:24:35.536012 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a23bf3b3-c734-44d3-ab80-7a7ac2654636&page=queryresults
[0m22:24:39.227538 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 22:24:34.225851 => 22:24:39.227226
[0m22:24:39.228669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '709a5781-c723-4ad1-9a8e-875a765bd5ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24ae343dc0>]}
[0m22:24:39.229586 [info ] [Thread-1 (]: 1 of 7 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 5.02s]
[0m22:24:39.230533 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m22:24:39.231138 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m22:24:39.231865 [info ] [Thread-1 (]: 2 of 7 START sql table model games.dim_platforms ............................... [RUN]
[0m22:24:39.232723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m22:24:39.233270 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m22:24:39.236715 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m22:24:39.237454 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 22:24:39.233647 => 22:24:39.237219
[0m22:24:39.237916 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m22:24:39.246589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:40.023871 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m22:24:40.024495 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m22:24:40.543780 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:970886b1-0781-4d17-be1f-0e0157e35490&page=queryresults
[0m22:24:43.886261 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 22:24:39.238246 => 22:24:43.886079
[0m22:24:43.886992 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '709a5781-c723-4ad1-9a8e-875a765bd5ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24ae342f80>]}
[0m22:24:43.887553 [info ] [Thread-1 (]: 2 of 7 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.65s]
[0m22:24:43.888191 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m22:24:43.888621 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m22:24:43.889186 [info ] [Thread-1 (]: 3 of 7 START sql table model games.dim_price_overview .......................... [RUN]
[0m22:24:43.889816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m22:24:43.890198 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m22:24:43.893013 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m22:24:43.893649 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 22:24:43.890462 => 22:24:43.893437
[0m22:24:43.894045 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m22:24:43.896116 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:44.619294 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m22:24:44.620320 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m22:24:45.131913 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:6a54bb43-3c45-4372-ae96-869b65a9a0b6&page=queryresults
[0m22:24:48.788522 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 22:24:43.894312 => 22:24:48.787646
[0m22:24:48.791637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '709a5781-c723-4ad1-9a8e-875a765bd5ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24ae360f40>]}
[0m22:24:48.794213 [info ] [Thread-1 (]: 3 of 7 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (1.1k rows, 114.2 KiB processed)[0m in 4.90s]
[0m22:24:48.797159 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m22:24:48.799229 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m22:24:48.801956 [info ] [Thread-1 (]: 4 of 7 START sql table model games.dim_publishers .............................. [RUN]
[0m22:24:48.804986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m22:24:48.806819 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m22:24:48.819692 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m22:24:48.822571 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 22:24:48.808153 => 22:24:48.821632
[0m22:24:48.824506 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m22:24:48.828359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:49.535658 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m22:24:49.536359 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m22:24:50.118371 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9d5c6d45-3f41-4056-a013-b405c7bc42fc&page=queryresults
[0m22:24:53.240376 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 22:24:48.825710 => 22:24:53.240191
[0m22:24:53.241077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '709a5781-c723-4ad1-9a8e-875a765bd5ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24aea4e110>]}
[0m22:24:53.241617 [info ] [Thread-1 (]: 4 of 7 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.44s]
[0m22:24:53.242194 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m22:24:53.242635 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m22:24:53.243057 [info ] [Thread-1 (]: 5 of 7 START sql table model games.dim_release ................................. [RUN]
[0m22:24:53.243813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m22:24:53.244207 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m22:24:53.253022 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m22:24:53.253747 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 22:24:53.244469 => 22:24:53.253518
[0m22:24:53.254157 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m22:24:53.256544 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:53.977774 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m22:24:53.978454 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m22:24:54.444502 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:4fcb15e9-43bc-4116-858a-62856d4e0568&page=queryresults
[0m22:24:57.220257 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 22:24:53.254430 => 22:24:57.219360
[0m22:24:57.223377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '709a5781-c723-4ad1-9a8e-875a765bd5ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24aec056f0>]}
[0m22:24:57.225964 [info ] [Thread-1 (]: 5 of 7 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 3.98s]
[0m22:24:57.228792 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m22:24:57.230855 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m22:24:57.233759 [info ] [Thread-1 (]: 6 of 7 START sql table model games.dim_support_language ........................ [RUN]
[0m22:24:57.237427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m22:24:57.240001 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m22:24:57.256726 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m22:24:57.259177 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 22:24:57.241917 => 22:24:57.258502
[0m22:24:57.260474 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m22:24:57.265658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:58.007477 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m22:24:58.010206 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m22:24:58.486701 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:0dcf1c0c-8975-4da1-be21-6bec0f5bcbac&page=queryresults
[0m22:25:01.845835 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 22:24:57.261158 => 22:25:01.844946
[0m22:25:01.848995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '709a5781-c723-4ad1-9a8e-875a765bd5ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24aead6140>]}
[0m22:25:01.851592 [info ] [Thread-1 (]: 6 of 7 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.61s]
[0m22:25:01.854417 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m22:25:01.856497 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m22:25:01.858933 [info ] [Thread-1 (]: 7 of 7 START sql table model games.fct_game_pricing ............................ [RUN]
[0m22:25:01.861918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m22:25:01.863884 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m22:25:01.870933 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m22:25:01.871631 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 22:25:01.865219 => 22:25:01.871422
[0m22:25:01.872012 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m22:25:01.874266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:25:02.670417 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m22:25:02.673553 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Calcular el precio promedio de juego vendido
WITH avg_game_price AS (
    SELECT
        app_id,
        AVG(price_with_tax) AS avg_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id
),

-- Encontrar el juego con el precio más alto
max_game_price AS (
    SELECT
        app_id,
        MAX(price_with_tax) AS max_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id
),

-- Encontrar el juego con el precio más bajo
min_game_price AS (
    SELECT
        app_id,
        MIN(price_with_tax) AS min_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id
),

-- Agregar un campo de ingresos totales
total_revenue AS (
    SELECT
        app_id,
        SUM(price_with_tax) AS revenue
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id
),

-- Agregar un campo de descuentos totales
total_discounts AS (
    SELECT
        app_id,
        SUM(discount_amount) AS total_discount
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id
),

-- Calcular ganancias totales
total_gross_profit AS (
    SELECT
        app_id,
        (total_revenue.revenue - total_discounts.total_discount) AS gross_profit
    FROM total_revenue
    JOIN total_discounts ON total_revenue.app_id = total_discounts.app_id
)

-- Combinar todas las medidas en la tabla de hechos
SELECT
    ROW_NUMBER() OVER () AS fct_id,
    avg_game_price.app_id,
    avg_price,
    max_price,
    min_price,
    total_discount,
    gross_profit
FROM
    avg_game_price
    JOIN max_game_price ON avg_game_price.app_id = max_game_price.app_id
    JOIN min_game_price ON avg_game_price.app_id = min_game_price.app_id
    JOIN total_discounts ON avg_game_price.app_id = total_discounts.app_id
    JOIN total_gross_profit ON avg_game_price.app_id = total_gross_profit.app_id;
    );
  
[0m22:25:02.982074 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:74fac76e-b79f-44e0-9eed-825c64726706&page=queryresults
[0m22:25:02.983584 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [83:81]')
[0m22:25:03.545904 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c340e981-d97a-48a8-a4f1-fca00c32f34b&page=queryresults
[0m22:25:03.550183 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c340e981-d97a-48a8-a4f1-fca00c32f34b&page=queryresults
[0m22:25:03.553416 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 22:25:01.872274 => 22:25:03.552415
[0m22:25:03.557953 [debug] [Thread-1 (]: Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Syntax error: Expected ")" but got ";" at [83:81]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m22:25:03.558460 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '709a5781-c723-4ad1-9a8e-875a765bd5ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24b2470ca0>]}
[0m22:25:03.559009 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model games.fct_game_pricing ................... [[31mERROR[0m in 1.70s]
[0m22:25:03.559570 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m22:25:03.561001 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:25:03.561318 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m22:25:03.561655 [info ] [MainThread]: 
[0m22:25:03.561992 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 30.89 seconds (30.89s).
[0m22:25:03.563450 [debug] [MainThread]: Command end result
[0m22:25:03.571741 [info ] [MainThread]: 
[0m22:25:03.572213 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:25:03.572556 [info ] [MainThread]: 
[0m22:25:03.572924 [error] [MainThread]:   Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Syntax error: Expected ")" but got ";" at [83:81]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m22:25:03.573302 [info ] [MainThread]: 
[0m22:25:03.573733 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m22:25:03.574336 [debug] [MainThread]: Command `dbt run` failed at 22:25:03.574242 after 31.37 seconds
[0m22:25:03.574718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24b2c16b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24aec07310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24aec04bb0>]}
[0m22:25:03.575110 [debug] [MainThread]: Flushing usage events
[0m22:25:31.297897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ff1da6560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fefd94070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fefd940d0>]}


============================== 22:25:31.300119 | c621057a-e2a1-4752-b1ab-34af4586afb2 ==============================
[0m22:25:31.300119 [info ] [MainThread]: Running with dbt=1.6.5
[0m22:25:31.300711 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'debug': 'False', 'profiles_dir': '../dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:25:31.580122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c621057a-e2a1-4752-b1ab-34af4586afb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ff159b070>]}
[0m22:25:31.596007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c621057a-e2a1-4752-b1ab-34af4586afb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fedd309a0>]}
[0m22:25:31.596561 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m22:25:31.610091 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m22:25:31.673979 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:25:31.674523 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m22:25:31.717892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c621057a-e2a1-4752-b1ab-34af4586afb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fedbe40d0>]}
[0m22:25:31.726443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c621057a-e2a1-4752-b1ab-34af4586afb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fedb3bd30>]}
[0m22:25:31.726897 [info ] [MainThread]: Found 7 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m22:25:31.727244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c621057a-e2a1-4752-b1ab-34af4586afb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fedb3be20>]}
[0m22:25:31.728585 [info ] [MainThread]: 
[0m22:25:31.729221 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:25:31.730454 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m22:25:31.730859 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:25:32.465459 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m22:25:32.467497 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:25:33.218876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c621057a-e2a1-4752-b1ab-34af4586afb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8feff6bee0>]}
[0m22:25:33.219611 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:25:33.220005 [info ] [MainThread]: 
[0m22:25:33.222176 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m22:25:33.222665 [info ] [Thread-1 (]: 1 of 7 START sql table model games.dim_developers .............................. [RUN]
[0m22:25:33.223283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m22:25:33.223695 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m22:25:33.231203 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m22:25:33.231910 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 22:25:33.223981 => 22:25:33.231681
[0m22:25:33.232326 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m22:25:33.246586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:25:34.024759 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m22:25:34.025566 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m22:25:34.681154 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:03ba8ef1-c615-4853-ba94-7d5348b56e3b&page=queryresults
[0m22:25:38.321708 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 22:25:33.232613 => 22:25:38.321510
[0m22:25:38.322775 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c621057a-e2a1-4752-b1ab-34af4586afb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fed453f10>]}
[0m22:25:38.323437 [info ] [Thread-1 (]: 1 of 7 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 5.10s]
[0m22:25:38.324172 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m22:25:38.324693 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m22:25:38.325374 [info ] [Thread-1 (]: 2 of 7 START sql table model games.dim_platforms ............................... [RUN]
[0m22:25:38.326092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m22:25:38.326501 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m22:25:38.329191 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m22:25:38.329830 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 22:25:38.326777 => 22:25:38.329625
[0m22:25:38.330226 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m22:25:38.337251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:25:39.056091 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m22:25:39.058896 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m22:25:39.528412 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:73ed4e9a-a518-4fc0-8ec3-968bef735096&page=queryresults
[0m22:25:42.608655 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 22:25:38.330502 => 22:25:42.608437
[0m22:25:42.609571 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c621057a-e2a1-4752-b1ab-34af4586afb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fed496bf0>]}
[0m22:25:42.610274 [info ] [Thread-1 (]: 2 of 7 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.28s]
[0m22:25:42.611266 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m22:25:42.611806 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m22:25:42.612414 [info ] [Thread-1 (]: 3 of 7 START sql table model games.dim_price_overview .......................... [RUN]
[0m22:25:42.613129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m22:25:42.613552 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m22:25:42.616638 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m22:25:42.617658 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 22:25:42.613863 => 22:25:42.617400
[0m22:25:42.618149 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m22:25:42.620602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:25:43.326018 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m22:25:43.326786 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m22:25:43.937159 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:dcee2b85-ada4-4e76-9e88-5a6d7a5163db&page=queryresults
[0m22:25:47.950407 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 22:25:42.618504 => 22:25:47.950209
[0m22:25:47.951299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c621057a-e2a1-4752-b1ab-34af4586afb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fed462860>]}
[0m22:25:47.952190 [info ] [Thread-1 (]: 3 of 7 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (1.1k rows, 114.2 KiB processed)[0m in 5.34s]
[0m22:25:47.952958 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m22:25:47.953430 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m22:25:47.954001 [info ] [Thread-1 (]: 4 of 7 START sql table model games.dim_publishers .............................. [RUN]
[0m22:25:47.954845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m22:25:47.955235 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m22:25:47.958242 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m22:25:47.958924 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 22:25:47.955501 => 22:25:47.958716
[0m22:25:47.959312 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m22:25:47.961588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:25:48.661201 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m22:25:48.661908 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m22:25:49.137726 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:6c6fd353-4c1c-46c8-9f6c-1b103a67a821&page=queryresults
[0m22:25:53.196685 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 22:25:47.959634 => 22:25:53.195834
[0m22:25:53.199957 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c621057a-e2a1-4752-b1ab-34af4586afb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fed462dd0>]}
[0m22:25:53.202539 [info ] [Thread-1 (]: 4 of 7 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 5.25s]
[0m22:25:53.205377 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m22:25:53.207416 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m22:25:53.209883 [info ] [Thread-1 (]: 5 of 7 START sql table model games.dim_release ................................. [RUN]
[0m22:25:53.212993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m22:25:53.214832 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m22:25:53.225618 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m22:25:53.227382 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 22:25:53.216192 => 22:25:53.226905
[0m22:25:53.228333 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m22:25:53.242852 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:25:54.041906 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m22:25:54.042528 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m22:25:54.596321 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7b2cdafd-e6b9-418f-b117-1693da537d83&page=queryresults
[0m22:25:57.925198 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 22:25:53.228995 => 22:25:57.925017
[0m22:25:57.925936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c621057a-e2a1-4752-b1ab-34af4586afb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fedd31390>]}
[0m22:25:57.926567 [info ] [Thread-1 (]: 5 of 7 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.71s]
[0m22:25:57.927264 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m22:25:57.927869 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m22:25:57.928466 [info ] [Thread-1 (]: 6 of 7 START sql table model games.dim_support_language ........................ [RUN]
[0m22:25:57.929400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m22:25:57.929916 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m22:25:57.932945 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m22:25:57.933854 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 22:25:57.930299 => 22:25:57.933640
[0m22:25:57.934302 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m22:25:57.936938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:25:58.769229 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m22:25:58.769925 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m22:25:59.255295 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ac431d4b-23a2-4ec2-8c78-138357335cfd&page=queryresults
[0m22:26:02.413829 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 22:25:57.934666 => 22:26:02.413630
[0m22:26:02.414536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c621057a-e2a1-4752-b1ab-34af4586afb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fedba4160>]}
[0m22:26:02.415101 [info ] [Thread-1 (]: 6 of 7 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.49s]
[0m22:26:02.415700 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m22:26:02.416203 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m22:26:02.416876 [info ] [Thread-1 (]: 7 of 7 START sql table model games.fct_game_pricing ............................ [RUN]
[0m22:26:02.417618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m22:26:02.418045 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m22:26:02.421779 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m22:26:02.422934 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 22:26:02.418315 => 22:26:02.422647
[0m22:26:02.423385 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m22:26:02.425778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:26:03.238794 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m22:26:03.239510 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Calcular el precio promedio de juego vendido
WITH avg_game_price AS (
    SELECT
        app_id,
        AVG(price_with_tax) AS avg_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id
),

-- Encontrar el juego con el precio más alto
max_game_price AS (
    SELECT
        app_id,
        MAX(price_with_tax) AS max_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id
),

-- Encontrar el juego con el precio más bajo
min_game_price AS (
    SELECT
        app_id,
        MIN(price_with_tax) AS min_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id
),

-- Agregar un campo de ingresos totales
total_revenue AS (
    SELECT
        app_id,
        SUM(price_with_tax) AS revenue
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id
),

-- Agregar un campo de descuentos totales
total_discounts AS (
    SELECT
        app_id,
        SUM(discount_amount) AS total_discount
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id
),

-- Calcular ganancias totales
total_gross_profit AS (
    SELECT
        app_id,
        (total_revenue.revenue - total_discounts.total_discount) AS gross_profit
    FROM total_revenue
    JOIN total_discounts ON total_revenue.app_id = total_discounts.app_id
)

-- Combinar todas las medidas en la tabla de hechos
SELECT
    ROW_NUMBER() OVER () AS fct_id,
    avg_game_price.app_id,
    avg_price,
    max_price,
    min_price,
    total_discount,
    gross_profit
FROM
    avg_game_price
    JOIN max_game_price ON avg_game_price.app_id = max_game_price.app_id
    JOIN min_game_price ON avg_game_price.app_id = min_game_price.app_id
    JOIN total_discounts ON avg_game_price.app_id = total_discounts.app_id
    JOIN total_gross_profit ON avg_game_price.app_id = total_gross_profit.app_id
    );
  
[0m22:26:03.972381 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:20b87baf-3e66-47f7-bc43-c5f98cd698aa&page=queryresults
[0m22:26:04.515268 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Column name app_id is ambiguous at [63:9]')
[0m22:26:05.261422 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:6e67b8c4-4514-4329-8957-81e57759d49a&page=queryresults
[0m22:26:05.807148 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:6e67b8c4-4514-4329-8957-81e57759d49a&page=queryresults
[0m22:26:05.807890 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 22:26:02.423738 => 22:26:05.807698
[0m22:26:05.810613 [debug] [Thread-1 (]: Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Column name app_id is ambiguous at [63:9]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m22:26:05.811183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c621057a-e2a1-4752-b1ab-34af4586afb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fedd30be0>]}
[0m22:26:05.811826 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model games.fct_game_pricing ................... [[31mERROR[0m in 3.39s]
[0m22:26:05.812455 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m22:26:05.813929 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:26:05.814257 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m22:26:05.814653 [info ] [MainThread]: 
[0m22:26:05.815052 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 34.09 seconds (34.09s).
[0m22:26:05.816645 [debug] [MainThread]: Command end result
[0m22:26:05.830579 [info ] [MainThread]: 
[0m22:26:05.831031 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:26:05.831376 [info ] [MainThread]: 
[0m22:26:05.831725 [error] [MainThread]:   Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Column name app_id is ambiguous at [63:9]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m22:26:05.832073 [info ] [MainThread]: 
[0m22:26:05.832434 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m22:26:05.833008 [debug] [MainThread]: Command `dbt run` failed at 22:26:05.832906 after 34.54 seconds
[0m22:26:05.833397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ff1da6560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fedee7dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fed4dfd00>]}
[0m22:26:05.833791 [debug] [MainThread]: Flushing usage events
[0m22:28:48.199785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7985f21180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7983fc4070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7983fc40d0>]}


============================== 22:28:48.201984 | c4d15d00-2438-458c-b6bc-5d592553af29 ==============================
[0m22:28:48.201984 [info ] [MainThread]: Running with dbt=1.6.5
[0m22:28:48.202460 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:28:48.489576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4d15d00-2438-458c-b6bc-5d592553af29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7981f46c50>]}
[0m22:28:48.506908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4d15d00-2438-458c-b6bc-5d592553af29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7981f607c0>]}
[0m22:28:48.507776 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m22:28:48.523026 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m22:28:48.589651 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:28:48.590225 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m22:28:48.635173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4d15d00-2438-458c-b6bc-5d592553af29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7981dac0d0>]}
[0m22:28:48.644027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4d15d00-2438-458c-b6bc-5d592553af29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7981d6bd30>]}
[0m22:28:48.644493 [info ] [MainThread]: Found 7 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m22:28:48.644842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4d15d00-2438-458c-b6bc-5d592553af29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7981d6be20>]}
[0m22:28:48.646172 [info ] [MainThread]: 
[0m22:28:48.646821 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:28:48.648087 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m22:28:48.648512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:28:49.476489 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m22:28:49.478246 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:28:50.223856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4d15d00-2438-458c-b6bc-5d592553af29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7981d69f90>]}
[0m22:28:50.224836 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:28:50.225293 [info ] [MainThread]: 
[0m22:28:50.227533 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m22:28:50.228389 [info ] [Thread-1 (]: 1 of 7 START sql table model games.dim_developers .............................. [RUN]
[0m22:28:50.229211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m22:28:50.229634 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m22:28:50.237421 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m22:28:50.238207 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 22:28:50.229927 => 22:28:50.237965
[0m22:28:50.238649 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m22:28:50.252177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:28:51.124141 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m22:28:51.124912 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m22:28:51.629247 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:34d24d0c-37dd-4025-a85a-95f879369fc6&page=queryresults
[0m22:28:55.322238 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 22:28:50.238911 => 22:28:55.321923
[0m22:28:55.323369 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4d15d00-2438-458c-b6bc-5d592553af29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f798147bfd0>]}
[0m22:28:55.324308 [info ] [Thread-1 (]: 1 of 7 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 5.09s]
[0m22:28:55.325215 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m22:28:55.325822 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m22:28:55.326544 [info ] [Thread-1 (]: 2 of 7 START sql table model games.dim_platforms ............................... [RUN]
[0m22:28:55.327419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m22:28:55.327994 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m22:28:55.331511 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m22:28:55.332315 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 22:28:55.328374 => 22:28:55.332074
[0m22:28:55.332785 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m22:28:55.340275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:28:56.097590 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m22:28:56.100317 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m22:28:56.736909 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a3c51adc-4354-4157-9c33-4f4766b1a072&page=queryresults
[0m22:29:00.137223 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 22:28:55.333118 => 22:29:00.136331
[0m22:29:00.140546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4d15d00-2438-458c-b6bc-5d592553af29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79814beb90>]}
[0m22:29:00.143283 [info ] [Thread-1 (]: 2 of 7 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.81s]
[0m22:29:00.146417 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m22:29:00.148653 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m22:29:00.150551 [info ] [Thread-1 (]: 3 of 7 START sql table model games.dim_price_overview .......................... [RUN]
[0m22:29:00.152885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m22:29:00.154186 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m22:29:00.161148 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m22:29:00.162403 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 22:29:00.154994 => 22:29:00.161999
[0m22:29:00.163172 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m22:29:00.166885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:00.966405 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m22:29:00.967966 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m22:29:01.534064 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:3fcf89c4-ad07-40a0-a7ba-9fff70aceba6&page=queryresults
[0m22:29:05.496388 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 22:29:00.163715 => 22:29:05.495488
[0m22:29:05.499682 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4d15d00-2438-458c-b6bc-5d592553af29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f798148a080>]}
[0m22:29:05.502254 [info ] [Thread-1 (]: 3 of 7 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (1.1k rows, 114.2 KiB processed)[0m in 5.35s]
[0m22:29:05.505159 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m22:29:05.507216 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m22:29:05.509922 [info ] [Thread-1 (]: 4 of 7 START sql table model games.dim_publishers .............................. [RUN]
[0m22:29:05.513069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m22:29:05.514901 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m22:29:05.529592 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m22:29:05.532797 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 22:29:05.516647 => 22:29:05.531706
[0m22:29:05.534711 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m22:29:05.544929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:06.364481 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m22:29:06.367153 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m22:29:06.965672 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e0b7def1-9ac4-437e-8527-ce2e6a6d3992&page=queryresults
[0m22:29:10.868376 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 22:29:05.536084 => 22:29:10.867456
[0m22:29:10.872096 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4d15d00-2438-458c-b6bc-5d592553af29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f798148ab30>]}
[0m22:29:10.874769 [info ] [Thread-1 (]: 4 of 7 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 5.36s]
[0m22:29:10.877655 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m22:29:10.879739 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m22:29:10.882154 [info ] [Thread-1 (]: 5 of 7 START sql table model games.dim_release ................................. [RUN]
[0m22:29:10.884887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m22:29:10.886165 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m22:29:10.893355 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m22:29:10.894654 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 22:29:10.887068 => 22:29:10.894269
[0m22:29:10.895392 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m22:29:10.909123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:11.690329 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m22:29:11.693035 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m22:29:12.167599 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:96f8d146-f73a-43ae-8fd1-deca44cd215c&page=queryresults
[0m22:29:15.249775 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 22:29:10.895983 => 22:29:15.248900
[0m22:29:15.253434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4d15d00-2438-458c-b6bc-5d592553af29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7981f456c0>]}
[0m22:29:15.256195 [info ] [Thread-1 (]: 5 of 7 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.37s]
[0m22:29:15.259140 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m22:29:15.261207 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m22:29:15.263678 [info ] [Thread-1 (]: 6 of 7 START sql table model games.dim_support_language ........................ [RUN]
[0m22:29:15.266937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m22:29:15.268981 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m22:29:15.279544 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m22:29:15.281169 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 22:29:15.270298 => 22:29:15.280641
[0m22:29:15.282129 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m22:29:15.286616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:16.048941 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m22:29:16.051816 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m22:29:16.634903 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:3fd35292-6f7a-42d8-85cb-3e3d73415954&page=queryresults
[0m22:29:20.328837 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 22:29:15.282802 => 22:29:20.327954
[0m22:29:20.331967 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4d15d00-2438-458c-b6bc-5d592553af29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7981dd6890>]}
[0m22:29:20.334709 [info ] [Thread-1 (]: 6 of 7 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 5.07s]
[0m22:29:20.338200 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m22:29:20.340779 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m22:29:20.343925 [info ] [Thread-1 (]: 7 of 7 START sql table model games.fct_game_pricing ............................ [RUN]
[0m22:29:20.347829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m22:29:20.350193 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m22:29:20.360616 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m22:29:20.361903 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 22:29:20.351541 => 22:29:20.361497
[0m22:29:20.362658 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m22:29:20.366710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:21.126922 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m22:29:21.129967 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Calcular el precio promedio de juego vendido
WITH avg_game_price AS (
    SELECT
        dim_price_overview.app_id,
        AVG(dim_price_overview.price_with_tax) AS avg_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview` AS dim_price_overview
    GROUP BY dim_price_overview.app_id
),

-- Encontrar el juego con el precio más alto
max_game_price AS (
    SELECT
        dim_price_overview.app_id,
        MAX(dim_price_overview.price_with_tax) AS max_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview` AS dim_price_overview
    GROUP BY dim_price_overview.app_id
),

-- Encontrar el juego con el precio más bajo
min_game_price AS (
    SELECT
        dim_price_overview.app_id,
        MIN(dim_price_overview.price_with_tax) AS min_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview` AS dim_price_overview
    GROUP BY dim_price_overview.app_id
),

-- Agregar un campo de ingresos totales
total_revenue AS (
    SELECT
        dim_price_overview.app_id,
        SUM(dim_price_overview.price_with_tax) AS revenue
    FROM `pristine-flames-400818`.`games`.`dim_price_overview` AS dim_price_overview
    GROUP BY dim_price_overview.app_id
),

-- Agregar un campo de descuentos totales
total_discounts AS (
    SELECT
        dim_price_overview.app_id,
        SUM(dim_price_overview.discount_amount) AS total_discount
    FROM `pristine-flames-400818`.`games`.`dim_price_overview` AS dim_price_overview
    GROUP BY dim_price_overview.app_id
),

-- Calcular ganancias totales
total_gross_profit AS (
    SELECT
        dim_price_overview.app_id,
        (total_revenue.revenue - total_discounts.total_discount) AS gross_profit
    FROM total_revenue
    JOIN total_discounts ON total_revenue.app_id = total_discounts.app_id
)

-- Combinar todas las medidas en la tabla de hechos
SELECT
    ROW_NUMBER() OVER () AS fct_id,
    avg_game_price.app_id,
    avg_price,
    max_price,
    min_price,
    total_discount,
    gross_profit
FROM
    avg_game_price
    JOIN max_game_price ON avg_game_price.app_id = max_game_price.app_id
    JOIN min_game_price ON avg_game_price.app_id = min_game_price.app_id
    JOIN total_discounts ON avg_game_price.app_id = total_discounts.app_id
    JOIN total_gross_profit ON avg_game_price.app_id = total_gross_profit.app_id
    );
  
[0m22:29:21.759315 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:bd2dcd0b-6b2c-4342-915a-8ae1fbef2ee7&page=queryresults
[0m22:29:22.298902 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: dim_price_overview at [63:9]')
[0m22:29:22.789352 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:1d5c5392-5e60-45be-834a-d06cd5da22ae&page=queryresults
[0m22:29:23.337778 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:1d5c5392-5e60-45be-834a-d06cd5da22ae&page=queryresults
[0m22:29:23.341539 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 22:29:20.363216 => 22:29:23.340555
[0m22:29:23.355111 [debug] [Thread-1 (]: Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Unrecognized name: dim_price_overview at [63:9]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m22:29:23.357334 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4d15d00-2438-458c-b6bc-5d592553af29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7981f45690>]}
[0m22:29:23.359983 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model games.fct_game_pricing ................... [[31mERROR[0m in 3.01s]
[0m22:29:23.362812 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m22:29:23.367530 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:29:23.368722 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m22:29:23.369657 [info ] [MainThread]: 
[0m22:29:23.370563 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 34.72 seconds (34.72s).
[0m22:29:23.374286 [debug] [MainThread]: Command end result
[0m22:29:23.397485 [info ] [MainThread]: 
[0m22:29:23.398080 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:29:23.398549 [info ] [MainThread]: 
[0m22:29:23.399004 [error] [MainThread]:   Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Unrecognized name: dim_price_overview at [63:9]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m22:29:23.399421 [info ] [MainThread]: 
[0m22:29:23.399864 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m22:29:23.400539 [debug] [MainThread]: Command `dbt run` failed at 22:29:23.400418 after 35.21 seconds
[0m22:29:23.401008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7985f21180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79814e6f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79814e7910>]}
[0m22:29:23.401525 [debug] [MainThread]: Flushing usage events
[0m22:36:00.952514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b98b11180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b96ba4070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b96ba40d0>]}


============================== 22:36:00.954668 | ca2785e6-ca09-418b-92a0-2ec30c4bdca0 ==============================
[0m22:36:00.954668 [info ] [MainThread]: Running with dbt=1.6.5
[0m22:36:00.955133 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'debug': 'False', 'profiles_dir': '../dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:36:01.239302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca2785e6-ca09-418b-92a0-2ec30c4bdca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b94b26c50>]}
[0m22:36:01.255173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca2785e6-ca09-418b-92a0-2ec30c4bdca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b94b40640>]}
[0m22:36:01.255823 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m22:36:01.269218 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m22:36:01.330686 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:36:01.331055 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:36:01.336436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca2785e6-ca09-418b-92a0-2ec30c4bdca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b9498e230>]}
[0m22:36:01.345682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca2785e6-ca09-418b-92a0-2ec30c4bdca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b9496c5b0>]}
[0m22:36:01.346147 [info ] [MainThread]: Found 7 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m22:36:01.346504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca2785e6-ca09-418b-92a0-2ec30c4bdca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b9496e290>]}
[0m22:36:01.347881 [info ] [MainThread]: 
[0m22:36:01.348540 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:36:01.349786 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m22:36:01.350198 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:36:02.198140 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m22:36:02.198703 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:36:02.935527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca2785e6-ca09-418b-92a0-2ec30c4bdca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b9496c9a0>]}
[0m22:36:02.936301 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:36:02.936671 [info ] [MainThread]: 
[0m22:36:02.938725 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m22:36:02.939216 [info ] [Thread-1 (]: 1 of 7 START sql table model games.dim_developers .............................. [RUN]
[0m22:36:02.939885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m22:36:02.940275 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m22:36:02.947621 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m22:36:02.948318 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 22:36:02.940528 => 22:36:02.948100
[0m22:36:02.948741 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m22:36:02.963674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:36:03.730852 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m22:36:03.731669 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m22:36:04.436354 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:88e1013e-166e-47ba-916d-20e5d1e8ae6e&page=queryresults
[0m22:36:08.070724 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 22:36:02.949037 => 22:36:08.070534
[0m22:36:08.071427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca2785e6-ca09-418b-92a0-2ec30c4bdca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b94b26dd0>]}
[0m22:36:08.071993 [info ] [Thread-1 (]: 1 of 7 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 5.13s]
[0m22:36:08.072575 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m22:36:08.072997 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m22:36:08.073422 [info ] [Thread-1 (]: 2 of 7 START sql table model games.dim_platforms ............................... [RUN]
[0m22:36:08.074014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m22:36:08.074385 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m22:36:08.077110 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m22:36:08.077731 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 22:36:08.074727 => 22:36:08.077538
[0m22:36:08.078102 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m22:36:08.084019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:36:08.863129 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m22:36:08.866047 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m22:36:09.469784 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e84d38de-5164-4a32-a519-55813a3a47ca&page=queryresults
[0m22:36:12.883129 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 22:36:08.078362 => 22:36:12.882242
[0m22:36:12.886363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca2785e6-ca09-418b-92a0-2ec30c4bdca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b94882080>]}
[0m22:36:12.888936 [info ] [Thread-1 (]: 2 of 7 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.81s]
[0m22:36:12.891726 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m22:36:12.893734 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m22:36:12.896136 [info ] [Thread-1 (]: 3 of 7 START sql table model games.dim_price_overview .......................... [RUN]
[0m22:36:12.899050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m22:36:12.900904 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m22:36:12.912086 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m22:36:12.913699 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 22:36:12.902196 => 22:36:12.913223
[0m22:36:12.914618 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m22:36:12.919201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:36:13.648838 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m22:36:13.649644 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m22:36:14.296201 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:cd262d6d-30c6-42fe-baef-6672afeed78a&page=queryresults
[0m22:36:17.078395 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 22:36:12.915286 => 22:36:17.077528
[0m22:36:17.081673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca2785e6-ca09-418b-92a0-2ec30c4bdca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b94867e20>]}
[0m22:36:17.084282 [info ] [Thread-1 (]: 3 of 7 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (1.1k rows, 114.2 KiB processed)[0m in 4.18s]
[0m22:36:17.087114 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m22:36:17.089220 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m22:36:17.091906 [info ] [Thread-1 (]: 4 of 7 START sql table model games.dim_publishers .............................. [RUN]
[0m22:36:17.095018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m22:36:17.096876 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m22:36:17.107344 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m22:36:17.108897 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 22:36:17.098174 => 22:36:17.108422
[0m22:36:17.109823 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m22:36:17.114528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:36:17.851869 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m22:36:17.852623 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m22:36:18.450749 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:225b5216-bd2f-4ce2-86e3-891410eda6a8&page=queryresults
[0m22:36:21.510244 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 22:36:17.110483 => 22:36:21.509377
[0m22:36:21.513507 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca2785e6-ca09-418b-92a0-2ec30c4bdca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b9488ffa0>]}
[0m22:36:21.516063 [info ] [Thread-1 (]: 4 of 7 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.42s]
[0m22:36:21.519001 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m22:36:21.521037 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m22:36:21.523442 [info ] [Thread-1 (]: 5 of 7 START sql table model games.dim_release ................................. [RUN]
[0m22:36:21.526575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m22:36:21.528678 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m22:36:21.539245 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m22:36:21.540794 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 22:36:21.530401 => 22:36:21.540316
[0m22:36:21.541715 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m22:36:21.554231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:36:22.276629 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m22:36:22.279308 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m22:36:22.897299 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:0e40b31a-ca20-48a7-a6ed-25ffeb253f19&page=queryresults
[0m22:36:26.243652 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 22:36:21.542370 => 22:36:26.243019
[0m22:36:26.245833 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca2785e6-ca09-418b-92a0-2ec30c4bdca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b94820880>]}
[0m22:36:26.247638 [info ] [Thread-1 (]: 5 of 7 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.72s]
[0m22:36:26.249561 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m22:36:26.250979 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m22:36:26.252670 [info ] [Thread-1 (]: 6 of 7 START sql table model games.dim_support_language ........................ [RUN]
[0m22:36:26.254217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m22:36:26.255166 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m22:36:26.261021 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m22:36:26.262206 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 22:36:26.255857 => 22:36:26.261822
[0m22:36:26.262896 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m22:36:26.266252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:36:27.012560 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m22:36:27.015239 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m22:36:27.604527 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:bdec1a61-e998-4418-8996-b68f25d0eae4&page=queryresults
[0m22:36:30.382998 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 22:36:26.263334 => 22:36:30.382790
[0m22:36:30.383843 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca2785e6-ca09-418b-92a0-2ec30c4bdca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b94b247f0>]}
[0m22:36:30.384544 [info ] [Thread-1 (]: 6 of 7 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.13s]
[0m22:36:30.385185 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m22:36:30.385628 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m22:36:30.386072 [info ] [Thread-1 (]: 7 of 7 START sql table model games.fct_game_pricing ............................ [RUN]
[0m22:36:30.386828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m22:36:30.387209 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m22:36:30.390885 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m22:36:30.391516 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 22:36:30.387477 => 22:36:30.391323
[0m22:36:30.391900 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m22:36:30.394905 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m22:36:30.395617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:36:30.428041 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Calcular el precio promedio de juego vendido
WITH avg_game_price AS (
    SELECT
        dim_price_overview.app_id,
        AVG(dim_price_overview.price_with_tax) AS avg_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview` AS dim_price_overview
    GROUP BY dim_price_overview.app_id
),

-- Encontrar el juego con el precio más alto
max_game_price AS (
    SELECT
        dim_price_overview.app_id,
        MAX(dim_price_overview.price_with_tax) AS max_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview` AS dim_price_overview
    GROUP BY dim_price_overview.app_id
),

-- Encontrar el juego con el precio más bajo
min_game_price AS (
    SELECT
        dim_price_overview.app_id,
        MIN(dim_price_overview.price_with_tax) AS min_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview` AS dim_price_overview
    GROUP BY dim_price_overview.app_id
),

-- Agregar un campo de ingresos totales
total_revenue AS (
    SELECT
        dim_price_overview.app_id,
        SUM(dim_price_overview.price_with_tax) AS revenue
    FROM `pristine-flames-400818`.`games`.`dim_price_overview` AS dim_price_overview
    GROUP BY dim_price_overview.app_id
),

-- Agregar un campo de descuentos totales
total_discounts AS (
    SELECT
        dim_price_overview.app_id,
        SUM(dim_price_overview.discount_amount) AS total_discount
    FROM `pristine-flames-400818`.`games`.`dim_price_overview` AS dim_price_overview
    GROUP BY dim_price_overview.app_id
),

-- Calcular ganancias totales
total_gross_profit AS (
    SELECT
        dim_price_overview.app_id,
        (total_revenue.revenue - total_discounts.total_discount) AS gross_profit
    FROM total_revenue
    JOIN total_discounts ON total_revenue.app_id = total_discounts.app_id
)

-- Combinar todas las medidas en la tabla de hechos
SELECT
    ROW_NUMBER() OVER () AS fct_id,
    avg_game_price.app_id,
    avg_price,
    max_price,
    min_price,
    total_discount,
    gross_profit
FROM
    avg_game_price
    JOIN max_game_price ON avg_game_price.app_id = max_game_price.app_id
    JOIN min_game_price ON avg_game_price.app_id = min_game_price.app_id
    JOIN total_discounts ON avg_game_price.app_id = total_discounts.app_id
    JOIN total_gross_profit ON avg_game_price.app_id = total_gross_profit.app_id
    );
  
[0m22:36:31.315357 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:505960a4-1b16-481e-bd14-cb4c48cdb5d6&page=queryresults
[0m22:36:31.809632 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: dim_price_overview at [63:9]')
[0m22:36:33.024234 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f4f4fc27-c6e3-4401-84f5-096c20fddc63&page=queryresults
[0m22:36:33.551435 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f4f4fc27-c6e3-4401-84f5-096c20fddc63&page=queryresults
[0m22:36:33.554883 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 22:36:30.392163 => 22:36:33.553575
[0m22:36:33.568890 [debug] [Thread-1 (]: Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Unrecognized name: dim_price_overview at [63:9]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m22:36:33.570824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca2785e6-ca09-418b-92a0-2ec30c4bdca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b94b27d30>]}
[0m22:36:33.573773 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model games.fct_game_pricing ................... [[31mERROR[0m in 3.18s]
[0m22:36:33.575811 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m22:36:33.580151 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:36:33.581076 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m22:36:33.582073 [info ] [MainThread]: 
[0m22:36:33.583161 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 32.23 seconds (32.23s).
[0m22:36:33.587149 [debug] [MainThread]: Command end result
[0m22:36:33.615289 [info ] [MainThread]: 
[0m22:36:33.615791 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:36:33.616148 [info ] [MainThread]: 
[0m22:36:33.616495 [error] [MainThread]:   Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Unrecognized name: dim_price_overview at [63:9]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m22:36:33.616852 [info ] [MainThread]: 
[0m22:36:33.617217 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m22:36:33.617801 [debug] [MainThread]: Command `dbt run` failed at 22:36:33.617705 after 32.67 seconds
[0m22:36:33.618181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b98b11180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b9496de40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b9496e230>]}
[0m22:36:33.618569 [debug] [MainThread]: Flushing usage events
[0m22:40:05.073101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe62ee091b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe62ce9c070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe62ce9c0d0>]}


============================== 22:40:05.075152 | 91b60ae9-9f4d-4123-a33d-82029ceb9fd5 ==============================
[0m22:40:05.075152 [info ] [MainThread]: Running with dbt=1.6.5
[0m22:40:05.075646 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:40:05.360869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91b60ae9-9f4d-4123-a33d-82029ceb9fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe62e3d4e50>]}
[0m22:40:05.376590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91b60ae9-9f4d-4123-a33d-82029ceb9fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe62ae3c9d0>]}
[0m22:40:05.377162 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m22:40:05.390841 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m22:40:05.455082 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:40:05.455458 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:40:05.460882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91b60ae9-9f4d-4123-a33d-82029ceb9fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe62ac861a0>]}
[0m22:40:05.469871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91b60ae9-9f4d-4123-a33d-82029ceb9fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe62ac68520>]}
[0m22:40:05.470323 [info ] [MainThread]: Found 7 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m22:40:05.470671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91b60ae9-9f4d-4123-a33d-82029ceb9fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe62ac6a200>]}
[0m22:40:05.472023 [info ] [MainThread]: 
[0m22:40:05.472675 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:40:05.473914 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m22:40:05.474256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:40:06.278587 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m22:40:06.279368 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:40:07.025375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91b60ae9-9f4d-4123-a33d-82029ceb9fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe62ac68880>]}
[0m22:40:07.026090 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:40:07.026460 [info ] [MainThread]: 
[0m22:40:07.028475 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m22:40:07.028970 [info ] [Thread-1 (]: 1 of 7 START sql table model games.dim_developers .............................. [RUN]
[0m22:40:07.029604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m22:40:07.029980 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m22:40:07.037281 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m22:40:07.037953 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 22:40:07.030245 => 22:40:07.037752
[0m22:40:07.038337 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m22:40:07.050868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:40:07.840863 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m22:40:07.841671 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m22:40:08.426153 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:1477e98c-d861-4b8a-82d8-60df2545fa08&page=queryresults
[0m22:40:11.938695 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 22:40:07.038638 => 22:40:11.938505
[0m22:40:11.939489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91b60ae9-9f4d-4123-a33d-82029ceb9fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe62ae3ea40>]}
[0m22:40:11.940162 [info ] [Thread-1 (]: 1 of 7 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.91s]
[0m22:40:11.940800 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m22:40:11.941272 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m22:40:11.941807 [info ] [Thread-1 (]: 2 of 7 START sql table model games.dim_platforms ............................... [RUN]
[0m22:40:11.942517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m22:40:11.942900 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m22:40:11.945661 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m22:40:11.946353 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 22:40:11.943177 => 22:40:11.946124
[0m22:40:11.946747 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m22:40:11.953981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:40:12.677669 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m22:40:12.678403 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m22:40:13.207607 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:bab94789-1265-4dc5-8084-e4759a8a2153&page=queryresults
[0m22:40:16.254714 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 22:40:11.947003 => 22:40:16.253845
[0m22:40:16.257818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91b60ae9-9f4d-4123-a33d-82029ceb9fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe62ab6e260>]}
[0m22:40:16.260418 [info ] [Thread-1 (]: 2 of 7 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.32s]
[0m22:40:16.263194 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m22:40:16.265319 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m22:40:16.267680 [info ] [Thread-1 (]: 3 of 7 START sql table model games.dim_price_overview .......................... [RUN]
[0m22:40:16.270651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m22:40:16.272528 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m22:40:16.284171 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m22:40:16.285958 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 22:40:16.273825 => 22:40:16.285476
[0m22:40:16.286905 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m22:40:16.291876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:40:17.010723 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m22:40:17.011439 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m22:40:17.673333 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:6af1b71c-03b7-44e6-b53a-71d7475bfe02&page=queryresults
[0m22:40:21.034446 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 22:40:16.287589 => 22:40:21.033539
[0m22:40:21.037818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91b60ae9-9f4d-4123-a33d-82029ceb9fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe62ab62c50>]}
[0m22:40:21.040442 [info ] [Thread-1 (]: 3 of 7 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (1.1k rows, 114.2 KiB processed)[0m in 4.77s]
[0m22:40:21.043257 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m22:40:21.045807 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m22:40:21.048603 [info ] [Thread-1 (]: 4 of 7 START sql table model games.dim_publishers .............................. [RUN]
[0m22:40:21.051860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m22:40:21.053993 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m22:40:21.064980 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m22:40:21.066588 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 22:40:21.055377 => 22:40:21.066105
[0m22:40:21.067512 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m22:40:21.072720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:40:21.845532 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m22:40:21.848310 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m22:40:22.348879 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:82305917-32c8-4938-9a1e-712111f7e050&page=queryresults
[0m22:40:25.799864 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 22:40:21.068193 => 22:40:25.798962
[0m22:40:25.803196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91b60ae9-9f4d-4123-a33d-82029ceb9fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe62ab62350>]}
[0m22:40:25.805884 [info ] [Thread-1 (]: 4 of 7 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.75s]
[0m22:40:25.808776 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m22:40:25.810843 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m22:40:25.813298 [info ] [Thread-1 (]: 5 of 7 START sql table model games.dim_release ................................. [RUN]
[0m22:40:25.816450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m22:40:25.818278 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m22:40:25.828569 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m22:40:25.830095 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 22:40:25.819607 => 22:40:25.829613
[0m22:40:25.831009 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m22:40:25.845946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:40:26.564565 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m22:40:26.567260 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m22:40:27.071465 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d56238fc-50cb-4421-9e67-3e517ef706bc&page=queryresults
[0m22:40:30.152816 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 22:40:25.831681 => 22:40:30.152630
[0m22:40:30.153570 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91b60ae9-9f4d-4123-a33d-82029ceb9fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe62ae3da50>]}
[0m22:40:30.154171 [info ] [Thread-1 (]: 5 of 7 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.34s]
[0m22:40:30.154801 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m22:40:30.155254 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m22:40:30.155809 [info ] [Thread-1 (]: 6 of 7 START sql table model games.dim_support_language ........................ [RUN]
[0m22:40:30.156467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m22:40:30.156880 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m22:40:30.159911 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m22:40:30.160655 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 22:40:30.157165 => 22:40:30.160425
[0m22:40:30.161068 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m22:40:30.163379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:40:30.955582 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m22:40:30.956322 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m22:40:31.536365 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:bc3c9a7a-11e1-414b-bb27-e29feb7e9f0a&page=queryresults
[0m22:40:34.586167 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 22:40:30.161349 => 22:40:34.585205
[0m22:40:34.589632 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91b60ae9-9f4d-4123-a33d-82029ceb9fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe62ae4abf0>]}
[0m22:40:34.592913 [info ] [Thread-1 (]: 6 of 7 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.43s]
[0m22:40:34.596687 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m22:40:34.598923 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m22:40:34.601657 [info ] [Thread-1 (]: 7 of 7 START sql table model games.fct_game_pricing ............................ [RUN]
[0m22:40:34.605139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m22:40:34.607959 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m22:40:34.618954 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m22:40:34.620291 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 22:40:34.609334 => 22:40:34.619873
[0m22:40:34.621127 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m22:40:34.626562 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m22:40:34.627655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:40:34.664172 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Calcular el precio promedio de juego vendido
WITH avg_game_price AS (
    SELECT
        dim_price_overview.app_id,
        AVG(dim_price_overview.price_with_tax) AS avg_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview` AS dim_price_overview
    GROUP BY dim_price_overview.app_id
),

-- Encontrar el juego con el precio más alto
max_game_price AS (
    SELECT
        dim_price_overview.app_id,
        MAX(dim_price_overview.price_with_tax) AS max_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview` AS dim_price_overview
    GROUP BY dim_price_overview.app_id
),

-- Encontrar el juego con el precio más bajo
min_game_price AS (
    SELECT
        dim_price_overview.app_id,
        MIN(dim_price_overview.price_with_tax) AS min_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview` AS dim_price_overview
    GROUP BY dim_price_overview.app_id
),

-- Agregar un campo de ingresos totales
total_revenue AS (
    SELECT
        dim_price_overview.app_id,
        SUM(dim_price_overview.price_with_tax) AS revenue
    FROM `pristine-flames-400818`.`games`.`dim_price_overview` AS dim_price_overview
    GROUP BY dim_price_overview.app_id
),

-- Agregar un campo de descuentos totales
total_discounts AS (
    SELECT
        dim_price_overview.app_id,
        SUM(dim_price_overview.discount_amount) AS total_discount
    FROM `pristine-flames-400818`.`games`.`dim_price_overview` AS dim_price_overview
    GROUP BY dim_price_overview.app_id
),

-- Calcular ganancias totales
total_gross_profit AS (
    SELECT
        dim_price_overview.app_id,
        (total_revenue.revenue - total_discounts.total_discount) AS gross_profit
    FROM total_revenue
    JOIN total_discounts ON total_revenue.app_id = total_discounts.app_id
)

-- Combinar todas las medidas en la tabla de hechos
SELECT
    ROW_NUMBER() OVER () AS fct_id,
    avg_game_price.app_id,
    avg_price,
    max_price,
    min_price,
    total_discount,
    gross_profit
FROM
    avg_game_price
    JOIN max_game_price ON avg_game_price.app_id = max_game_price.app_id
    JOIN min_game_price ON avg_game_price.app_id = min_game_price.app_id
    JOIN total_discounts ON avg_game_price.app_id = total_discounts.app_id
    JOIN total_gross_profit ON avg_game_price.app_id = total_gross_profit.app_id
    );
  
[0m22:40:35.672988 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:74608ec8-acce-4356-a01c-2dbbdf680892&page=queryresults
[0m22:40:36.177309 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: dim_price_overview at [63:9]')
[0m22:40:37.626147 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7470f48f-41bd-40bd-a15f-cdbf6cc4376a&page=queryresults
[0m22:40:38.160385 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7470f48f-41bd-40bd-a15f-cdbf6cc4376a&page=queryresults
[0m22:40:38.161065 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 22:40:34.621729 => 22:40:38.160873
[0m22:40:38.163902 [debug] [Thread-1 (]: Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Unrecognized name: dim_price_overview at [63:9]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m22:40:38.164374 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91b60ae9-9f4d-4123-a33d-82029ceb9fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe62ae3e110>]}
[0m22:40:38.164936 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model games.fct_game_pricing ................... [[31mERROR[0m in 3.56s]
[0m22:40:38.165537 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m22:40:38.167124 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:40:38.167451 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m22:40:38.167855 [info ] [MainThread]: 
[0m22:40:38.168241 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 32.70 seconds (32.70s).
[0m22:40:38.169695 [debug] [MainThread]: Command end result
[0m22:40:38.184065 [info ] [MainThread]: 
[0m22:40:38.184484 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:40:38.184805 [info ] [MainThread]: 
[0m22:40:38.185117 [error] [MainThread]:   Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Unrecognized name: dim_price_overview at [63:9]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m22:40:38.185434 [info ] [MainThread]: 
[0m22:40:38.185764 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m22:40:38.186313 [debug] [MainThread]: Command `dbt run` failed at 22:40:38.186219 after 33.12 seconds
[0m22:40:38.186692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe62ee091b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe62ac68220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe62ac68100>]}
[0m22:40:38.187078 [debug] [MainThread]: Flushing usage events
[0m22:42:21.196634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe54962ab00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe547688070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5476880d0>]}


============================== 22:42:21.198790 | 4e76dcd0-0526-4cf6-b294-14b62923dd81 ==============================
[0m22:42:21.198790 [info ] [MainThread]: Running with dbt=1.6.5
[0m22:42:21.199283 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'send_anonymous_usage_stats': 'True'}
[0m22:42:21.483612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e76dcd0-0526-4cf6-b294-14b62923dd81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe548bd47c0>]}
[0m22:42:21.500236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e76dcd0-0526-4cf6-b294-14b62923dd81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5456289d0>]}
[0m22:42:21.500960 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m22:42:21.515303 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m22:42:21.582673 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:42:21.583295 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m22:42:21.628155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e76dcd0-0526-4cf6-b294-14b62923dd81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5454e00d0>]}
[0m22:42:21.636884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e76dcd0-0526-4cf6-b294-14b62923dd81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe545437df0>]}
[0m22:42:21.637354 [info ] [MainThread]: Found 7 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m22:42:21.637707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e76dcd0-0526-4cf6-b294-14b62923dd81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe545437d60>]}
[0m22:42:21.639066 [info ] [MainThread]: 
[0m22:42:21.639764 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:42:21.641062 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m22:42:21.641496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:42:22.528898 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m22:42:22.530950 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:42:23.284548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e76dcd0-0526-4cf6-b294-14b62923dd81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5478580a0>]}
[0m22:42:23.288235 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:42:23.289997 [info ] [MainThread]: 
[0m22:42:23.298173 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m22:42:23.300467 [info ] [Thread-1 (]: 1 of 7 START sql table model games.dim_developers .............................. [RUN]
[0m22:42:23.303376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m22:42:23.305215 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m22:42:23.332057 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m22:42:23.333384 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 22:42:23.306506 => 22:42:23.332958
[0m22:42:23.334195 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m22:42:23.354567 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:42:24.167098 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m22:42:24.167846 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m22:42:24.652615 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f7ea071a-2d0f-486d-b0d9-28833a81bd00&page=queryresults
[0m22:42:27.743601 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 22:42:23.334734 => 22:42:27.743393
[0m22:42:27.744332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e76dcd0-0526-4cf6-b294-14b62923dd81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe54560d720>]}
[0m22:42:27.744898 [info ] [Thread-1 (]: 1 of 7 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.44s]
[0m22:42:27.745520 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m22:42:27.745982 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m22:42:27.746543 [info ] [Thread-1 (]: 2 of 7 START sql table model games.dim_platforms ............................... [RUN]
[0m22:42:27.747178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m22:42:27.747569 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m22:42:27.750133 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m22:42:27.750781 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 22:42:27.747864 => 22:42:27.750558
[0m22:42:27.751163 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m22:42:27.757085 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:42:28.512871 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m22:42:28.515539 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m22:42:28.984863 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:bf35a79e-b581-4a9b-b745-86ef32669c4a&page=queryresults
[0m22:42:32.368225 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 22:42:27.751428 => 22:42:32.368042
[0m22:42:32.368912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e76dcd0-0526-4cf6-b294-14b62923dd81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe548e6cca0>]}
[0m22:42:32.369452 [info ] [Thread-1 (]: 2 of 7 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.62s]
[0m22:42:32.370061 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m22:42:32.370488 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m22:42:32.370923 [info ] [Thread-1 (]: 3 of 7 START sql table model games.dim_price_overview .......................... [RUN]
[0m22:42:32.371676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m22:42:32.372053 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m22:42:32.374992 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m22:42:32.375625 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 22:42:32.372337 => 22:42:32.375420
[0m22:42:32.376001 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m22:42:32.378124 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:42:33.092586 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m22:42:33.093342 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m22:42:33.740702 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f7f0bad7-332b-47c9-a260-deabf3a66b4f&page=queryresults
[0m22:42:36.811077 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 22:42:32.376267 => 22:42:36.810201
[0m22:42:36.814405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e76dcd0-0526-4cf6-b294-14b62923dd81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe544d5a890>]}
[0m22:42:36.817024 [info ] [Thread-1 (]: 3 of 7 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (1.1k rows, 114.2 KiB processed)[0m in 4.44s]
[0m22:42:36.819877 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m22:42:36.821924 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m22:42:36.824313 [info ] [Thread-1 (]: 4 of 7 START sql table model games.dim_publishers .............................. [RUN]
[0m22:42:36.827755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m22:42:36.829664 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m22:42:36.833830 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m22:42:36.834462 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 22:42:36.830975 => 22:42:36.834270
[0m22:42:36.834869 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m22:42:36.837386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:42:37.581226 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m22:42:37.583964 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m22:42:38.212772 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7b400d9e-11b3-4934-a7e4-fb381335c47b&page=queryresults
[0m22:42:41.849422 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 22:42:36.835137 => 22:42:41.848962
[0m22:42:41.850759 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e76dcd0-0526-4cf6-b294-14b62923dd81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe544d59990>]}
[0m22:42:41.851656 [info ] [Thread-1 (]: 4 of 7 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 5.02s]
[0m22:42:41.852518 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m22:42:41.853130 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m22:42:41.853852 [info ] [Thread-1 (]: 5 of 7 START sql table model games.dim_release ................................. [RUN]
[0m22:42:41.854804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m22:42:41.855347 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m22:42:41.858665 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m22:42:41.859407 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 22:42:41.855689 => 22:42:41.859169
[0m22:42:41.859873 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m22:42:41.869418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:42:42.610520 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m22:42:42.611229 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m22:42:43.203677 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f549445d-15cf-43d2-a8c5-571d37d6e497&page=queryresults
[0m22:42:46.237580 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 22:42:41.860200 => 22:42:46.237367
[0m22:42:46.238389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e76dcd0-0526-4cf6-b294-14b62923dd81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe54560c460>]}
[0m22:42:46.239050 [info ] [Thread-1 (]: 5 of 7 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.38s]
[0m22:42:46.239692 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m22:42:46.240151 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m22:42:46.240674 [info ] [Thread-1 (]: 6 of 7 START sql table model games.dim_support_language ........................ [RUN]
[0m22:42:46.241391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m22:42:46.241823 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m22:42:46.244999 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m22:42:46.245750 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 22:42:46.242121 => 22:42:46.245531
[0m22:42:46.246166 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m22:42:46.248368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:42:47.033778 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m22:42:47.055757 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m22:42:47.525305 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:6f09d1b0-1a2e-4943-8a66-2904ded890c3&page=queryresults
[0m22:42:51.175609 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 22:42:46.246436 => 22:42:51.175388
[0m22:42:51.176423 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e76dcd0-0526-4cf6-b294-14b62923dd81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5454992d0>]}
[0m22:42:51.177052 [info ] [Thread-1 (]: 6 of 7 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.94s]
[0m22:42:51.178606 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m22:42:51.179052 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m22:42:51.179573 [info ] [Thread-1 (]: 7 of 7 START sql table model games.fct_game_pricing ............................ [RUN]
[0m22:42:51.180238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m22:42:51.180612 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m22:42:51.184551 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m22:42:51.185630 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 22:42:51.180877 => 22:42:51.185323
[0m22:42:51.186197 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m22:42:51.189754 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m22:42:51.190455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:42:51.223977 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Calcular el precio promedio de juego vendido
WITH avg_game_price AS (
    SELECT
        dim_price_overview.app_id,
        AVG(dim_price_overview.price_with_tax) AS avg_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview` AS dim_price_overview
    GROUP BY dim_price_overview.app_id
),

-- Encontrar el juego con el precio más alto
max_game_price AS (
    SELECT
        dim_price_overview.app_id,
        MAX(dim_price_overview.price_with_tax) AS max_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview` AS dim_price_overview
    GROUP BY dim_price_overview.app_id
),

-- Encontrar el juego con el precio más bajo
min_game_price AS (
    SELECT
        dim_price_overview.app_id,
        MIN(dim_price_overview.price_with_tax) AS min_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview` AS dim_price_overview
    GROUP BY dim_price_overview.app_id
),

-- Agregar un campo de ingresos totales
total_revenue AS (
    SELECT
        dim_price_overview.app_id,
        SUM(dim_price_overview.price_with_tax) AS revenue
    FROM `pristine-flames-400818`.`games`.`dim_price_overview` AS dim_price_overview
    GROUP BY dim_price_overview.app_id
),

-- Agregar un campo de descuentos totales
total_discounts AS (
    SELECT
        dim_price_overview.app_id,
        SUM(dim_price_overview.discount_amount) AS total_discount
    FROM `pristine-flames-400818`.`games`.`dim_price_overview` AS dim_price_overview
    GROUP BY dim_price_overview.app_id
),

-- Calcular ganancias totales
total_gross_profit AS (
    SELECT
        dim_price_overview.app_id,
        (total_revenue.revenue - total_discounts.total_discount) AS gross_profit
    FROM total_revenue
    JOIN total_discounts ON total_revenue.app_id = total_discounts.app_id
)

-- Combinar todas las medidas en la tabla de hechos
SELECT
    ROW_NUMBER() OVER () AS fct_id,
    avg_game_price.app_id,
    avg_price,
    max_price,
    min_price,
    total_discount,
    gross_profit
FROM
    avg_game_price
    JOIN max_game_price ON avg_game_price.app_id = max_game_price.app_id
    JOIN min_game_price ON avg_game_price.app_id = min_game_price.app_id
    JOIN total_discounts ON avg_game_price.app_id = total_discounts.app_id
    JOIN total_gross_profit ON avg_game_price.app_id = total_gross_profit.app_id
    );
  
[0m22:42:52.087157 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:bba5f22f-8f86-48d5-86ed-e0c3e71b0a20&page=queryresults
[0m22:42:52.672556 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: dim_price_overview at [63:9]')
[0m22:42:53.243986 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:05be749a-1830-424e-8cd1-f2a15fdcd70b&page=queryresults
[0m22:42:53.786541 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:05be749a-1830-424e-8cd1-f2a15fdcd70b&page=queryresults
[0m22:42:53.787380 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 22:42:51.186639 => 22:42:53.787119
[0m22:42:53.791948 [debug] [Thread-1 (]: Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Unrecognized name: dim_price_overview at [63:9]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m22:42:53.792719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e76dcd0-0526-4cf6-b294-14b62923dd81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe54560f010>]}
[0m22:42:53.793489 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model games.fct_game_pricing ................... [[31mERROR[0m in 2.61s]
[0m22:42:53.794379 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m22:42:53.795875 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:42:53.796261 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m22:42:53.796641 [info ] [MainThread]: 
[0m22:42:53.797724 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 32.16 seconds (32.16s).
[0m22:42:53.799583 [debug] [MainThread]: Command end result
[0m22:42:53.819279 [info ] [MainThread]: 
[0m22:42:53.819991 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:42:53.820708 [info ] [MainThread]: 
[0m22:42:53.821223 [error] [MainThread]:   Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Unrecognized name: dim_price_overview at [63:9]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m22:42:53.821797 [info ] [MainThread]: 
[0m22:42:53.822339 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m22:42:53.823144 [debug] [MainThread]: Command `dbt run` failed at 22:42:53.823025 after 32.63 seconds
[0m22:42:53.823666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe54962ab00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe548dc07f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe54785bb20>]}
[0m22:42:53.824171 [debug] [MainThread]: Flushing usage events
[0m22:46:20.431361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab255135b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab236b0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab236b00d0>]}


============================== 22:46:20.433671 | abd99f10-a11b-4c2f-952d-a7926fbdabce ==============================
[0m22:46:20.433671 [info ] [MainThread]: Running with dbt=1.6.5
[0m22:46:20.434181 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:46:20.726250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'abd99f10-a11b-4c2f-952d-a7926fbdabce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab21636bc0>]}
[0m22:46:20.742388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'abd99f10-a11b-4c2f-952d-a7926fbdabce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab21650730>]}
[0m22:46:20.743046 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m22:46:20.757121 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m22:46:20.819744 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:46:20.820302 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m22:46:20.864225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'abd99f10-a11b-4c2f-952d-a7926fbdabce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab214900d0>]}
[0m22:46:20.873495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'abd99f10-a11b-4c2f-952d-a7926fbdabce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab2145bdf0>]}
[0m22:46:20.873961 [info ] [MainThread]: Found 7 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m22:46:20.874309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abd99f10-a11b-4c2f-952d-a7926fbdabce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab2145bd60>]}
[0m22:46:20.875674 [info ] [MainThread]: 
[0m22:46:20.876329 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:46:20.877578 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m22:46:20.878006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:21.775364 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m22:46:21.777476 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:46:22.524519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abd99f10-a11b-4c2f-952d-a7926fbdabce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab21459f90>]}
[0m22:46:22.525354 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:46:22.525773 [info ] [MainThread]: 
[0m22:46:22.527908 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m22:46:22.528486 [info ] [Thread-1 (]: 1 of 7 START sql table model games.dim_developers .............................. [RUN]
[0m22:46:22.529204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m22:46:22.529629 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m22:46:22.537692 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m22:46:22.538459 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 22:46:22.529941 => 22:46:22.538215
[0m22:46:22.538898 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m22:46:22.553237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:46:23.371146 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m22:46:23.371860 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m22:46:23.864294 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:1d1d21c7-53fb-48e1-8b01-36d9bc5dde0b&page=queryresults
[0m22:46:26.963667 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 22:46:22.539188 => 22:46:26.963469
[0m22:46:26.964360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abd99f10-a11b-4c2f-952d-a7926fbdabce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab20b6beb0>]}
[0m22:46:26.964910 [info ] [Thread-1 (]: 1 of 7 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.44s]
[0m22:46:26.965485 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m22:46:26.965902 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m22:46:26.966320 [info ] [Thread-1 (]: 2 of 7 START sql table model games.dim_platforms ............................... [RUN]
[0m22:46:26.966901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m22:46:26.967382 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m22:46:26.969995 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m22:46:26.970589 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 22:46:26.967663 => 22:46:26.970404
[0m22:46:26.971019 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m22:46:26.976828 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:46:27.698676 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m22:46:27.699371 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m22:46:28.278210 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:6be18176-d5c0-49d1-9b84-bef14a5e7a4c&page=queryresults
[0m22:46:31.599723 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 22:46:26.971277 => 22:46:31.598826
[0m22:46:31.602803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abd99f10-a11b-4c2f-952d-a7926fbdabce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab20badf90>]}
[0m22:46:31.605423 [info ] [Thread-1 (]: 2 of 7 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.64s]
[0m22:46:31.608276 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m22:46:31.610366 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m22:46:31.612830 [info ] [Thread-1 (]: 3 of 7 START sql table model games.dim_price_overview .......................... [RUN]
[0m22:46:31.615839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m22:46:31.617672 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m22:46:31.628401 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m22:46:31.629898 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 22:46:31.618969 => 22:46:31.629393
[0m22:46:31.630815 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m22:46:31.635264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:46:32.418873 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m22:46:32.421329 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m22:46:32.855776 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:3dbbd1d1-d59d-4a7e-9c4a-02bceb43975e&page=queryresults
[0m22:46:36.510037 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 22:46:31.631471 => 22:46:36.509817
[0m22:46:36.510955 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abd99f10-a11b-4c2f-952d-a7926fbdabce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab20b7e830>]}
[0m22:46:36.511651 [info ] [Thread-1 (]: 3 of 7 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (1.1k rows, 114.2 KiB processed)[0m in 4.90s]
[0m22:46:36.512401 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m22:46:36.512891 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m22:46:36.513525 [info ] [Thread-1 (]: 4 of 7 START sql table model games.dim_publishers .............................. [RUN]
[0m22:46:36.514264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m22:46:36.514651 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m22:46:36.517500 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m22:46:36.518126 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 22:46:36.514920 => 22:46:36.517928
[0m22:46:36.518502 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m22:46:36.520657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:46:37.232991 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m22:46:37.235912 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m22:46:37.784263 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7a0188ad-e86a-4e88-a1e2-b6933ca93e73&page=queryresults
[0m22:46:41.143526 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 22:46:36.518767 => 22:46:41.142644
[0m22:46:41.146855 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abd99f10-a11b-4c2f-952d-a7926fbdabce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab20b7ef50>]}
[0m22:46:41.149494 [info ] [Thread-1 (]: 4 of 7 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.63s]
[0m22:46:41.151654 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m22:46:41.153113 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m22:46:41.154889 [info ] [Thread-1 (]: 5 of 7 START sql table model games.dim_release ................................. [RUN]
[0m22:46:41.156656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m22:46:41.157627 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m22:46:41.164121 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m22:46:41.165633 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 22:46:41.158298 => 22:46:41.165142
[0m22:46:41.166571 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m22:46:41.181059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:46:41.914013 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m22:46:41.914794 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m22:46:42.500808 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:baa78552-647d-4fdc-9d81-a5e4adea1d79&page=queryresults
[0m22:46:45.858249 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 22:46:41.167231 => 22:46:45.857360
[0m22:46:45.861392 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abd99f10-a11b-4c2f-952d-a7926fbdabce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab21634310>]}
[0m22:46:45.863967 [info ] [Thread-1 (]: 5 of 7 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.71s]
[0m22:46:45.866793 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m22:46:45.868860 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m22:46:45.871259 [info ] [Thread-1 (]: 6 of 7 START sql table model games.dim_support_language ........................ [RUN]
[0m22:46:45.874336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m22:46:45.876216 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m22:46:45.887754 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m22:46:45.889727 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 22:46:45.877527 => 22:46:45.889075
[0m22:46:45.890733 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m22:46:45.895593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:46:46.491890 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m22:46:46.494583 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m22:46:47.048260 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:236b8d12-ef65-45ba-8ba3-b647fb5a27fc&page=queryresults
[0m22:46:50.111824 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 22:46:45.891398 => 22:46:50.111637
[0m22:46:50.112529 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abd99f10-a11b-4c2f-952d-a7926fbdabce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab214c2800>]}
[0m22:46:50.113088 [info ] [Thread-1 (]: 6 of 7 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.24s]
[0m22:46:50.113704 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m22:46:50.114177 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m22:46:50.114628 [info ] [Thread-1 (]: 7 of 7 START sql table model games.fct_game_pricing ............................ [RUN]
[0m22:46:50.115275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m22:46:50.115827 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m22:46:50.119288 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m22:46:50.120019 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 22:46:50.116107 => 22:46:50.119757
[0m22:46:50.120443 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m22:46:50.123293 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m22:46:50.123961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:46:50.155285 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Calcular el precio promedio de juego vendido
WITH avg_game_price AS (
    SELECT
        app_id,
        AVG(price_with_tax) AS avg_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id
),

-- Encontrar el juego con el precio más alto
max_game_price AS (
    SELECT
        app_id,
        MAX(price_with_tax) AS max_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id
),

-- Encontrar el juego con el precio más bajo
min_game_price AS (
    SELECT
        app_id,
        MIN(price_with_tax) AS min_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id
),

-- Agregar un campo de ingresos totales
total_revenue AS (
    SELECT
        app_id,
        SUM(price_with_tax) AS revenue
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id
),

-- Agregar un campo de descuentos totales
total_discounts AS (
    SELECT
        app_id,
        SUM(discount_amount) AS total_discount
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id
),

-- Calcular ganancias totales
total_gross_profit AS (
    SELECT
        app_id,
        (total_revenue.revenue - total_discounts.total_discount) AS gross_profit
    FROM total_revenue
    JOIN total_discounts ON total_revenue.app_id = total_discounts.app_id
)

-- Combinar todas las medidas en la tabla de hechos
SELECT
    ROW_NUMBER() OVER () AS fct_id,
    avg_game_price.app_id,
    avg_price,
    max_price,
    min_price,
    total_discount,
    gross_profit
FROM
    avg_game_price
    JOIN max_game_price ON avg_game_price.app_id = max_game_price.app_id
    JOIN min_game_price ON avg_game_price.app_id = min_game_price.app_id
    JOIN total_discounts ON avg_game_price.app_id = total_discounts.app_id
    JOIN total_gross_profit ON avg_game_price.app_id = total_gross_profit.app_id;
    );
  
[0m22:46:50.828944 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:2cf44412-0159-4a23-82ec-44fee13cbb08&page=queryresults
[0m22:46:50.834306 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [83:81]')
[0m22:46:51.570878 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ac7b873f-c37a-423a-a455-4f0b4668f989&page=queryresults
[0m22:46:51.575217 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ac7b873f-c37a-423a-a455-4f0b4668f989&page=queryresults
[0m22:46:51.578355 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 22:46:50.120710 => 22:46:51.577399
[0m22:46:51.591662 [debug] [Thread-1 (]: Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Syntax error: Expected ")" but got ";" at [83:81]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m22:46:51.593772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abd99f10-a11b-4c2f-952d-a7926fbdabce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab21634310>]}
[0m22:46:51.596358 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model games.fct_game_pricing ................... [[31mERROR[0m in 1.48s]
[0m22:46:51.599167 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m22:46:51.605214 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:46:51.606832 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m22:46:51.607335 [info ] [MainThread]: 
[0m22:46:51.607766 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 30.73 seconds (30.73s).
[0m22:46:51.609238 [debug] [MainThread]: Command end result
[0m22:46:51.622029 [info ] [MainThread]: 
[0m22:46:51.622478 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:46:51.622845 [info ] [MainThread]: 
[0m22:46:51.623212 [error] [MainThread]:   Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Syntax error: Expected ")" but got ";" at [83:81]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m22:46:51.623595 [info ] [MainThread]: 
[0m22:46:51.623992 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m22:46:51.624578 [debug] [MainThread]: Command `dbt run` failed at 22:46:51.624487 after 31.20 seconds
[0m22:46:51.624951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab255135b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab20bf3a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab20bf3a30>]}
[0m22:46:51.625332 [debug] [MainThread]: Flushing usage events
[0m22:49:07.883800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f7ee1eb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f7ce88070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f7ce880d0>]}


============================== 22:49:07.885861 | d59d494f-ba74-408c-9953-1f7cf498be67 ==============================
[0m22:49:07.885861 [info ] [MainThread]: Running with dbt=1.6.5
[0m22:49:07.886343 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:49:08.160612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd59d494f-ba74-408c-9953-1f7cf498be67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f7ae0ec50>]}
[0m22:49:08.176336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd59d494f-ba74-408c-9953-1f7cf498be67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f7ae287c0>]}
[0m22:49:08.176896 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m22:49:08.190314 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m22:49:08.256121 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:49:08.256664 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m22:49:08.301158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd59d494f-ba74-408c-9953-1f7cf498be67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f7acdc0d0>]}
[0m22:49:08.309686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd59d494f-ba74-408c-9953-1f7cf498be67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f7ac33d30>]}
[0m22:49:08.310142 [info ] [MainThread]: Found 7 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m22:49:08.310488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd59d494f-ba74-408c-9953-1f7cf498be67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f7ac33e20>]}
[0m22:49:08.311871 [info ] [MainThread]: 
[0m22:49:08.312515 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:49:08.313742 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m22:49:08.314151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:09.180134 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m22:49:09.182148 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:49:09.913079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd59d494f-ba74-408c-9953-1f7cf498be67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f7ac31f90>]}
[0m22:49:09.916277 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:49:09.917909 [info ] [MainThread]: 
[0m22:49:09.925844 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m22:49:09.928038 [info ] [Thread-1 (]: 1 of 7 START sql table model games.dim_developers .............................. [RUN]
[0m22:49:09.930890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m22:49:09.932784 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m22:49:09.962015 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m22:49:09.963575 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 22:49:09.934045 => 22:49:09.963059
[0m22:49:09.964493 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m22:49:09.984301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:49:10.765702 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m22:49:10.766413 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m22:49:11.247754 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:118d6c3a-1f7a-4e49-8580-1deaf89cf5ba&page=queryresults
[0m22:49:14.654586 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 22:49:09.965118 => 22:49:14.654380
[0m22:49:14.655332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd59d494f-ba74-408c-9953-1f7cf498be67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f7a347d60>]}
[0m22:49:14.655936 [info ] [Thread-1 (]: 1 of 7 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.73s]
[0m22:49:14.656580 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m22:49:14.657033 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m22:49:14.657489 [info ] [Thread-1 (]: 2 of 7 START sql table model games.dim_platforms ............................... [RUN]
[0m22:49:14.658215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m22:49:14.658621 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m22:49:14.661434 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m22:49:14.662091 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 22:49:14.658903 => 22:49:14.661886
[0m22:49:14.662491 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m22:49:14.668799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:49:15.409290 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m22:49:15.412332 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m22:49:16.027867 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:184242c6-7385-4c98-92b6-25d6865af1ca&page=queryresults
[0m22:49:19.379773 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 22:49:14.662775 => 22:49:19.378886
[0m22:49:19.382814 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd59d494f-ba74-408c-9953-1f7cf498be67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f7a3961d0>]}
[0m22:49:19.385361 [info ] [Thread-1 (]: 2 of 7 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.72s]
[0m22:49:19.388145 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m22:49:19.390158 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m22:49:19.392542 [info ] [Thread-1 (]: 3 of 7 START sql table model games.dim_price_overview .......................... [RUN]
[0m22:49:19.395395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m22:49:19.397227 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m22:49:19.408720 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m22:49:19.410531 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 22:49:19.398502 => 22:49:19.410052
[0m22:49:19.411442 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m22:49:19.416318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:49:20.161193 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m22:49:20.161949 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m22:49:20.728037 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:0c97def7-cda9-4114-8916-995d20be1313&page=queryresults
[0m22:49:24.060348 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 22:49:19.412110 => 22:49:24.059463
[0m22:49:24.063546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd59d494f-ba74-408c-9953-1f7cf498be67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f7e3cf490>]}
[0m22:49:24.066110 [info ] [Thread-1 (]: 3 of 7 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (1.1k rows, 114.2 KiB processed)[0m in 4.67s]
[0m22:49:24.069027 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m22:49:24.071065 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m22:49:24.073731 [info ] [Thread-1 (]: 4 of 7 START sql table model games.dim_publishers .............................. [RUN]
[0m22:49:24.076777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m22:49:24.078601 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m22:49:24.084852 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m22:49:24.085548 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 22:49:24.079909 => 22:49:24.085305
[0m22:49:24.085928 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m22:49:24.088056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:49:24.832604 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m22:49:24.833252 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m22:49:25.285769 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:4df85d92-7e92-4c37-be7c-46ae93a63768&page=queryresults
[0m22:49:28.491775 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 22:49:24.086190 => 22:49:28.491585
[0m22:49:28.492503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd59d494f-ba74-408c-9953-1f7cf498be67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f7a388fd0>]}
[0m22:49:28.493041 [info ] [Thread-1 (]: 4 of 7 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.42s]
[0m22:49:28.493607 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m22:49:28.494045 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m22:49:28.494458 [info ] [Thread-1 (]: 5 of 7 START sql table model games.dim_release ................................. [RUN]
[0m22:49:28.495063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m22:49:28.495511 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m22:49:28.498149 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m22:49:28.498747 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 22:49:28.495786 => 22:49:28.498549
[0m22:49:28.499103 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m22:49:28.506966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:49:29.203302 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m22:49:29.203927 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m22:49:29.809530 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:fc79291e-b541-4f2f-a605-8bfa5b23e3f8&page=queryresults
[0m22:49:33.019871 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 22:49:28.499352 => 22:49:33.019660
[0m22:49:33.020568 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd59d494f-ba74-408c-9953-1f7cf498be67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f7acdf2e0>]}
[0m22:49:33.021121 [info ] [Thread-1 (]: 5 of 7 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.53s]
[0m22:49:33.021702 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m22:49:33.022122 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m22:49:33.022550 [info ] [Thread-1 (]: 6 of 7 START sql table model games.dim_support_language ........................ [RUN]
[0m22:49:33.023145 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m22:49:33.023521 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m22:49:33.026469 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m22:49:33.027242 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 22:49:33.023793 => 22:49:33.027008
[0m22:49:33.027668 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m22:49:33.029920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:49:33.766885 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m22:49:33.769615 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m22:49:34.225016 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:593d00f2-59a2-402d-84a0-717fc49c2ad6&page=queryresults
[0m22:49:37.618639 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 22:49:33.027958 => 22:49:37.618455
[0m22:49:37.619325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd59d494f-ba74-408c-9953-1f7cf498be67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f7acbdea0>]}
[0m22:49:37.619938 [info ] [Thread-1 (]: 6 of 7 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.60s]
[0m22:49:37.620546 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m22:49:37.621011 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m22:49:37.621570 [info ] [Thread-1 (]: 7 of 7 START sql table model games.fct_game_pricing ............................ [RUN]
[0m22:49:37.622220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m22:49:37.622587 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m22:49:37.626209 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m22:49:37.626860 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 22:49:37.622862 => 22:49:37.626645
[0m22:49:37.627248 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m22:49:37.630047 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m22:49:37.630608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:49:37.662216 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Calcular el precio promedio de juego vendido
WITH avg_game_price AS (
    SELECT
        app_id,
        AVG(price_with_tax) AS avg_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id
),

-- Encontrar el juego con el precio más alto
max_game_price AS (
    SELECT
        app_id,
        MAX(price_with_tax) AS max_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id
),

-- Encontrar el juego con el precio más bajo
min_game_price AS (
    SELECT
        app_id,
        MIN(price_with_tax) AS min_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id
),

-- Agregar un campo de ingresos totales
total_revenue AS (
    SELECT
        app_id,
        SUM(price_with_tax) AS revenue
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id
),

-- Agregar un campo de descuentos totales
total_discounts AS (
    SELECT
        app_id,
        SUM(discount_amount) AS total_discount
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id
),

-- Calcular ganancias totales
total_gross_profit AS (
    SELECT
        app_id,
        (total_revenue.revenue - total_discounts.total_discount) AS gross_profit
    FROM total_revenue
    JOIN total_discounts ON total_revenue.app_id = total_discounts.app_id
)

-- Combinar todas las medidas en la tabla de hechos
SELECT
    ROW_NUMBER() OVER () AS fct_id,
    avg_game_price.app_id,
    avg_price,
    max_price,
    min_price,
    total_discount,
    gross_profit
FROM
    avg_game_price
    JOIN max_game_price ON avg_game_price.app_id = max_game_price.app_id
    JOIN min_game_price ON avg_game_price.app_id = min_game_price.app_id
    JOIN total_discounts ON avg_game_price.app_id = total_discounts.app_id
    JOIN total_gross_profit ON avg_game_price.app_id = total_gross_profit.app_id
    );
  
[0m22:49:38.653115 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:97092527-9a7c-4088-9953-dc135d04ffba&page=queryresults
[0m22:49:39.191879 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Column name app_id is ambiguous at [63:9]')
[0m22:49:40.647376 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:4de0a532-f161-4ee8-b4ad-155ecf019eaa&page=queryresults
[0m22:49:41.172706 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:4de0a532-f161-4ee8-b4ad-155ecf019eaa&page=queryresults
[0m22:49:41.175906 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 22:49:37.627506 => 22:49:41.174907
[0m22:49:41.179385 [debug] [Thread-1 (]: Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Column name app_id is ambiguous at [63:9]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m22:49:41.179897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd59d494f-ba74-408c-9953-1f7cf498be67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f7ae0c340>]}
[0m22:49:41.180481 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model games.fct_game_pricing ................... [[31mERROR[0m in 3.56s]
[0m22:49:41.181082 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m22:49:41.182587 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:49:41.182912 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m22:49:41.183268 [info ] [MainThread]: 
[0m22:49:41.183657 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 32.87 seconds (32.87s).
[0m22:49:41.185159 [debug] [MainThread]: Command end result
[0m22:49:41.197634 [info ] [MainThread]: 
[0m22:49:41.198107 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:49:41.198474 [info ] [MainThread]: 
[0m22:49:41.198834 [error] [MainThread]:   Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Column name app_id is ambiguous at [63:9]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m22:49:41.199202 [info ] [MainThread]: 
[0m22:49:41.199595 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m22:49:41.200217 [debug] [MainThread]: Command `dbt run` failed at 22:49:41.200107 after 33.32 seconds
[0m22:49:41.200653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f7ee1eb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f7a3d16c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f7a3d2650>]}
[0m22:49:41.201080 [debug] [MainThread]: Flushing usage events
[0m22:50:31.435764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d4ef211b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d4cfc4070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d4cfc40d0>]}


============================== 22:50:31.437835 | a963d53d-756a-415e-a3cc-c71aacdf0810 ==============================
[0m22:50:31.437835 [info ] [MainThread]: Running with dbt=1.6.5
[0m22:50:31.438295 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'send_anonymous_usage_stats': 'True'}
[0m22:50:31.712553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a963d53d-756a-415e-a3cc-c71aacdf0810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d4af46bf0>]}
[0m22:50:31.728232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a963d53d-756a-415e-a3cc-c71aacdf0810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d4af60700>]}
[0m22:50:31.728821 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m22:50:31.742221 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m22:50:31.806857 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:50:31.807408 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m22:50:31.841287 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.games.fct_game_pricing' (models/transform/fct_game_pricing.sql) depends on a node named 'avg_game_price' which was not found
[0m22:50:31.841901 [debug] [MainThread]: Command `dbt run` failed at 22:50:31.841805 after 0.41 seconds
[0m22:50:31.842255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d4ef211b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d4adcbbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d4af6c1f0>]}
[0m22:50:31.842616 [debug] [MainThread]: Flushing usage events
[0m22:54:52.641618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7177c0ab30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7175c9c070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7175c9c0d0>]}


============================== 22:54:52.643831 | 8ac9c284-c555-41b5-9a9c-323ed9f9f2d7 ==============================
[0m22:54:52.643831 [info ] [MainThread]: Running with dbt=1.6.5
[0m22:54:52.644310 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:54:52.937893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ac9c284-c555-41b5-9a9c-323ed9f9f2d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7173c22c50>]}
[0m22:54:52.954870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ac9c284-c555-41b5-9a9c-323ed9f9f2d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7173c3c640>]}
[0m22:54:52.955697 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m22:54:52.970730 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m22:54:53.038144 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:54:53.038822 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m22:54:53.086430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ac9c284-c555-41b5-9a9c-323ed9f9f2d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7173aec0d0>]}
[0m22:54:53.095710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ac9c284-c555-41b5-9a9c-323ed9f9f2d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7173a47d30>]}
[0m22:54:53.096171 [info ] [MainThread]: Found 7 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m22:54:53.096521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ac9c284-c555-41b5-9a9c-323ed9f9f2d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7173a47e20>]}
[0m22:54:53.097986 [info ] [MainThread]: 
[0m22:54:53.098746 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:54:53.100021 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m22:54:53.102203 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:54:53.967021 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m22:54:53.969019 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:54:54.767813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ac9c284-c555-41b5-9a9c-323ed9f9f2d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7173a45f00>]}
[0m22:54:54.771290 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:54:54.773085 [info ] [MainThread]: 
[0m22:54:54.780513 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m22:54:54.782360 [info ] [Thread-1 (]: 1 of 7 START sql table model games.dim_developers .............................. [RUN]
[0m22:54:54.784471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m22:54:54.785783 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m22:54:54.803834 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m22:54:54.805395 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 22:54:54.786725 => 22:54:54.804996
[0m22:54:54.806179 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m22:54:54.823791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:54:55.686355 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m22:54:55.687117 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m22:54:56.197718 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:79e000fa-8b99-41df-bc59-2d3b51db2dd3&page=queryresults
[0m22:54:59.143494 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 22:54:54.806733 => 22:54:59.143181
[0m22:54:59.144628 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ac9c284-c555-41b5-9a9c-323ed9f9f2d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7173157f40>]}
[0m22:54:59.145536 [info ] [Thread-1 (]: 1 of 7 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.36s]
[0m22:54:59.146460 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m22:54:59.147088 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m22:54:59.147789 [info ] [Thread-1 (]: 2 of 7 START sql table model games.dim_platforms ............................... [RUN]
[0m22:54:59.148651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m22:54:59.149179 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m22:54:59.152655 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m22:54:59.153449 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 22:54:59.149555 => 22:54:59.153190
[0m22:54:59.153913 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m22:54:59.160587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:54:59.954196 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m22:54:59.956900 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m22:55:00.443877 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:8c81d9e5-563d-4ecd-a542-6697dc94a155&page=queryresults
[0m22:55:03.511727 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 22:54:59.154240 => 22:55:03.510826
[0m22:55:03.514935 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ac9c284-c555-41b5-9a9c-323ed9f9f2d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f717319b550>]}
[0m22:55:03.517580 [info ] [Thread-1 (]: 2 of 7 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.37s]
[0m22:55:03.520410 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m22:55:03.522453 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m22:55:03.524824 [info ] [Thread-1 (]: 3 of 7 START sql table model games.dim_price_overview .......................... [RUN]
[0m22:55:03.527791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m22:55:03.529663 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m22:55:03.538393 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m22:55:03.539978 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 22:55:03.530983 => 22:55:03.539406
[0m22:55:03.540923 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m22:55:03.544989 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:55:04.300972 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m22:55:04.303945 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m22:55:04.797094 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d9d07422-4528-4f7d-9538-f52aec306a6c&page=queryresults
[0m22:55:07.885845 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 22:55:03.541465 => 22:55:07.884919
[0m22:55:07.889224 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ac9c284-c555-41b5-9a9c-323ed9f9f2d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7173166e90>]}
[0m22:55:07.891871 [info ] [Thread-1 (]: 3 of 7 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (1.1k rows, 114.2 KiB processed)[0m in 4.36s]
[0m22:55:07.894837 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m22:55:07.897040 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m22:55:07.899752 [info ] [Thread-1 (]: 4 of 7 START sql table model games.dim_publishers .............................. [RUN]
[0m22:55:07.902876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m22:55:07.904200 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m22:55:07.907059 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m22:55:07.907747 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 22:55:07.904463 => 22:55:07.907511
[0m22:55:07.908115 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m22:55:07.910224 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:55:08.673943 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m22:55:08.675696 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m22:55:09.253792 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9cf7ebc3-a4cb-4a39-99fc-f663f74b90fc&page=queryresults
[0m22:55:12.356107 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 22:55:07.908369 => 22:55:12.355734
[0m22:55:12.357482 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ac9c284-c555-41b5-9a9c-323ed9f9f2d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7173c3cdc0>]}
[0m22:55:12.358556 [info ] [Thread-1 (]: 4 of 7 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.46s]
[0m22:55:12.359732 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m22:55:12.360574 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m22:55:12.361570 [info ] [Thread-1 (]: 5 of 7 START sql table model games.dim_release ................................. [RUN]
[0m22:55:12.362839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m22:55:12.363596 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m22:55:12.368718 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m22:55:12.369911 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 22:55:12.364131 => 22:55:12.369506
[0m22:55:12.370642 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m22:55:12.383605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:55:13.059789 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m22:55:13.062466 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m22:55:13.656580 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:88c50be0-7d01-40a2-8f9f-156c8b878a3a&page=queryresults
[0m22:55:17.020411 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 22:55:12.371161 => 22:55:17.019455
[0m22:55:17.023582 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ac9c284-c555-41b5-9a9c-323ed9f9f2d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7177474c40>]}
[0m22:55:17.026232 [info ] [Thread-1 (]: 5 of 7 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.66s]
[0m22:55:17.029217 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m22:55:17.031280 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m22:55:17.033734 [info ] [Thread-1 (]: 6 of 7 START sql table model games.dim_support_language ........................ [RUN]
[0m22:55:17.036689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m22:55:17.038519 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m22:55:17.046665 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m22:55:17.048176 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 22:55:17.039570 => 22:55:17.047690
[0m22:55:17.049099 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m22:55:17.053063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:55:17.810689 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m22:55:17.814615 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m22:55:18.387484 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e1f811b1-e8aa-46f2-935f-48e8c0219b37&page=queryresults
[0m22:55:21.810042 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 22:55:17.049625 => 22:55:21.809144
[0m22:55:21.813506 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ac9c284-c555-41b5-9a9c-323ed9f9f2d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7173aae410>]}
[0m22:55:21.816558 [info ] [Thread-1 (]: 6 of 7 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.78s]
[0m22:55:21.820008 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m22:55:21.822235 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m22:55:21.825097 [info ] [Thread-1 (]: 7 of 7 START sql table model games.fct_game_pricing ............................ [RUN]
[0m22:55:21.827316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m22:55:21.828760 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m22:55:21.837852 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m22:55:21.839474 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 22:55:21.829742 => 22:55:21.838997
[0m22:55:21.840254 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m22:55:21.845254 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m22:55:21.846148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:55:21.881055 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Calcular el precio promedio de juego vendido
WITH avg_game_price AS (
    SELECT
        app_id,
        AVG(price_with_tax) AS avg_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id
),

-- Encontrar el juego con el precio más alto
max_game_price AS (
    SELECT
        app_id,
        MAX(price_with_tax) AS max_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id
),

-- Encontrar el juego con el precio más bajo
min_game_price AS (
    SELECT
        app_id,
        MIN(price_with_tax) AS min_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id
),

-- Agregar un campo de ingresos totales
total_revenue AS (
    SELECT
        app_id,
        SUM(price_with_tax) AS revenue
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id
),

-- Agregar un campo de descuentos totales
total_discounts AS (
    SELECT
        app_id,
        SUM(discount_amount) AS total_discount
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id
),

-- Calcular ganancias totales
total_gross_profit AS (
    SELECT
        app_id,
        (total_revenue.revenue - total_discounts.total_discount) AS gross_profit
    FROM total_revenue
    JOIN total_discounts ON total_revenue.app_id = total_discounts.app_id
)

-- Combinar todas las medidas en la tabla de hechos
SELECT
    ROW_NUMBER() OVER () AS fct_id,
    avg_game_price.app_id,
    avg_price,
    max_price,
    min_price,
    total_discount,
    gross_profit
FROM
    avg_game_price, max_game_price, min_game_price, total_discounts, total_gross_profit
    );
  
[0m22:55:22.816104 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5c3d5e4f-5e58-4f90-a3e1-f96f8aae9257&page=queryresults
[0m22:55:23.371530 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Column name app_id is ambiguous at [63:9]')
[0m22:55:23.938407 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:fc1bc33e-e3b7-4e8a-9baf-8c15be7dcf09&page=queryresults
[0m22:55:24.483618 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:fc1bc33e-e3b7-4e8a-9baf-8c15be7dcf09&page=queryresults
[0m22:55:24.486800 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 22:55:21.840756 => 22:55:24.485832
[0m22:55:24.500132 [debug] [Thread-1 (]: Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Column name app_id is ambiguous at [63:9]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m22:55:24.502292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ac9c284-c555-41b5-9a9c-323ed9f9f2d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7173c21840>]}
[0m22:55:24.504899 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model games.fct_game_pricing ................... [[31mERROR[0m in 2.68s]
[0m22:55:24.507807 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m22:55:24.513933 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:55:24.515601 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m22:55:24.517271 [info ] [MainThread]: 
[0m22:55:24.518948 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 31.42 seconds (31.42s).
[0m22:55:24.526138 [debug] [MainThread]: Command end result
[0m22:55:24.559169 [info ] [MainThread]: 
[0m22:55:24.559874 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:55:24.560360 [info ] [MainThread]: 
[0m22:55:24.560816 [error] [MainThread]:   Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Column name app_id is ambiguous at [63:9]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m22:55:24.561281 [info ] [MainThread]: 
[0m22:55:24.561769 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m22:55:24.562583 [debug] [MainThread]: Command `dbt run` failed at 22:55:24.562431 after 31.93 seconds
[0m22:55:24.563116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7177c0ab30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71731ed240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71731ef370>]}
[0m22:55:24.563658 [debug] [MainThread]: Flushing usage events
[0m22:57:14.723043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb1531180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8baf6c0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8baf6c00d0>]}


============================== 22:57:14.725195 | 19a794f0-07ab-4bd1-8e20-b1a4f1ab52bd ==============================
[0m22:57:14.725195 [info ] [MainThread]: Running with dbt=1.6.5
[0m22:57:14.725692 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '../dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'send_anonymous_usage_stats': 'True'}
[0m22:57:15.002319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19a794f0-07ab-4bd1-8e20-b1a4f1ab52bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb0b107c0>]}
[0m22:57:15.017955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19a794f0-07ab-4bd1-8e20-b1a4f1ab52bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bad6609d0>]}
[0m22:57:15.018547 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m22:57:15.034069 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m22:57:15.097819 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:57:15.098355 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m22:57:15.142287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19a794f0-07ab-4bd1-8e20-b1a4f1ab52bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bad4b00d0>]}
[0m22:57:15.150925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19a794f0-07ab-4bd1-8e20-b1a4f1ab52bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bad46bdf0>]}
[0m22:57:15.151374 [info ] [MainThread]: Found 7 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m22:57:15.151759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19a794f0-07ab-4bd1-8e20-b1a4f1ab52bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bad46bd60>]}
[0m22:57:15.153102 [info ] [MainThread]: 
[0m22:57:15.153762 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:57:15.155016 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m22:57:15.155448 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:57:15.980372 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m22:57:15.982109 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:57:16.677775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19a794f0-07ab-4bd1-8e20-b1a4f1ab52bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8baf6940a0>]}
[0m22:57:16.678723 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:57:16.679103 [info ] [MainThread]: 
[0m22:57:16.681314 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m22:57:16.681814 [info ] [Thread-1 (]: 1 of 7 START sql table model games.dim_developers .............................. [RUN]
[0m22:57:16.682471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m22:57:16.682858 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m22:57:16.690150 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m22:57:16.690800 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 22:57:16.683112 => 22:57:16.690598
[0m22:57:16.691189 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m22:57:16.704650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:57:17.498470 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m22:57:17.499241 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m22:57:18.141841 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7fddee97-1378-4023-a1dd-9022eebd3087&page=queryresults
[0m22:57:21.246172 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 22:57:16.691460 => 22:57:21.245987
[0m22:57:21.246876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19a794f0-07ab-4bd1-8e20-b1a4f1ab52bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bacd83b20>]}
[0m22:57:21.247442 [info ] [Thread-1 (]: 1 of 7 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.56s]
[0m22:57:21.248096 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m22:57:21.248558 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m22:57:21.249070 [info ] [Thread-1 (]: 2 of 7 START sql table model games.dim_platforms ............................... [RUN]
[0m22:57:21.249699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m22:57:21.250078 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m22:57:21.252677 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m22:57:21.253315 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 22:57:21.250342 => 22:57:21.253093
[0m22:57:21.253695 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m22:57:21.259778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:57:22.005322 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m22:57:22.008129 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m22:57:22.624973 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ea68062d-6984-41fa-8f67-939e327d6854&page=queryresults
[0m22:57:25.401016 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 22:57:21.253959 => 22:57:25.400802
[0m22:57:25.401767 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19a794f0-07ab-4bd1-8e20-b1a4f1ab52bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bacdc6bf0>]}
[0m22:57:25.402475 [info ] [Thread-1 (]: 2 of 7 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.15s]
[0m22:57:25.403050 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m22:57:25.403485 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m22:57:25.403922 [info ] [Thread-1 (]: 3 of 7 START sql table model games.dim_price_overview .......................... [RUN]
[0m22:57:25.404568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m22:57:25.404988 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m22:57:25.407933 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m22:57:25.408546 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 22:57:25.405251 => 22:57:25.408355
[0m22:57:25.408914 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m22:57:25.411226 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:57:26.151995 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m22:57:26.154953 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m22:57:26.621924 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b8c34b27-2abc-4f9e-8500-fb9eb0810cbb&page=queryresults
[0m22:57:29.385758 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 22:57:25.409171 => 22:57:29.384882
[0m22:57:29.388992 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19a794f0-07ab-4bd1-8e20-b1a4f1ab52bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bacd90730>]}
[0m22:57:29.391576 [info ] [Thread-1 (]: 3 of 7 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (1.1k rows, 114.2 KiB processed)[0m in 3.98s]
[0m22:57:29.394372 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m22:57:29.396423 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m22:57:29.399089 [info ] [Thread-1 (]: 4 of 7 START sql table model games.dim_publishers .............................. [RUN]
[0m22:57:29.402201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m22:57:29.404076 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m22:57:29.416848 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m22:57:29.419662 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 22:57:29.405382 => 22:57:29.418716
[0m22:57:29.421445 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m22:57:29.430927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:57:30.176316 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m22:57:30.177031 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m22:57:30.621645 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:51ca1610-0645-44e9-9a75-4f9e212e0e7e&page=queryresults
[0m22:57:40.421363 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 22:57:29.422722 => 22:57:40.420494
[0m22:57:40.424694 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19a794f0-07ab-4bd1-8e20-b1a4f1ab52bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bacd87850>]}
[0m22:57:40.427283 [info ] [Thread-1 (]: 4 of 7 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 11.02s]
[0m22:57:40.430205 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m22:57:40.432384 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m22:57:40.434770 [info ] [Thread-1 (]: 5 of 7 START sql table model games.dim_release ................................. [RUN]
[0m22:57:40.437921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m22:57:40.439776 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m22:57:40.449953 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m22:57:40.451436 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 22:57:40.441084 => 22:57:40.450960
[0m22:57:40.452371 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m22:57:40.466612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:57:41.189584 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m22:57:41.190196 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m22:57:41.643403 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ccdd53ee-8fbe-4af0-92ed-d847711b9aab&page=queryresults
[0m22:57:44.689015 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 22:57:40.453029 => 22:57:44.688780
[0m22:57:44.690038 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19a794f0-07ab-4bd1-8e20-b1a4f1ab52bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bad660bb0>]}
[0m22:57:44.690701 [info ] [Thread-1 (]: 5 of 7 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.25s]
[0m22:57:44.691332 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m22:57:44.691798 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m22:57:44.692341 [info ] [Thread-1 (]: 6 of 7 START sql table model games.dim_support_language ........................ [RUN]
[0m22:57:44.693008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m22:57:44.693411 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m22:57:44.696628 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m22:57:44.697337 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 22:57:44.693698 => 22:57:44.697129
[0m22:57:44.697739 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m22:57:44.700006 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:57:45.407656 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m22:57:45.408533 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m22:57:45.974411 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ea00002c-d6f3-4057-8496-4d49d8ad186e&page=queryresults
[0m22:57:49.308123 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 22:57:44.698021 => 22:57:49.307805
[0m22:57:49.309626 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19a794f0-07ab-4bd1-8e20-b1a4f1ab52bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bad647d60>]}
[0m22:57:49.310791 [info ] [Thread-1 (]: 6 of 7 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.62s]
[0m22:57:49.312011 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m22:57:49.321963 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m22:57:49.322758 [info ] [Thread-1 (]: 7 of 7 START sql table model games.fct_game_pricing ............................ [RUN]
[0m22:57:49.323796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m22:57:49.324385 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m22:57:49.328926 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m22:57:49.329944 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 22:57:49.324782 => 22:57:49.329706
[0m22:57:49.330422 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m22:57:49.333964 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m22:57:49.334961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:57:49.370951 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Calcular el precio promedio de juego vendido
WITH avg_game_price AS (
    SELECT
        app_id,
        AVG(price_with_tax) AS avg_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id
),

-- Encontrar el juego con el precio más alto
max_game_price AS (
    SELECT
        app_id,
        MAX(price_with_tax) AS max_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id
),

-- Encontrar el juego con el precio más bajo
min_game_price AS (
    SELECT
        app_id,
        MIN(price_with_tax) AS min_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id
),

-- Agregar un campo de ingresos totales
total_revenue AS (
    SELECT
        app_id,
        SUM(price_with_tax) AS revenue
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id
),

-- Agregar un campo de descuentos totales
total_discounts AS (
    SELECT
        app_id,
        SUM(discount_amount) AS total_discount
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id
),

-- Calcular ganancias totales
total_gross_profit AS (
    SELECT
        app_id,
        (total_revenue.revenue - total_discounts.total_discount) AS gross_profit
    FROM total_revenue
    JOIN total_discounts ON total_revenue.app_id = total_discounts.app_id
)

-- Combinar todas las medidas en la tabla de hechos
SELECT
    ROW_NUMBER() OVER () AS fct_id,
    app_id,
    avg_price,
    max_price,
    min_price,
    total_discount,
    gross_profit
FROM
    avg_game_price, max_game_price, min_game_price, total_discounts, total_gross_profit
    );
  
[0m22:57:50.221098 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9ca5853f-f053-4a05-a05f-db0fe1f370e7&page=queryresults
[0m22:57:50.737826 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Column name app_id is ambiguous at [63:9]')
[0m22:57:52.044471 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a7264bb0-2a86-4331-ab02-405fa38fd666&page=queryresults
[0m22:57:52.578095 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a7264bb0-2a86-4331-ab02-405fa38fd666&page=queryresults
[0m22:57:52.579831 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 22:57:49.330772 => 22:57:52.579301
[0m22:57:52.585735 [debug] [Thread-1 (]: Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Column name app_id is ambiguous at [63:9]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m22:57:52.586738 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19a794f0-07ab-4bd1-8e20-b1a4f1ab52bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bad645780>]}
[0m22:57:52.587795 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model games.fct_game_pricing ................... [[31mERROR[0m in 3.26s]
[0m22:57:52.589041 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m22:57:52.591346 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:57:52.591947 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m22:57:52.592462 [info ] [MainThread]: 
[0m22:57:52.592950 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 37.44 seconds (37.44s).
[0m22:57:52.595039 [debug] [MainThread]: Command end result
[0m22:57:52.610286 [info ] [MainThread]: 
[0m22:57:52.610835 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:57:52.611158 [info ] [MainThread]: 
[0m22:57:52.611478 [error] [MainThread]:   Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Column name app_id is ambiguous at [63:9]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m22:57:52.611816 [info ] [MainThread]: 
[0m22:57:52.612157 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m22:57:52.612704 [debug] [MainThread]: Command `dbt run` failed at 22:57:52.612608 after 37.90 seconds
[0m22:57:52.613074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb1531180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8baf697f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8baf6940a0>]}
[0m22:57:52.613470 [debug] [MainThread]: Flushing usage events
[0m22:58:25.016539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b38d11180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b36f68070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b36f680d0>]}


============================== 22:58:25.018855 | d9479437-c515-4adb-ab38-0670dcc87914 ==============================
[0m22:58:25.018855 [info ] [MainThread]: Running with dbt=1.6.5
[0m22:58:25.019516 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:58:25.316166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9479437-c515-4adb-ab38-0670dcc87914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3832c1f0>]}
[0m22:58:25.332799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9479437-c515-4adb-ab38-0670dcc87914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b34d0b490>]}
[0m22:58:25.333481 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m22:58:25.347764 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m22:58:25.418946 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:58:25.419594 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m22:58:25.473048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9479437-c515-4adb-ab38-0670dcc87914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b34bc00d0>]}
[0m22:58:25.483200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9479437-c515-4adb-ab38-0670dcc87914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b34b13df0>]}
[0m22:58:25.483813 [info ] [MainThread]: Found 7 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m22:58:25.484312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9479437-c515-4adb-ab38-0670dcc87914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b34b13d60>]}
[0m22:58:25.485947 [info ] [MainThread]: 
[0m22:58:25.486729 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:58:25.488030 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m22:58:25.488496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:58:26.257917 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m22:58:26.258487 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:58:26.963739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9479437-c515-4adb-ab38-0670dcc87914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b34b11f90>]}
[0m22:58:26.964486 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:58:26.964898 [info ] [MainThread]: 
[0m22:58:26.966675 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m22:58:26.967163 [info ] [Thread-1 (]: 1 of 7 START sql table model games.dim_developers .............................. [RUN]
[0m22:58:26.967794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m22:58:26.968163 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m22:58:26.976528 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m22:58:26.977716 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 22:58:26.968422 => 22:58:26.977427
[0m22:58:26.978192 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m22:58:26.992017 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:58:28.024482 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m22:58:28.025207 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m22:58:28.666464 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:46d0fb2f-b334-485a-876a-2fdf0a7c7eb0&page=queryresults
[0m22:58:32.390280 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 22:58:26.978481 => 22:58:32.389974
[0m22:58:32.391401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9479437-c515-4adb-ab38-0670dcc87914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b34427af0>]}
[0m22:58:32.392285 [info ] [Thread-1 (]: 1 of 7 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 5.42s]
[0m22:58:32.393110 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m22:58:32.393707 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m22:58:32.394421 [info ] [Thread-1 (]: 2 of 7 START sql table model games.dim_platforms ............................... [RUN]
[0m22:58:32.395273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m22:58:32.395820 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m22:58:32.399166 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m22:58:32.399940 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 22:58:32.396196 => 22:58:32.399689
[0m22:58:32.400401 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m22:58:32.407266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:58:33.161049 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m22:58:33.162039 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m22:58:33.692512 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:78cd17c0-c77f-40d2-87e4-17af44ba76c1&page=queryresults
[0m22:58:37.038845 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 22:58:32.400727 => 22:58:37.038645
[0m22:58:37.039639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9479437-c515-4adb-ab38-0670dcc87914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3446b550>]}
[0m22:58:37.040268 [info ] [Thread-1 (]: 2 of 7 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.64s]
[0m22:58:37.044802 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m22:58:37.045510 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m22:58:37.046312 [info ] [Thread-1 (]: 3 of 7 START sql table model games.dim_price_overview .......................... [RUN]
[0m22:58:37.047148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m22:58:37.047743 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m22:58:37.050919 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m22:58:37.052080 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 22:58:37.048044 => 22:58:37.051792
[0m22:58:37.052629 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m22:58:37.055500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:58:37.786960 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m22:58:37.787693 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m22:58:38.255680 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7ba66d70-8bac-4a8f-9dc6-37a3d835502b&page=queryresults
[0m22:58:41.921437 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 22:58:37.053034 => 22:58:41.921246
[0m22:58:41.922182 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9479437-c515-4adb-ab38-0670dcc87914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b344369e0>]}
[0m22:58:41.922732 [info ] [Thread-1 (]: 3 of 7 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (1.1k rows, 114.2 KiB processed)[0m in 4.88s]
[0m22:58:41.923311 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m22:58:41.923740 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m22:58:41.924329 [info ] [Thread-1 (]: 4 of 7 START sql table model games.dim_publishers .............................. [RUN]
[0m22:58:41.924968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m22:58:41.925339 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m22:58:41.928178 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m22:58:41.928828 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 22:58:41.925602 => 22:58:41.928634
[0m22:58:41.929195 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m22:58:41.931609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:58:42.704809 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m22:58:42.705543 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m22:58:43.171608 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f09c13ff-e550-4874-892c-56558aa90d7f&page=queryresults
[0m22:58:46.512029 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 22:58:41.929458 => 22:58:46.511204
[0m22:58:46.513085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9479437-c515-4adb-ab38-0670dcc87914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3442a2c0>]}
[0m22:58:46.513847 [info ] [Thread-1 (]: 4 of 7 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.59s]
[0m22:58:46.514658 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m22:58:46.515164 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m22:58:46.515682 [info ] [Thread-1 (]: 5 of 7 START sql table model games.dim_release ................................. [RUN]
[0m22:58:46.516681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m22:58:46.517192 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m22:58:46.520135 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m22:58:46.521064 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 22:58:46.517468 => 22:58:46.520864
[0m22:58:46.521494 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m22:58:46.530944 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:58:47.249410 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m22:58:47.250803 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m22:58:47.817131 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b7f99722-011c-401c-ace5-845e3f476361&page=queryresults
[0m22:58:50.829158 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 22:58:46.521804 => 22:58:50.828914
[0m22:58:50.829848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9479437-c515-4adb-ab38-0670dcc87914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b34d09420>]}
[0m22:58:50.830399 [info ] [Thread-1 (]: 5 of 7 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.31s]
[0m22:58:50.830982 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m22:58:50.831416 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m22:58:50.831865 [info ] [Thread-1 (]: 6 of 7 START sql table model games.dim_support_language ........................ [RUN]
[0m22:58:50.832474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m22:58:50.832941 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m22:58:50.835751 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m22:58:50.836381 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 22:58:50.833217 => 22:58:50.836184
[0m22:58:50.836751 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m22:58:50.838889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:58:51.517592 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m22:58:51.519402 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m22:58:52.063533 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f43ff40b-1623-4e2f-bbe2-a2c966007a03&page=queryresults
[0m22:58:55.459241 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 22:58:50.837012 => 22:58:55.459048
[0m22:58:55.459964 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9479437-c515-4adb-ab38-0670dcc87914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b34eeed10>]}
[0m22:58:55.460699 [info ] [Thread-1 (]: 6 of 7 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.63s]
[0m22:58:55.461635 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m22:58:55.462259 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m22:58:55.462832 [info ] [Thread-1 (]: 7 of 7 START sql table model games.fct_game_pricing ............................ [RUN]
[0m22:58:55.463590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m22:58:55.464010 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m22:58:55.467825 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m22:58:55.468519 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 22:58:55.464283 => 22:58:55.468316
[0m22:58:55.468897 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m22:58:55.471926 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m22:58:55.472553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:58:55.505811 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Calcular el precio promedio de juego vendido
WITH avg_game_price AS (
    SELECT
        app_id,
        AVG(price_with_tax) AS avg_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Encontrar el juego con el precio más alto
max_game_price AS (
    SELECT
        app_id,
        MAX(price_with_tax) AS max_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Encontrar el juego con el precio más bajo
min_game_price AS (
    SELECT
        app_id,
        MIN(price_with_tax) AS min_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Agregar un campo de ingresos totales
total_revenue AS (
    SELECT
        app_id,
        SUM(price_with_tax) AS revenue
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Agregar un campo de descuentos totales
total_discounts AS (
    SELECT
        app_id,
        SUM(discount_amount) AS total_discount
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Calcular ganancias totales
total_gross_profit AS (
    SELECT
        app_id,
        (total_revenue.revenue - total_discounts.total_discount) AS gross_profit
    FROM total_revenue
    JOIN total_discounts ON total_revenue.app_id = total_discounts.app_id
)

-- Combinar todas las medidas en la tabla de hechos
SELECT
    ROW_NUMBER() OVER () AS fct_id,
    app_id,
    avg_price,
    max_price,
    min_price,
    total_discount,
    gross_profit
FROM
    avg_game_price, max_game_price, min_game_price, total_discounts, total_gross_profit
    );
  
[0m22:58:56.345378 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:4f7f88ea-b272-441e-9df7-ea2c60f26403&page=queryresults
[0m22:58:56.871617 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column app_id which is neither grouped nor aggregated at [18:9]')
[0m22:58:58.270345 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:92816496-556e-475b-b315-68a397ac455f&page=queryresults
[0m22:58:58.792657 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:92816496-556e-475b-b315-68a397ac455f&page=queryresults
[0m22:58:58.794293 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 22:58:55.469161 => 22:58:58.793792
[0m22:58:58.801904 [debug] [Thread-1 (]: Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  SELECT list expression references column app_id which is neither grouped nor aggregated at [18:9]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m22:58:58.803303 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9479437-c515-4adb-ab38-0670dcc87914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b34eec940>]}
[0m22:58:58.805007 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model games.fct_game_pricing ................... [[31mERROR[0m in 3.34s]
[0m22:58:58.806795 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m22:58:58.810728 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:58:58.811797 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m22:58:58.812870 [info ] [MainThread]: 
[0m22:58:58.813942 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 33.33 seconds (33.33s).
[0m22:58:58.818521 [debug] [MainThread]: Command end result
[0m22:58:58.849574 [info ] [MainThread]: 
[0m22:58:58.850287 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:58:58.850844 [info ] [MainThread]: 
[0m22:58:58.851372 [error] [MainThread]:   Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  SELECT list expression references column app_id which is neither grouped nor aggregated at [18:9]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m22:58:58.852001 [info ] [MainThread]: 
[0m22:58:58.852697 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m22:58:58.853756 [debug] [MainThread]: Command `dbt run` failed at 22:58:58.853556 after 33.84 seconds
[0m22:58:58.854722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b38d11180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b384a7ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b344bea10>]}
[0m22:58:58.855351 [debug] [MainThread]: Flushing usage events
[0m23:02:30.924719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1737532b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17356c4070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17356c40d0>]}


============================== 23:02:30.926919 | a65e3364-0870-4d63-96f0-24d3cbad388d ==============================
[0m23:02:30.926919 [info ] [MainThread]: Running with dbt=1.6.5
[0m23:02:30.927506 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '../dbt/', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:02:31.516054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a65e3364-0870-4d63-96f0-24d3cbad388d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1736b4c7c0>]}
[0m23:02:31.532243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a65e3364-0870-4d63-96f0-24d3cbad388d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17336649d0>]}
[0m23:02:31.544608 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m23:02:31.559018 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m23:02:31.629834 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:02:31.630628 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m23:02:31.704410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a65e3364-0870-4d63-96f0-24d3cbad388d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17334b40d0>]}
[0m23:02:31.911675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a65e3364-0870-4d63-96f0-24d3cbad388d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f173346fdf0>]}
[0m23:02:31.913886 [info ] [MainThread]: Found 7 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m23:02:31.915849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a65e3364-0870-4d63-96f0-24d3cbad388d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f173346fd60>]}
[0m23:02:31.922294 [info ] [MainThread]: 
[0m23:02:31.925602 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:02:31.931715 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m23:02:31.933767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:02:32.819672 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m23:02:32.822089 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:02:33.529449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a65e3364-0870-4d63-96f0-24d3cbad388d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17356980a0>]}
[0m23:02:33.594427 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:02:33.595844 [info ] [MainThread]: 
[0m23:02:33.601138 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m23:02:33.602346 [info ] [Thread-1 (]: 1 of 7 START sql table model games.dim_developers .............................. [RUN]
[0m23:02:33.603846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m23:02:33.604697 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m23:02:33.616616 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m23:02:33.825782 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 23:02:33.605300 => 23:02:33.824647
[0m23:02:33.827966 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m23:02:33.875123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:02:34.653063 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m23:02:34.654768 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m23:02:35.159098 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:69c26860-04af-4c43-a9f4-c3047e4ea51d&page=queryresults
[0m23:02:38.869667 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 23:02:33.829478 => 23:02:38.869400
[0m23:02:38.870643 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a65e3364-0870-4d63-96f0-24d3cbad388d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1736df4ca0>]}
[0m23:02:38.871427 [info ] [Thread-1 (]: 1 of 7 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 5.27s]
[0m23:02:38.872270 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m23:02:38.872874 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m23:02:38.873584 [info ] [Thread-1 (]: 2 of 7 START sql table model games.dim_platforms ............................... [RUN]
[0m23:02:38.874342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m23:02:38.874814 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m23:02:38.878043 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m23:02:38.901742 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 23:02:38.875147 => 23:02:38.900401
[0m23:02:38.903760 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m23:02:38.929298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:02:39.701305 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m23:02:39.713507 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m23:02:40.246906 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:906a71a5-13e7-4a68-bff0-5e5561888117&page=queryresults
[0m23:02:43.621964 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 23:02:38.905108 => 23:02:43.621081
[0m23:02:43.625108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a65e3364-0870-4d63-96f0-24d3cbad388d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1732bd21d0>]}
[0m23:02:43.627810 [info ] [Thread-1 (]: 2 of 7 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.75s]
[0m23:02:43.630748 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m23:02:43.632984 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m23:02:43.636901 [info ] [Thread-1 (]: 3 of 7 START sql table model games.dim_price_overview .......................... [RUN]
[0m23:02:43.640733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m23:02:43.643506 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m23:02:43.652805 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m23:02:43.654220 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 23:02:43.644620 => 23:02:43.653818
[0m23:02:43.654992 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m23:02:43.659083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:02:44.397983 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m23:02:44.398650 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m23:02:45.010399 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:046167a9-43ee-4986-a6e5-5eb5d530c5a2&page=queryresults
[0m23:02:48.399180 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 23:02:43.655538 => 23:02:48.398309
[0m23:02:48.402497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a65e3364-0870-4d63-96f0-24d3cbad388d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1732bc7be0>]}
[0m23:02:48.405151 [info ] [Thread-1 (]: 3 of 7 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (1.1k rows, 114.2 KiB processed)[0m in 4.76s]
[0m23:02:48.408307 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m23:02:48.410398 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m23:02:48.412907 [info ] [Thread-1 (]: 4 of 7 START sql table model games.dim_publishers .............................. [RUN]
[0m23:02:48.415645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m23:02:48.416944 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m23:02:48.423863 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m23:02:48.425066 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 23:02:48.417854 => 23:02:48.424682
[0m23:02:48.425809 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m23:02:48.429753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:02:49.162132 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m23:02:49.163912 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m23:02:49.743748 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:82bbc267-1ecb-4e7f-b786-3ed7248a0f62&page=queryresults
[0m23:02:53.521757 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 23:02:48.426335 => 23:02:53.521410
[0m23:02:53.547274 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a65e3364-0870-4d63-96f0-24d3cbad388d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1732bc5720>]}
[0m23:02:53.549996 [info ] [Thread-1 (]: 4 of 7 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 5.13s]
[0m23:02:53.551010 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m23:02:53.551466 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m23:02:53.551927 [info ] [Thread-1 (]: 5 of 7 START sql table model games.dim_release ................................. [RUN]
[0m23:02:53.552603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m23:02:53.552968 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m23:02:53.555664 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m23:02:53.998525 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 23:02:53.553228 => 23:02:53.997465
[0m23:02:54.000455 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m23:02:54.031345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:02:54.800299 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m23:02:54.948587 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m23:02:55.409347 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:1678a4c5-f40f-421d-932f-b2f01efc3897&page=queryresults
[0m23:02:59.365979 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 23:02:54.001779 => 23:02:59.365103
[0m23:02:59.369193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a65e3364-0870-4d63-96f0-24d3cbad388d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1736df4ca0>]}
[0m23:02:59.371760 [info ] [Thread-1 (]: 5 of 7 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 5.82s]
[0m23:02:59.374553 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m23:02:59.376618 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m23:02:59.378717 [info ] [Thread-1 (]: 6 of 7 START sql table model games.dim_support_language ........................ [RUN]
[0m23:02:59.381952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m23:02:59.383864 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m23:02:59.391164 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m23:02:59.418859 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 23:02:59.385184 => 23:02:59.418546
[0m23:02:59.419294 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m23:02:59.421501 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:03:00.180058 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m23:03:00.293692 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m23:03:00.773211 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:8a8a6f1f-c695-44d3-825b-eca2a27ef0b2&page=queryresults
[0m23:03:04.403196 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 23:02:59.419560 => 23:03:04.402337
[0m23:03:04.406326 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a65e3364-0870-4d63-96f0-24d3cbad388d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17334d4df0>]}
[0m23:03:04.408906 [info ] [Thread-1 (]: 6 of 7 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 5.03s]
[0m23:03:04.411765 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m23:03:04.413799 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m23:03:04.416260 [info ] [Thread-1 (]: 7 of 7 START sql table model games.fct_game_pricing ............................ [RUN]
[0m23:03:04.419178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m23:03:04.421050 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m23:03:04.434457 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m23:03:04.823775 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 23:03:04.422349 => 23:03:04.822660
[0m23:03:04.825722 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m23:03:04.830253 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m23:03:04.937978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:03:05.008599 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Calcular el precio promedio de juego vendido
WITH avg_game_price AS (
    SELECT
        AVG(price_with_tax) AS avg_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Encontrar el juego con el precio más alto
max_game_price AS (
    SELECT
        MAX(price_with_tax) AS max_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Encontrar el juego con el precio más bajo
min_game_price AS (
    SELECT
        MIN(price_with_tax) AS min_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Agregar un campo de ingresos totales
total_revenue AS (
    SELECT
        SUM(price_with_tax) AS revenue
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Agregar un campo de descuentos totales
total_discounts AS (
    SELECT
        SUM(discount_amount) AS total_discount
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Calcular ganancias totales
total_gross_profit AS (
    SELECT
        (total_revenue.revenue - total_discounts.total_discount) AS gross_profit
    FROM total_revenue
)

-- Combinar todas las medidas en la tabla de hechos
SELECT
    ROW_NUMBER() OVER () AS fct_id,
    avg_price,
    max_price,
    min_price,
    total_discount,
    gross_profit
FROM
    avg_game_price, max_game_price, min_game_price, total_discounts, total_gross_profit
    );
  
[0m23:03:05.865682 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:751c57b6-cc8f-4353-b36b-1094f5a4179c&page=queryresults
[0m23:03:06.411318 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: total_discounts at [53:34]')
[0m23:03:07.486083 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ac681ea0-9c58-4f2b-b60f-8b3b6ecbd9bb&page=queryresults
[0m23:03:08.023376 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ac681ea0-9c58-4f2b-b60f-8b3b6ecbd9bb&page=queryresults
[0m23:03:08.026601 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 23:03:04.827048 => 23:03:08.025644
[0m23:03:08.040074 [debug] [Thread-1 (]: Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Unrecognized name: total_discounts at [53:34]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m23:03:08.042111 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a65e3364-0870-4d63-96f0-24d3cbad388d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1733648340>]}
[0m23:03:08.044787 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model games.fct_game_pricing ................... [[31mERROR[0m in 3.62s]
[0m23:03:08.047634 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m23:03:08.053675 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:03:08.055318 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m23:03:08.057172 [info ] [MainThread]: 
[0m23:03:08.059040 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 36.13 seconds (36.13s).
[0m23:03:08.066401 [debug] [MainThread]: Command end result
[0m23:03:08.168868 [info ] [MainThread]: 
[0m23:03:08.170793 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:03:08.172537 [info ] [MainThread]: 
[0m23:03:08.174189 [error] [MainThread]:   Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Unrecognized name: total_discounts at [53:34]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m23:03:08.175898 [info ] [MainThread]: 
[0m23:03:08.177621 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m23:03:08.180330 [debug] [MainThread]: Command `dbt run` failed at 23:03:08.179867 after 37.27 seconds
[0m23:03:08.182330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1737532b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f173569bf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17356980a0>]}
[0m23:03:08.184273 [debug] [MainThread]: Flushing usage events
[0m23:04:35.607774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb27932b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb25994070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb259940d0>]}


============================== 23:04:35.611881 | 5fe1c4f6-6237-4f52-abb1-b63ab63ab219 ==============================
[0m23:04:35.611881 [info ] [MainThread]: Running with dbt=1.6.5
[0m23:04:35.612785 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:04:36.196689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fe1c4f6-6237-4f52-abb1-b63ab63ab219', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb23916c50>]}
[0m23:04:36.213668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fe1c4f6-6237-4f52-abb1-b63ab63ab219', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb23930640>]}
[0m23:04:36.214354 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m23:04:36.229122 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m23:04:36.299795 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:04:36.300202 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:04:36.305849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fe1c4f6-6237-4f52-abb1-b63ab63ab219', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb2377e230>]}
[0m23:04:36.315460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fe1c4f6-6237-4f52-abb1-b63ab63ab219', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb237605b0>]}
[0m23:04:36.315938 [info ] [MainThread]: Found 7 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m23:04:36.316295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fe1c4f6-6237-4f52-abb1-b63ab63ab219', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb23762290>]}
[0m23:04:36.317715 [info ] [MainThread]: 
[0m23:04:36.318448 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:04:36.319762 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m23:04:36.320183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:04:37.077913 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m23:04:37.079959 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:04:37.831138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fe1c4f6-6237-4f52-abb1-b63ab63ab219', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb237609a0>]}
[0m23:04:37.831900 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:04:37.832287 [info ] [MainThread]: 
[0m23:04:37.834356 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m23:04:37.834883 [info ] [Thread-1 (]: 1 of 7 START sql table model games.dim_developers .............................. [RUN]
[0m23:04:37.835570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m23:04:37.835982 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m23:04:37.843978 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m23:04:37.966594 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 23:04:37.836270 => 23:04:37.965346
[0m23:04:37.969169 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m23:04:38.007100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:04:38.799499 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m23:04:38.800208 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m23:04:39.323778 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ea39fe69-7ad8-4c6b-9f47-2d291b1833e5&page=queryresults
[0m23:04:42.748833 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 23:04:37.970505 => 23:04:42.748526
[0m23:04:42.749957 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fe1c4f6-6237-4f52-abb1-b63ab63ab219', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb23914730>]}
[0m23:04:42.751156 [info ] [Thread-1 (]: 1 of 7 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.91s]
[0m23:04:42.752300 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m23:04:42.753018 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m23:04:42.753837 [info ] [Thread-1 (]: 2 of 7 START sql table model games.dim_platforms ............................... [RUN]
[0m23:04:42.754717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m23:04:42.755247 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m23:04:42.758707 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m23:04:42.795352 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 23:04:42.755632 => 23:04:42.795046
[0m23:04:42.795844 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m23:04:42.802875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:04:43.537548 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m23:04:43.581055 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m23:04:44.126284 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ca0481e8-c517-4e83-a5ad-76b86f5b4d5a&page=queryresults
[0m23:04:47.239495 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 23:04:42.796140 => 23:04:47.238635
[0m23:04:47.242573 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fe1c4f6-6237-4f52-abb1-b63ab63ab219', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb23676260>]}
[0m23:04:47.245138 [info ] [Thread-1 (]: 2 of 7 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.49s]
[0m23:04:47.247929 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m23:04:47.249955 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m23:04:47.252343 [info ] [Thread-1 (]: 3 of 7 START sql table model games.dim_price_overview .......................... [RUN]
[0m23:04:47.255283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m23:04:47.257106 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m23:04:47.267417 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m23:04:47.419077 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 23:04:47.258391 => 23:04:47.417974
[0m23:04:47.421073 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m23:04:47.431296 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:04:48.205206 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m23:04:48.357874 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m23:04:48.816459 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e7db5d92-3db8-4b4e-ab76-f6cf2e940e7e&page=queryresults
[0m23:04:52.877875 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 23:04:47.422411 => 23:04:52.877689
[0m23:04:52.889921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fe1c4f6-6237-4f52-abb1-b63ab63ab219', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb2365bbb0>]}
[0m23:04:52.890696 [info ] [Thread-1 (]: 3 of 7 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (1.1k rows, 114.2 KiB processed)[0m in 5.64s]
[0m23:04:52.891382 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m23:04:52.891867 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m23:04:52.892352 [info ] [Thread-1 (]: 4 of 7 START sql table model games.dim_publishers .............................. [RUN]
[0m23:04:52.893140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m23:04:52.893686 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m23:04:52.896557 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m23:04:52.898000 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 23:04:52.894001 => 23:04:52.897783
[0m23:04:52.898448 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m23:04:52.900907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:04:53.653285 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m23:04:54.020607 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m23:04:54.722596 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:581a669c-d8f4-44d2-afed-ee55682c12d4&page=queryresults
[0m23:04:58.352683 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 23:04:52.898714 => 23:04:58.352501
[0m23:04:58.353413 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fe1c4f6-6237-4f52-abb1-b63ab63ab219', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb2365bbb0>]}
[0m23:04:58.353971 [info ] [Thread-1 (]: 4 of 7 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 5.46s]
[0m23:04:58.354582 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m23:04:58.355046 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m23:04:58.355555 [info ] [Thread-1 (]: 5 of 7 START sql table model games.dim_release ................................. [RUN]
[0m23:04:58.356176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m23:04:58.356536 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m23:04:58.359154 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m23:04:58.359761 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 23:04:58.356794 => 23:04:58.359565
[0m23:04:58.360138 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m23:04:58.369239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:04:59.082928 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m23:04:59.084365 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m23:04:59.549262 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:8a0833cf-4f14-46bc-a53c-5892b7e788ea&page=queryresults
[0m23:05:03.818264 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 23:04:58.360399 => 23:05:03.817999
[0m23:05:03.819155 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fe1c4f6-6237-4f52-abb1-b63ab63ab219', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb236194e0>]}
[0m23:05:03.819784 [info ] [Thread-1 (]: 5 of 7 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 5.46s]
[0m23:05:03.820393 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m23:05:03.820866 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m23:05:03.821391 [info ] [Thread-1 (]: 6 of 7 START sql table model games.dim_support_language ........................ [RUN]
[0m23:05:03.822270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m23:05:03.822694 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m23:05:03.825930 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m23:05:03.826612 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 23:05:03.822973 => 23:05:03.826398
[0m23:05:03.827003 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m23:05:03.829316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:05:04.566294 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m23:05:04.882925 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m23:05:05.524270 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:11310ad2-3e75-4cac-aaaf-c57ad0a5b0b3&page=queryresults
[0m23:05:09.506249 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 23:05:03.827301 => 23:05:09.505383
[0m23:05:09.509348 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fe1c4f6-6237-4f52-abb1-b63ab63ab219', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb2373e770>]}
[0m23:05:09.511896 [info ] [Thread-1 (]: 6 of 7 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 5.69s]
[0m23:05:09.514690 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m23:05:09.516878 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m23:05:09.519180 [info ] [Thread-1 (]: 7 of 7 START sql table model games.fct_game_pricing ............................ [RUN]
[0m23:05:09.522117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m23:05:09.523949 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m23:05:09.535605 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m23:05:09.608105 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 23:05:09.525244 => 23:05:09.607010
[0m23:05:09.610006 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m23:05:09.623620 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m23:05:09.708414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:05:09.778094 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Calcular el precio promedio de juego vendido
WITH avg_game_price AS (
    SELECT
        AVG(price_with_tax) AS avg_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Encontrar el juego con el precio más alto
max_game_price AS (
    SELECT
        MAX(price_with_tax) AS max_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Encontrar el juego con el precio más bajo
min_game_price AS (
    SELECT
        MIN(price_with_tax) AS min_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Agregar un campo de ingresos totales
total_revenue AS (
    SELECT
        SUM(price_with_tax) AS revenue
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Agregar un campo de descuentos totales
total_discounts AS (
    SELECT
        SUM(discount_amount) AS total_discount
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Calcular ganancias totales
total_gross_profit AS (
    SELECT
        (total_revenue.revenue - total_discounts.total_discount) AS gross_profit
    FROM total_revenue
)

-- Combinar todas las medidas en la tabla de hechos
SELECT
    ROW_NUMBER() OVER () AS fct_id,
    avg_price,
    max_price,
    min_price,
    total_discount,
    gross_profit
FROM
    avg_game_price, max_game_price, min_game_price, total_discounts, total_gross_profit
    );
  
[0m23:05:10.838448 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:113e9c6d-4097-494a-adca-f1b73180601b&page=queryresults
[0m23:05:11.750719 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: total_discounts at [53:34]')
[0m23:05:13.123733 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f33bcc7b-1af0-4a7c-baad-37f78af0c03e&page=queryresults
[0m23:05:13.670936 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f33bcc7b-1af0-4a7c-baad-37f78af0c03e&page=queryresults
[0m23:05:13.671699 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 23:05:09.611301 => 23:05:13.671471
[0m23:05:13.674980 [debug] [Thread-1 (]: Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Unrecognized name: total_discounts at [53:34]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m23:05:13.675533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fe1c4f6-6237-4f52-abb1-b63ab63ab219', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb23917bb0>]}
[0m23:05:13.676202 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model games.fct_game_pricing ................... [[31mERROR[0m in 4.15s]
[0m23:05:13.676884 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m23:05:13.678550 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:05:13.678977 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m23:05:13.679430 [info ] [MainThread]: 
[0m23:05:13.679896 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 37.36 seconds (37.36s).
[0m23:05:13.681792 [debug] [MainThread]: Command end result
[0m23:05:14.022000 [info ] [MainThread]: 
[0m23:05:14.022634 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:05:14.023110 [info ] [MainThread]: 
[0m23:05:14.023593 [error] [MainThread]:   Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Unrecognized name: total_discounts at [53:34]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m23:05:14.024079 [info ] [MainThread]: 
[0m23:05:14.024581 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m23:05:14.025352 [debug] [MainThread]: Command `dbt run` failed at 23:05:14.025213 after 38.44 seconds
[0m23:05:14.025875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb27932b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb23761e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb23762230>]}
[0m23:05:14.026406 [debug] [MainThread]: Flushing usage events
[0m23:06:58.827545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde4e11eb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde4c2b0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde4c2b00d0>]}


============================== 23:06:58.829626 | 9ccc607a-d4a8-485c-8eac-d0adafebb31d ==============================
[0m23:06:58.829626 [info ] [MainThread]: Running with dbt=1.6.5
[0m23:06:58.830087 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'debug': 'False', 'profiles_dir': '../dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'send_anonymous_usage_stats': 'True'}
[0m23:06:59.107702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ccc607a-d4a8-485c-8eac-d0adafebb31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde4d7687c0>]}
[0m23:06:59.123347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ccc607a-d4a8-485c-8eac-d0adafebb31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde4a2509d0>]}
[0m23:06:59.123985 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m23:06:59.137618 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m23:06:59.202102 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:06:59.202646 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m23:06:59.245885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ccc607a-d4a8-485c-8eac-d0adafebb31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde4a0940d0>]}
[0m23:06:59.254414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ccc607a-d4a8-485c-8eac-d0adafebb31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde4a05bdf0>]}
[0m23:06:59.254863 [info ] [MainThread]: Found 7 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m23:06:59.255204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ccc607a-d4a8-485c-8eac-d0adafebb31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde4a05bd60>]}
[0m23:06:59.256541 [info ] [MainThread]: 
[0m23:06:59.257190 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:06:59.258403 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m23:06:59.258816 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:07:00.086921 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m23:07:00.088974 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:07:00.795005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ccc607a-d4a8-485c-8eac-d0adafebb31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde4a059f90>]}
[0m23:07:00.798240 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:07:00.799922 [info ] [MainThread]: 
[0m23:07:00.808333 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m23:07:00.810582 [info ] [Thread-1 (]: 1 of 7 START sql table model games.dim_developers .............................. [RUN]
[0m23:07:00.813296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m23:07:00.813876 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m23:07:00.820987 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m23:07:00.821693 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 23:07:00.814161 => 23:07:00.821475
[0m23:07:00.822086 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m23:07:00.835692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:07:01.647836 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m23:07:01.648634 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m23:07:02.191432 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:fce419a1-39a3-4e22-8a6a-971811afce84&page=queryresults
[0m23:07:05.370820 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 23:07:00.822341 => 23:07:05.370504
[0m23:07:05.371981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ccc607a-d4a8-485c-8eac-d0adafebb31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde4d9f8ca0>]}
[0m23:07:05.374767 [info ] [Thread-1 (]: 1 of 7 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.56s]
[0m23:07:05.375630 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m23:07:05.376236 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m23:07:05.376948 [info ] [Thread-1 (]: 2 of 7 START sql table model games.dim_platforms ............................... [RUN]
[0m23:07:05.377815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m23:07:05.378351 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m23:07:05.381694 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m23:07:05.382443 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 23:07:05.378730 => 23:07:05.382207
[0m23:07:05.382901 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m23:07:05.390232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:07:06.088557 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m23:07:06.089177 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m23:07:06.569616 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:338a2516-22e3-46ac-9cd7-fc212f2c5a77&page=queryresults
[0m23:07:10.669843 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 23:07:05.383230 => 23:07:10.668970
[0m23:07:10.672950 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ccc607a-d4a8-485c-8eac-d0adafebb31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde4d9f8dc0>]}
[0m23:07:10.675542 [info ] [Thread-1 (]: 2 of 7 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 5.30s]
[0m23:07:10.678380 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m23:07:10.680415 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m23:07:10.682835 [info ] [Thread-1 (]: 3 of 7 START sql table model games.dim_price_overview .......................... [RUN]
[0m23:07:10.685808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m23:07:10.687657 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m23:07:10.701048 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m23:07:10.703942 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 23:07:10.688957 => 23:07:10.702990
[0m23:07:10.705261 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m23:07:10.711523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:07:11.460471 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m23:07:11.461161 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m23:07:11.956941 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:dc4cc656-defd-44d0-8f2b-a45788b6a1f3&page=queryresults
[0m23:07:15.438755 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 23:07:10.706169 => 23:07:15.437873
[0m23:07:15.442117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ccc607a-d4a8-485c-8eac-d0adafebb31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde49982950>]}
[0m23:07:15.444692 [info ] [Thread-1 (]: 3 of 7 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (1.1k rows, 114.2 KiB processed)[0m in 4.76s]
[0m23:07:15.447509 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m23:07:15.449580 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m23:07:15.452302 [info ] [Thread-1 (]: 4 of 7 START sql table model games.dim_publishers .............................. [RUN]
[0m23:07:15.455393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m23:07:15.457261 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m23:07:15.468262 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m23:07:15.470038 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 23:07:15.458571 => 23:07:15.469557
[0m23:07:15.470970 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m23:07:15.475947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:07:16.238733 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m23:07:16.241436 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m23:07:16.821685 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:51f7551a-3ab5-432f-ac29-e0aeebaa8839&page=queryresults
[0m23:07:20.170125 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 23:07:15.471689 => 23:07:20.169939
[0m23:07:20.170861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ccc607a-d4a8-485c-8eac-d0adafebb31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde49982e00>]}
[0m23:07:20.171419 [info ] [Thread-1 (]: 4 of 7 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.72s]
[0m23:07:20.172086 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m23:07:20.172550 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m23:07:20.173109 [info ] [Thread-1 (]: 5 of 7 START sql table model games.dim_release ................................. [RUN]
[0m23:07:20.173792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m23:07:20.174196 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m23:07:20.177012 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m23:07:20.177649 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 23:07:20.174474 => 23:07:20.177450
[0m23:07:20.178034 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m23:07:20.186584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:07:20.955619 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m23:07:20.958284 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m23:07:21.509497 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:8727d86c-9e00-45fe-8319-5c90d1b58dd2&page=queryresults
[0m23:07:25.168187 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 23:07:20.178309 => 23:07:25.167271
[0m23:07:25.171352 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ccc607a-d4a8-485c-8eac-d0adafebb31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde4a234400>]}
[0m23:07:25.174132 [info ] [Thread-1 (]: 5 of 7 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 5.00s]
[0m23:07:25.177009 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m23:07:25.179053 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m23:07:25.181161 [info ] [Thread-1 (]: 6 of 7 START sql table model games.dim_support_language ........................ [RUN]
[0m23:07:25.184389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m23:07:25.186265 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m23:07:25.197674 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m23:07:25.199613 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 23:07:25.187606 => 23:07:25.199069
[0m23:07:25.200560 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m23:07:25.205350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:07:25.939214 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m23:07:25.941928 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m23:07:26.529872 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a69862c9-6f1a-4386-8226-d5232f16b458&page=queryresults
[0m23:07:29.870840 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 23:07:25.201229 => 23:07:29.869927
[0m23:07:29.874001 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ccc607a-d4a8-485c-8eac-d0adafebb31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde4a0e7c10>]}
[0m23:07:29.876583 [info ] [Thread-1 (]: 6 of 7 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.69s]
[0m23:07:29.879393 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m23:07:29.881472 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m23:07:29.884015 [info ] [Thread-1 (]: 7 of 7 START sql table model games.fct_game_pricing ............................ [RUN]
[0m23:07:29.886963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m23:07:29.888829 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m23:07:29.901278 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m23:07:29.902840 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 23:07:29.890132 => 23:07:29.902351
[0m23:07:29.903816 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m23:07:29.909599 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m23:07:29.910566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:07:29.946781 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Calcular el precio promedio de juego vendido
WITH avg_game_price AS (
    SELECT
        AVG(price_with_tax) AS avg_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Encontrar el juego con el precio más alto
max_game_price AS (
    SELECT
        MAX(price_with_tax) AS max_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Encontrar el juego con el precio más bajo
min_game_price AS (
    SELECT
        MIN(price_with_tax) AS min_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Agregar un campo de ingresos totales
total_revenue AS (
    SELECT
        SUM(price_with_tax) AS revenue
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Agregar un campo de descuentos totales
total_discounts AS (
    SELECT
        SUM(discount_amount) AS total_discount
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Calcular ganancias totales
total_gross_profit AS (
    SELECT
        (total_revenue.revenue - total_discounts.total_discount) AS gross_profit
    FROM total_revenue
)

-- Combinar todas las medidas en la tabla de hechos
SELECT
    ROW_NUMBER() OVER () AS fct_id,
    avg_price,
    max_price,
    min_price,
    gross_profit
FROM
    avg_game_price, max_game_price, min_game_price, total_gross_profit
    );
  
[0m23:07:30.830292 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:53dd0d7d-e0bd-4147-84ba-ac092b10efc2&page=queryresults
[0m23:07:31.379620 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: total_discounts at [53:34]')
[0m23:07:32.344708 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c7c2c22a-5171-4bfc-b646-0cd1ce158368&page=queryresults
[0m23:07:32.875805 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c7c2c22a-5171-4bfc-b646-0cd1ce158368&page=queryresults
[0m23:07:32.878824 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 23:07:29.904442 => 23:07:32.877890
[0m23:07:32.882677 [debug] [Thread-1 (]: Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Unrecognized name: total_discounts at [53:34]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m23:07:32.883136 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ccc607a-d4a8-485c-8eac-d0adafebb31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde4a237010>]}
[0m23:07:32.883734 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model games.fct_game_pricing ................... [[31mERROR[0m in 3.00s]
[0m23:07:32.884337 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m23:07:32.885848 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:07:32.886180 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m23:07:32.886542 [info ] [MainThread]: 
[0m23:07:32.886929 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 33.63 seconds (33.63s).
[0m23:07:32.888448 [debug] [MainThread]: Command end result
[0m23:07:32.902790 [info ] [MainThread]: 
[0m23:07:32.903363 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:07:32.903793 [info ] [MainThread]: 
[0m23:07:32.904149 [error] [MainThread]:   Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Unrecognized name: total_discounts at [53:34]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m23:07:32.904505 [info ] [MainThread]: 
[0m23:07:32.904870 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m23:07:32.905445 [debug] [MainThread]: Command `dbt run` failed at 23:07:32.905343 after 34.08 seconds
[0m23:07:32.905827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde4e11eb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde4d94c7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde499f7f10>]}
[0m23:07:32.906210 [debug] [MainThread]: Flushing usage events
[0m23:08:21.885882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd233d2eb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd231d8c070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd231d8c0d0>]}


============================== 23:08:21.888003 | 9d92201c-48b1-48f0-85c7-c23905659a78 ==============================
[0m23:08:21.888003 [info ] [MainThread]: Running with dbt=1.6.5
[0m23:08:21.888457 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'profiles_dir': '../dbt/', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:08:22.163416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d92201c-48b1-48f0-85c7-c23905659a78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2332dc7c0>]}
[0m23:08:22.178974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d92201c-48b1-48f0-85c7-c23905659a78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd22fd289d0>]}
[0m23:08:22.179640 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m23:08:22.193193 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m23:08:22.256993 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:08:22.257542 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m23:08:22.300572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d92201c-48b1-48f0-85c7-c23905659a78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd22fbe40d0>]}
[0m23:08:22.309156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d92201c-48b1-48f0-85c7-c23905659a78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd22fb33df0>]}
[0m23:08:22.309612 [info ] [MainThread]: Found 7 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m23:08:22.309960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d92201c-48b1-48f0-85c7-c23905659a78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd22fb33d60>]}
[0m23:08:22.311273 [info ] [MainThread]: 
[0m23:08:22.311956 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:08:22.313203 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m23:08:22.313615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:08:23.084976 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m23:08:23.085609 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:08:23.785458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d92201c-48b1-48f0-85c7-c23905659a78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd22fb31f90>]}
[0m23:08:23.786152 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:08:23.786497 [info ] [MainThread]: 
[0m23:08:23.788338 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m23:08:23.788839 [info ] [Thread-1 (]: 1 of 7 START sql table model games.dim_developers .............................. [RUN]
[0m23:08:23.789520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m23:08:23.789911 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m23:08:23.797405 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m23:08:23.798135 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 23:08:23.790184 => 23:08:23.797898
[0m23:08:23.798569 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m23:08:23.813434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:08:24.601684 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m23:08:24.602352 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m23:08:25.073776 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ecfc8f73-df94-4515-b860-bbe1b87b705b&page=queryresults
[0m23:08:28.779418 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 23:08:23.798871 => 23:08:28.779099
[0m23:08:28.780408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d92201c-48b1-48f0-85c7-c23905659a78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd233588ca0>]}
[0m23:08:28.781225 [info ] [Thread-1 (]: 1 of 7 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.99s]
[0m23:08:28.782064 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m23:08:28.782669 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m23:08:28.783388 [info ] [Thread-1 (]: 2 of 7 START sql table model games.dim_platforms ............................... [RUN]
[0m23:08:28.784274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m23:08:28.784772 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m23:08:28.788015 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m23:08:28.788772 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 23:08:28.785116 => 23:08:28.788531
[0m23:08:28.789240 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m23:08:28.795962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:08:29.597884 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m23:08:29.598609 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m23:08:30.077100 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:6b77e20d-856d-4490-95e6-b3607e1382fb&page=queryresults
[0m23:08:33.517972 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 23:08:28.789561 => 23:08:33.517102
[0m23:08:33.521100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d92201c-48b1-48f0-85c7-c23905659a78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd233588dc0>]}
[0m23:08:33.523656 [info ] [Thread-1 (]: 2 of 7 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.74s]
[0m23:08:33.526452 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m23:08:33.528508 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m23:08:33.530892 [info ] [Thread-1 (]: 3 of 7 START sql table model games.dim_price_overview .......................... [RUN]
[0m23:08:33.533899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m23:08:33.535761 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m23:08:33.542446 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m23:08:33.543127 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 23:08:33.537067 => 23:08:33.542908
[0m23:08:33.543509 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m23:08:33.545633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:08:34.237122 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m23:08:34.240060 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m23:08:34.842026 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:217ceee3-e163-440d-9ee8-a2d7002f739e&page=queryresults
[0m23:08:37.616391 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 23:08:33.543786 => 23:08:37.615476
[0m23:08:37.619734 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d92201c-48b1-48f0-85c7-c23905659a78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd22f45b250>]}
[0m23:08:37.622315 [info ] [Thread-1 (]: 3 of 7 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (1.1k rows, 114.2 KiB processed)[0m in 4.09s]
[0m23:08:37.625188 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m23:08:37.627231 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m23:08:37.629955 [info ] [Thread-1 (]: 4 of 7 START sql table model games.dim_publishers .............................. [RUN]
[0m23:08:37.633102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m23:08:37.634970 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m23:08:37.641442 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m23:08:37.642154 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 23:08:37.636315 => 23:08:37.641905
[0m23:08:37.642548 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m23:08:37.644761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:08:38.439251 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m23:08:38.440379 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m23:08:39.058074 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:8700380a-76a4-4961-8906-b22c9d712bdf&page=queryresults
[0m23:08:42.218989 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 23:08:37.642821 => 23:08:42.218098
[0m23:08:42.222284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d92201c-48b1-48f0-85c7-c23905659a78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd22f45ae90>]}
[0m23:08:42.224866 [info ] [Thread-1 (]: 4 of 7 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.59s]
[0m23:08:42.227729 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m23:08:42.229771 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m23:08:42.232260 [info ] [Thread-1 (]: 5 of 7 START sql table model games.dim_release ................................. [RUN]
[0m23:08:42.235384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m23:08:42.237255 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m23:08:42.243231 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m23:08:42.243985 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 23:08:42.238564 => 23:08:42.243758
[0m23:08:42.244384 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m23:08:42.252252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:08:43.005869 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m23:08:43.006675 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m23:08:43.528650 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5bec1916-21df-476d-886f-b54f4d4fc254&page=queryresults
[0m23:08:49.492552 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 23:08:42.244642 => 23:08:49.491660
[0m23:08:49.495682 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d92201c-48b1-48f0-85c7-c23905659a78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd22fd0c400>]}
[0m23:08:49.498232 [info ] [Thread-1 (]: 5 of 7 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 7.26s]
[0m23:08:49.501077 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m23:08:49.503115 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m23:08:49.505543 [info ] [Thread-1 (]: 6 of 7 START sql table model games.dim_support_language ........................ [RUN]
[0m23:08:49.508523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m23:08:49.510371 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m23:08:49.517213 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m23:08:49.517910 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 23:08:49.511712 => 23:08:49.517684
[0m23:08:49.518312 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m23:08:49.520479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:08:50.241740 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m23:08:50.242484 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m23:08:50.821562 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:3b7709b1-c19f-4c02-85b3-c9468dba1926&page=queryresults
[0m23:08:53.870369 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 23:08:49.518571 => 23:08:53.869464
[0m23:08:53.873526 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d92201c-48b1-48f0-85c7-c23905659a78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd22fbbb580>]}
[0m23:08:53.876195 [info ] [Thread-1 (]: 6 of 7 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.37s]
[0m23:08:53.879101 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m23:08:53.881219 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m23:08:53.883724 [info ] [Thread-1 (]: 7 of 7 START sql table model games.fct_game_pricing ............................ [RUN]
[0m23:08:53.886726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m23:08:53.888605 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m23:08:53.896128 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m23:08:53.896850 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 23:08:53.889922 => 23:08:53.896626
[0m23:08:53.897242 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m23:08:53.900174 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m23:08:53.900735 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:08:53.932780 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Calcular el precio promedio de juego vendido
WITH avg_game_price AS (
    SELECT
        AVG(price_with_tax) AS avg_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Encontrar el juego con el precio más alto
max_game_price AS (
    SELECT
        MAX(price_with_tax) AS max_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Encontrar el juego con el precio más bajo
min_game_price AS (
    SELECT
        MIN(price_with_tax) AS min_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Agregar un campo de ingresos totales
total_revenue AS (
    SELECT
        SUM(price_with_tax) AS revenue
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Agregar un campo de descuentos totales
-- total_discounts AS (
--     SELECT
--         SUM(discount_amount) AS total_discount
--     FROM `pristine-flames-400818`.`games`.`dim_price_overview`
-- ),

-- Calcular ganancias totales
total_gross_profit AS (
    SELECT
        (total_revenue.revenue - total_discounts.total_discount) AS gross_profit
    FROM total_revenue
)

-- Combinar todas las medidas en la tabla de hechos
SELECT
    ROW_NUMBER() OVER () AS fct_id,
    avg_price,
    max_price,
    min_price,
    gross_profit
FROM
    avg_game_price, max_game_price, min_game_price, total_gross_profit
    );
  
[0m23:08:54.759788 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f0fb4993-2f08-428b-84eb-4c51fabb5dde&page=queryresults
[0m23:08:55.267216 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: total_discounts at [53:34]')
[0m23:08:56.377235 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b46e7cac-016e-4819-a2a6-15cb054d6366&page=queryresults
[0m23:08:56.906070 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b46e7cac-016e-4819-a2a6-15cb054d6366&page=queryresults
[0m23:08:56.906874 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 23:08:53.897502 => 23:08:56.906635
[0m23:08:56.910334 [debug] [Thread-1 (]: Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Unrecognized name: total_discounts at [53:34]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m23:08:56.910926 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d92201c-48b1-48f0-85c7-c23905659a78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd22fd0f010>]}
[0m23:08:56.911665 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model games.fct_game_pricing ................... [[31mERROR[0m in 3.03s]
[0m23:08:56.912436 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m23:08:56.914181 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:08:56.914614 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m23:08:56.915069 [info ] [MainThread]: 
[0m23:08:56.915533 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 34.60 seconds (34.60s).
[0m23:08:56.917490 [debug] [MainThread]: Command end result
[0m23:08:56.930531 [info ] [MainThread]: 
[0m23:08:56.930991 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:08:56.931366 [info ] [MainThread]: 
[0m23:08:56.931809 [error] [MainThread]:   Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Unrecognized name: total_discounts at [53:34]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m23:08:56.932185 [info ] [MainThread]: 
[0m23:08:56.932588 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m23:08:56.933166 [debug] [MainThread]: Command `dbt run` failed at 23:08:56.933069 after 35.05 seconds
[0m23:08:56.933667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd233d2eb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd231f5ff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd231f5feb0>]}
[0m23:08:56.934101 [debug] [MainThread]: Flushing usage events
[0m23:09:26.875233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffae212eb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffae0290070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffae02900d0>]}


============================== 23:09:26.877296 | b84678fa-37cd-4c48-92e6-42cea5ed05ff ==============================
[0m23:09:26.877296 [info ] [MainThread]: Running with dbt=1.6.5
[0m23:09:26.877778 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:09:27.151999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b84678fa-37cd-4c48-92e6-42cea5ed05ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffae17007c0>]}
[0m23:09:27.167453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b84678fa-37cd-4c48-92e6-42cea5ed05ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffade2309d0>]}
[0m23:09:27.168145 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m23:09:27.181764 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m23:09:27.245319 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:09:27.245857 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m23:09:27.288928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b84678fa-37cd-4c48-92e6-42cea5ed05ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffade0ec0d0>]}
[0m23:09:27.297536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b84678fa-37cd-4c48-92e6-42cea5ed05ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffade03fdf0>]}
[0m23:09:27.297989 [info ] [MainThread]: Found 7 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m23:09:27.298336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b84678fa-37cd-4c48-92e6-42cea5ed05ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffade03fd60>]}
[0m23:09:27.299680 [info ] [MainThread]: 
[0m23:09:27.300324 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:09:27.301560 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m23:09:27.301975 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:09:28.167940 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m23:09:28.170075 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:09:28.925173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b84678fa-37cd-4c48-92e6-42cea5ed05ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffae04600a0>]}
[0m23:09:28.926278 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:09:28.926662 [info ] [MainThread]: 
[0m23:09:28.928760 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m23:09:28.929225 [info ] [Thread-1 (]: 1 of 7 START sql table model games.dim_developers .............................. [RUN]
[0m23:09:28.929889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m23:09:28.930275 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m23:09:28.937384 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m23:09:28.938076 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 23:09:28.930548 => 23:09:28.937851
[0m23:09:28.938480 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m23:09:28.951739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:09:29.746751 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m23:09:29.747600 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m23:09:30.271682 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:0e11902a-fa6c-43fc-ba65-a9d6489c718d&page=queryresults
[0m23:09:33.196936 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 23:09:28.938736 => 23:09:33.196628
[0m23:09:33.198056 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b84678fa-37cd-4c48-92e6-42cea5ed05ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffadd953fd0>]}
[0m23:09:33.198964 [info ] [Thread-1 (]: 1 of 7 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.27s]
[0m23:09:33.199898 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m23:09:33.200496 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m23:09:33.201206 [info ] [Thread-1 (]: 2 of 7 START sql table model games.dim_platforms ............................... [RUN]
[0m23:09:33.202060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m23:09:33.202598 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m23:09:33.206050 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m23:09:33.206796 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 23:09:33.202974 => 23:09:33.206562
[0m23:09:33.207256 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m23:09:33.214374 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:09:33.942199 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m23:09:33.944948 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m23:09:34.415667 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f34233fd-a96e-4b54-bb31-31d9f81010c0&page=queryresults
[0m23:09:38.067426 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 23:09:33.207600 => 23:09:38.067241
[0m23:09:38.068167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b84678fa-37cd-4c48-92e6-42cea5ed05ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffadd995f90>]}
[0m23:09:38.068711 [info ] [Thread-1 (]: 2 of 7 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.87s]
[0m23:09:38.069309 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m23:09:38.069760 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m23:09:38.070236 [info ] [Thread-1 (]: 3 of 7 START sql table model games.dim_price_overview .......................... [RUN]
[0m23:09:38.070977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m23:09:38.071350 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m23:09:38.074174 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m23:09:38.074776 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 23:09:38.071679 => 23:09:38.074591
[0m23:09:38.075134 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m23:09:38.077197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:09:38.814171 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m23:09:38.817406 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m23:09:39.283643 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a3e51b37-ab4d-46b9-bbbd-1f75ef36a8e5&page=queryresults
[0m23:09:42.582700 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 23:09:38.075386 => 23:09:42.582424
[0m23:09:42.583740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b84678fa-37cd-4c48-92e6-42cea5ed05ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffadd9632b0>]}
[0m23:09:42.584544 [info ] [Thread-1 (]: 3 of 7 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (1.1k rows, 114.2 KiB processed)[0m in 4.51s]
[0m23:09:42.585514 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m23:09:42.586214 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m23:09:42.587154 [info ] [Thread-1 (]: 4 of 7 START sql table model games.dim_publishers .............................. [RUN]
[0m23:09:42.588225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m23:09:42.588850 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m23:09:42.593761 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m23:09:42.594948 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 23:09:42.589287 => 23:09:42.594521
[0m23:09:42.595773 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m23:09:42.600555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:09:43.359052 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m23:09:43.359799 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m23:09:43.795925 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:dfe626fe-03a8-4e1c-9bbd-02e3dd42e576&page=queryresults
[0m23:09:47.000505 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 23:09:42.596354 => 23:09:46.999625
[0m23:09:47.003756 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b84678fa-37cd-4c48-92e6-42cea5ed05ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffadd963df0>]}
[0m23:09:47.006294 [info ] [Thread-1 (]: 4 of 7 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.42s]
[0m23:09:47.009129 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m23:09:47.011145 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m23:09:47.013570 [info ] [Thread-1 (]: 5 of 7 START sql table model games.dim_release ................................. [RUN]
[0m23:09:47.016664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m23:09:47.018505 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m23:09:47.026788 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m23:09:47.028344 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 23:09:47.019794 => 23:09:47.027840
[0m23:09:47.029268 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m23:09:47.042618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:09:47.780062 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m23:09:47.782803 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m23:09:48.312145 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9a910b7d-604a-4199-8ccd-4bb1bf57acbe&page=queryresults
[0m23:09:51.332702 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 23:09:47.029876 => 23:09:51.332425
[0m23:09:51.333715 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b84678fa-37cd-4c48-92e6-42cea5ed05ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffae19b0dc0>]}
[0m23:09:51.334520 [info ] [Thread-1 (]: 5 of 7 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.32s]
[0m23:09:51.335366 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m23:09:51.335994 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m23:09:51.336724 [info ] [Thread-1 (]: 6 of 7 START sql table model games.dim_support_language ........................ [RUN]
[0m23:09:51.337633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m23:09:51.338186 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m23:09:51.342698 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m23:09:51.343693 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 23:09:51.338578 => 23:09:51.343371
[0m23:09:51.344253 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m23:09:51.347438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:09:52.058058 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m23:09:52.060837 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m23:09:52.551305 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5fb8b902-6a9a-483a-a098-4833c69b280d&page=queryresults
[0m23:09:55.892472 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 23:09:51.344638 => 23:09:55.891575
[0m23:09:55.895599 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b84678fa-37cd-4c48-92e6-42cea5ed05ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffade2144c0>]}
[0m23:09:55.898158 [info ] [Thread-1 (]: 6 of 7 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.56s]
[0m23:09:55.901073 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m23:09:55.903115 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m23:09:55.905269 [info ] [Thread-1 (]: 7 of 7 START sql table model games.fct_game_pricing ............................ [RUN]
[0m23:09:55.908495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m23:09:55.910386 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m23:09:55.921809 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m23:09:55.923384 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 23:09:55.911722 => 23:09:55.922883
[0m23:09:55.924209 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m23:09:55.929938 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m23:09:55.930928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:09:55.967003 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Calcular el precio promedio de juego vendido
WITH avg_game_price AS (
    SELECT
        AVG(price_with_tax) AS avg_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Encontrar el juego con el precio más alto
max_game_price AS (
    SELECT
        MAX(price_with_tax) AS max_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Encontrar el juego con el precio más bajo
min_game_price AS (
    SELECT
        MIN(price_with_tax) AS min_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Agregar un campo de ingresos totales
total_revenue AS (
    SELECT
        SUM(price_with_tax) AS revenue
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Agregar un campo de descuentos totales
-- total_discounts AS (
--     SELECT
--         SUM(discount_amount) AS total_discount
--     FROM `pristine-flames-400818`.`games`.`dim_price_overview`
-- ),

-- Calcular ganancias totales
-- total_gross_profit AS (
--     SELECT
--         (total_revenue.revenue - total_discounts.total_discount) AS gross_profit
--     FROM total_revenue
-- )

-- Combinar todas las medidas en la tabla de hechos
SELECT
    ROW_NUMBER() OVER () AS fct_id,
    avg_price,
    max_price,
    min_price,
FROM
    avg_game_price, max_game_price, min_game_price
    );
  
[0m23:09:56.676562 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b271849b-987f-47a9-8731-237d9859edaa&page=queryresults
[0m23:09:56.680820 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [58:1]')
[0m23:09:57.267036 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d02a323d-7645-4469-a449-cb09b2adae75&page=queryresults
[0m23:09:57.269434 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d02a323d-7645-4469-a449-cb09b2adae75&page=queryresults
[0m23:09:57.270054 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 23:09:55.924744 => 23:09:57.269858
[0m23:09:57.273274 [debug] [Thread-1 (]: Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [58:1]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m23:09:57.273847 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b84678fa-37cd-4c48-92e6-42cea5ed05ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffade2142e0>]}
[0m23:09:57.274475 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model games.fct_game_pricing ................... [[31mERROR[0m in 1.37s]
[0m23:09:57.275120 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m23:09:57.276608 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:09:57.276958 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m23:09:57.277325 [info ] [MainThread]: 
[0m23:09:57.277686 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 29.98 seconds (29.98s).
[0m23:09:57.279279 [debug] [MainThread]: Command end result
[0m23:09:57.292894 [info ] [MainThread]: 
[0m23:09:57.293340 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:09:57.293712 [info ] [MainThread]: 
[0m23:09:57.294082 [error] [MainThread]:   Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [58:1]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m23:09:57.294555 [info ] [MainThread]: 
[0m23:09:57.294952 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m23:09:57.295516 [debug] [MainThread]: Command `dbt run` failed at 23:09:57.295422 after 30.43 seconds
[0m23:09:57.296060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffae212eb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffae0463f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffae04600a0>]}
[0m23:09:57.296446 [debug] [MainThread]: Flushing usage events
[0m23:10:13.913418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf45d29bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf43dbc070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf43dbc0d0>]}


============================== 23:10:13.915491 | a44e3b07-c7fb-4a97-b0a0-c5b4c7affd90 ==============================
[0m23:10:13.915491 [info ] [MainThread]: Running with dbt=1.6.5
[0m23:10:13.915986 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:10:14.190517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a44e3b07-c7fb-4a97-b0a0-c5b4c7affd90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf41d3ec50>]}
[0m23:10:14.207333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a44e3b07-c7fb-4a97-b0a0-c5b4c7affd90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf41d587c0>]}
[0m23:10:14.208033 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m23:10:14.221882 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m23:10:14.286580 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:10:14.287162 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m23:10:14.330567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a44e3b07-c7fb-4a97-b0a0-c5b4c7affd90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf41b9c0d0>]}
[0m23:10:14.339143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a44e3b07-c7fb-4a97-b0a0-c5b4c7affd90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf41b67d30>]}
[0m23:10:14.339635 [info ] [MainThread]: Found 7 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m23:10:14.339977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a44e3b07-c7fb-4a97-b0a0-c5b4c7affd90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf41b67e20>]}
[0m23:10:14.341285 [info ] [MainThread]: 
[0m23:10:14.341939 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:10:14.343157 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m23:10:14.343563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:10:15.123078 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m23:10:15.125126 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:10:15.872829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a44e3b07-c7fb-4a97-b0a0-c5b4c7affd90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf41b65f90>]}
[0m23:10:15.873656 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:10:15.874027 [info ] [MainThread]: 
[0m23:10:15.875909 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m23:10:15.876405 [info ] [Thread-1 (]: 1 of 7 START sql table model games.dim_developers .............................. [RUN]
[0m23:10:15.877063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m23:10:15.877452 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m23:10:15.884561 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m23:10:15.885228 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 23:10:15.877707 => 23:10:15.885008
[0m23:10:15.885625 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m23:10:15.898409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:10:16.707834 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m23:10:16.708542 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m23:10:17.327014 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:dac3c3b5-d40a-47ba-9395-2fb4ba053450&page=queryresults
[0m23:10:20.696478 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 23:10:15.885887 => 23:10:20.696260
[0m23:10:20.697281 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a44e3b07-c7fb-4a97-b0a0-c5b4c7affd90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf41277dc0>]}
[0m23:10:20.697917 [info ] [Thread-1 (]: 1 of 7 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.82s]
[0m23:10:20.698589 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m23:10:20.699074 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m23:10:20.699636 [info ] [Thread-1 (]: 2 of 7 START sql table model games.dim_platforms ............................... [RUN]
[0m23:10:20.700325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m23:10:20.700752 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m23:10:20.703726 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m23:10:20.704419 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 23:10:20.701053 => 23:10:20.704205
[0m23:10:20.704840 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m23:10:20.712184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:10:21.492870 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m23:10:21.495529 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m23:10:21.967683 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ee7e4142-5eeb-4568-9fb2-f7a8c2d74dab&page=queryresults
[0m23:10:25.140702 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 23:10:20.705144 => 23:10:25.140524
[0m23:10:25.141381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a44e3b07-c7fb-4a97-b0a0-c5b4c7affd90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf412c61d0>]}
[0m23:10:25.141945 [info ] [Thread-1 (]: 2 of 7 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.44s]
[0m23:10:25.142550 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m23:10:25.143013 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m23:10:25.143569 [info ] [Thread-1 (]: 3 of 7 START sql table model games.dim_price_overview .......................... [RUN]
[0m23:10:25.144218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m23:10:25.144588 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m23:10:25.147387 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m23:10:25.148058 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 23:10:25.144868 => 23:10:25.147847
[0m23:10:25.148449 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m23:10:25.150480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:10:25.883082 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m23:10:25.883767 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m23:10:26.457742 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d620ab53-f0ae-4089-ab5f-b07b12a73f57&page=queryresults
[0m23:10:30.044200 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 23:10:25.148714 => 23:10:30.043301
[0m23:10:30.047383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a44e3b07-c7fb-4a97-b0a0-c5b4c7affd90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf452b9de0>]}
[0m23:10:30.049974 [info ] [Thread-1 (]: 3 of 7 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (1.1k rows, 114.2 KiB processed)[0m in 4.90s]
[0m23:10:30.052803 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m23:10:30.054837 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m23:10:30.057544 [info ] [Thread-1 (]: 4 of 7 START sql table model games.dim_publishers .............................. [RUN]
[0m23:10:30.060687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m23:10:30.061999 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m23:10:30.064973 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m23:10:30.065669 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 23:10:30.062261 => 23:10:30.065437
[0m23:10:30.066064 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m23:10:30.068286 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:10:30.777185 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m23:10:30.777977 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m23:10:31.197731 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:21719388-2a56-4fb2-9c4d-29d77df26fee&page=queryresults
[0m23:10:34.844195 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 23:10:30.066318 => 23:10:34.843300
[0m23:10:34.847433 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a44e3b07-c7fb-4a97-b0a0-c5b4c7affd90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf412b9420>]}
[0m23:10:34.850006 [info ] [Thread-1 (]: 4 of 7 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.79s]
[0m23:10:34.852794 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m23:10:34.854810 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m23:10:34.857247 [info ] [Thread-1 (]: 5 of 7 START sql table model games.dim_release ................................. [RUN]
[0m23:10:34.860397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m23:10:34.862213 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m23:10:34.872587 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m23:10:34.874179 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 23:10:34.863509 => 23:10:34.873688
[0m23:10:34.875101 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m23:10:34.889322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:10:35.606207 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m23:10:35.606931 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m23:10:36.137105 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:4d94adb2-5d24-4f2c-b625-b90e7b3a3ae6&page=queryresults
[0m23:10:39.267817 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 23:10:34.875793 => 23:10:39.266932
[0m23:10:39.270898 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a44e3b07-c7fb-4a97-b0a0-c5b4c7affd90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf41d3c460>]}
[0m23:10:39.273443 [info ] [Thread-1 (]: 5 of 7 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.41s]
[0m23:10:39.276260 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m23:10:39.278301 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m23:10:39.280432 [info ] [Thread-1 (]: 6 of 7 START sql table model games.dim_support_language ........................ [RUN]
[0m23:10:39.283668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m23:10:39.285509 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m23:10:39.292702 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m23:10:39.293408 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 23:10:39.286824 => 23:10:39.293163
[0m23:10:39.293800 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m23:10:39.295964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:10:40.030050 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m23:10:40.030782 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m23:10:40.491313 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f1658166-c876-46d7-a0ae-d9b265f12466&page=queryresults
[0m23:10:43.266990 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 23:10:39.294051 => 23:10:43.266681
[0m23:10:43.268143 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a44e3b07-c7fb-4a97-b0a0-c5b4c7affd90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf41bea050>]}
[0m23:10:43.269137 [info ] [Thread-1 (]: 6 of 7 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 3.99s]
[0m23:10:43.270207 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m23:10:43.270979 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m23:10:43.271861 [info ] [Thread-1 (]: 7 of 7 START sql table model games.fct_game_pricing ............................ [RUN]
[0m23:10:43.272951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m23:10:43.273635 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m23:10:43.280219 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m23:10:43.281345 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 23:10:43.274122 => 23:10:43.280990
[0m23:10:43.282025 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m23:10:43.287699 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m23:10:43.288769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:10:43.328661 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Calcular el precio promedio de juego vendido
WITH avg_game_price AS (
    SELECT
        AVG(price_with_tax) AS avg_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Encontrar el juego con el precio más alto
max_game_price AS (
    SELECT
        MAX(price_with_tax) AS max_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Encontrar el juego con el precio más bajo
min_game_price AS (
    SELECT
        MIN(price_with_tax) AS min_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Agregar un campo de ingresos totales
total_revenue AS (
    SELECT
        SUM(price_with_tax) AS revenue
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
)

-- Agregar un campo de descuentos totales
-- total_discounts AS (
--     SELECT
--         SUM(discount_amount) AS total_discount
--     FROM `pristine-flames-400818`.`games`.`dim_price_overview`
-- ),

-- Calcular ganancias totales
-- total_gross_profit AS (
--     SELECT
--         (total_revenue.revenue - total_discounts.total_discount) AS gross_profit
--     FROM total_revenue
-- )

-- Combinar todas las medidas en la tabla de hechos
SELECT
    ROW_NUMBER() OVER () AS fct_id,
    avg_price,
    max_price,
    min_price,
FROM
    avg_game_price, max_game_price, min_game_price
    );
  
[0m23:10:44.333497 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:8b03f6cc-15f0-4f44-b8aa-46cc8d9eebb9&page=queryresults
[0m23:10:49.706588 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 23:10:43.282504 => 23:10:49.705718
[0m23:10:49.709972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a44e3b07-c7fb-4a97-b0a0-c5b4c7affd90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf41100160>]}
[0m23:10:49.712765 [info ] [Thread-1 (]: 7 of 7 OK created sql table model games.fct_game_pricing ....................... [[32mCREATE TABLE (1.0 rows, 17.8 KiB processed)[0m in 6.44s]
[0m23:10:49.715953 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m23:10:49.722042 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:10:49.723457 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m23:10:49.724725 [info ] [MainThread]: 
[0m23:10:49.726191 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 35.38 seconds (35.38s).
[0m23:10:49.730647 [debug] [MainThread]: Command end result
[0m23:10:49.754349 [info ] [MainThread]: 
[0m23:10:49.754827 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:10:49.755202 [info ] [MainThread]: 
[0m23:10:49.755593 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m23:10:49.756194 [debug] [MainThread]: Command `dbt run` succeeded at 23:10:49.756088 after 35.85 seconds
[0m23:10:49.756581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf45d29bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf412dcbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf412dc070>]}
[0m23:10:49.756985 [debug] [MainThread]: Flushing usage events
[0m23:11:16.100986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043f61f5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043d7b4070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043d7b40d0>]}


============================== 23:11:16.103051 | b34856b6-6828-4ba7-af39-afe9c3391799 ==============================
[0m23:11:16.103051 [info ] [MainThread]: Running with dbt=1.6.5
[0m23:11:16.103544 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'profiles_dir': '../dbt/', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:11:16.380058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b34856b6-6828-4ba7-af39-afe9c3391799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043b736bc0>]}
[0m23:11:16.395608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b34856b6-6828-4ba7-af39-afe9c3391799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043eb2ead0>]}
[0m23:11:16.396172 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m23:11:16.409665 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m23:11:16.475873 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:11:16.476419 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m23:11:16.519436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b34856b6-6828-4ba7-af39-afe9c3391799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043b5940d0>]}
[0m23:11:16.528013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b34856b6-6828-4ba7-af39-afe9c3391799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043b55fd30>]}
[0m23:11:16.528464 [info ] [MainThread]: Found 7 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m23:11:16.528812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b34856b6-6828-4ba7-af39-afe9c3391799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043b55fe20>]}
[0m23:11:16.530113 [info ] [MainThread]: 
[0m23:11:16.530762 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:11:16.532045 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m23:11:16.532465 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:17.291678 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m23:11:17.293429 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:11:18.021939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b34856b6-6828-4ba7-af39-afe9c3391799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043b55df90>]}
[0m23:11:18.022760 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:11:18.023123 [info ] [MainThread]: 
[0m23:11:18.025026 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m23:11:18.025527 [info ] [Thread-1 (]: 1 of 7 START sql table model games.dim_developers .............................. [RUN]
[0m23:11:18.026125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m23:11:18.026485 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m23:11:18.033514 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m23:11:18.034187 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 23:11:18.026737 => 23:11:18.033964
[0m23:11:18.034583 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m23:11:18.048185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:11:18.816149 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m23:11:18.816866 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m23:11:19.318851 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:3227ddc1-5b8c-4333-9f2d-80837e3fb845&page=queryresults
[0m23:11:23.021793 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 23:11:18.034857 => 23:11:23.021475
[0m23:11:23.022926 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b34856b6-6828-4ba7-af39-afe9c3391799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043ae6fb80>]}
[0m23:11:23.023852 [info ] [Thread-1 (]: 1 of 7 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 5.00s]
[0m23:11:23.024838 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m23:11:23.025469 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m23:11:23.026180 [info ] [Thread-1 (]: 2 of 7 START sql table model games.dim_platforms ............................... [RUN]
[0m23:11:23.027042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m23:11:23.027586 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m23:11:23.031082 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m23:11:23.031833 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 23:11:23.027968 => 23:11:23.031596
[0m23:11:23.032299 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m23:11:23.039429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:11:23.806644 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m23:11:23.809286 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m23:11:24.433372 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a9017bad-abae-4ce7-a046-6a35c39b2728&page=queryresults
[0m23:11:27.495608 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 23:11:23.032628 => 23:11:27.494391
[0m23:11:27.499036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b34856b6-6828-4ba7-af39-afe9c3391799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043aeb2e00>]}
[0m23:11:27.501622 [info ] [Thread-1 (]: 2 of 7 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.47s]
[0m23:11:27.504466 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m23:11:27.506492 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m23:11:27.508623 [info ] [Thread-1 (]: 3 of 7 START sql table model games.dim_price_overview .......................... [RUN]
[0m23:11:27.511820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m23:11:27.513674 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m23:11:27.520463 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m23:11:27.521148 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 23:11:27.514993 => 23:11:27.520926
[0m23:11:27.521539 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m23:11:27.523696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:11:28.267995 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m23:11:28.270850 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m23:11:28.726353 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9152b5da-838c-4787-a7fb-ff86847e761d&page=queryresults
[0m23:11:31.790975 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 23:11:27.521794 => 23:11:31.790091
[0m23:11:31.794263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b34856b6-6828-4ba7-af39-afe9c3391799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043ae7eaa0>]}
[0m23:11:31.796831 [info ] [Thread-1 (]: 3 of 7 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (1.1k rows, 114.2 KiB processed)[0m in 4.28s]
[0m23:11:31.799667 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m23:11:31.801707 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m23:11:31.804364 [info ] [Thread-1 (]: 4 of 7 START sql table model games.dim_publishers .............................. [RUN]
[0m23:11:31.807460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m23:11:31.809314 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m23:11:31.817522 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m23:11:31.819034 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 23:11:31.810427 => 23:11:31.818555
[0m23:11:31.820008 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m23:11:31.824175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:11:32.573063 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m23:11:32.575812 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m23:11:33.112592 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a78deea9-581c-4468-a2b6-94af4bcd6791&page=queryresults
[0m23:11:36.741840 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 23:11:31.820528 => 23:11:36.741657
[0m23:11:36.742567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b34856b6-6828-4ba7-af39-afe9c3391799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043ae71ba0>]}
[0m23:11:36.743129 [info ] [Thread-1 (]: 4 of 7 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.94s]
[0m23:11:36.743757 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m23:11:36.744225 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m23:11:36.744813 [info ] [Thread-1 (]: 5 of 7 START sql table model games.dim_release ................................. [RUN]
[0m23:11:36.745473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m23:11:36.745865 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m23:11:36.748644 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m23:11:36.749266 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 23:11:36.746139 => 23:11:36.749069
[0m23:11:36.749642 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m23:11:36.757837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:11:37.496696 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m23:11:37.499344 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m23:11:37.966119 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:91db6fcd-e5c9-47ac-ad72-7bf0deff7999&page=queryresults
[0m23:11:41.310999 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 23:11:36.749909 => 23:11:41.310818
[0m23:11:41.311721 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b34856b6-6828-4ba7-af39-afe9c3391799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043b7516f0>]}
[0m23:11:41.312444 [info ] [Thread-1 (]: 5 of 7 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.57s]
[0m23:11:41.313077 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m23:11:41.313548 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m23:11:41.314109 [info ] [Thread-1 (]: 6 of 7 START sql table model games.dim_support_language ........................ [RUN]
[0m23:11:41.314749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m23:11:41.315140 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m23:11:41.317990 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m23:11:41.318614 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 23:11:41.315410 => 23:11:41.318416
[0m23:11:41.318992 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m23:11:41.321128 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:11:42.070322 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m23:11:42.071004 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m23:11:42.576656 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:517f735b-4ef8-4b82-84cb-364487f48840&page=queryresults
[0m23:11:45.607811 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 23:11:41.319259 => 23:11:45.606896
[0m23:11:45.610881 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b34856b6-6828-4ba7-af39-afe9c3391799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043b751150>]}
[0m23:11:45.613451 [info ] [Thread-1 (]: 6 of 7 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.30s]
[0m23:11:45.615929 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m23:11:45.617342 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m23:11:45.619028 [info ] [Thread-1 (]: 7 of 7 START sql table model games.fct_game_pricing ............................ [RUN]
[0m23:11:45.620829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m23:11:45.621767 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m23:11:45.629234 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m23:11:45.630435 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 23:11:45.622432 => 23:11:45.630107
[0m23:11:45.631057 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m23:11:45.634619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:11:46.388519 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m23:11:46.391429 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Calcular el precio promedio de juego vendido
WITH avg_game_price AS (
    SELECT
        AVG(price_with_tax) AS avg_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Encontrar el juego con el precio más alto
max_game_price AS (
    SELECT
        MAX(price_with_tax) AS max_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Encontrar el juego con el precio más bajo
min_game_price AS (
    SELECT
        MIN(price_with_tax) AS min_price
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
),

-- Agregar un campo de ingresos totales
total_revenue AS (
    SELECT
        SUM(price_with_tax) AS revenue
    FROM `pristine-flames-400818`.`games`.`dim_price_overview`
)

-- Agregar un campo de descuentos totales
-- total_discounts AS (
--     SELECT
--         SUM(discount_amount) AS total_discount
--     FROM `pristine-flames-400818`.`games`.`dim_price_overview`
-- ),

-- Calcular ganancias totales
-- total_gross_profit AS (
--     SELECT
--         (total_revenue.revenue - total_discounts.total_discount) AS gross_profit
--     FROM total_revenue
-- )

-- Combinar todas las medidas en la tabla de hechos
SELECT
    ROW_NUMBER() OVER () AS fct_id,
    app_id,
    avg_price,
    max_price,
    min_price,
FROM
    avg_game_price, max_game_price, min_game_price
    );
  
[0m23:11:46.849764 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:dd98e6e7-2062-42c2-b867-b37dce5ee45f&page=queryresults
[0m23:11:47.348304 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: app_id at [60:5]')
[0m23:11:48.346419 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c58ab346-fafc-4dd5-8b5c-eacce97c7464&page=queryresults
[0m23:11:48.864488 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c58ab346-fafc-4dd5-8b5c-eacce97c7464&page=queryresults
[0m23:11:48.867741 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 23:11:45.631495 => 23:11:48.866736
[0m23:11:48.881048 [debug] [Thread-1 (]: Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Unrecognized name: app_id at [60:5]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m23:11:48.883111 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b34856b6-6828-4ba7-af39-afe9c3391799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043b751270>]}
[0m23:11:48.885921 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model games.fct_game_pricing ................... [[31mERROR[0m in 3.26s]
[0m23:11:48.888822 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m23:11:48.894829 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:11:48.896507 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m23:11:48.898225 [info ] [MainThread]: 
[0m23:11:48.899983 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 32.37 seconds (32.37s).
[0m23:11:48.907160 [debug] [MainThread]: Command end result
[0m23:11:48.923064 [info ] [MainThread]: 
[0m23:11:48.923514 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:11:48.923890 [info ] [MainThread]: 
[0m23:11:48.924281 [error] [MainThread]:   Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Unrecognized name: app_id at [60:5]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m23:11:48.924641 [info ] [MainThread]: 
[0m23:11:48.925012 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m23:11:48.925613 [debug] [MainThread]: Command `dbt run` failed at 23:11:48.925506 after 32.83 seconds
[0m23:11:48.926007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043f61f5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043aefb670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043aefa890>]}
[0m23:11:48.926414 [debug] [MainThread]: Flushing usage events
[0m15:05:45.216116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e8301dbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e81088070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e810880d0>]}


============================== 15:05:45.219755 | b8c96515-ed9d-48f5-94fe-e6957087c6e1 ==============================
[0m15:05:45.219755 [info ] [MainThread]: Running with dbt=1.6.5
[0m15:05:45.220272 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'profiles_dir': '../dbt/', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:05:46.397174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8c96515-ed9d-48f5-94fe-e6957087c6e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e7f00ec50>]}
[0m15:05:46.422820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8c96515-ed9d-48f5-94fe-e6957087c6e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e7f0287c0>]}
[0m15:05:46.424662 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m15:05:46.452872 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m15:05:46.741335 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:05:46.742543 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m15:05:46.785545 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.games.fct_game_pricing' (models/transform/fct_game_pricing.sql) depends on a source named 'games.dim_price_overview' which was not found
[0m15:05:46.786183 [debug] [MainThread]: Command `dbt run` failed at 15:05:46.786083 after 1.58 seconds
[0m15:05:46.786548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e8301dbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e7ee97ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e7ee7b6a0>]}
[0m15:05:46.786929 [debug] [MainThread]: Flushing usage events
[0m15:06:23.478986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc385e21180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc383fb4070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc383fb40d0>]}


============================== 15:06:23.481076 | e62309c8-26b4-4ff2-bdd8-7fc6777f019d ==============================
[0m15:06:23.481076 [info ] [MainThread]: Running with dbt=1.6.5
[0m15:06:23.481570 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:06:23.756142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e62309c8-26b4-4ff2-bdd8-7fc6777f019d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc38545bdc0>]}
[0m15:06:23.771746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e62309c8-26b4-4ff2-bdd8-7fc6777f019d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc381f509d0>]}
[0m15:06:23.772376 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m15:06:23.786029 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m15:06:23.851536 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:06:23.852080 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m15:06:23.895070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e62309c8-26b4-4ff2-bdd8-7fc6777f019d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc381d800d0>]}
[0m15:06:23.929035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e62309c8-26b4-4ff2-bdd8-7fc6777f019d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc381d5fd30>]}
[0m15:06:23.929911 [info ] [MainThread]: Found 7 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m15:06:23.930618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e62309c8-26b4-4ff2-bdd8-7fc6777f019d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc381d5fe20>]}
[0m15:06:23.933203 [info ] [MainThread]: 
[0m15:06:23.934462 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:06:23.936936 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m15:06:23.937748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:24.725269 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m15:06:24.726666 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:06:25.508735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e62309c8-26b4-4ff2-bdd8-7fc6777f019d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc383f8f100>]}
[0m15:06:25.511963 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:06:25.513677 [info ] [MainThread]: 
[0m15:06:25.563276 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m15:06:25.564571 [info ] [Thread-1 (]: 1 of 7 START sql table model games.dim_developers .............................. [RUN]
[0m15:06:25.566109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m15:06:25.567073 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m15:06:25.584489 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m15:06:25.585732 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 15:06:25.567740 => 15:06:25.585340
[0m15:06:25.586477 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m15:06:25.605179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:26.372892 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m15:06:26.373668 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m15:06:27.051500 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:01ee047f-694a-4663-a135-2a1b273acafd&page=queryresults
[0m15:06:29.934884 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 15:06:25.587012 => 15:06:29.934666
[0m15:06:29.935828 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e62309c8-26b4-4ff2-bdd8-7fc6777f019d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc38166ffd0>]}
[0m15:06:29.936697 [info ] [Thread-1 (]: 1 of 7 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.37s]
[0m15:06:29.937591 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m15:06:29.938115 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m15:06:29.938612 [info ] [Thread-1 (]: 2 of 7 START sql table model games.dim_platforms ............................... [RUN]
[0m15:06:29.939292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m15:06:29.939710 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m15:06:29.942685 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m15:06:29.943623 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 15:06:29.940045 => 15:06:29.943355
[0m15:06:29.944049 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m15:06:29.954886 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:30.677123 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m15:06:30.677789 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m15:06:31.292462 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:03cf1bf2-0782-49e2-afce-24f11ecd6f6d&page=queryresults
[0m15:06:34.177811 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 15:06:29.944353 => 15:06:34.177462
[0m15:06:34.179061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e62309c8-26b4-4ff2-bdd8-7fc6777f019d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3816b2e00>]}
[0m15:06:34.180153 [info ] [Thread-1 (]: 2 of 7 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.24s]
[0m15:06:34.181479 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m15:06:34.182483 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m15:06:34.183628 [info ] [Thread-1 (]: 3 of 7 START sql table model games.dim_price_overview .......................... [RUN]
[0m15:06:34.185006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m15:06:34.185833 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m15:06:34.191946 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m15:06:34.193304 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 15:06:34.186421 => 15:06:34.192874
[0m15:06:34.194138 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m15:06:34.198765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:34.840368 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m15:06:34.841104 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m15:06:35.513882 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:4ceb22df-a061-45fc-841f-be2df83994d2&page=queryresults
[0m15:06:39.194583 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 15:06:34.194717 => 15:06:39.193704
[0m15:06:39.197909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e62309c8-26b4-4ff2-bdd8-7fc6777f019d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc38167e680>]}
[0m15:06:39.200492 [info ] [Thread-1 (]: 3 of 7 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (1.1k rows, 114.2 KiB processed)[0m in 5.01s]
[0m15:06:39.203296 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m15:06:39.205348 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m15:06:39.208045 [info ] [Thread-1 (]: 4 of 7 START sql table model games.dim_publishers .............................. [RUN]
[0m15:06:39.211136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m15:06:39.212984 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m15:06:39.225822 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m15:06:39.228776 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 15:06:39.214275 => 15:06:39.227766
[0m15:06:39.230615 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m15:06:39.237216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:39.914601 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m15:06:39.917363 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m15:06:40.624282 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9d586cc7-117e-4e92-8ad0-419a4ab0e955&page=queryresults
[0m15:06:43.715620 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 15:06:39.231923 => 15:06:43.714753
[0m15:06:43.718855 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e62309c8-26b4-4ff2-bdd8-7fc6777f019d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc38167f100>]}
[0m15:06:43.721421 [info ] [Thread-1 (]: 4 of 7 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.51s]
[0m15:06:43.724188 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m15:06:43.726220 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m15:06:43.728621 [info ] [Thread-1 (]: 5 of 7 START sql table model games.dim_release ................................. [RUN]
[0m15:06:43.731801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m15:06:43.733844 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m15:06:43.744561 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m15:06:43.746168 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 15:06:43.735224 => 15:06:43.745681
[0m15:06:43.747109 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m15:06:43.761975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:44.497040 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m15:06:44.497727 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m15:06:45.126471 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d56de2de-7e16-4d44-8a7f-a748b3e24358&page=queryresults
[0m15:06:48.228687 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 15:06:43.747770 => 15:06:48.228506
[0m15:06:48.229368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e62309c8-26b4-4ff2-bdd8-7fc6777f019d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc381f53130>]}
[0m15:06:48.229933 [info ] [Thread-1 (]: 5 of 7 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.50s]
[0m15:06:48.230536 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m15:06:48.230999 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m15:06:48.231556 [info ] [Thread-1 (]: 6 of 7 START sql table model games.dim_support_language ........................ [RUN]
[0m15:06:48.232183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m15:06:48.232606 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m15:06:48.235345 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m15:06:48.235957 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 15:06:48.232884 => 15:06:48.235759
[0m15:06:48.236368 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m15:06:48.238433 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:49.034912 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m15:06:49.035677 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m15:06:49.646625 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:4ae0ced2-14ec-4374-8a67-a798057a46cd&page=queryresults
[0m15:06:52.753641 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 15:06:48.236643 => 15:06:52.752759
[0m15:06:52.756726 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e62309c8-26b4-4ff2-bdd8-7fc6777f019d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc381dc5db0>]}
[0m15:06:52.759252 [info ] [Thread-1 (]: 6 of 7 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.52s]
[0m15:06:52.762065 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m15:06:52.764076 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m15:06:52.766509 [info ] [Thread-1 (]: 7 of 7 START sql table model games.fct_game_pricing ............................ [RUN]
[0m15:06:52.769445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m15:06:52.771274 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m15:06:52.782581 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m15:06:52.784580 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 15:06:52.772597 => 15:06:52.783902
[0m15:06:52.785542 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m15:06:52.790733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:53.514084 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m15:06:53.514791 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        DATE_TRUNC('day', purchase_date) AS date,  -- Agrupa por día
        SUM(initial_price) AS total_initial_price,  -- Suma de precios iniciales
        SUM(final_price) AS total_final_price,  -- Suma de precios finales
        SUM(discount_amount) AS total_discount_amount,  -- Suma de montos de descuento
        SUM(price_with_tax) AS total_price_with_tax  -- Suma de precios con impuestos
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY
        app_id, DATE_TRUNC('day', purchase_date)
)

SELECT
    ROW_NUMBER() OVER () AS game_sales_id, 
    gs.*
FROM
    game_sales gs;
    );
  
[0m15:06:53.843708 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:14ad44d1-33c8-4579-a775-f064b4332f5b&page=queryresults
[0m15:06:53.848063 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [34:18]')
[0m15:06:54.704568 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:85c0f264-639e-4bbe-8b7d-3cfc0a4b3d91&page=queryresults
[0m15:06:54.709190 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:85c0f264-639e-4bbe-8b7d-3cfc0a4b3d91&page=queryresults
[0m15:06:54.712319 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 15:06:52.786211 => 15:06:54.711341
[0m15:06:54.733359 [debug] [Thread-1 (]: Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Syntax error: Expected ")" but got ";" at [34:18]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m15:06:54.735471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e62309c8-26b4-4ff2-bdd8-7fc6777f019d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc381f52d10>]}
[0m15:06:54.738208 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model games.fct_game_pricing ................... [[31mERROR[0m in 1.97s]
[0m15:06:54.741058 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m15:06:54.746582 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:06:54.747797 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m15:06:54.749039 [info ] [MainThread]: 
[0m15:06:54.749905 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 30.81 seconds (30.81s).
[0m15:06:54.751430 [debug] [MainThread]: Command end result
[0m15:06:54.763697 [info ] [MainThread]: 
[0m15:06:54.764113 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:06:54.764490 [info ] [MainThread]: 
[0m15:06:54.764804 [error] [MainThread]:   Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Syntax error: Expected ")" but got ";" at [34:18]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m15:06:54.765164 [info ] [MainThread]: 
[0m15:06:54.765503 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m15:06:54.766024 [debug] [MainThread]: Command `dbt run` failed at 15:06:54.765931 after 31.29 seconds
[0m15:06:54.766374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc385e21180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc38563c7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3816f4430>]}
[0m15:06:54.766730 [debug] [MainThread]: Flushing usage events
[0m15:07:15.706605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd06229180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd042b8070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd042b80d0>]}


============================== 15:07:15.708703 | a6fac3f6-8bfe-4132-9983-f9c99cde19b5 ==============================
[0m15:07:15.708703 [info ] [MainThread]: Running with dbt=1.6.5
[0m15:07:15.709171 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:07:15.984394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6fac3f6-8bfe-4132-9983-f9c99cde19b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd057a87c0>]}
[0m15:07:15.999788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6fac3f6-8bfe-4132-9983-f9c99cde19b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd022589d0>]}
[0m15:07:16.000415 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m15:07:16.014171 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m15:07:16.080180 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:07:16.080723 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m15:07:16.123591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6fac3f6-8bfe-4132-9983-f9c99cde19b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd020ac0d0>]}
[0m15:07:16.132120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6fac3f6-8bfe-4132-9983-f9c99cde19b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd02067df0>]}
[0m15:07:16.132602 [info ] [MainThread]: Found 7 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m15:07:16.132945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6fac3f6-8bfe-4132-9983-f9c99cde19b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd02067d60>]}
[0m15:07:16.134245 [info ] [MainThread]: 
[0m15:07:16.134895 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:07:16.136123 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m15:07:16.136568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:16.892963 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m15:07:16.894720 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:17.621014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6fac3f6-8bfe-4132-9983-f9c99cde19b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd02065f00>]}
[0m15:07:17.623750 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:07:17.625300 [info ] [MainThread]: 
[0m15:07:17.633228 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m15:07:17.635424 [info ] [Thread-1 (]: 1 of 7 START sql table model games.dim_developers .............................. [RUN]
[0m15:07:17.637797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m15:07:17.638185 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m15:07:17.644949 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m15:07:17.645577 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 15:07:17.638449 => 15:07:17.645377
[0m15:07:17.645957 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m15:07:17.659191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:18.380794 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m15:07:18.381613 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m15:07:18.990065 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:264be66d-602a-4bed-90d0-87164e3536e8&page=queryresults
[0m15:07:21.549204 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 15:07:17.646219 => 15:07:21.548886
[0m15:07:21.550337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6fac3f6-8bfe-4132-9983-f9c99cde19b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd0197fdc0>]}
[0m15:07:21.551249 [info ] [Thread-1 (]: 1 of 7 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 3.91s]
[0m15:07:21.552146 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m15:07:21.552776 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m15:07:21.553493 [info ] [Thread-1 (]: 2 of 7 START sql table model games.dim_platforms ............................... [RUN]
[0m15:07:21.554352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m15:07:21.554889 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m15:07:21.558300 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m15:07:21.559048 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 15:07:21.555264 => 15:07:21.558808
[0m15:07:21.559510 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m15:07:21.567047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:22.326727 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m15:07:22.327827 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m15:07:22.997414 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:cf53f72f-5c1b-4f03-b1b7-b936137a9b6c&page=queryresults
[0m15:07:25.779655 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 15:07:21.559841 => 15:07:25.778774
[0m15:07:25.782790 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6fac3f6-8bfe-4132-9983-f9c99cde19b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd019ce1d0>]}
[0m15:07:25.785358 [info ] [Thread-1 (]: 2 of 7 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.23s]
[0m15:07:25.788188 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m15:07:25.790256 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m15:07:25.792674 [info ] [Thread-1 (]: 3 of 7 START sql table model games.dim_price_overview .......................... [RUN]
[0m15:07:25.795577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m15:07:25.797175 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m15:07:25.805232 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m15:07:25.806745 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 15:07:25.798080 => 15:07:25.806284
[0m15:07:25.807483 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m15:07:25.811504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:26.517890 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m15:07:26.518598 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m15:07:27.106751 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:2ab095ef-1661-4822-9860-dbd4c0ea0a92&page=queryresults
[0m15:07:30.311665 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 15:07:25.808011 => 15:07:30.310771
[0m15:07:30.314901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6fac3f6-8bfe-4132-9983-f9c99cde19b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd019c25f0>]}
[0m15:07:30.317490 [info ] [Thread-1 (]: 3 of 7 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (1.1k rows, 114.2 KiB processed)[0m in 4.52s]
[0m15:07:30.320370 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m15:07:30.322411 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m15:07:30.325106 [info ] [Thread-1 (]: 4 of 7 START sql table model games.dim_publishers .............................. [RUN]
[0m15:07:30.328205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m15:07:30.330072 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m15:07:30.343033 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m15:07:30.346217 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 15:07:30.331356 => 15:07:30.345110
[0m15:07:30.348117 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m15:07:30.356398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:31.138414 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m15:07:31.141469 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m15:07:31.753798 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:294fb320-25eb-4d6f-9fe1-0a7ccbc01299&page=queryresults
[0m15:07:34.834205 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 15:07:30.349537 => 15:07:34.834019
[0m15:07:34.835036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6fac3f6-8bfe-4132-9983-f9c99cde19b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd019c22f0>]}
[0m15:07:34.835610 [info ] [Thread-1 (]: 4 of 7 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.51s]
[0m15:07:34.836275 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m15:07:34.836746 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m15:07:34.837219 [info ] [Thread-1 (]: 5 of 7 START sql table model games.dim_release ................................. [RUN]
[0m15:07:34.837930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m15:07:34.838445 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m15:07:34.841153 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m15:07:34.841799 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 15:07:34.838723 => 15:07:34.841555
[0m15:07:34.842185 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m15:07:34.850230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:35.573471 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m15:07:35.574111 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m15:07:36.171139 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:1f8b55c9-45c3-420d-85de-f91ba635d0d2&page=queryresults
[0m15:07:39.509045 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 15:07:34.842439 => 15:07:39.508860
[0m15:07:39.509857 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6fac3f6-8bfe-4132-9983-f9c99cde19b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd020ef010>]}
[0m15:07:39.510468 [info ] [Thread-1 (]: 5 of 7 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.67s]
[0m15:07:39.511423 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m15:07:39.511973 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m15:07:39.512608 [info ] [Thread-1 (]: 6 of 7 START sql table model games.dim_support_language ........................ [RUN]
[0m15:07:39.513282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m15:07:39.513656 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m15:07:39.516757 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m15:07:39.517443 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 15:07:39.513939 => 15:07:39.517221
[0m15:07:39.517873 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m15:07:39.520069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:40.226548 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m15:07:40.227236 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m15:07:40.822629 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:002cf503-d47a-40fb-ad18-c43bd819ad00&page=queryresults
[0m15:07:43.685573 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 15:07:39.518160 => 15:07:43.685375
[0m15:07:43.686339 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6fac3f6-8bfe-4132-9983-f9c99cde19b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd020cf700>]}
[0m15:07:43.686973 [info ] [Thread-1 (]: 6 of 7 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.17s]
[0m15:07:43.687843 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m15:07:43.688391 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m15:07:43.688934 [info ] [Thread-1 (]: 7 of 7 START sql table model games.fct_game_pricing ............................ [RUN]
[0m15:07:43.689644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m15:07:43.690166 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m15:07:43.696161 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m15:07:43.697135 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 15:07:43.690481 => 15:07:43.696895
[0m15:07:43.697529 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m15:07:43.700119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:44.396264 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m15:07:44.397073 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        DATE_TRUNC('day', purchase_date) AS date,  -- Agrupa por día
        SUM(initial_price) AS total_initial_price,  -- Suma de precios iniciales
        SUM(final_price) AS total_final_price,  -- Suma de precios finales
        SUM(discount_amount) AS total_discount_amount,  -- Suma de montos de descuento
        SUM(price_with_tax) AS total_price_with_tax  -- Suma de precios con impuestos
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY
        app_id, DATE_TRUNC('day', purchase_date)
)

SELECT
    ROW_NUMBER() OVER () AS game_sales_id, 
    gs.*
FROM
    game_sales gs
    );
  
[0m15:07:45.020903 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5390c880-9d61-4739-9b6c-85a6bf06b195&page=queryresults
[0m15:07:45.548649 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('A valid date part name is required but found purchase_date at [19:27]')
[0m15:07:46.439159 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:2b65161e-863c-44d2-8802-f1bfacaaf3b3&page=queryresults
[0m15:07:47.099902 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:2b65161e-863c-44d2-8802-f1bfacaaf3b3&page=queryresults
[0m15:07:47.100679 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 15:07:43.697811 => 15:07:47.100456
[0m15:07:47.103807 [debug] [Thread-1 (]: Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  A valid date part name is required but found purchase_date at [19:27]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m15:07:47.104319 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6fac3f6-8bfe-4132-9983-f9c99cde19b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd0223c3a0>]}
[0m15:07:47.104941 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model games.fct_game_pricing ................... [[31mERROR[0m in 3.41s]
[0m15:07:47.105612 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m15:07:47.107281 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:07:47.107672 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m15:07:47.108089 [info ] [MainThread]: 
[0m15:07:47.108511 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 30.97 seconds (30.97s).
[0m15:07:47.110282 [debug] [MainThread]: Command end result
[0m15:07:47.128537 [info ] [MainThread]: 
[0m15:07:47.129392 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:07:47.129996 [info ] [MainThread]: 
[0m15:07:47.130595 [error] [MainThread]:   Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  A valid date part name is required but found purchase_date at [19:27]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m15:07:47.131191 [info ] [MainThread]: 
[0m15:07:47.131802 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m15:07:47.132794 [debug] [MainThread]: Command `dbt run` failed at 15:07:47.132624 after 31.43 seconds
[0m15:07:47.133445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd06229180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd019e3d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd019e3eb0>]}
[0m15:07:47.134107 [debug] [MainThread]: Flushing usage events
[0m15:08:38.402527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf6f31180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf4fc4070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf4fc40d0>]}


============================== 15:08:38.405203 | 29c3abea-674f-4768-90da-362153e0937c ==============================
[0m15:08:38.405203 [info ] [MainThread]: Running with dbt=1.6.5
[0m15:08:38.405840 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:08:38.695727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29c3abea-674f-4768-90da-362153e0937c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf650c1f0>]}
[0m15:08:38.711587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29c3abea-674f-4768-90da-362153e0937c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf2f63490>]}
[0m15:08:38.712165 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m15:08:38.725597 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m15:08:38.789226 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:08:38.789839 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m15:08:38.834841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29c3abea-674f-4768-90da-362153e0937c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf2db00d0>]}
[0m15:08:38.843334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29c3abea-674f-4768-90da-362153e0937c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf2d6fdf0>]}
[0m15:08:38.843784 [info ] [MainThread]: Found 7 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m15:08:38.844121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29c3abea-674f-4768-90da-362153e0937c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf2d6fd60>]}
[0m15:08:38.845458 [info ] [MainThread]: 
[0m15:08:38.846095 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:08:38.847310 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m15:08:38.847723 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:39.588439 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m15:08:39.590192 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:08:40.262375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29c3abea-674f-4768-90da-362153e0937c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf4f9bbe0>]}
[0m15:08:40.265590 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:08:40.267233 [info ] [MainThread]: 
[0m15:08:40.275271 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m15:08:40.277456 [info ] [Thread-1 (]: 1 of 7 START sql table model games.dim_developers .............................. [RUN]
[0m15:08:40.280342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m15:08:40.282129 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m15:08:40.313492 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m15:08:40.315193 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 15:08:40.283390 => 15:08:40.314693
[0m15:08:40.316123 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m15:08:40.337284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:41.031641 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m15:08:41.032376 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m15:08:41.694209 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:23b80d75-a6ff-427e-9b81-fbb16c1ffb4e&page=queryresults
[0m15:08:44.350515 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 15:08:40.316793 => 15:08:44.350208
[0m15:08:44.351641 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29c3abea-674f-4768-90da-362153e0937c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf247ffa0>]}
[0m15:08:44.352561 [info ] [Thread-1 (]: 1 of 7 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.07s]
[0m15:08:44.353534 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m15:08:44.354227 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m15:08:44.354929 [info ] [Thread-1 (]: 2 of 7 START sql table model games.dim_platforms ............................... [RUN]
[0m15:08:44.355788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m15:08:44.356329 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m15:08:44.359875 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m15:08:44.360642 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 15:08:44.356709 => 15:08:44.360393
[0m15:08:44.361098 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m15:08:44.367793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:45.102527 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m15:08:45.103221 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m15:08:45.717699 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:2dde3875-26c5-409b-84df-a1c04cfb30c2&page=queryresults
[0m15:08:48.483078 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 15:08:44.361424 => 15:08:48.482892
[0m15:08:48.483761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29c3abea-674f-4768-90da-362153e0937c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf24c2bf0>]}
[0m15:08:48.484344 [info ] [Thread-1 (]: 2 of 7 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.13s]
[0m15:08:48.484921 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m15:08:48.485356 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m15:08:48.485763 [info ] [Thread-1 (]: 3 of 7 START sql table model games.dim_price_overview .......................... [RUN]
[0m15:08:48.486342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m15:08:48.486697 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m15:08:48.489537 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m15:08:48.490221 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 15:08:48.486950 => 15:08:48.490029
[0m15:08:48.490581 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m15:08:48.492658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:49.238798 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m15:08:49.240484 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m15:08:49.854575 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:bdbdfe58-8bf6-479d-8811-59c385da9609&page=queryresults
[0m15:08:52.998947 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 15:08:48.490834 => 15:08:52.998053
[0m15:08:53.002475 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29c3abea-674f-4768-90da-362153e0937c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf248f280>]}
[0m15:08:53.004959 [info ] [Thread-1 (]: 3 of 7 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (1.1k rows, 114.2 KiB processed)[0m in 4.52s]
[0m15:08:53.007010 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m15:08:53.008787 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m15:08:53.010693 [info ] [Thread-1 (]: 4 of 7 START sql table model games.dim_publishers .............................. [RUN]
[0m15:08:53.012507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m15:08:53.013548 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m15:08:53.019560 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m15:08:53.020773 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 15:08:53.014414 => 15:08:53.020370
[0m15:08:53.021482 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m15:08:53.025417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:53.728984 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m15:08:53.729787 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m15:08:54.277678 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:8fd4a586-6eea-4769-aa55-3718d4e5394d&page=queryresults
[0m15:08:57.122860 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 15:08:53.021980 => 15:08:57.122666
[0m15:08:57.123591 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29c3abea-674f-4768-90da-362153e0937c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf2f61030>]}
[0m15:08:57.124150 [info ] [Thread-1 (]: 4 of 7 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.11s]
[0m15:08:57.124743 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m15:08:57.125166 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m15:08:57.125590 [info ] [Thread-1 (]: 5 of 7 START sql table model games.dim_release ................................. [RUN]
[0m15:08:57.126226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m15:08:57.126597 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m15:08:57.129287 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m15:08:57.129956 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 15:08:57.126859 => 15:08:57.129751
[0m15:08:57.130322 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m15:08:57.138185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:57.860503 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m15:08:57.861272 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m15:08:58.430562 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e869c1ec-e1fc-4b46-87b5-c6147c255356&page=queryresults
[0m15:09:01.368941 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 15:08:57.130583 => 15:09:01.368758
[0m15:09:01.369633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29c3abea-674f-4768-90da-362153e0937c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf64764d0>]}
[0m15:09:01.370183 [info ] [Thread-1 (]: 5 of 7 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.24s]
[0m15:09:01.370790 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m15:09:01.371250 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m15:09:01.371806 [info ] [Thread-1 (]: 6 of 7 START sql table model games.dim_support_language ........................ [RUN]
[0m15:09:01.372450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m15:09:01.372833 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m15:09:01.375556 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m15:09:01.376176 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 15:09:01.373100 => 15:09:01.375975
[0m15:09:01.376604 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m15:09:01.378615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:09:02.121212 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m15:09:02.121937 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m15:09:02.725224 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5b76609b-0d94-47af-badb-9551306cc5d0&page=queryresults
[0m15:09:05.522936 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 15:09:01.376867 => 15:09:05.522752
[0m15:09:05.523636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29c3abea-674f-4768-90da-362153e0937c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf2dd4370>]}
[0m15:09:05.524193 [info ] [Thread-1 (]: 6 of 7 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.15s]
[0m15:09:05.524842 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m15:09:05.525306 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m15:09:05.525847 [info ] [Thread-1 (]: 7 of 7 START sql table model games.fct_game_pricing ............................ [RUN]
[0m15:09:05.526477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m15:09:05.526842 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m15:09:05.529598 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m15:09:05.530221 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 15:09:05.527121 => 15:09:05.530023
[0m15:09:05.530578 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m15:09:05.532728 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:09:06.263338 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m15:09:06.264096 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        SUM(initial_price) AS total_initial_price,  -- Suma de precios iniciales
        SUM(final_price) AS total_final_price,  -- Suma de precios finales
        SUM(discount_amount) AS total_discount_amount,  -- Suma de montos de descuento
        SUM(price_with_tax) AS total_price_with_tax  -- Suma de precios con impuestos
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY
        app_id, DATE_TRUNC('day', purchase_date)
)

SELECT
    ROW_NUMBER() OVER () AS game_sales_id, 
    gs.*
FROM
    game_sales gs
    );
  
[0m15:09:06.930550 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:05bda9da-72b8-493b-96c3-a852141ba193&page=queryresults
[0m15:09:07.692004 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('A valid date part name is required but found purchase_date at [26:35]')
[0m15:09:09.245839 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:82312ed1-477b-4b72-9e1d-e2bb3aa63d46&page=queryresults
[0m15:09:09.789380 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:82312ed1-477b-4b72-9e1d-e2bb3aa63d46&page=queryresults
[0m15:09:09.792575 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 15:09:05.530832 => 15:09:09.791585
[0m15:09:09.796440 [debug] [Thread-1 (]: Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  A valid date part name is required but found purchase_date at [26:35]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m15:09:09.796905 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29c3abea-674f-4768-90da-362153e0937c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf2f44970>]}
[0m15:09:09.797458 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model games.fct_game_pricing ................... [[31mERROR[0m in 4.27s]
[0m15:09:09.798056 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m15:09:09.799571 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:09:09.799896 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m15:09:09.800266 [info ] [MainThread]: 
[0m15:09:09.800614 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 30.95 seconds (30.95s).
[0m15:09:09.802106 [debug] [MainThread]: Command end result
[0m15:09:09.815244 [info ] [MainThread]: 
[0m15:09:09.815689 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:09:09.816029 [info ] [MainThread]: 
[0m15:09:09.816371 [error] [MainThread]:   Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  A valid date part name is required but found purchase_date at [26:35]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m15:09:09.816717 [info ] [MainThread]: 
[0m15:09:09.817074 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m15:09:09.817637 [debug] [MainThread]: Command `dbt run` failed at 15:09:09.817536 after 31.42 seconds
[0m15:09:09.818019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf6f31180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf6691930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf24f3d00>]}
[0m15:09:09.818413 [debug] [MainThread]: Flushing usage events
[0m15:09:48.898834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c5932ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c3994070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c39940d0>]}


============================== 15:09:48.900951 | 1eb2b742-8ab6-4cc2-98f5-03c9892801a8 ==============================
[0m15:09:48.900951 [info ] [MainThread]: Running with dbt=1.6.5
[0m15:09:48.901446 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:09:49.186932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1eb2b742-8ab6-4cc2-98f5-03c9892801a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c4edfdc0>]}
[0m15:09:49.203007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1eb2b742-8ab6-4cc2-98f5-03c9892801a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c19309d0>]}
[0m15:09:49.203669 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m15:09:49.218324 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m15:09:49.283680 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:09:49.284262 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m15:09:49.329897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1eb2b742-8ab6-4cc2-98f5-03c9892801a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c17e40d0>]}
[0m15:09:49.338754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1eb2b742-8ab6-4cc2-98f5-03c9892801a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c173bd30>]}
[0m15:09:49.339218 [info ] [MainThread]: Found 7 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m15:09:49.339574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1eb2b742-8ab6-4cc2-98f5-03c9892801a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c173be20>]}
[0m15:09:49.340986 [info ] [MainThread]: 
[0m15:09:49.341730 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:09:49.343117 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m15:09:49.343618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:50.079047 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m15:09:50.081154 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:50.828472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1eb2b742-8ab6-4cc2-98f5-03c9892801a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c1739f90>]}
[0m15:09:50.829469 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:09:50.831174 [info ] [MainThread]: 
[0m15:09:50.834919 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m15:09:50.835673 [info ] [Thread-1 (]: 1 of 7 START sql table model games.dim_developers .............................. [RUN]
[0m15:09:50.836798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m15:09:50.837427 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m15:09:50.850005 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m15:09:50.850696 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 15:09:50.837785 => 15:09:50.850493
[0m15:09:50.851082 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m15:09:50.864515 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:09:51.626926 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m15:09:51.628541 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m15:09:52.300670 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:0b3ce0e4-ad1a-41c9-abac-dd22f1b68ad7&page=queryresults
[0m15:09:55.427638 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 15:09:50.851349 => 15:09:55.426723
[0m15:09:55.430633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eb2b742-8ab6-4cc2-98f5-03c9892801a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c1057f10>]}
[0m15:09:55.432480 [info ] [Thread-1 (]: 1 of 7 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.59s]
[0m15:09:55.434489 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m15:09:55.435956 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m15:09:55.438009 [info ] [Thread-1 (]: 2 of 7 START sql table model games.dim_platforms ............................... [RUN]
[0m15:09:55.439989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m15:09:55.441063 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m15:09:55.447824 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m15:09:55.449395 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 15:09:55.441782 => 15:09:55.448936
[0m15:09:55.450254 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m15:09:55.460997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:09:56.180891 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m15:09:56.183913 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m15:09:56.830762 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7d3c4732-92f5-469b-8630-10b6407a0c54&page=queryresults
[0m15:09:59.397888 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 15:09:55.450966 => 15:09:59.397217
[0m15:09:59.399892 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eb2b742-8ab6-4cc2-98f5-03c9892801a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c109abf0>]}
[0m15:09:59.401333 [info ] [Thread-1 (]: 2 of 7 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 3.96s]
[0m15:09:59.402841 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m15:09:59.403898 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m15:09:59.404943 [info ] [Thread-1 (]: 3 of 7 START sql table model games.dim_price_overview .......................... [RUN]
[0m15:09:59.406189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m15:09:59.406974 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m15:09:59.412360 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m15:09:59.413446 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 15:09:59.407519 => 15:09:59.413097
[0m15:09:59.414094 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m15:09:59.417394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:00.325102 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m15:10:00.325868 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m15:10:00.866452 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e47e89f7-20b5-40f4-a49d-9211f7970b83&page=queryresults
[0m15:10:04.208756 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 15:09:59.414548 => 15:10:04.207823
[0m15:10:04.212031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eb2b742-8ab6-4cc2-98f5-03c9892801a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c1066890>]}
[0m15:10:04.214636 [info ] [Thread-1 (]: 3 of 7 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (1.1k rows, 114.2 KiB processed)[0m in 4.81s]
[0m15:10:04.217491 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m15:10:04.219549 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m15:10:04.221993 [info ] [Thread-1 (]: 4 of 7 START sql table model games.dim_publishers .............................. [RUN]
[0m15:10:04.225133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m15:10:04.227354 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m15:10:04.237330 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m15:10:04.238805 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 15:10:04.228753 => 15:10:04.238324
[0m15:10:04.239732 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m15:10:04.244284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:04.912335 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m15:10:04.913051 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m15:10:05.509954 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:2b59eb8c-2bad-465d-9dc5-d529edf2205d&page=queryresults
[0m15:10:07.973488 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 15:10:04.240421 => 15:10:07.972603
[0m15:10:07.976805 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eb2b742-8ab6-4cc2-98f5-03c9892801a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c1066e00>]}
[0m15:10:07.979399 [info ] [Thread-1 (]: 4 of 7 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 3.75s]
[0m15:10:07.982264 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m15:10:07.984346 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m15:10:07.986758 [info ] [Thread-1 (]: 5 of 7 START sql table model games.dim_release ................................. [RUN]
[0m15:10:07.989876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m15:10:07.991728 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m15:10:08.001807 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m15:10:08.003295 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 15:10:07.993069 => 15:10:08.002807
[0m15:10:08.004240 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m15:10:08.018231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:08.744099 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m15:10:08.744830 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m15:10:09.372724 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:6952cad0-2372-43bd-930f-ad2237202862&page=queryresults
[0m15:10:12.270660 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 15:10:08.004927 => 15:10:12.270474
[0m15:10:12.271359 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eb2b742-8ab6-4cc2-98f5-03c9892801a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c1930ca0>]}
[0m15:10:12.271917 [info ] [Thread-1 (]: 5 of 7 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.28s]
[0m15:10:12.272540 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m15:10:12.273006 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m15:10:12.273564 [info ] [Thread-1 (]: 6 of 7 START sql table model games.dim_support_language ........................ [RUN]
[0m15:10:12.274197 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m15:10:12.274570 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m15:10:12.277309 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m15:10:12.277944 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 15:10:12.274849 => 15:10:12.277728
[0m15:10:12.278340 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m15:10:12.280414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:13.011265 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m15:10:13.014889 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m15:10:13.632268 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b1fcbc02-e0fc-4cd8-b96e-5fb70bc84264&page=queryresults
[0m15:10:16.739487 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 15:10:12.278605 => 15:10:16.739289
[0m15:10:16.740229 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eb2b742-8ab6-4cc2-98f5-03c9892801a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c17ab670>]}
[0m15:10:16.740841 [info ] [Thread-1 (]: 6 of 7 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.47s]
[0m15:10:16.741564 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m15:10:16.742037 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m15:10:16.742577 [info ] [Thread-1 (]: 7 of 7 START sql table model games.fct_game_pricing ............................ [RUN]
[0m15:10:16.743250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m15:10:16.743673 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m15:10:16.746601 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m15:10:16.747298 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 15:10:16.743962 => 15:10:16.747084
[0m15:10:16.747703 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m15:10:16.750052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:17.601327 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m15:10:17.604101 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        SUM(initial_price) AS total_initial_price,  -- Suma de precios iniciales
        SUM(final_price) AS total_final_price,  -- Suma de precios finales
        SUM(discount_amount) AS total_discount_amount,  -- Suma de montos de descuento
        SUM(price_with_tax) AS total_price_with_tax  -- Suma de precios con impuestos
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY
        app_id
)

SELECT
    ROW_NUMBER() OVER () AS game_sales_id, 
    gs.*
FROM
    game_sales gs
    );
  
[0m15:10:18.160043 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:098d2574-b8cc-4708-94c7-947db7695692&page=queryresults
[0m15:10:20.713298 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 15:10:16.747986 => 15:10:20.712429
[0m15:10:20.716628 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eb2b742-8ab6-4cc2-98f5-03c9892801a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c105b910>]}
[0m15:10:20.719199 [info ] [Thread-1 (]: 7 of 7 OK created sql table model games.fct_game_pricing ....................... [[32mCREATE TABLE (1.1k rows, 62.5 KiB processed)[0m in 3.97s]
[0m15:10:20.722039 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m15:10:20.727871 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:10:20.729494 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m15:10:20.730788 [info ] [MainThread]: 
[0m15:10:20.731190 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 31.39 seconds (31.39s).
[0m15:10:20.732715 [debug] [MainThread]: Command end result
[0m15:10:20.746963 [info ] [MainThread]: 
[0m15:10:20.747470 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:10:20.747873 [info ] [MainThread]: 
[0m15:10:20.748277 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m15:10:20.748876 [debug] [MainThread]: Command `dbt run` succeeded at 15:10:20.748769 after 31.86 seconds
[0m15:10:20.749269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c5932ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c176ea10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c10c7c40>]}
[0m15:10:20.749710 [debug] [MainThread]: Flushing usage events
[0m15:27:40.885060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f850c7251b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f850a894070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f850a8940d0>]}


============================== 15:27:40.887180 | e046c8ed-7ca9-4876-85af-7bf2242e0d5f ==============================
[0m15:27:40.887180 [info ] [MainThread]: Running with dbt=1.6.5
[0m15:27:40.887727 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '../dbt/', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:27:41.180171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e046c8ed-7ca9-4876-85af-7bf2242e0d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f850bd34e50>]}
[0m15:27:41.196408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e046c8ed-7ca9-4876-85af-7bf2242e0d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85088349d0>]}
[0m15:27:41.197081 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m15:27:41.211722 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m15:27:41.273382 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:27:41.273922 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m15:27:41.316447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e046c8ed-7ca9-4876-85af-7bf2242e0d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85086ec0d0>]}
[0m15:27:41.324817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e046c8ed-7ca9-4876-85af-7bf2242e0d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f850863fdf0>]}
[0m15:27:41.325272 [info ] [MainThread]: Found 7 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m15:27:41.325617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e046c8ed-7ca9-4876-85af-7bf2242e0d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f850863fd60>]}
[0m15:27:41.326926 [info ] [MainThread]: 
[0m15:27:41.327571 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:27:41.328831 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m15:27:41.329277 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:27:42.201880 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m15:27:42.203967 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:27:43.003206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e046c8ed-7ca9-4876-85af-7bf2242e0d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f850863df90>]}
[0m15:27:43.003939 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:27:43.004366 [info ] [MainThread]: 
[0m15:27:43.006504 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m15:27:43.006992 [info ] [Thread-1 (]: 1 of 7 START sql table model games.dim_developers .............................. [RUN]
[0m15:27:43.007616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m15:27:43.007992 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m15:27:43.015478 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m15:27:43.016224 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 15:27:43.008272 => 15:27:43.015966
[0m15:27:43.016673 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m15:27:43.032032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:43.793333 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m15:27:43.794104 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m15:27:44.421697 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:bcb0c908-1913-404e-9dbb-fe8a4481a204&page=queryresults
[0m15:27:47.397103 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 15:27:43.016987 => 15:27:47.396787
[0m15:27:47.398230 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e046c8ed-7ca9-4876-85af-7bf2242e0d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8507d53ca0>]}
[0m15:27:47.399138 [info ] [Thread-1 (]: 1 of 7 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.39s]
[0m15:27:47.400117 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m15:27:47.400828 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m15:27:47.401576 [info ] [Thread-1 (]: 2 of 7 START sql table model games.dim_platforms ............................... [RUN]
[0m15:27:47.402436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_platforms)
[0m15:27:47.402966 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m15:27:47.406564 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m15:27:47.407324 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 15:27:47.403345 => 15:27:47.407072
[0m15:27:47.407804 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m15:27:47.414669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:48.108297 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m15:27:48.109245 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m15:27:48.748365 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:3c64690b-cf78-4913-bab5-074fc6bc8059&page=queryresults
[0m15:27:51.622226 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 15:27:47.408157 => 15:27:51.621834
[0m15:27:51.623745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e046c8ed-7ca9-4876-85af-7bf2242e0d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8507da21d0>]}
[0m15:27:51.625053 [info ] [Thread-1 (]: 2 of 7 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.22s]
[0m15:27:51.626428 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m15:27:51.627360 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m15:27:51.628426 [info ] [Thread-1 (]: 3 of 7 START sql table model games.dim_price_overview .......................... [RUN]
[0m15:27:51.629730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m15:27:51.630522 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m15:27:51.636416 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m15:27:51.638228 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 15:27:51.631079 => 15:27:51.637731
[0m15:27:51.639071 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m15:27:51.642848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:52.412255 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m15:27:52.412934 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m15:27:53.237392 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:205e8524-1682-4247-8003-e1374b2c5d34&page=queryresults
[0m15:27:56.288328 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 15:27:51.639595 => 15:27:56.287508
[0m15:27:56.291696 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e046c8ed-7ca9-4876-85af-7bf2242e0d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8507d97d90>]}
[0m15:27:56.294349 [info ] [Thread-1 (]: 3 of 7 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (1.1k rows, 114.2 KiB processed)[0m in 4.66s]
[0m15:27:56.297211 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m15:27:56.299265 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m15:27:56.302011 [info ] [Thread-1 (]: 4 of 7 START sql table model games.dim_publishers .............................. [RUN]
[0m15:27:56.305334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m15:27:56.307216 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m15:27:56.317965 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m15:27:56.319572 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 15:27:56.308580 => 15:27:56.319089
[0m15:27:56.320507 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m15:27:56.325189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:57.056183 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m15:27:57.058953 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m15:27:57.702647 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c4cee2bf-051f-4ee5-800c-9c4e62f0586f&page=queryresults
[0m15:28:01.693585 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 15:27:56.321165 => 15:28:01.692686
[0m15:28:01.696974 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e046c8ed-7ca9-4876-85af-7bf2242e0d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8507d960b0>]}
[0m15:28:01.699593 [info ] [Thread-1 (]: 4 of 7 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 5.39s]
[0m15:28:01.702492 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m15:28:01.704583 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m15:28:01.707108 [info ] [Thread-1 (]: 5 of 7 START sql table model games.dim_release ................................. [RUN]
[0m15:28:01.710337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m15:28:01.712155 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m15:28:01.724594 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m15:28:01.727411 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 15:28:01.713484 => 15:28:01.726480
[0m15:28:01.729240 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m15:28:01.748359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:02.409756 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m15:28:02.410476 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m15:28:03.038877 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9e45d3fc-44d3-4359-b03b-530fb52032db&page=queryresults
[0m15:28:05.849374 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 15:28:01.730524 => 15:28:05.849193
[0m15:28:05.850060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e046c8ed-7ca9-4876-85af-7bf2242e0d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8508836140>]}
[0m15:28:05.850628 [info ] [Thread-1 (]: 5 of 7 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.14s]
[0m15:28:05.851245 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m15:28:05.851717 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m15:28:05.852291 [info ] [Thread-1 (]: 6 of 7 START sql table model games.dim_support_language ........................ [RUN]
[0m15:28:05.852930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m15:28:05.853303 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m15:28:05.856178 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m15:28:05.856820 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 15:28:05.853598 => 15:28:05.856618
[0m15:28:05.857208 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m15:28:05.859451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:06.595466 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m15:28:06.596493 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m15:28:07.234593 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:0049f33a-a408-4f13-a476-894fecfd4fde&page=queryresults
[0m15:28:10.414070 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 15:28:05.857493 => 15:28:10.413169
[0m15:28:10.417214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e046c8ed-7ca9-4876-85af-7bf2242e0d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85086b2e00>]}
[0m15:28:10.419770 [info ] [Thread-1 (]: 6 of 7 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.56s]
[0m15:28:10.422620 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m15:28:10.424726 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m15:28:10.427228 [info ] [Thread-1 (]: 7 of 7 START sql table model games.fct_game_pricing ............................ [RUN]
[0m15:28:10.430201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m15:28:10.432024 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m15:28:10.440615 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m15:28:10.442183 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 15:28:10.433366 => 15:28:10.441661
[0m15:28:10.443119 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m15:28:10.447398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:11.177893 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m15:28:11.178638 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crear una tabla de hechos para el análisis de precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        SUM(price_with_tax) AS total_sales,
        SUM(discount_amount) AS total_discounts,
        COUNT(*) AS num_sales,
        MAX(discount_pct) AS max_discount,
        MIN(initial_price) AS min_price,
        MAX(initial_price) AS max_price,
        SUM(price_with_tax) AS total_sales_with_tax,
        SUM(final_price) AS total_sales_with_tax_discounted
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id
)

SELECT
   g.*
FROM game_sales g
    );
  
[0m15:28:11.641344 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d0fa1c92-252f-4e95-b4b9-37d6527e19bd&page=queryresults
[0m15:28:14.145242 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 15:28:10.443724 => 15:28:14.145028
[0m15:28:14.146139 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e046c8ed-7ca9-4876-85af-7bf2242e0d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8508836fe0>]}
[0m15:28:14.146796 [info ] [Thread-1 (]: 7 of 7 OK created sql table model games.fct_game_pricing ....................... [[32mCREATE TABLE (1.1k rows, 71.4 KiB processed)[0m in 3.72s]
[0m15:28:14.147483 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m15:28:14.148983 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:28:14.149396 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m15:28:14.149790 [info ] [MainThread]: 
[0m15:28:14.150231 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 32.82 seconds (32.82s).
[0m15:28:14.151870 [debug] [MainThread]: Command end result
[0m15:28:14.167935 [info ] [MainThread]: 
[0m15:28:14.168437 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:28:14.168807 [info ] [MainThread]: 
[0m15:28:14.169199 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m15:28:14.169840 [debug] [MainThread]: Command `dbt run` succeeded at 15:28:14.169723 after 33.29 seconds
[0m15:28:14.170238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f850c7251b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85086769e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8507ddfca0>]}
[0m15:28:14.170630 [debug] [MainThread]: Flushing usage events
[0m15:58:41.643552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4698726b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46968c4070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46968c40d0>]}


============================== 15:58:41.645795 | 2e75dc5f-2974-4cf9-bb31-7bbd9bfd561d ==============================
[0m15:58:41.645795 [info ] [MainThread]: Running with dbt=1.6.5
[0m15:58:41.646416 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '../dbt/', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:58:41.952431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e75dc5f-2974-4cf9-bb31-7bbd9bfd561d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f469484ac50>]}
[0m15:58:41.969494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e75dc5f-2974-4cf9-bb31-7bbd9bfd561d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4694864640>]}
[0m15:58:41.970159 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m15:58:41.985820 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m15:58:42.056689 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m15:58:42.057258 [debug] [MainThread]: Partial parsing: added file: games://models/transform/dim_games.sql
[0m15:58:42.057708 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m15:58:42.109153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e75dc5f-2974-4cf9-bb31-7bbd9bfd561d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46946a40d0>]}
[0m15:58:42.119153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e75dc5f-2974-4cf9-bb31-7bbd9bfd561d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f469466fdf0>]}
[0m15:58:42.119682 [info ] [MainThread]: Found 8 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m15:58:42.120177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e75dc5f-2974-4cf9-bb31-7bbd9bfd561d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f469466fd60>]}
[0m15:58:42.121689 [info ] [MainThread]: 
[0m15:58:42.122556 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:58:42.124139 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m15:58:42.124614 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:42.890513 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m15:58:42.891027 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:58:43.589178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e75dc5f-2974-4cf9-bb31-7bbd9bfd561d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f469466ddb0>]}
[0m15:58:43.589971 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:58:43.590360 [info ] [MainThread]: 
[0m15:58:43.592189 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m15:58:43.592674 [info ] [Thread-1 (]: 1 of 8 START sql table model games.dim_developers .............................. [RUN]
[0m15:58:43.593309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m15:58:43.593715 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m15:58:43.601081 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m15:58:43.601790 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 15:58:43.594001 => 15:58:43.601580
[0m15:58:43.602326 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m15:58:43.616175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:44.361575 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m15:58:44.362274 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m15:58:45.101957 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:870e7908-1f84-4084-a2b9-746da7e7f616&page=queryresults
[0m15:58:49.298827 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 15:58:43.602689 => 15:58:49.298636
[0m15:58:49.299548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e75dc5f-2974-4cf9-bb31-7bbd9bfd561d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4693f87e50>]}
[0m15:58:49.300136 [info ] [Thread-1 (]: 1 of 8 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 5.71s]
[0m15:58:49.300811 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m15:58:49.301325 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m15:58:49.301973 [info ] [Thread-1 (]: 2 of 8 START sql table model games.dim_games ................................... [RUN]
[0m15:58:49.302635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m15:58:49.303024 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m15:58:49.305937 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m15:58:49.306752 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 15:58:49.303291 => 15:58:49.306527
[0m15:58:49.307148 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m15:58:49.316641 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m15:58:49.317276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:49.351196 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM game_sales g
    );
  
[0m15:58:50.055037 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:6d0bf146-ed7e-4239-bbd6-421ca5119a5e&page=queryresults
[0m15:58:50.056353 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "game_sales" must be qualified with a dataset (e.g. dataset.table).')
[0m15:58:50.983904 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:aea48997-8386-483a-a65b-3d1b5f243601&page=queryresults
[0m15:58:50.991455 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:aea48997-8386-483a-a65b-3d1b5f243601&page=queryresults
[0m15:58:50.992239 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 15:58:49.307445 => 15:58:50.992003
[0m15:58:50.995106 [debug] [Thread-1 (]: Database Error in model dim_games (models/transform/dim_games.sql)
  Table "game_sales" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/games/models/transform/dim_games.sql
[0m15:58:50.995658 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e75dc5f-2974-4cf9-bb31-7bbd9bfd561d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4693f84100>]}
[0m15:58:50.996522 [error] [Thread-1 (]: 2 of 8 ERROR creating sql table model games.dim_games .......................... [[31mERROR[0m in 1.69s]
[0m15:58:50.997255 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m15:58:50.997740 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m15:58:50.998325 [info ] [Thread-1 (]: 3 of 8 START sql table model games.dim_platforms ............................... [RUN]
[0m15:58:50.999054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m15:58:50.999711 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m15:58:51.008717 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m15:58:51.009675 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 15:58:51.000007 => 15:58:51.009401
[0m15:58:51.010136 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m15:58:51.012979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:51.736763 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m15:58:51.737725 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m15:58:52.427498 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:21808a80-f463-4527-b8d1-23dea5fc00df&page=queryresults
[0m15:58:55.076128 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 15:58:51.010518 => 15:58:55.075920
[0m15:58:55.076970 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e75dc5f-2974-4cf9-bb31-7bbd9bfd561d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46948719c0>]}
[0m15:58:55.077608 [info ] [Thread-1 (]: 3 of 8 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.08s]
[0m15:58:55.078240 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m15:58:55.078750 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m15:58:55.079341 [info ] [Thread-1 (]: 4 of 8 START sql table model games.dim_price_overview .......................... [RUN]
[0m15:58:55.080660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m15:58:55.081210 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m15:58:55.085393 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m15:58:55.086127 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 15:58:55.081684 => 15:58:55.085917
[0m15:58:55.086655 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m15:58:55.090011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:55.806918 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m15:58:55.807600 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m15:58:56.419206 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ec5079ed-50a3-4cc5-bd72-83e5d50ead35&page=queryresults
[0m15:58:58.675328 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 15:58:55.086951 => 15:58:58.674451
[0m15:58:58.678666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e75dc5f-2974-4cf9-bb31-7bbd9bfd561d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46948708b0>]}
[0m15:58:58.681237 [info ] [Thread-1 (]: 4 of 8 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (1.1k rows, 114.2 KiB processed)[0m in 3.60s]
[0m15:58:58.684055 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m15:58:58.686136 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m15:58:58.688861 [info ] [Thread-1 (]: 5 of 8 START sql table model games.dim_publishers .............................. [RUN]
[0m15:58:58.692030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m15:58:58.693333 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m15:58:58.701852 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m15:58:58.702529 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 15:58:58.693623 => 15:58:58.702334
[0m15:58:58.702899 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m15:58:58.705040 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:59.488001 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m15:58:59.490863 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m15:59:00.137402 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:fbe64c9d-1ec0-416a-bbfe-7f2e703e8c9f&page=queryresults
[0m15:59:02.665053 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 15:58:58.703158 => 15:59:02.664150
[0m15:59:02.668243 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e75dc5f-2974-4cf9-bb31-7bbd9bfd561d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46946e4e80>]}
[0m15:59:02.670822 [info ] [Thread-1 (]: 5 of 8 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 3.98s]
[0m15:59:02.673680 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m15:59:02.675735 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m15:59:02.678191 [info ] [Thread-1 (]: 6 of 8 START sql table model games.dim_release ................................. [RUN]
[0m15:59:02.681204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m15:59:02.683091 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m15:59:02.693134 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m15:59:02.694675 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 15:59:02.684467 => 15:59:02.694187
[0m15:59:02.695628 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m15:59:02.700263 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:03.458245 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m15:59:03.458968 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m15:59:04.083640 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d5d569cd-e86c-4d34-ae48-cf25cfa8df5b&page=queryresults
[0m15:59:06.972852 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 15:59:02.696314 => 15:59:06.971952
[0m15:59:06.975946 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e75dc5f-2974-4cf9-bb31-7bbd9bfd561d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46946a5ea0>]}
[0m15:59:06.978532 [info ] [Thread-1 (]: 6 of 8 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.30s]
[0m15:59:06.981367 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m15:59:06.983418 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m15:59:06.985873 [info ] [Thread-1 (]: 7 of 8 START sql table model games.dim_support_language ........................ [RUN]
[0m15:59:06.988870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m15:59:06.990736 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m15:59:07.001536 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m15:59:07.003209 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 15:59:06.992048 => 15:59:07.002720
[0m15:59:07.004152 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m15:59:07.009001 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:07.787347 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m15:59:07.788127 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m15:59:08.415779 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5ebdf5b3-935f-49f3-927f-513066284dec&page=queryresults
[0m15:59:10.949691 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 15:59:07.004851 => 15:59:10.948819
[0m15:59:10.952842 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e75dc5f-2974-4cf9-bb31-7bbd9bfd561d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46914fbfa0>]}
[0m15:59:10.955388 [info ] [Thread-1 (]: 7 of 8 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 3.96s]
[0m15:59:10.958294 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m15:59:10.960356 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m15:59:10.962774 [info ] [Thread-1 (]: 8 of 8 START sql table model games.fct_game_pricing ............................ [RUN]
[0m15:59:10.965784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m15:59:10.967657 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m15:59:10.977883 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m15:59:10.979430 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 15:59:10.969002 => 15:59:10.978938
[0m15:59:10.980387 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m15:59:10.984868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:11.754367 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m15:59:11.755108 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para el análisis de precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        SUM(price_with_tax) AS total_sales,
        SUM(discount_amount) AS total_discounts,
        COUNT(*) AS num_sales,
        MAX(discount_pct) AS max_discount,
        MIN(initial_price) AS min_price,
        MAX(initial_price) AS max_price,
        SUM(price_with_tax) AS total_sales_with_tax,
        SUM(final_price) AS total_sales_with_tax_discounted
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id
)

SELECT
   g.*
FROM game_sales g
    );
  
[0m15:59:12.248719 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5c328429-76fa-47a3-8cc5-69079b73d374&page=queryresults
[0m15:59:14.783000 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 15:59:10.981101 => 15:59:14.782068
[0m15:59:14.786212 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e75dc5f-2974-4cf9-bb31-7bbd9bfd561d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4691515870>]}
[0m15:59:14.788893 [info ] [Thread-1 (]: 8 of 8 OK created sql table model games.fct_game_pricing ....................... [[32mCREATE TABLE (1.1k rows, 71.4 KiB processed)[0m in 3.82s]
[0m15:59:14.791892 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m15:59:14.797999 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:59:14.799610 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m15:59:14.800405 [info ] [MainThread]: 
[0m15:59:14.800765 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 32.68 seconds (32.68s).
[0m15:59:14.802598 [debug] [MainThread]: Command end result
[0m15:59:14.810843 [info ] [MainThread]: 
[0m15:59:14.811300 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:59:14.811676 [info ] [MainThread]: 
[0m15:59:14.812044 [error] [MainThread]:   Database Error in model dim_games (models/transform/dim_games.sql)
  Table "game_sales" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/games/models/transform/dim_games.sql
[0m15:59:14.812453 [info ] [MainThread]: 
[0m15:59:14.812794 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m15:59:14.813331 [debug] [MainThread]: Command `dbt run` failed at 15:59:14.813234 after 33.18 seconds
[0m15:59:14.813689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4698726b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f469151bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4691517670>]}
[0m15:59:14.814057 [debug] [MainThread]: Flushing usage events
[0m15:59:33.875518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144f41dbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144d5c0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144d5c00d0>]}


============================== 15:59:33.877629 | 31a4f96c-dd8c-4cfe-ac8c-dc39584b1e0d ==============================
[0m15:59:33.877629 [info ] [MainThread]: Running with dbt=1.6.5
[0m15:59:33.878120 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '../dbt/', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'send_anonymous_usage_stats': 'True'}
[0m15:59:34.153318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31a4f96c-dd8c-4cfe-ac8c-dc39584b1e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144b542c50>]}
[0m15:59:34.168904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31a4f96c-dd8c-4cfe-ac8c-dc39584b1e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144b55c7c0>]}
[0m15:59:34.169476 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m15:59:34.182877 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m15:59:34.246495 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:59:34.247039 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_games.sql
[0m15:59:34.289824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31a4f96c-dd8c-4cfe-ac8c-dc39584b1e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144b39c0d0>]}
[0m15:59:34.298401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31a4f96c-dd8c-4cfe-ac8c-dc39584b1e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144b367d90>]}
[0m15:59:34.298854 [info ] [MainThread]: Found 8 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m15:59:34.299196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31a4f96c-dd8c-4cfe-ac8c-dc39584b1e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144b367e80>]}
[0m15:59:34.300577 [info ] [MainThread]: 
[0m15:59:34.301234 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:59:34.302776 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m15:59:34.303389 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:35.036825 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m15:59:35.037351 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:35.768897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31a4f96c-dd8c-4cfe-ac8c-dc39584b1e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144b365e10>]}
[0m15:59:35.772085 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:59:35.773783 [info ] [MainThread]: 
[0m15:59:35.781995 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m15:59:35.784197 [info ] [Thread-1 (]: 1 of 8 START sql table model games.dim_developers .............................. [RUN]
[0m15:59:35.787127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m15:59:35.788979 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m15:59:35.819334 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m15:59:35.820894 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 15:59:35.790252 => 15:59:35.820407
[0m15:59:35.821836 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m15:59:35.842164 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:36.582991 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m15:59:36.583689 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m15:59:37.193784 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:31c03b04-d179-486c-826f-3c19676a20ee&page=queryresults
[0m15:59:39.979319 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 15:59:35.822495 => 15:59:39.979132
[0m15:59:39.980164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31a4f96c-dd8c-4cfe-ac8c-dc39584b1e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144b3b8070>]}
[0m15:59:39.980789 [info ] [Thread-1 (]: 1 of 8 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.19s]
[0m15:59:39.981416 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m15:59:39.981883 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m15:59:39.982427 [info ] [Thread-1 (]: 2 of 8 START sql table model games.dim_games ................................... [RUN]
[0m15:59:39.983081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m15:59:39.983511 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m15:59:39.986183 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m15:59:39.986840 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 15:59:39.983768 => 15:59:39.986625
[0m15:59:39.987227 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m15:59:39.994067 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m15:59:39.994924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:40.027096 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m15:59:41.060551 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:104a2d27-db24-4a1d-9ff4-91b373390901&page=queryresults
[0m15:59:43.588730 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 15:59:39.987485 => 15:59:43.587827
[0m15:59:43.591806 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31a4f96c-dd8c-4cfe-ac8c-dc39584b1e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144aabb670>]}
[0m15:59:43.594362 [info ] [Thread-1 (]: 2 of 8 OK created sql table model games.dim_games .............................. [[32mCREATE TABLE (2.7k rows, 753.9 KiB processed)[0m in 3.61s]
[0m15:59:43.597191 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m15:59:43.599197 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m15:59:43.601546 [info ] [Thread-1 (]: 3 of 8 START sql table model games.dim_platforms ............................... [RUN]
[0m15:59:43.604499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m15:59:43.606321 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m15:59:43.613069 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m15:59:43.613749 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 15:59:43.607620 => 15:59:43.613532
[0m15:59:43.614155 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m15:59:43.616370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:44.403805 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m15:59:44.406507 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m15:59:44.984268 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e3c7821f-57df-45cd-b25d-3fff80783b15&page=queryresults
[0m15:59:47.740489 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 15:59:43.614449 => 15:59:47.739590
[0m15:59:47.743577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31a4f96c-dd8c-4cfe-ac8c-dc39584b1e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144aa87e50>]}
[0m15:59:47.746148 [info ] [Thread-1 (]: 3 of 8 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.14s]
[0m15:59:47.748969 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m15:59:47.751008 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m15:59:47.753137 [info ] [Thread-1 (]: 4 of 8 START sql table model games.dim_price_overview .......................... [RUN]
[0m15:59:47.756558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m15:59:47.758429 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m15:59:47.765193 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m15:59:47.765873 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 15:59:47.759741 => 15:59:47.765654
[0m15:59:47.766264 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m15:59:47.768554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:48.557433 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m15:59:48.558124 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m15:59:49.163800 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c6c875cc-9bf4-42a3-b7cf-bb0b94ec6bff&page=queryresults
[0m15:59:51.638026 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 15:59:47.766515 => 15:59:51.637151
[0m15:59:51.641341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31a4f96c-dd8c-4cfe-ac8c-dc39584b1e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144aa85f30>]}
[0m15:59:51.643885 [info ] [Thread-1 (]: 4 of 8 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (1.1k rows, 114.2 KiB processed)[0m in 3.89s]
[0m15:59:51.646728 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m15:59:51.648780 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m15:59:51.651494 [info ] [Thread-1 (]: 5 of 8 START sql table model games.dim_publishers .............................. [RUN]
[0m15:59:51.654617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m15:59:51.656240 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m15:59:51.659174 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m15:59:51.659902 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 15:59:51.656516 => 15:59:51.659665
[0m15:59:51.660288 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m15:59:51.668254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:52.411383 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m15:59:52.412126 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m15:59:52.865882 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:40d8e551-65b7-4dc2-bb70-179bd695b5c1&page=queryresults
[0m15:59:55.657447 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 15:59:51.660552 => 15:59:55.656572
[0m15:59:55.660584 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31a4f96c-dd8c-4cfe-ac8c-dc39584b1e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144b5405e0>]}
[0m15:59:55.663114 [info ] [Thread-1 (]: 5 of 8 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.01s]
[0m15:59:55.665968 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m15:59:55.668025 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m15:59:55.670453 [info ] [Thread-1 (]: 6 of 8 START sql table model games.dim_release ................................. [RUN]
[0m15:59:55.673412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m15:59:55.675245 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m15:59:55.682066 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m15:59:55.682809 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 15:59:55.676585 => 15:59:55.682571
[0m15:59:55.683220 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m15:59:55.685402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:56.430410 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m15:59:56.431166 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m15:59:57.054620 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7875fb3b-dc10-44d1-8239-76ab370320aa&page=queryresults
[0m15:59:59.856087 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 15:59:55.683474 => 15:59:59.855873
[0m15:59:59.856920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31a4f96c-dd8c-4cfe-ac8c-dc39584b1e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144aa7a2c0>]}
[0m15:59:59.857593 [info ] [Thread-1 (]: 6 of 8 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.18s]
[0m15:59:59.858256 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m15:59:59.858760 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m15:59:59.859388 [info ] [Thread-1 (]: 7 of 8 START sql table model games.dim_support_language ........................ [RUN]
[0m15:59:59.860173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m15:59:59.860692 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m15:59:59.863864 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m15:59:59.865013 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 15:59:59.861021 => 15:59:59.864691
[0m15:59:59.865548 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m15:59:59.868506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:00.605625 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m16:00:00.607593 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m16:00:01.235175 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9eefdbce-0adc-4415-8b07-d022967c12ea&page=queryresults
[0m16:00:04.283974 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 15:59:59.865925 => 16:00:04.283659
[0m16:00:04.285186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31a4f96c-dd8c-4cfe-ac8c-dc39584b1e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144aa87a60>]}
[0m16:00:04.286111 [info ] [Thread-1 (]: 7 of 8 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.43s]
[0m16:00:04.287095 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m16:00:04.287824 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m16:00:04.288704 [info ] [Thread-1 (]: 8 of 8 START sql table model games.fct_game_pricing ............................ [RUN]
[0m16:00:04.289795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m16:00:04.290421 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m16:00:04.304510 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m16:00:04.305573 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 16:00:04.290872 => 16:00:04.305240
[0m16:00:04.306202 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m16:00:04.310953 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:05.022926 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m16:00:05.023652 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para el análisis de precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        SUM(price_with_tax) AS total_sales,
        SUM(discount_amount) AS total_discounts,
        COUNT(*) AS num_sales,
        MAX(discount_pct) AS max_discount,
        MIN(initial_price) AS min_price,
        MAX(initial_price) AS max_price,
        SUM(price_with_tax) AS total_sales_with_tax,
        SUM(final_price) AS total_sales_with_tax_discounted
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id
)

SELECT
   g.*
FROM game_sales g
    );
  
[0m16:00:05.717422 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:83921cb7-3f00-453c-8777-3a467a607491&page=queryresults
[0m16:00:08.458520 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 16:00:04.306645 => 16:00:08.458095
[0m16:00:08.459467 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31a4f96c-dd8c-4cfe-ac8c-dc39584b1e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144b5404c0>]}
[0m16:00:08.460283 [info ] [Thread-1 (]: 8 of 8 OK created sql table model games.fct_game_pricing ....................... [[32mCREATE TABLE (1.1k rows, 71.4 KiB processed)[0m in 4.17s]
[0m16:00:08.461019 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m16:00:08.462503 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:00:08.462921 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m16:00:08.463298 [info ] [MainThread]: 
[0m16:00:08.463670 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 34.16 seconds (34.16s).
[0m16:00:08.465323 [debug] [MainThread]: Command end result
[0m16:00:08.475251 [info ] [MainThread]: 
[0m16:00:08.475766 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:00:08.476283 [info ] [MainThread]: 
[0m16:00:08.476777 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m16:00:08.477516 [debug] [MainThread]: Command `dbt run` succeeded at 16:00:08.477386 after 34.61 seconds
[0m16:00:08.478007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144f41dbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144aad3fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144b5684c0>]}
[0m16:00:08.478467 [debug] [MainThread]: Flushing usage events
[0m16:36:13.043685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f929641ead0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92945b4070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92945b40d0>]}


============================== 16:36:13.046311 | fecf5dc6-a516-4768-a4be-a973e8a5fd3c ==============================
[0m16:36:13.046311 [info ] [MainThread]: Running with dbt=1.6.5
[0m16:36:13.046836 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '../dbt/', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'send_anonymous_usage_stats': 'True'}
[0m16:36:13.399715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fecf5dc6-a516-4768-a4be-a973e8a5fd3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9295a6fdc0>]}
[0m16:36:13.415183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fecf5dc6-a516-4768-a4be-a973e8a5fd3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92925509d0>]}
[0m16:36:13.415750 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m16:36:13.429697 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m16:36:13.498864 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:36:13.499415 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m16:36:13.542801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fecf5dc6-a516-4768-a4be-a973e8a5fd3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92923800d0>]}
[0m16:36:13.551627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fecf5dc6-a516-4768-a4be-a973e8a5fd3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f929235fdc0>]}
[0m16:36:13.552085 [info ] [MainThread]: Found 8 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m16:36:13.552464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fecf5dc6-a516-4768-a4be-a973e8a5fd3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f929235fd30>]}
[0m16:36:13.553762 [info ] [MainThread]: 
[0m16:36:13.554411 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:36:13.555591 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m16:36:13.556171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:14.371587 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m16:36:14.373654 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:36:15.133020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fecf5dc6-a516-4768-a4be-a973e8a5fd3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f929235e6b0>]}
[0m16:36:15.133748 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:36:15.134107 [info ] [MainThread]: 
[0m16:36:15.136278 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m16:36:15.136783 [info ] [Thread-1 (]: 1 of 8 START sql table model games.dim_developers .............................. [RUN]
[0m16:36:15.137425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m16:36:15.137815 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m16:36:15.144905 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m16:36:15.145597 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 16:36:15.138090 => 16:36:15.145348
[0m16:36:15.146004 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m16:36:15.158516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:15.966340 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m16:36:15.967068 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m16:36:16.532757 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b1ea1bf2-dc1b-43f1-8ee0-583a1e89930a&page=queryresults
[0m16:36:19.620906 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 16:36:15.146291 => 16:36:19.620718
[0m16:36:19.621724 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecf5dc6-a516-4768-a4be-a973e8a5fd3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9292551450>]}
[0m16:36:19.622305 [info ] [Thread-1 (]: 1 of 8 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.48s]
[0m16:36:19.622934 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m16:36:19.623407 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m16:36:19.623955 [info ] [Thread-1 (]: 2 of 8 START sql table model games.dim_games ................................... [RUN]
[0m16:36:19.624615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m16:36:19.625012 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m16:36:19.627648 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m16:36:19.628369 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 16:36:19.625271 => 16:36:19.628143
[0m16:36:19.628804 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m16:36:19.634801 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:20.311460 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m16:36:20.314146 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m16:36:20.923001 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9d1c78b4-d069-412d-8f2e-c4a07c27ce99&page=queryresults
[0m16:36:23.733939 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 16:36:19.629066 => 16:36:23.733071
[0m16:36:23.737075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecf5dc6-a516-4768-a4be-a973e8a5fd3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9291aad870>]}
[0m16:36:23.739658 [info ] [Thread-1 (]: 2 of 8 OK created sql table model games.dim_games .............................. [[32mCREATE TABLE (2.7k rows, 753.9 KiB processed)[0m in 4.11s]
[0m16:36:23.742498 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m16:36:23.744576 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m16:36:23.746968 [info ] [Thread-1 (]: 3 of 8 START sql table model games.dim_platforms ............................... [RUN]
[0m16:36:23.749934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m16:36:23.751767 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m16:36:23.758890 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m16:36:23.759602 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 16:36:23.753106 => 16:36:23.759381
[0m16:36:23.760013 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m16:36:23.762386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:24.535195 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m16:36:24.535930 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m16:36:25.174789 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b46ce220-1885-4a50-b3fe-751d5f0031b0&page=queryresults
[0m16:36:27.964855 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 16:36:23.760321 => 16:36:27.963929
[0m16:36:27.968186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecf5dc6-a516-4768-a4be-a973e8a5fd3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9291a8a530>]}
[0m16:36:27.970788 [info ] [Thread-1 (]: 3 of 8 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.22s]
[0m16:36:27.973609 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m16:36:27.975670 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m16:36:27.978038 [info ] [Thread-1 (]: 4 of 8 START sql table model games.dim_price_overview .......................... [RUN]
[0m16:36:27.981112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m16:36:27.982966 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m16:36:27.989950 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m16:36:27.990629 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 16:36:27.984297 => 16:36:27.990409
[0m16:36:27.991060 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m16:36:27.993283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:28.692392 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m16:36:28.693207 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m16:36:29.194506 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f8d9a865-78ff-4daa-892d-b9708307b68d&page=queryresults
[0m16:36:31.999765 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 16:36:27.991340 => 16:36:31.998882
[0m16:36:32.003133 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecf5dc6-a516-4768-a4be-a973e8a5fd3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9291a78070>]}
[0m16:36:32.005781 [info ] [Thread-1 (]: 4 of 8 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (1.1k rows, 114.2 KiB processed)[0m in 4.02s]
[0m16:36:32.008635 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m16:36:32.010675 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m16:36:32.013089 [info ] [Thread-1 (]: 5 of 8 START sql table model games.dim_publishers .............................. [RUN]
[0m16:36:32.016146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m16:36:32.018023 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m16:36:32.024082 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m16:36:32.024865 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 16:36:32.019333 => 16:36:32.024611
[0m16:36:32.025262 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m16:36:32.033277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:32.795570 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m16:36:32.796253 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m16:36:33.430540 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b133a3cf-d15b-4e24-b9f8-8ac719a9fb5e&page=queryresults
[0m16:36:36.230086 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 16:36:32.025519 => 16:36:36.229207
[0m16:36:36.233202 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecf5dc6-a516-4768-a4be-a973e8a5fd3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92923838e0>]}
[0m16:36:36.235748 [info ] [Thread-1 (]: 5 of 8 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.22s]
[0m16:36:36.238612 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m16:36:36.240687 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m16:36:36.243374 [info ] [Thread-1 (]: 6 of 8 START sql table model games.dim_release ................................. [RUN]
[0m16:36:36.246341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m16:36:36.248173 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m16:36:36.251367 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m16:36:36.252081 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 16:36:36.248631 => 16:36:36.251830
[0m16:36:36.252518 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m16:36:36.254658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:36.941746 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m16:36:36.942459 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m16:36:37.621408 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a0a3af89-f4c2-42e5-a164-e2cae77a77d1&page=queryresults
[0m16:36:40.824457 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 16:36:36.252778 => 16:36:40.824273
[0m16:36:40.825146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecf5dc6-a516-4768-a4be-a973e8a5fd3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9291abd2d0>]}
[0m16:36:40.825720 [info ] [Thread-1 (]: 6 of 8 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.58s]
[0m16:36:40.826332 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m16:36:40.826808 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m16:36:40.827369 [info ] [Thread-1 (]: 7 of 8 START sql table model games.dim_support_language ........................ [RUN]
[0m16:36:40.828001 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m16:36:40.828397 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m16:36:40.831245 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m16:36:40.831882 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 16:36:40.828672 => 16:36:40.831684
[0m16:36:40.832277 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m16:36:40.834515 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:41.531841 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m16:36:41.532587 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m16:36:42.230021 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5990805c-5513-49e7-9e47-5f8ae163bd02&page=queryresults
[0m16:36:45.651839 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 16:36:40.832550 => 16:36:45.650963
[0m16:36:45.655147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecf5dc6-a516-4768-a4be-a973e8a5fd3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92923bfe50>]}
[0m16:36:45.657751 [info ] [Thread-1 (]: 7 of 8 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.83s]
[0m16:36:45.660579 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m16:36:45.662637 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m16:36:45.665099 [info ] [Thread-1 (]: 8 of 8 START sql table model games.fct_game_pricing ............................ [RUN]
[0m16:36:45.668232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m16:36:45.670126 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m16:36:45.683413 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m16:36:45.684090 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 16:36:45.671450 => 16:36:45.683896
[0m16:36:45.684467 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m16:36:45.687031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:46.440119 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m16:36:46.440937 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para el análisis de precios de juegos
WITH game_sales AS (
    SELECT
        g.app_id,
        p.id_purchase,     
        pl.platform_id,      
        d.developer_id,     
        pub.publisher_id,     
        SUM(p.price_with_tax) AS total_sales,
        SUM(p.discount_amount) AS total_discounts,
        COUNT(*) AS num_sales,
        MAX(p.discount_pct) AS max_discount,
        MIN(p.initial_price) AS min_price,
        MAX(p.initial_price) AS max_price,
        SUM(p.price_with_tax) AS total_sales_with_tax,
        SUM(p.final_price) AS total_sales_with_tax_discounted
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview` AS p
    JOIN
        `pristine-flames-400818`.`games`.`dim_platforms` AS pl ON g.platform_id = pl.platform_id  
    JOIN
        `pristine-flames-400818`.`games`.`dim_developers` AS d ON g.developer_id = d.developer_id  
    JOIN
        `pristine-flames-400818`.`games`.`dim_publishers` AS pub ON g.publisher_id = pub.publisher_id  
    JOIN
        `pristine-flames-400818`.`games`.`dim_games` AS ga ON g.app_id = ga.app_id  
    GROUP BY g.app_id, p.id_purchase, pl.platform_id, d.developer_id, pub.publisher_id
)

SELECT
   g.*
FROM game_sales g
    );
  
[0m16:36:47.037974 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:6565b79f-522b-41ad-be70-6186542aa77a&page=queryresults
[0m16:36:47.584347 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: g at [34:67]')
[0m16:36:49.084373 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9cedf7c9-b167-4e80-9309-0d761d821ffd&page=queryresults
[0m16:36:49.658976 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9cedf7c9-b167-4e80-9309-0d761d821ffd&page=queryresults
[0m16:36:49.662146 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 16:36:45.684728 => 16:36:49.661203
[0m16:36:49.665380 [debug] [Thread-1 (]: Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Unrecognized name: g at [34:67]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m16:36:49.665856 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecf5dc6-a516-4768-a4be-a973e8a5fd3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92925501f0>]}
[0m16:36:49.666425 [error] [Thread-1 (]: 8 of 8 ERROR creating sql table model games.fct_game_pricing ................... [[31mERROR[0m in 4.00s]
[0m16:36:49.667028 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m16:36:49.668519 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:36:49.668839 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m16:36:49.669180 [info ] [MainThread]: 
[0m16:36:49.669527 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 36.12 seconds (36.12s).
[0m16:36:49.671049 [debug] [MainThread]: Command end result
[0m16:36:49.679551 [info ] [MainThread]: 
[0m16:36:49.680086 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:36:49.680504 [info ] [MainThread]: 
[0m16:36:49.680871 [error] [MainThread]:   Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Unrecognized name: g at [34:67]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m16:36:49.681222 [info ] [MainThread]: 
[0m16:36:49.681580 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m16:36:49.682145 [debug] [MainThread]: Command `dbt run` failed at 16:36:49.682052 after 36.65 seconds
[0m16:36:49.682509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f929641ead0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9291a8a530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f929237df30>]}
[0m16:36:49.682896 [debug] [MainThread]: Flushing usage events
[0m17:30:25.903644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0ae81eb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0ac988070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0ac9880d0>]}


============================== 17:30:25.906662 | c7feeee8-8bc0-4e24-ac5c-57b402efea64 ==============================
[0m17:30:25.906662 [info ] [MainThread]: Running with dbt=1.6.5
[0m17:30:25.907248 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'debug': 'False', 'profiles_dir': '../dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:30:26.211512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7feeee8-8bc0-4e24-ac5c-57b402efea64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0ade701f0>]}
[0m17:30:26.227656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7feeee8-8bc0-4e24-ac5c-57b402efea64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0aa927490>]}
[0m17:30:26.228334 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m17:30:26.242326 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m17:30:26.307025 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:30:26.307595 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m17:30:26.352020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7feeee8-8bc0-4e24-ac5c-57b402efea64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0aa7e00d0>]}
[0m17:30:26.361050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7feeee8-8bc0-4e24-ac5c-57b402efea64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0aa733df0>]}
[0m17:30:26.361524 [info ] [MainThread]: Found 8 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m17:30:26.361872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7feeee8-8bc0-4e24-ac5c-57b402efea64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0aa733d60>]}
[0m17:30:26.363219 [info ] [MainThread]: 
[0m17:30:26.363872 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:30:26.365188 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m17:30:26.365574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:27.202521 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m17:30:27.204479 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:30:27.976538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7feeee8-8bc0-4e24-ac5c-57b402efea64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0aa732020>]}
[0m17:30:27.977685 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:30:27.978255 [info ] [MainThread]: 
[0m17:30:27.981284 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m17:30:27.982055 [info ] [Thread-1 (]: 1 of 8 START sql table model games.dim_developers .............................. [RUN]
[0m17:30:27.983061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m17:30:27.983678 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m17:30:27.996372 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m17:30:27.997417 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 17:30:27.984375 => 17:30:27.997092
[0m17:30:27.998039 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m17:30:28.018045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:28.758313 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m17:30:28.759074 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m17:30:29.472799 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:6b7f5bb8-e900-4cfb-8aa8-2dc4600b269f&page=queryresults
[0m17:30:32.340019 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 17:30:27.998473 => 17:30:32.339705
[0m17:30:32.341111 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7feeee8-8bc0-4e24-ac5c-57b402efea64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0aa909750>]}
[0m17:30:32.341907 [info ] [Thread-1 (]: 1 of 8 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.36s]
[0m17:30:32.342767 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m17:30:32.343410 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m17:30:32.344153 [info ] [Thread-1 (]: 2 of 8 START sql table model games.dim_games ................................... [RUN]
[0m17:30:32.345062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m17:30:32.345620 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m17:30:32.348934 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m17:30:32.349682 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 17:30:32.345953 => 17:30:32.349441
[0m17:30:32.350142 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m17:30:32.357125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:33.112237 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m17:30:33.114960 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m17:30:33.614573 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f3f7a586-7d5e-4a22-8d45-31ae9f199353&page=queryresults
[0m17:30:36.178126 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 17:30:32.350473 => 17:30:36.177206
[0m17:30:36.181375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7feeee8-8bc0-4e24-ac5c-57b402efea64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0aa0858a0>]}
[0m17:30:36.183942 [info ] [Thread-1 (]: 2 of 8 OK created sql table model games.dim_games .............................. [[32mCREATE TABLE (2.7k rows, 753.9 KiB processed)[0m in 3.84s]
[0m17:30:36.186820 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m17:30:36.188896 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m17:30:36.191281 [info ] [Thread-1 (]: 3 of 8 START sql table model games.dim_platforms ............................... [RUN]
[0m17:30:36.194258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m17:30:36.196790 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m17:30:36.206519 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m17:30:36.208022 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 17:30:36.198144 => 17:30:36.207542
[0m17:30:36.208970 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m17:30:36.213427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:36.938337 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m17:30:36.940425 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m17:30:37.563410 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:49c8e1f2-21b9-4a8e-8856-0d87a146cf6b&page=queryresults
[0m17:30:41.062688 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 17:30:36.209639 => 17:30:41.061813
[0m17:30:41.066094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7feeee8-8bc0-4e24-ac5c-57b402efea64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0aa052a10>]}
[0m17:30:41.068710 [info ] [Thread-1 (]: 3 of 8 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.87s]
[0m17:30:41.071597 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m17:30:41.073717 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m17:30:41.076123 [info ] [Thread-1 (]: 4 of 8 START sql table model games.dim_price_overview .......................... [RUN]
[0m17:30:41.079287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m17:30:41.081170 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m17:30:41.090703 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m17:30:41.092252 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 17:30:41.082482 => 17:30:41.091750
[0m17:30:41.093196 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m17:30:41.097814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:41.868205 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m17:30:41.871388 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m17:30:42.457322 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b9134553-9eea-4c68-aafb-44d3f76ab7f1&page=queryresults
[0m17:30:44.987696 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 17:30:41.093826 => 17:30:44.986808
[0m17:30:44.991070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7feeee8-8bc0-4e24-ac5c-57b402efea64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0aa053c70>]}
[0m17:30:44.993704 [info ] [Thread-1 (]: 4 of 8 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (1.1k rows, 114.2 KiB processed)[0m in 3.91s]
[0m17:30:44.996702 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m17:30:44.998803 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m17:30:45.001299 [info ] [Thread-1 (]: 5 of 8 START sql table model games.dim_publishers .............................. [RUN]
[0m17:30:45.004829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m17:30:45.006703 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m17:30:45.020323 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m17:30:45.023317 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 17:30:45.008003 => 17:30:45.022343
[0m17:30:45.024803 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m17:30:45.041389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:45.780030 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m17:30:45.780673 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m17:30:46.463973 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c5ec656f-d507-4b16-98c9-0cd542d43080&page=queryresults
[0m17:30:49.576661 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 17:30:45.025740 => 17:30:49.575747
[0m17:30:49.579823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7feeee8-8bc0-4e24-ac5c-57b402efea64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0aa908520>]}
[0m17:30:49.582411 [info ] [Thread-1 (]: 5 of 8 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.58s]
[0m17:30:49.585241 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m17:30:49.587279 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m17:30:49.589691 [info ] [Thread-1 (]: 6 of 8 START sql table model games.dim_release ................................. [RUN]
[0m17:30:49.592353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m17:30:49.593628 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m17:30:49.601010 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m17:30:49.602328 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 17:30:49.594538 => 17:30:49.601938
[0m17:30:49.603074 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m17:30:49.607037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:50.394817 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m17:30:50.397468 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m17:30:51.011377 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:781cef81-5e6b-409f-b87f-352631837e5e&page=queryresults
[0m17:30:53.827492 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 17:30:49.603608 => 17:30:53.826564
[0m17:30:53.830691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7feeee8-8bc0-4e24-ac5c-57b402efea64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0aa043760>]}
[0m17:30:53.833344 [info ] [Thread-1 (]: 6 of 8 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.24s]
[0m17:30:53.836285 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m17:30:53.838365 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m17:30:53.840812 [info ] [Thread-1 (]: 7 of 8 START sql table model games.dim_support_language ........................ [RUN]
[0m17:30:53.843794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m17:30:53.845734 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m17:30:53.855604 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m17:30:53.857173 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 17:30:53.847117 => 17:30:53.856662
[0m17:30:53.858102 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m17:30:53.862674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:54.587291 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m17:30:54.590010 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m17:30:55.212698 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:4089102f-433e-44fa-a122-84f1e8727a35&page=queryresults
[0m17:30:58.033200 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 17:30:53.858764 => 17:30:58.032310
[0m17:30:58.036502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7feeee8-8bc0-4e24-ac5c-57b402efea64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0aa908460>]}
[0m17:30:58.039054 [info ] [Thread-1 (]: 7 of 8 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.19s]
[0m17:30:58.041907 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m17:30:58.043948 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m17:30:58.046394 [info ] [Thread-1 (]: 8 of 8 START sql table model games.fct_game_pricing ............................ [RUN]
[0m17:30:58.049519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m17:30:58.051358 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m17:30:58.072559 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m17:30:58.073628 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 17:30:58.052693 => 17:30:58.073303
[0m17:30:58.074242 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m17:30:58.077609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:58.812709 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m17:30:58.815617 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para el análisis de precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        SUM(price_with_tax) AS total_sales,
        SUM(discount_amount) AS total_discounts,
        COUNT(*) AS num_sales,
        MAX(discount_pct) AS max_discount,
        MIN(initial_price) AS min_price,
        MAX(initial_price) AS max_price,
        SUM(price_with_tax) AS total_sales_with_tax,
        SUM(final_price) AS total_sales_with_tax_discounted
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id
)

SELECT
    fct.app_id,
    fct.total_sales,
    fct.total_discounts,
    fct.num_sales,
    fct.max_discount,
    fct.min_price,
    fct.max_price,
    fct.total_sales_with_tax,
    fct.total_sales_with_tax_discounted,
    games.name AS game_name,
    games.description AS game_description,
    games.is_free AS game_is_free
FROM
    game_sales AS fct
LEFT JOIN
    `pristine-flames-400818`.`games`.`dim_games` AS games
ON
    fct.app_id = games.app_id;
    );
  
[0m17:30:59.142030 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:226ffe6e-c46d-4e5c-8045-668674620e40&page=queryresults
[0m17:30:59.146506 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [50:30]')
[0m17:31:00.147596 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f02ac3f2-6359-43e6-a0d6-cf07fff5ebd4&page=queryresults
[0m17:31:00.151753 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f02ac3f2-6359-43e6-a0d6-cf07fff5ebd4&page=queryresults
[0m17:31:00.154885 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 17:30:58.074674 => 17:31:00.153924
[0m17:31:00.168087 [debug] [Thread-1 (]: Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Syntax error: Expected ")" but got ";" at [50:30]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m17:31:00.170134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7feeee8-8bc0-4e24-ac5c-57b402efea64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0aa9082e0>]}
[0m17:31:00.172720 [error] [Thread-1 (]: 8 of 8 ERROR creating sql table model games.fct_game_pricing ................... [[31mERROR[0m in 2.12s]
[0m17:31:00.175499 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m17:31:00.180098 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:31:00.181227 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m17:31:00.182382 [info ] [MainThread]: 
[0m17:31:00.183558 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 33.82 seconds (33.82s).
[0m17:31:00.188955 [debug] [MainThread]: Command end result
[0m17:31:00.214488 [info ] [MainThread]: 
[0m17:31:00.215466 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:31:00.216291 [info ] [MainThread]: 
[0m17:31:00.217019 [error] [MainThread]:   Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Syntax error: Expected ")" but got ";" at [50:30]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m17:31:00.217686 [info ] [MainThread]: 
[0m17:31:00.218368 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m17:31:00.219424 [debug] [MainThread]: Command `dbt run` failed at 17:31:00.219224 after 34.32 seconds
[0m17:31:00.220137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0ae81eb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0aa09ff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0aa043760>]}
[0m17:31:00.220886 [debug] [MainThread]: Flushing usage events
[0m17:31:49.391802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d3532b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d1694070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d16940d0>]}


============================== 17:31:49.393985 | edefdcbe-f9f4-4e3a-bd49-7191c344cded ==============================
[0m17:31:49.393985 [info ] [MainThread]: Running with dbt=1.6.5
[0m17:31:49.394478 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'send_anonymous_usage_stats': 'True'}
[0m17:31:49.683234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'edefdcbe-f9f4-4e3a-bd49-7191c344cded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18cf61ac50>]}
[0m17:31:49.699285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'edefdcbe-f9f4-4e3a-bd49-7191c344cded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18cf634640>]}
[0m17:31:49.699883 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m17:31:49.713759 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m17:31:49.778850 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:31:49.779397 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m17:31:49.823115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'edefdcbe-f9f4-4e3a-bd49-7191c344cded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18cf4ec0d0>]}
[0m17:31:49.831723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'edefdcbe-f9f4-4e3a-bd49-7191c344cded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18cf45e5f0>]}
[0m17:31:49.832176 [info ] [MainThread]: Found 8 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m17:31:49.832564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edefdcbe-f9f4-4e3a-bd49-7191c344cded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18cf45e620>]}
[0m17:31:49.833900 [info ] [MainThread]: 
[0m17:31:49.834547 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:31:49.836380 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m17:31:49.836953 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:50.578445 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m17:31:50.578930 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:31:51.190622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edefdcbe-f9f4-4e3a-bd49-7191c344cded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18cf45d1b0>]}
[0m17:31:51.191780 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:31:51.192406 [info ] [MainThread]: 
[0m17:31:51.195278 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m17:31:51.196005 [info ] [Thread-1 (]: 1 of 8 START sql table model games.dim_developers .............................. [RUN]
[0m17:31:51.196943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m17:31:51.197530 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m17:31:51.206355 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m17:31:51.207130 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 17:31:51.197918 => 17:31:51.206890
[0m17:31:51.207547 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m17:31:51.221270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:31:51.999412 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m17:31:52.000270 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m17:31:52.681226 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:3b320a99-db61-495e-ace1-0a065fe1e656&page=queryresults
[0m17:31:55.821584 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 17:31:51.207834 => 17:31:55.821274
[0m17:31:55.822713 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edefdcbe-f9f4-4e3a-bd49-7191c344cded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18cf61a590>]}
[0m17:31:55.823619 [info ] [Thread-1 (]: 1 of 8 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.63s]
[0m17:31:55.824504 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m17:31:55.825106 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m17:31:55.825818 [info ] [Thread-1 (]: 2 of 8 START sql table model games.dim_games ................................... [RUN]
[0m17:31:55.826686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m17:31:55.827216 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m17:31:55.830646 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m17:31:55.831404 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 17:31:55.827590 => 17:31:55.831156
[0m17:31:55.831873 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m17:31:55.838953 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:31:56.646202 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m17:31:56.646964 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m17:31:57.252830 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7fea03a6-5fa9-47e2-b62b-f51ef539d04b&page=queryresults
[0m17:32:00.084609 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 17:31:55.832203 => 17:32:00.084426
[0m17:32:00.085286 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edefdcbe-f9f4-4e3a-bd49-7191c344cded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18ced95960>]}
[0m17:32:00.085824 [info ] [Thread-1 (]: 2 of 8 OK created sql table model games.dim_games .............................. [[32mCREATE TABLE (2.7k rows, 753.9 KiB processed)[0m in 4.26s]
[0m17:32:00.086388 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m17:32:00.086825 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m17:32:00.087265 [info ] [Thread-1 (]: 3 of 8 START sql table model games.dim_platforms ............................... [RUN]
[0m17:32:00.087853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m17:32:00.088303 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m17:32:00.091037 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m17:32:00.091658 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 17:32:00.088563 => 17:32:00.091457
[0m17:32:00.092019 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m17:32:00.094123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:00.957269 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m17:32:00.959974 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m17:32:01.590002 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:83a74509-4911-4c97-8c8e-f7ed6262422f&page=queryresults
[0m17:32:04.660804 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 17:32:00.092323 => 17:32:04.660593
[0m17:32:04.661545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edefdcbe-f9f4-4e3a-bd49-7191c344cded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18ced60d90>]}
[0m17:32:04.662142 [info ] [Thread-1 (]: 3 of 8 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.57s]
[0m17:32:04.662768 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m17:32:04.663235 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m17:32:04.663815 [info ] [Thread-1 (]: 4 of 8 START sql table model games.dim_price_overview .......................... [RUN]
[0m17:32:04.664508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m17:32:04.664904 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m17:32:04.667961 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m17:32:04.668620 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 17:32:04.665182 => 17:32:04.668420
[0m17:32:04.669009 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m17:32:04.671303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:05.403702 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m17:32:05.406605 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m17:32:06.012690 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:0a280622-d88c-44be-a644-9ccafdfeb4d4&page=queryresults
[0m17:32:09.159931 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 17:32:04.669303 => 17:32:09.159056
[0m17:32:09.163317 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edefdcbe-f9f4-4e3a-bd49-7191c344cded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d18640d0>]}
[0m17:32:09.165937 [info ] [Thread-1 (]: 4 of 8 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (1.1k rows, 114.2 KiB processed)[0m in 4.50s]
[0m17:32:09.168778 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m17:32:09.170806 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m17:32:09.173307 [info ] [Thread-1 (]: 5 of 8 START sql table model games.dim_publishers .............................. [RUN]
[0m17:32:09.176791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m17:32:09.178684 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m17:32:09.188870 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m17:32:09.190385 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 17:32:09.179976 => 17:32:09.189898
[0m17:32:09.191330 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m17:32:09.205362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:09.994236 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m17:32:09.994941 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m17:32:10.578188 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:094b7206-6a9c-41b5-af08-0318873ec6a5&page=queryresults
[0m17:32:13.460164 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 17:32:09.191985 => 17:32:13.459969
[0m17:32:13.460912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edefdcbe-f9f4-4e3a-bd49-7191c344cded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18cf4900d0>]}
[0m17:32:13.461484 [info ] [Thread-1 (]: 5 of 8 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.29s]
[0m17:32:13.462076 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m17:32:13.462501 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m17:32:13.463004 [info ] [Thread-1 (]: 6 of 8 START sql table model games.dim_release ................................. [RUN]
[0m17:32:13.463624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m17:32:13.463997 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m17:32:13.466799 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m17:32:13.467414 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 17:32:13.464270 => 17:32:13.467221
[0m17:32:13.467783 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m17:32:13.469872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:14.206584 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m17:32:14.207249 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m17:32:14.842301 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:546d7291-ca05-47ae-af3a-1f474af689c1&page=queryresults
[0m17:32:17.995052 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 17:32:13.468044 => 17:32:17.994159
[0m17:32:17.998221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edefdcbe-f9f4-4e3a-bd49-7191c344cded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18ced536a0>]}
[0m17:32:18.000990 [info ] [Thread-1 (]: 6 of 8 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.53s]
[0m17:32:18.003830 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m17:32:18.005913 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m17:32:18.008383 [info ] [Thread-1 (]: 7 of 8 START sql table model games.dim_support_language ........................ [RUN]
[0m17:32:18.011351 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m17:32:18.013245 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m17:32:18.022272 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m17:32:18.023756 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 17:32:18.014545 => 17:32:18.023273
[0m17:32:18.024708 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m17:32:18.029108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:18.741226 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m17:32:18.741987 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m17:32:19.348803 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:086ea410-6b9c-4f12-82a8-6712ae9a1cd0&page=queryresults
[0m17:32:22.147224 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 17:32:18.025374 => 17:32:22.146295
[0m17:32:22.150743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edefdcbe-f9f4-4e3a-bd49-7191c344cded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18cf61ab90>]}
[0m17:32:22.153324 [info ] [Thread-1 (]: 7 of 8 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.14s]
[0m17:32:22.156129 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m17:32:22.158194 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m17:32:22.160336 [info ] [Thread-1 (]: 8 of 8 START sql table model games.fct_game_pricing ............................ [RUN]
[0m17:32:22.163718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m17:32:22.165680 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m17:32:22.187665 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m17:32:22.189451 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 17:32:22.166999 => 17:32:22.189117
[0m17:32:22.190082 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m17:32:22.193506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:22.959064 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m17:32:22.962041 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para el análisis de precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        SUM(price_with_tax) AS total_sales,
        SUM(discount_amount) AS total_discounts,
        COUNT(*) AS num_sales,
        MAX(discount_pct) AS max_discount,
        MIN(initial_price) AS min_price,
        MAX(initial_price) AS max_price,
        SUM(price_with_tax) AS total_sales_with_tax,
        SUM(final_price) AS total_sales_with_tax_discounted
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id
)

SELECT
    fct.app_id,
    fct.total_sales,
    fct.total_discounts,
    fct.num_sales,
    fct.max_discount,
    fct.min_price,
    fct.max_price,
    fct.total_sales_with_tax,
    fct.total_sales_with_tax_discounted,
    games.name AS game_name,
    games.description AS game_description,
    games.is_free AS game_is_free
FROM
    game_sales AS fct
LEFT JOIN
    `pristine-flames-400818`.`games`.`dim_games` AS games
ON
    fct.app_id = games.app_id
    );
  
[0m17:32:23.590137 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:81e21611-bb23-4a47-a8b4-b5ee70356d6f&page=queryresults
[0m17:32:26.370676 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 17:32:22.190524 => 17:32:26.369602
[0m17:32:26.374684 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edefdcbe-f9f4-4e3a-bd49-7191c344cded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18ced94610>]}
[0m17:32:26.378175 [info ] [Thread-1 (]: 8 of 8 OK created sql table model games.fct_game_pricing ....................... [[32mCREATE TABLE (1.1k rows, 683.7 KiB processed)[0m in 4.21s]
[0m17:32:26.382330 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m17:32:26.388843 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:32:26.390776 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m17:32:26.392764 [info ] [MainThread]: 
[0m17:32:26.394481 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 36.56 seconds (36.56s).
[0m17:32:26.402262 [debug] [MainThread]: Command end result
[0m17:32:26.425626 [info ] [MainThread]: 
[0m17:32:26.426346 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:32:26.426903 [info ] [MainThread]: 
[0m17:32:26.427475 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m17:32:26.428366 [debug] [MainThread]: Command `dbt run` succeeded at 17:32:26.428194 after 37.04 seconds
[0m17:32:26.428951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d3532b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18ceded930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18cf45c4f0>]}
[0m17:32:26.429561 [debug] [MainThread]: Flushing usage events
[0m17:33:57.233795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a5f10d180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a5d364070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a5d3640d0>]}


============================== 17:33:57.235940 | 233b2384-2869-4369-aca3-96fa5442e9c7 ==============================
[0m17:33:57.235940 [info ] [MainThread]: Running with dbt=1.6.5
[0m17:33:57.236439 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'send_anonymous_usage_stats': 'True'}
[0m17:33:57.530325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '233b2384-2869-4369-aca3-96fa5442e9c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a5b2eab30>]}
[0m17:33:57.547028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '233b2384-2869-4369-aca3-96fa5442e9c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a5b1047f0>]}
[0m17:33:57.547714 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m17:33:57.562725 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m17:33:57.627224 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:33:57.627822 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m17:33:57.674427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '233b2384-2869-4369-aca3-96fa5442e9c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a5afb80d0>]}
[0m17:33:57.684375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '233b2384-2869-4369-aca3-96fa5442e9c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a5af0fe50>]}
[0m17:33:57.684850 [info ] [MainThread]: Found 8 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m17:33:57.685207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '233b2384-2869-4369-aca3-96fa5442e9c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a5af0fdc0>]}
[0m17:33:57.686654 [info ] [MainThread]: 
[0m17:33:57.687379 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:33:57.688835 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m17:33:57.689263 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:33:58.546507 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m17:33:58.547966 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:33:59.231633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '233b2384-2869-4369-aca3-96fa5442e9c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a5af0e080>]}
[0m17:33:59.232751 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:33:59.233352 [info ] [MainThread]: 
[0m17:33:59.236519 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m17:33:59.237375 [info ] [Thread-1 (]: 1 of 8 START sql table model games.dim_developers .............................. [RUN]
[0m17:33:59.238565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m17:33:59.239346 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m17:33:59.256488 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m17:33:59.258098 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 17:33:59.239917 => 17:33:59.257577
[0m17:33:59.259091 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m17:33:59.284374 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:00.028617 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m17:34:00.029642 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m17:34:00.714600 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:35288993-7e81-4541-a467-5eca22f0ec97&page=queryresults
[0m17:34:04.497095 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 17:33:59.259766 => 17:34:04.496895
[0m17:34:04.497959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '233b2384-2869-4369-aca3-96fa5442e9c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a5a823ee0>]}
[0m17:34:04.498706 [info ] [Thread-1 (]: 1 of 8 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 5.26s]
[0m17:34:04.499477 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m17:34:04.500246 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m17:34:04.501008 [info ] [Thread-1 (]: 2 of 8 START sql table model games.dim_games ................................... [RUN]
[0m17:34:04.501929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m17:34:04.502488 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m17:34:04.505656 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m17:34:04.506589 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 17:34:04.502816 => 17:34:04.506331
[0m17:34:04.507051 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m17:34:04.514710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:05.239850 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m17:34:05.242682 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m17:34:05.890673 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:fcb0bd99-3ec9-439b-91eb-ddef634b5252&page=queryresults
[0m17:34:08.625895 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 17:34:04.507409 => 17:34:08.625705
[0m17:34:08.626585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '233b2384-2869-4369-aca3-96fa5442e9c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a5a865a20>]}
[0m17:34:08.627147 [info ] [Thread-1 (]: 2 of 8 OK created sql table model games.dim_games .............................. [[32mCREATE TABLE (2.7k rows, 753.9 KiB processed)[0m in 4.12s]
[0m17:34:08.627722 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m17:34:08.628140 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m17:34:08.628660 [info ] [Thread-1 (]: 3 of 8 START sql table model games.dim_platforms ............................... [RUN]
[0m17:34:08.629270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m17:34:08.629643 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m17:34:08.632401 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m17:34:08.633015 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 17:34:08.629904 => 17:34:08.632824
[0m17:34:08.633384 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m17:34:08.635477 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:09.338617 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m17:34:09.339299 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m17:34:09.868538 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9f161840-8a14-4553-ad4c-bcdd0be12ee2&page=queryresults
[0m17:34:12.702757 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 17:34:08.633649 => 17:34:12.701564
[0m17:34:12.706627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '233b2384-2869-4369-aca3-96fa5442e9c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a5a832b00>]}
[0m17:34:12.709375 [info ] [Thread-1 (]: 3 of 8 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.08s]
[0m17:34:12.712342 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m17:34:12.714800 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m17:34:12.717433 [info ] [Thread-1 (]: 4 of 8 START sql table model games.dim_price_overview .......................... [RUN]
[0m17:34:12.720706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m17:34:12.722627 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m17:34:12.732689 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m17:34:12.734271 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 17:34:12.723983 => 17:34:12.733748
[0m17:34:12.735225 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m17:34:12.739976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:13.478281 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m17:34:13.481143 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m17:34:14.150768 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:158741dd-1016-42f3-a504-655af02f3ad3&page=queryresults
[0m17:34:17.219706 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 17:34:12.735897 => 17:34:17.218825
[0m17:34:17.223052 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '233b2384-2869-4369-aca3-96fa5442e9c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a5a830490>]}
[0m17:34:17.225658 [info ] [Thread-1 (]: 4 of 8 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (1.1k rows, 114.2 KiB processed)[0m in 4.50s]
[0m17:34:17.228521 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m17:34:17.230570 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m17:34:17.232704 [info ] [Thread-1 (]: 5 of 8 START sql table model games.dim_publishers .............................. [RUN]
[0m17:34:17.236385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m17:34:17.238256 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m17:34:17.249299 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m17:34:17.251219 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 17:34:17.239568 => 17:34:17.250603
[0m17:34:17.252143 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m17:34:17.265977 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:18.017003 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m17:34:18.019712 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m17:34:18.684566 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:12046852-8b28-45d2-924d-db369e785746&page=queryresults
[0m17:34:21.752196 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 17:34:17.252826 => 17:34:21.751283
[0m17:34:21.755409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '233b2384-2869-4369-aca3-96fa5442e9c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a5b105cc0>]}
[0m17:34:21.758152 [info ] [Thread-1 (]: 5 of 8 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.52s]
[0m17:34:21.761152 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m17:34:21.762626 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m17:34:21.764327 [info ] [Thread-1 (]: 6 of 8 START sql table model games.dim_release ................................. [RUN]
[0m17:34:21.766360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m17:34:21.767325 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m17:34:21.773609 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m17:34:21.774873 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 17:34:21.768004 => 17:34:21.774470
[0m17:34:21.775635 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m17:34:21.779236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:22.537043 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m17:34:22.539776 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m17:34:23.136010 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:18344bcb-c81d-4743-bbb7-6d2bd4908ac7&page=queryresults
[0m17:34:25.930786 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 17:34:21.776174 => 17:34:25.930573
[0m17:34:25.931646 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '233b2384-2869-4369-aca3-96fa5442e9c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a5b2e9750>]}
[0m17:34:25.932440 [info ] [Thread-1 (]: 6 of 8 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.17s]
[0m17:34:25.933116 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m17:34:25.933582 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m17:34:25.934204 [info ] [Thread-1 (]: 7 of 8 START sql table model games.dim_support_language ........................ [RUN]
[0m17:34:25.934892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m17:34:25.935335 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m17:34:25.938305 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m17:34:25.938930 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 17:34:25.935602 => 17:34:25.938734
[0m17:34:25.939297 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m17:34:25.941502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:26.687528 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m17:34:26.690245 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m17:34:27.262596 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:91a9751f-14b9-49cc-b84d-9374c2b9fc32&page=queryresults
[0m17:34:30.122298 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 17:34:25.939555 => 17:34:30.121416
[0m17:34:30.125642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '233b2384-2869-4369-aca3-96fa5442e9c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a5afbbf10>]}
[0m17:34:30.128193 [info ] [Thread-1 (]: 7 of 8 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.19s]
[0m17:34:30.131006 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m17:34:30.133075 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m17:34:30.135489 [info ] [Thread-1 (]: 8 of 8 START sql table model games.fct_game_pricing ............................ [RUN]
[0m17:34:30.138609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m17:34:30.140397 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m17:34:30.158002 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m17:34:30.159053 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 17:34:30.141292 => 17:34:30.158734
[0m17:34:30.159665 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m17:34:30.162904 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:30.785290 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m17:34:30.788096 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para el análisis de precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        SUM(price_with_tax) AS total_sales,
        SUM(discount_amount) AS total_discounts,
        COUNT(*) AS num_sales,
        MAX(discount_pct) AS max_discount,
        MIN(initial_price) AS min_price,
        MAX(initial_price) AS max_price,
        SUM(price_with_tax) AS total_sales_with_tax,
        SUM(final_price) AS total_sales_with_tax_discounted
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id
)

SELECT
    fct.app_id,
    fct.total_sales,
    fct.total_discounts,
    fct.num_sales,
    fct.max_discount,
    fct.min_price,
    fct.max_price,
    fct.total_sales_with_tax,
    fct.total_sales_with_tax_discounted,
    games.name AS game_name,
    games.description AS game_description,
    games.is_free AS game_is_free
FROM
    game_sales AS fct
INNER JOIN
    `pristine-flames-400818`.`games`.`dim_games` AS games
ON
    fct.app_id = games.app_id
    );
  
[0m17:34:31.304668 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d6b01b67-1b9f-49c6-9602-1055466fe6bc&page=queryresults
[0m17:34:34.214684 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 17:34:30.160096 => 17:34:34.213815
[0m17:34:34.217930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '233b2384-2869-4369-aca3-96fa5442e9c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a5b2e84f0>]}
[0m17:34:34.220713 [info ] [Thread-1 (]: 8 of 8 OK created sql table model games.fct_game_pricing ....................... [[32mCREATE TABLE (1.1k rows, 683.7 KiB processed)[0m in 4.08s]
[0m17:34:34.223648 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m17:34:34.229919 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:34:34.231627 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m17:34:34.233460 [info ] [MainThread]: 
[0m17:34:34.235229 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 36.55 seconds (36.55s).
[0m17:34:34.240955 [debug] [MainThread]: Command end result
[0m17:34:34.256350 [info ] [MainThread]: 
[0m17:34:34.256938 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:34:34.257413 [info ] [MainThread]: 
[0m17:34:34.257898 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m17:34:34.258662 [debug] [MainThread]: Command `dbt run` succeeded at 17:34:34.258523 after 37.03 seconds
[0m17:34:34.259163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a5f10d180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a5e6554e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a5a87fe80>]}
[0m17:34:34.259682 [debug] [MainThread]: Flushing usage events
[0m17:53:43.847538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd687f0d180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd686164070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6861640d0>]}


============================== 17:53:43.849664 | d0b70820-4677-47a1-a2bb-6a36db182eee ==============================
[0m17:53:43.849664 [info ] [MainThread]: Running with dbt=1.6.5
[0m17:53:43.850157 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'version_check': 'True', 'profiles_dir': '../dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:53:44.128663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0b70820-4677-47a1-a2bb-6a36db182eee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6874547c0>]}
[0m17:53:44.144614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0b70820-4677-47a1-a2bb-6a36db182eee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd683f049d0>]}
[0m17:53:44.145236 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m17:53:44.158842 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m17:53:44.222726 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:53:44.223287 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m17:53:44.266733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0b70820-4677-47a1-a2bb-6a36db182eee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd683dbc0d0>]}
[0m17:53:44.275337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0b70820-4677-47a1-a2bb-6a36db182eee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd683d13df0>]}
[0m17:53:44.275791 [info ] [MainThread]: Found 8 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m17:53:44.276131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0b70820-4677-47a1-a2bb-6a36db182eee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd683d13d60>]}
[0m17:53:44.277512 [info ] [MainThread]: 
[0m17:53:44.278156 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:53:44.279404 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m17:53:44.279812 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:45.075435 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m17:53:45.077491 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:53:45.822695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0b70820-4677-47a1-a2bb-6a36db182eee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd683d12020>]}
[0m17:53:45.823419 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:53:45.823802 [info ] [MainThread]: 
[0m17:53:45.825912 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m17:53:45.826438 [info ] [Thread-1 (]: 1 of 8 START sql table model games.dim_developers .............................. [RUN]
[0m17:53:45.827046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m17:53:45.827430 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m17:53:45.834556 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m17:53:45.835233 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 17:53:45.827718 => 17:53:45.835013
[0m17:53:45.835827 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m17:53:45.848559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:46.652715 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m17:53:46.653504 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    developers_name
FROM
    developers_cte
    );
  
[0m17:53:47.232516 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e150958d-527d-4327-85dc-c73de6e577bb&page=queryresults
[0m17:53:50.025052 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 17:53:45.836135 => 17:53:50.024789
[0m17:53:50.026077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0b70820-4677-47a1-a2bb-6a36db182eee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6840e9720>]}
[0m17:53:50.026837 [info ] [Thread-1 (]: 1 of 8 OK created sql table model games.dim_developers ......................... [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.20s]
[0m17:53:50.027623 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m17:53:50.028199 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m17:53:50.028978 [info ] [Thread-1 (]: 2 of 8 START sql table model games.dim_games ................................... [RUN]
[0m17:53:50.029832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m17:53:50.030372 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m17:53:50.033866 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m17:53:50.034625 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 17:53:50.030743 => 17:53:50.034398
[0m17:53:50.035075 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m17:53:50.042808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:50.782004 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m17:53:50.784719 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m17:53:51.430357 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:86fb0fb2-2481-41e5-aa79-663fb110bd1f&page=queryresults
[0m17:53:53.933188 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 17:53:50.035387 => 17:53:53.932323
[0m17:53:53.936281 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0b70820-4677-47a1-a2bb-6a36db182eee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6876ecca0>]}
[0m17:53:53.938841 [info ] [Thread-1 (]: 2 of 8 OK created sql table model games.dim_games .............................. [[32mCREATE TABLE (2.7k rows, 753.9 KiB processed)[0m in 3.91s]
[0m17:53:53.941683 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m17:53:53.943690 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m17:53:53.946074 [info ] [Thread-1 (]: 3 of 8 START sql table model games.dim_platforms ............................... [RUN]
[0m17:53:53.949024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m17:53:53.950855 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m17:53:53.961002 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m17:53:53.962532 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 17:53:53.952167 => 17:53:53.962048
[0m17:53:53.963457 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m17:53:53.967999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:54.735556 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m17:53:54.738285 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m17:53:55.304743 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:059dafc2-c7fe-4b1a-a8a1-85ee6cacf69a&page=queryresults
[0m17:53:57.872435 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 17:53:53.964122 => 17:53:57.871494
[0m17:53:57.875671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0b70820-4677-47a1-a2bb-6a36db182eee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd683630070>]}
[0m17:53:57.878341 [info ] [Thread-1 (]: 3 of 8 OK created sql table model games.dim_platforms .......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 3.93s]
[0m17:53:57.881233 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m17:53:57.883331 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m17:53:57.885814 [info ] [Thread-1 (]: 4 of 8 START sql table model games.dim_price_overview .......................... [RUN]
[0m17:53:57.888265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m17:53:57.889700 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m17:53:57.896693 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m17:53:57.897912 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 17:53:57.890624 => 17:53:57.897525
[0m17:53:57.898645 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m17:53:57.902781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:58.657169 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m17:53:58.658785 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m17:53:59.312583 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:aec4a919-4580-4d07-a2d9-b154154e3b4d&page=queryresults
[0m17:54:02.089084 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 17:53:57.899167 => 17:54:02.088842
[0m17:54:02.090008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0b70820-4677-47a1-a2bb-6a36db182eee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd683632f50>]}
[0m17:54:02.090706 [info ] [Thread-1 (]: 4 of 8 OK created sql table model games.dim_price_overview ..................... [[32mCREATE TABLE (1.1k rows, 114.2 KiB processed)[0m in 4.20s]
[0m17:54:02.093121 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m17:54:02.093791 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m17:54:02.094623 [info ] [Thread-1 (]: 5 of 8 START sql table model games.dim_publishers .............................. [RUN]
[0m17:54:02.095734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m17:54:02.096427 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m17:54:02.100419 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m17:54:02.101736 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 17:54:02.096818 => 17:54:02.101305
[0m17:54:02.103031 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m17:54:02.114540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:02.820440 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m17:54:02.821468 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m17:54:03.478209 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:39eeb11d-741f-49b6-9e26-775cde69d9c4&page=queryresults
[0m17:54:06.539267 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 17:54:02.103608 => 17:54:06.539057
[0m17:54:06.540340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0b70820-4677-47a1-a2bb-6a36db182eee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6840eb310>]}
[0m17:54:06.541065 [info ] [Thread-1 (]: 5 of 8 OK created sql table model games.dim_publishers ......................... [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.44s]
[0m17:54:06.541847 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m17:54:06.542350 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m17:54:06.543233 [info ] [Thread-1 (]: 6 of 8 START sql table model games.dim_release ................................. [RUN]
[0m17:54:06.544341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m17:54:06.544996 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m17:54:06.550371 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m17:54:06.551088 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 17:54:06.545861 => 17:54:06.550859
[0m17:54:06.551616 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m17:54:06.554574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:07.285437 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m17:54:07.286934 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m17:54:07.897155 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:75923ca6-46f9-4cf1-ab01-1cec6aa091f8&page=queryresults
[0m17:54:10.683135 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 17:54:06.552008 => 17:54:10.682818
[0m17:54:10.684303 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0b70820-4677-47a1-a2bb-6a36db182eee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd68367fee0>]}
[0m17:54:10.685245 [info ] [Thread-1 (]: 6 of 8 OK created sql table model games.dim_release ............................ [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.14s]
[0m17:54:10.686244 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m17:54:10.686967 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m17:54:10.687807 [info ] [Thread-1 (]: 7 of 8 START sql table model games.dim_support_language ........................ [RUN]
[0m17:54:10.688921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m17:54:10.689571 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m17:54:10.694292 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m17:54:10.695396 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 17:54:10.690025 => 17:54:10.695029
[0m17:54:10.696036 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m17:54:10.699733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:11.446641 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m17:54:11.449506 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m17:54:11.955082 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:68005287-9938-49e6-98f8-639188cb85b6&page=queryresults
[0m17:54:15.008791 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 17:54:10.696508 => 17:54:15.007887
[0m17:54:15.012046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0b70820-4677-47a1-a2bb-6a36db182eee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6840e8550>]}
[0m17:54:15.014646 [info ] [Thread-1 (]: 7 of 8 OK created sql table model games.dim_support_language ................... [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.32s]
[0m17:54:15.017494 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m17:54:15.019562 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m17:54:15.022021 [info ] [Thread-1 (]: 8 of 8 START sql table model games.fct_game_pricing ............................ [RUN]
[0m17:54:15.025164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m17:54:15.027012 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m17:54:15.048761 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m17:54:15.049835 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 17:54:15.028332 => 17:54:15.049490
[0m17:54:15.050444 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m17:54:15.053795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:15.794350 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m17:54:15.797278 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para el análisis de precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        SUM(price_with_tax) AS total_sales,
        SUM(discount_amount) AS total_discounts,
        COUNT(*) AS num_sales,
        MAX(discount_pct) AS max_discount,
        MIN(initial_price) AS min_price,
        MAX(initial_price) AS max_price,
        SUM(price_with_tax) AS total_sales_with_tax,
        SUM(final_price) AS total_sales_with_tax_discounted
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id
)

SELECT
    fct.app_id,
    fct.total_sales,
    fct.total_discounts,
    fct.num_sales,
    fct.max_discount,
    fct.min_price,
    fct.max_price,
    fct.total_sales_with_tax,
    fct.total_sales_with_tax_discounted,
    games.name AS game_name,
    games.description AS game_description,
    games.is_free AS game_is_free,
    games.fullgame_app_id,
    games.fullgame_name,
    games.type,
    games.genre_id,
    games.type_genre,
FROM
    game_sales AS fct
INNER JOIN
    `pristine-flames-400818`.`games`.`dim_games` AS games
ON
    fct.app_id = games.app_id
    );
  
[0m17:54:16.422463 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:91ba72fb-d300-4899-b49b-f8bff6828c8a&page=queryresults
[0m17:54:19.519680 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 17:54:15.050875 => 17:54:19.518813
[0m17:54:19.522819 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0b70820-4677-47a1-a2bb-6a36db182eee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6840eb010>]}
[0m17:54:19.525382 [info ] [Thread-1 (]: 8 of 8 OK created sql table model games.fct_game_pricing ....................... [[32mCREATE TABLE (1.1k rows, 825.2 KiB processed)[0m in 4.50s]
[0m17:54:19.528171 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m17:54:19.534214 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:54:19.535856 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m17:54:19.537556 [info ] [MainThread]: 
[0m17:54:19.539259 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 35.26 seconds (35.26s).
[0m17:54:19.547130 [debug] [MainThread]: Command end result
[0m17:54:19.574881 [info ] [MainThread]: 
[0m17:54:19.575679 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:54:19.576361 [info ] [MainThread]: 
[0m17:54:19.577050 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m17:54:19.578052 [debug] [MainThread]: Command `dbt run` succeeded at 17:54:19.577891 after 35.74 seconds
[0m17:54:19.578628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd687f0d180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6876407f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd683d13fd0>]}
[0m17:54:19.579233 [debug] [MainThread]: Flushing usage events
[0m12:21:43.131892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37b42d180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc379588070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3795880d0>]}


============================== 12:21:43.135121 | eaf08737-86d5-43e7-a0e8-32568a953734 ==============================
[0m12:21:43.135121 [info ] [MainThread]: Running with dbt=1.6.5
[0m12:21:43.135572 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:21:43.836002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eaf08737-86d5-43e7-a0e8-32568a953734', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37750abc0>]}
[0m12:21:43.851544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eaf08737-86d5-43e7-a0e8-32568a953734', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc377524640>]}
[0m12:21:43.852295 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m12:21:43.866864 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m12:21:43.925626 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:21:43.926038 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:21:43.926365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'eaf08737-86d5-43e7-a0e8-32568a953734', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37ac343d0>]}
[0m12:21:44.933089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eaf08737-86d5-43e7-a0e8-32568a953734', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc376cbce50>]}
[0m12:21:44.943035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eaf08737-86d5-43e7-a0e8-32568a953734', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc377532d70>]}
[0m12:21:44.943492 [info ] [MainThread]: Found 11 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m12:21:44.943842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eaf08737-86d5-43e7-a0e8-32568a953734', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc377533e50>]}
[0m12:21:44.945233 [info ] [MainThread]: 
[0m12:21:44.945895 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:21:44.947286 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m12:21:44.947724 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:21:44.948094 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: '/opt/airflow/credentials.json''
[0m12:21:44.949131 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:21:44.949438 [debug] [MainThread]: Connection 'list_pristine-flames-400818' was properly closed.
[0m12:21:44.949723 [info ] [MainThread]: 
[0m12:21:44.950066 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.00 seconds (0.00s).
[0m12:21:44.950494 [error] [MainThread]: Encountered an error:
Database Error
  [Errno 2] No such file or directory: '/opt/airflow/credentials.json'
[0m12:21:44.951031 [debug] [MainThread]: Command `dbt run` failed at 12:21:44.950944 after 1.83 seconds
[0m12:21:44.951353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37b42d180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3774e3130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc376cbe3b0>]}
[0m12:21:44.951694 [debug] [MainThread]: Flushing usage events
[0m12:22:07.772101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9522d180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d933c0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d933c00d0>]}


============================== 12:22:07.774201 | ed52b8b6-4b2a-4de0-8d5e-9aa1e55a659d ==============================
[0m12:22:07.774201 [info ] [MainThread]: Running with dbt=1.6.5
[0m12:22:07.774712 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '../dbt/', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:22:08.050312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed52b8b6-4b2a-4de0-8d5e-9aa1e55a659d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d948b7070>]}
[0m12:22:08.065832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed52b8b6-4b2a-4de0-8d5e-9aa1e55a659d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9135f490>]}
[0m12:22:08.066409 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m12:22:08.079586 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m12:22:08.123826 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:22:08.124264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ed52b8b6-4b2a-4de0-8d5e-9aa1e55a659d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d948b41f0>]}
[0m12:22:09.069911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed52b8b6-4b2a-4de0-8d5e-9aa1e55a659d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d90aed690>]}
[0m12:22:09.078932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed52b8b6-4b2a-4de0-8d5e-9aa1e55a659d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9136ace0>]}
[0m12:22:09.079410 [info ] [MainThread]: Found 11 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m12:22:09.079794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed52b8b6-4b2a-4de0-8d5e-9aa1e55a659d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d911b8430>]}
[0m12:22:09.081220 [info ] [MainThread]: 
[0m12:22:09.081913 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:22:09.083347 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m12:22:09.083781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:22:09.922181 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m12:22:09.924253 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:22:10.642227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed52b8b6-4b2a-4de0-8d5e-9aa1e55a659d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d911b8670>]}
[0m12:22:10.645504 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:22:10.647214 [info ] [MainThread]: 
[0m12:22:10.655123 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m12:22:10.657324 [info ] [Thread-1 (]: 1 of 11 START sql table model games.dim_developers ............................. [RUN]
[0m12:22:10.659606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m12:22:10.659998 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m12:22:10.667007 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m12:22:10.667655 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 12:22:10.660279 => 12:22:10.667452
[0m12:22:10.668046 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m12:22:10.685347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:11.441364 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m12:22:11.442105 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS developer_id,
    developers_name
FROM
    developers_cte
    );
  
[0m12:22:12.059318 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:4b9a894e-1a1e-4b1f-a245-b57d6d10b0a0&page=queryresults
[0m12:22:14.592785 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 12:22:10.668313 => 12:22:14.592474
[0m12:22:14.593903 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed52b8b6-4b2a-4de0-8d5e-9aa1e55a659d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9096c0d0>]}
[0m12:22:14.594848 [info ] [Thread-1 (]: 1 of 11 OK created sql table model games.dim_developers ........................ [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 3.93s]
[0m12:22:14.595729 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m12:22:14.596372 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m12:22:14.597149 [info ] [Thread-1 (]: 2 of 11 START sql table model games.dim_games .................................. [RUN]
[0m12:22:14.598112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m12:22:14.598685 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m12:22:14.602219 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m12:22:14.603004 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 12:22:14.599071 => 12:22:14.602766
[0m12:22:14.603468 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m12:22:14.606040 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:15.294242 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m12:22:15.294982 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m12:22:15.901239 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:cf782eac-e440-40b9-8a77-3967726daaf3&page=queryresults
[0m12:22:18.354743 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 12:22:14.603799 => 12:22:18.354561
[0m12:22:18.355476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed52b8b6-4b2a-4de0-8d5e-9aa1e55a659d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9096d210>]}
[0m12:22:18.356034 [info ] [Thread-1 (]: 2 of 11 OK created sql table model games.dim_games ............................. [[32mCREATE TABLE (2.7k rows, 753.9 KiB processed)[0m in 3.76s]
[0m12:22:18.356645 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m12:22:18.357114 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m12:22:18.357683 [info ] [Thread-1 (]: 3 of 11 START sql table model games.dim_platforms .............................. [RUN]
[0m12:22:18.358381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m12:22:18.358811 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m12:22:18.361644 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m12:22:18.362264 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 12:22:18.359077 => 12:22:18.362067
[0m12:22:18.362653 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m12:22:18.364791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:19.072102 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m12:22:19.072825 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m12:22:19.687321 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9c0c2428-fc87-45e3-93bd-c848c3a2d5a9&page=queryresults
[0m12:22:22.114236 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 12:22:18.362919 => 12:22:22.113369
[0m12:22:22.117532 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed52b8b6-4b2a-4de0-8d5e-9aa1e55a659d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9096c2b0>]}
[0m12:22:22.120119 [info ] [Thread-1 (]: 3 of 11 OK created sql table model games.dim_platforms ......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 3.76s]
[0m12:22:22.123008 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m12:22:22.125061 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m12:22:22.127444 [info ] [Thread-1 (]: 4 of 11 START sql table model games.dim_price_overview ......................... [RUN]
[0m12:22:22.130529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m12:22:22.132371 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m12:22:22.167568 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m12:22:22.170441 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 12:22:22.133685 => 12:22:22.169510
[0m12:22:22.172353 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m12:22:22.183121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:22.960312 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m12:22:22.963240 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m12:22:23.604335 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5a953e7e-fe69-4f14-9cad-4b52e5acc8a9&page=queryresults
[0m12:22:26.109203 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 12:22:22.173663 => 12:22:26.109005
[0m12:22:26.109942 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed52b8b6-4b2a-4de0-8d5e-9aa1e55a659d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d90a934c0>]}
[0m12:22:26.110564 [info ] [Thread-1 (]: 4 of 11 OK created sql table model games.dim_price_overview .................... [[32mCREATE TABLE (1.1k rows, 114.2 KiB processed)[0m in 3.98s]
[0m12:22:26.111180 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m12:22:26.111654 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m12:22:26.112263 [info ] [Thread-1 (]: 5 of 11 START sql table model games.dim_publishers ............................. [RUN]
[0m12:22:26.112916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m12:22:26.113418 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m12:22:26.116288 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m12:22:26.116928 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 12:22:26.113713 => 12:22:26.116728
[0m12:22:26.117347 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m12:22:26.119757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:26.839350 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m12:22:26.840065 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m12:22:27.532288 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a786c69e-e41d-4cc8-9a17-381dd8098e90&page=queryresults
[0m12:22:30.219114 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 12:22:26.117646 => 12:22:30.218899
[0m12:22:30.219894 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed52b8b6-4b2a-4de0-8d5e-9aa1e55a659d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d90a933a0>]}
[0m12:22:30.220558 [info ] [Thread-1 (]: 5 of 11 OK created sql table model games.dim_publishers ........................ [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.11s]
[0m12:22:30.221254 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m12:22:30.221769 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m12:22:30.222288 [info ] [Thread-1 (]: 6 of 11 START sql table model games.dim_release ................................ [RUN]
[0m12:22:30.223021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m12:22:30.223472 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m12:22:30.226765 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m12:22:30.227581 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 12:22:30.223791 => 12:22:30.227344
[0m12:22:30.228033 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m12:22:30.230586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:31.027125 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m12:22:31.027888 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m12:22:31.616713 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:da30202c-0187-46e9-99dc-8d5c0be6ea13&page=queryresults
[0m12:22:34.329469 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 12:22:30.228349 => 12:22:34.329288
[0m12:22:34.330167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed52b8b6-4b2a-4de0-8d5e-9aa1e55a659d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d90828280>]}
[0m12:22:34.330768 [info ] [Thread-1 (]: 6 of 11 OK created sql table model games.dim_release ........................... [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.11s]
[0m12:22:34.331375 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m12:22:34.331874 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m12:22:34.332396 [info ] [Thread-1 (]: 7 of 11 START sql table model games.dim_support_language ....................... [RUN]
[0m12:22:34.333037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m12:22:34.333408 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m12:22:34.336309 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m12:22:34.336956 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 12:22:34.333684 => 12:22:34.336746
[0m12:22:34.337337 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m12:22:34.339605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:35.071875 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m12:22:35.072604 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m12:22:35.663915 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a177258b-9695-45ea-bd86-9144778a6c83&page=queryresults
[0m12:22:38.182208 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 12:22:34.337605 => 12:22:38.181333
[0m12:22:38.185372 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed52b8b6-4b2a-4de0-8d5e-9aa1e55a659d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d909d0dc0>]}
[0m12:22:38.188001 [info ] [Thread-1 (]: 7 of 11 OK created sql table model games.dim_support_language .................. [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 3.85s]
[0m12:22:38.190841 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m12:22:38.192939 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m12:22:38.195073 [info ] [Thread-1 (]: 8 of 11 START sql table model games.fct_game_pricing ........................... [RUN]
[0m12:22:38.198282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m12:22:38.200196 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m12:22:38.210704 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m12:22:38.212283 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 12:22:38.201518 => 12:22:38.211772
[0m12:22:38.213215 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m12:22:38.217916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:39.031795 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m12:22:39.032589 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para el análisis de precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        formatted_initial_price,
        SUM(price_with_tax) AS total_sales,
        SUM(discount_amount) AS total_discounts,
        COUNT(*) AS num_sales,
        MAX(discount_pct) AS max_discount,
        MIN(initial_price) AS min_price,
        MAX(initial_price) AS max_price,
        SUM(price_with_tax) AS total_sales_with_tax,
        SUM(final_price) AS total_sales_with_tax_discounted
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id
)

SELECT
    fct.app_id,
    fct.formatted_initial_price,
    fct.total_sales,
    fct.total_discounts,
    fct.num_sales,
    fct.max_discount,
    fct.min_price,
    fct.max_price,
    fct.total_sales_with_tax,
    fct.total_sales_with_tax_discounted,
    games.name AS game_name,
    games.description AS game_description,
    games.is_free AS game_is_free,
    games.fullgame_app_id,
    games.fullgame_name,
    games.type,
    games.genre_id,
    games.type_genre,
FROM
    game_sales AS fct
INNER JOIN
    `pristine-flames-400818`.`games`.`dim_games` AS games
ON
    fct.app_id = games.app_id
    );
  
[0m12:22:39.641057 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:491692a3-08ad-48a6-aa15-43a991a8ac0e&page=queryresults
[0m12:22:40.137727 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column formatted_initial_price which is neither grouped nor aggregated at [19:9]')
[0m12:22:41.092251 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:0c164d02-a4a8-4a3e-829c-91371d01e1bf&page=queryresults
[0m12:22:41.754175 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:0c164d02-a4a8-4a3e-829c-91371d01e1bf&page=queryresults
[0m12:22:41.757194 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 12:22:38.213876 => 12:22:41.756272
[0m12:22:41.767155 [debug] [Thread-1 (]: Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  SELECT list expression references column formatted_initial_price which is neither grouped nor aggregated at [19:9]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m12:22:41.767704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed52b8b6-4b2a-4de0-8d5e-9aa1e55a659d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d909d1150>]}
[0m12:22:41.768340 [error] [Thread-1 (]: 8 of 11 ERROR creating sql table model games.fct_game_pricing .................. [[31mERROR[0m in 3.57s]
[0m12:22:41.768983 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m12:22:41.769994 [debug] [Thread-1 (]: Began running node model.games.top_10_discounted_games
[0m12:22:41.770549 [info ] [Thread-1 (]: 9 of 11 SKIP relation games.top_10_discounted_games ............................ [[33mSKIP[0m]
[0m12:22:41.771083 [debug] [Thread-1 (]: Finished running node model.games.top_10_discounted_games
[0m12:22:41.771584 [debug] [Thread-1 (]: Began running node model.games.top_10_high_tax_games
[0m12:22:41.772144 [info ] [Thread-1 (]: 10 of 11 SKIP relation games.top_10_high_tax_games ............................. [[33mSKIP[0m]
[0m12:22:41.772677 [debug] [Thread-1 (]: Finished running node model.games.top_10_high_tax_games
[0m12:22:41.773175 [debug] [Thread-1 (]: Began running node model.games.top_10_most_expensive_games
[0m12:22:41.773727 [info ] [Thread-1 (]: 11 of 11 SKIP relation games.top_10_most_expensive_games ....................... [[33mSKIP[0m]
[0m12:22:41.774285 [debug] [Thread-1 (]: Finished running node model.games.top_10_most_expensive_games
[0m12:22:41.775875 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:22:41.776309 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m12:22:41.776777 [info ] [MainThread]: 
[0m12:22:41.777239 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 32.70 seconds (32.70s).
[0m12:22:41.779542 [debug] [MainThread]: Command end result
[0m12:22:41.794334 [info ] [MainThread]: 
[0m12:22:41.794832 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:22:41.795204 [info ] [MainThread]: 
[0m12:22:41.795580 [error] [MainThread]:   Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  SELECT list expression references column formatted_initial_price which is neither grouped nor aggregated at [19:9]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m12:22:41.795987 [info ] [MainThread]: 
[0m12:22:41.796501 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=3 TOTAL=11
[0m12:22:41.797116 [debug] [MainThread]: Command `dbt run` failed at 12:22:41.797016 after 34.03 seconds
[0m12:22:41.797495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9522d180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d911b04f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9136ace0>]}
[0m12:22:41.797908 [debug] [MainThread]: Flushing usage events
[0m12:25:06.270514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f243a522b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f243858c070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f243858c0d0>]}


============================== 12:25:06.272652 | 14691cc0-c15c-45cc-b26f-6e70b52555f9 ==============================
[0m12:25:06.272652 [info ] [MainThread]: Running with dbt=1.6.5
[0m12:25:06.273121 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '../dbt/', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:25:06.570737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14691cc0-c15c-45cc-b26f-6e70b52555f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f243650ec50>]}
[0m12:25:06.587541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14691cc0-c15c-45cc-b26f-6e70b52555f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2436528640>]}
[0m12:25:06.588265 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m12:25:06.602560 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m12:25:06.668062 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:25:06.668652 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m12:25:06.714557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14691cc0-c15c-45cc-b26f-6e70b52555f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24363e1e40>]}
[0m12:25:06.724162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14691cc0-c15c-45cc-b26f-6e70b52555f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f243635b4c0>]}
[0m12:25:06.724630 [info ] [MainThread]: Found 11 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m12:25:06.724980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14691cc0-c15c-45cc-b26f-6e70b52555f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f243635b460>]}
[0m12:25:06.726491 [info ] [MainThread]: 
[0m12:25:06.727230 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:25:06.728675 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m12:25:06.729248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:07.546087 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m12:25:07.547282 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:08.228663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14691cc0-c15c-45cc-b26f-6e70b52555f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2436358ca0>]}
[0m12:25:08.232433 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:25:08.234205 [info ] [MainThread]: 
[0m12:25:08.240191 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m12:25:08.241391 [info ] [Thread-1 (]: 1 of 11 START sql table model games.dim_developers ............................. [RUN]
[0m12:25:08.243165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m12:25:08.244231 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m12:25:08.256895 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m12:25:08.257832 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 12:25:08.244945 => 12:25:08.257548
[0m12:25:08.258370 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m12:25:08.273566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:09.031281 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m12:25:09.032013 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS developer_id,
    developers_name
FROM
    developers_cte
    );
  
[0m12:25:09.665636 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c1bf13d2-69e0-44d6-9187-b866c401f8f5&page=queryresults
[0m12:25:12.439546 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 12:25:08.258758 => 12:25:12.439233
[0m12:25:12.440575 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14691cc0-c15c-45cc-b26f-6e70b52555f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2436332530>]}
[0m12:25:12.441364 [info ] [Thread-1 (]: 1 of 11 OK created sql table model games.dim_developers ........................ [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.20s]
[0m12:25:12.442204 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m12:25:12.442819 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m12:25:12.443535 [info ] [Thread-1 (]: 2 of 11 START sql table model games.dim_games .................................. [RUN]
[0m12:25:12.444402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m12:25:12.444941 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m12:25:12.454503 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m12:25:12.455230 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 12:25:12.445275 => 12:25:12.455033
[0m12:25:12.455600 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m12:25:12.457813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:13.194297 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m12:25:13.195058 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m12:25:13.874718 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ef242377-06de-438d-aef8-07db0f5137fa&page=queryresults
[0m12:25:16.003772 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 12:25:12.455861 => 12:25:16.003404
[0m12:25:16.005178 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14691cc0-c15c-45cc-b26f-6e70b52555f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2436332e90>]}
[0m12:25:16.006433 [info ] [Thread-1 (]: 2 of 11 OK created sql table model games.dim_games ............................. [[32mCREATE TABLE (2.7k rows, 753.9 KiB processed)[0m in 3.56s]
[0m12:25:16.007809 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m12:25:16.008790 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m12:25:16.009949 [info ] [Thread-1 (]: 3 of 11 START sql table model games.dim_platforms .............................. [RUN]
[0m12:25:16.011407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m12:25:16.012310 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m12:25:16.018451 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m12:25:16.019891 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 12:25:16.012934 => 12:25:16.019413
[0m12:25:16.020757 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m12:25:16.025486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:16.741486 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m12:25:16.742193 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m12:25:17.400890 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ef341900-6715-4860-b9a3-34c12fcb6793&page=queryresults
[0m12:25:20.039689 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 12:25:16.021373 => 12:25:20.039508
[0m12:25:20.040374 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14691cc0-c15c-45cc-b26f-6e70b52555f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2436332da0>]}
[0m12:25:20.040951 [info ] [Thread-1 (]: 3 of 11 OK created sql table model games.dim_platforms ......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.03s]
[0m12:25:20.041570 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m12:25:20.042033 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m12:25:20.042597 [info ] [Thread-1 (]: 4 of 11 START sql table model games.dim_price_overview ......................... [RUN]
[0m12:25:20.043231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m12:25:20.043613 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m12:25:20.046580 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m12:25:20.047208 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 12:25:20.043879 => 12:25:20.047011
[0m12:25:20.047588 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m12:25:20.049839 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:20.764562 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m12:25:20.765314 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m12:25:21.376083 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d5ec9ee3-bd62-42a5-b152-dc84a28d783d&page=queryresults
[0m12:25:24.064017 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 12:25:20.047856 => 12:25:24.063130
[0m12:25:24.067158 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14691cc0-c15c-45cc-b26f-6e70b52555f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2435b25c30>]}
[0m12:25:24.069706 [info ] [Thread-1 (]: 4 of 11 OK created sql table model games.dim_price_overview .................... [[32mCREATE TABLE (1.1k rows, 114.2 KiB processed)[0m in 4.02s]
[0m12:25:24.072554 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m12:25:24.074603 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m12:25:24.076673 [info ] [Thread-1 (]: 5 of 11 START sql table model games.dim_publishers ............................. [RUN]
[0m12:25:24.080147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m12:25:24.082021 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m12:25:24.086293 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m12:25:24.086996 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 12:25:24.083378 => 12:25:24.086772
[0m12:25:24.087392 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m12:25:24.089609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:24.825977 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m12:25:24.826695 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m12:25:25.408976 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c1974f7a-e7f8-4aeb-90c5-ac6b0c2b76c4&page=queryresults
[0m12:25:31.173761 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 12:25:24.087648 => 12:25:31.172868
[0m12:25:31.176900 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14691cc0-c15c-45cc-b26f-6e70b52555f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2435b14d30>]}
[0m12:25:31.179484 [info ] [Thread-1 (]: 5 of 11 OK created sql table model games.dim_publishers ........................ [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 7.10s]
[0m12:25:31.182374 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m12:25:31.184447 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m12:25:31.186900 [info ] [Thread-1 (]: 6 of 11 START sql table model games.dim_release ................................ [RUN]
[0m12:25:31.189885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m12:25:31.191795 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m12:25:31.197102 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m12:25:31.197858 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 12:25:31.193110 => 12:25:31.197615
[0m12:25:31.198266 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m12:25:31.200670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:31.921788 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m12:25:31.922514 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m12:25:32.485685 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:533183ac-baf1-449f-90d0-27ba22c6b8c5&page=queryresults
[0m12:25:36.089981 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 12:25:31.198578 => 12:25:36.089101
[0m12:25:36.093266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14691cc0-c15c-45cc-b26f-6e70b52555f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2435ccf5e0>]}
[0m12:25:36.095886 [info ] [Thread-1 (]: 6 of 11 OK created sql table model games.dim_release ........................... [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.90s]
[0m12:25:36.098762 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m12:25:36.100824 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m12:25:36.103337 [info ] [Thread-1 (]: 7 of 11 START sql table model games.dim_support_language ....................... [RUN]
[0m12:25:36.106435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m12:25:36.107731 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m12:25:36.110632 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m12:25:36.111280 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 12:25:36.107992 => 12:25:36.111086
[0m12:25:36.111669 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m12:25:36.118020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:36.868655 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m12:25:36.869399 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m12:25:37.267854 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:41f1b85e-1ead-4c25-a90a-5c2eab0c221f&page=queryresults
[0m12:25:39.689325 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 12:25:36.111927 => 12:25:39.688449
[0m12:25:39.692418 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14691cc0-c15c-45cc-b26f-6e70b52555f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2435b5beb0>]}
[0m12:25:39.694965 [info ] [Thread-1 (]: 7 of 11 OK created sql table model games.dim_support_language .................. [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 3.59s]
[0m12:25:39.697757 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m12:25:39.699815 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m12:25:39.702211 [info ] [Thread-1 (]: 8 of 11 START sql table model games.fct_game_pricing ........................... [RUN]
[0m12:25:39.705155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m12:25:39.706990 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m12:25:39.713594 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m12:25:39.714293 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 12:25:39.708286 => 12:25:39.714066
[0m12:25:39.714725 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m12:25:39.716929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:40.465704 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m12:25:40.466409 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para el análisis de precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        formatted_initial_price,
        SUM(price_with_tax) AS total_sales,
        SUM(discount_amount) AS total_discounts,
        COUNT(*) AS num_sales,
        MAX(discount_pct) AS max_discount,
        MIN(initial_price) AS min_price,
        MAX(initial_price) AS max_price,
        SUM(price_with_tax) AS total_sales_with_tax,
        SUM(final_price) AS total_sales_with_tax_discounted
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id, formatted_initial_price
)

SELECT
    fct.app_id,
    fct.formatted_initial_price,
    fct.total_sales,
    fct.total_discounts,
    fct.num_sales,
    fct.max_discount,
    fct.min_price,
    fct.max_price,
    fct.total_sales_with_tax,
    fct.total_sales_with_tax_discounted,
    games.name AS game_name,
    games.description AS game_description,
    games.is_free AS game_is_free,
    games.fullgame_app_id,
    games.fullgame_name,
    games.type,
    games.genre_id,
    games.type_genre,
FROM
    game_sales AS fct
INNER JOIN
    `pristine-flames-400818`.`games`.`dim_games` AS games
ON
    fct.app_id = games.app_id
    );
  
[0m12:25:41.090871 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9227f59d-3cbe-471b-92cc-f93d41aa7966&page=queryresults
[0m12:25:43.556565 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 12:25:39.714981 => 12:25:43.555943
[0m12:25:43.558791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14691cc0-c15c-45cc-b26f-6e70b52555f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2435b41d20>]}
[0m12:25:43.561012 [info ] [Thread-1 (]: 8 of 11 OK created sql table model games.fct_game_pricing ...................... [[32mCREATE TABLE (1.1k rows, 839.8 KiB processed)[0m in 3.85s]
[0m12:25:43.563581 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m12:25:43.566795 [debug] [Thread-1 (]: Began running node model.games.top_10_discounted_games
[0m12:25:43.568744 [info ] [Thread-1 (]: 9 of 11 START sql table model games.top_10_discounted_games .................... [RUN]
[0m12:25:43.571434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.fct_game_pricing, now model.games.top_10_discounted_games)
[0m12:25:43.573093 [debug] [Thread-1 (]: Began compiling node model.games.top_10_discounted_games
[0m12:25:43.584445 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_discounted_games"
[0m12:25:43.586370 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (compile): 12:25:43.574267 => 12:25:43.585764
[0m12:25:43.587552 [debug] [Thread-1 (]: Began executing node model.games.top_10_discounted_games
[0m12:25:43.590701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:44.334777 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_discounted_games"
[0m12:25:44.335475 [debug] [Thread-1 (]: On model.games.top_10_discounted_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_discounted_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_discounted_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 descuentos más grandes
SELECT
    app_id,
    game_name,
    total_discounts
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY total_discounts DESC
LIMIT 10
    );
  
[0m12:25:44.930933 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:167867bc-f78d-400b-aa28-7d9a30b76e6f&page=queryresults
[0m12:25:47.389838 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (execute): 12:25:43.588369 => 12:25:47.388958
[0m12:25:47.393097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14691cc0-c15c-45cc-b26f-6e70b52555f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2435c7c040>]}
[0m12:25:47.395677 [info ] [Thread-1 (]: 9 of 11 OK created sql table model games.top_10_discounted_games ............... [[32mCREATE TABLE (10.0 rows, 61.3 KiB processed)[0m in 3.82s]
[0m12:25:47.398531 [debug] [Thread-1 (]: Finished running node model.games.top_10_discounted_games
[0m12:25:47.400594 [debug] [Thread-1 (]: Began running node model.games.top_10_high_tax_games
[0m12:25:47.402761 [info ] [Thread-1 (]: 10 of 11 START sql table model games.top_10_high_tax_games ..................... [RUN]
[0m12:25:47.406126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_discounted_games, now model.games.top_10_high_tax_games)
[0m12:25:47.408065 [debug] [Thread-1 (]: Began compiling node model.games.top_10_high_tax_games
[0m12:25:47.414307 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_high_tax_games"
[0m12:25:47.414997 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (compile): 12:25:47.409390 => 12:25:47.414777
[0m12:25:47.415387 [debug] [Thread-1 (]: Began executing node model.games.top_10_high_tax_games
[0m12:25:47.423502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:48.154577 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_high_tax_games"
[0m12:25:48.155270 [debug] [Thread-1 (]: On model.games.top_10_high_tax_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_high_tax_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_high_tax_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos con más impuestos
SELECT
    app_id,
    game_name,
    SUM(total_sales_with_tax) AS total_taxes
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
GROUP BY app_id
ORDER BY total_taxes DESC
LIMIT 10
    );
  
[0m12:25:48.825950 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:94a0eb3d-a091-4717-bed5-fcd43340aa62&page=queryresults
[0m12:25:49.355041 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column game_name which is neither grouped nor aggregated at [16:5]')
[0m12:25:50.777097 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ee754848-c617-4193-8ee2-20f1b7878a25&page=queryresults
[0m12:25:51.279363 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ee754848-c617-4193-8ee2-20f1b7878a25&page=queryresults
[0m12:25:51.282556 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (execute): 12:25:47.415643 => 12:25:51.281578
[0m12:25:51.285951 [debug] [Thread-1 (]: Database Error in model top_10_high_tax_games (models/report/top_10_high_tax_games.sql)
  SELECT list expression references column game_name which is neither grouped nor aggregated at [16:5]
  compiled Code at target/run/games/models/report/top_10_high_tax_games.sql
[0m12:25:51.286394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14691cc0-c15c-45cc-b26f-6e70b52555f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2435ccdd20>]}
[0m12:25:51.286970 [error] [Thread-1 (]: 10 of 11 ERROR creating sql table model games.top_10_high_tax_games ............ [[31mERROR[0m in 3.88s]
[0m12:25:51.287533 [debug] [Thread-1 (]: Finished running node model.games.top_10_high_tax_games
[0m12:25:51.287972 [debug] [Thread-1 (]: Began running node model.games.top_10_most_expensive_games
[0m12:25:51.288393 [info ] [Thread-1 (]: 11 of 11 START sql table model games.top_10_most_expensive_games ............... [RUN]
[0m12:25:51.288988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_high_tax_games, now model.games.top_10_most_expensive_games)
[0m12:25:51.289466 [debug] [Thread-1 (]: Began compiling node model.games.top_10_most_expensive_games
[0m12:25:51.292293 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_most_expensive_games"
[0m12:25:51.292958 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (compile): 12:25:51.289737 => 12:25:51.292763
[0m12:25:51.293326 [debug] [Thread-1 (]: Began executing node model.games.top_10_most_expensive_games
[0m12:25:51.295541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:52.007350 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_most_expensive_games"
[0m12:25:52.007971 [debug] [Thread-1 (]: On model.games.top_10_most_expensive_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_most_expensive_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_most_expensive_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos más caros
SELECT
    app_id,
    game_name,
    max_price,
    formatted_initial_price,
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY max_price DESC
LIMIT 10
    );
  
[0m12:25:52.517995 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:54059833-8a03-4019-bc6c-494f47e6015a&page=queryresults
[0m12:25:55.111381 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (execute): 12:25:51.293579 => 12:25:55.110449
[0m12:25:55.114566 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14691cc0-c15c-45cc-b26f-6e70b52555f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2435b0c850>]}
[0m12:25:55.117142 [info ] [Thread-1 (]: 11 of 11 OK created sql table model games.top_10_most_expensive_games .......... [[32mCREATE TABLE (10.0 rows, 66.9 KiB processed)[0m in 3.83s]
[0m12:25:55.120052 [debug] [Thread-1 (]: Finished running node model.games.top_10_most_expensive_games
[0m12:25:55.125965 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:25:55.127648 [debug] [MainThread]: Connection 'model.games.top_10_most_expensive_games' was properly closed.
[0m12:25:55.129345 [info ] [MainThread]: 
[0m12:25:55.131081 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 48.40 seconds (48.40s).
[0m12:25:55.141013 [debug] [MainThread]: Command end result
[0m12:25:55.164710 [info ] [MainThread]: 
[0m12:25:55.165394 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:25:55.165941 [info ] [MainThread]: 
[0m12:25:55.166495 [error] [MainThread]:   Database Error in model top_10_high_tax_games (models/report/top_10_high_tax_games.sql)
  SELECT list expression references column game_name which is neither grouped nor aggregated at [16:5]
  compiled Code at target/run/games/models/report/top_10_high_tax_games.sql
[0m12:25:55.167066 [info ] [MainThread]: 
[0m12:25:55.167642 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m12:25:55.168524 [debug] [MainThread]: Command `dbt run` failed at 12:25:55.168367 after 48.91 seconds
[0m12:25:55.169120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f243a522b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2436528640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f243635b160>]}
[0m12:25:55.169667 [debug] [MainThread]: Flushing usage events
[0m12:26:45.356631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c5d1eb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c3d88070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c3d880d0>]}


============================== 12:26:45.358862 | 17b73bb7-d31b-42e7-ba86-bde00b81d5c2 ==============================
[0m12:26:45.358862 [info ] [MainThread]: Running with dbt=1.6.5
[0m12:26:45.359364 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:26:45.659354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17b73bb7-d31b-42e7-ba86-bde00b81d5c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c1d0ab60>]}
[0m12:26:45.676097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17b73bb7-d31b-42e7-ba86-bde00b81d5c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c1d247f0>]}
[0m12:26:45.676841 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m12:26:45.691661 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m12:26:45.764368 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:26:45.764954 [debug] [MainThread]: Partial parsing: updated file: games://models/report/top_10_high_tax_games.sql
[0m12:26:45.811318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17b73bb7-d31b-42e7-ba86-bde00b81d5c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c1be5db0>]}
[0m12:26:45.820877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17b73bb7-d31b-42e7-ba86-bde00b81d5c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c1b57430>]}
[0m12:26:45.821391 [info ] [MainThread]: Found 11 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m12:26:45.821818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17b73bb7-d31b-42e7-ba86-bde00b81d5c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c1b573d0>]}
[0m12:26:45.823613 [info ] [MainThread]: 
[0m12:26:45.824431 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:26:45.825878 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m12:26:45.826309 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:26:46.549519 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m12:26:46.550075 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:26:47.220948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17b73bb7-d31b-42e7-ba86-bde00b81d5c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c1b54c10>]}
[0m12:26:47.222163 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:26:47.222855 [info ] [MainThread]: 
[0m12:26:47.226277 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m12:26:47.227277 [info ] [Thread-1 (]: 1 of 11 START sql table model games.dim_developers ............................. [RUN]
[0m12:26:47.228603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m12:26:47.229421 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m12:26:47.247141 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m12:26:47.248758 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 12:26:47.229997 => 12:26:47.248241
[0m12:26:47.249795 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m12:26:47.264777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:47.993775 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m12:26:47.994554 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS developer_id,
    developers_name
FROM
    developers_cte
    );
  
[0m12:26:48.672462 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:fb22e395-0385-4541-b83c-03fd63663744&page=queryresults
[0m12:26:51.444440 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 12:26:47.250537 => 12:26:51.444125
[0m12:26:51.445648 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17b73bb7-d31b-42e7-ba86-bde00b81d5c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c1b2e4d0>]}
[0m12:26:51.446651 [info ] [Thread-1 (]: 1 of 11 OK created sql table model games.dim_developers ........................ [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.22s]
[0m12:26:51.447555 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m12:26:51.448279 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m12:26:51.449270 [info ] [Thread-1 (]: 2 of 11 START sql table model games.dim_games .................................. [RUN]
[0m12:26:51.450267 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m12:26:51.450907 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m12:26:51.461800 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m12:26:51.462525 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 12:26:51.451317 => 12:26:51.462317
[0m12:26:51.462921 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m12:26:51.465346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:52.140540 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m12:26:52.143243 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m12:26:52.730749 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f0c11463-53af-4749-906c-93e3d82b8b1e&page=queryresults
[0m12:26:54.870407 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 12:26:51.463188 => 12:26:54.870220
[0m12:26:54.871089 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17b73bb7-d31b-42e7-ba86-bde00b81d5c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c1b2c7f0>]}
[0m12:26:54.871624 [info ] [Thread-1 (]: 2 of 11 OK created sql table model games.dim_games ............................. [[32mCREATE TABLE (2.7k rows, 753.9 KiB processed)[0m in 3.42s]
[0m12:26:54.872184 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m12:26:54.872621 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m12:26:54.873033 [info ] [Thread-1 (]: 3 of 11 START sql table model games.dim_platforms .............................. [RUN]
[0m12:26:54.873614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m12:26:54.874056 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m12:26:54.876810 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m12:26:54.877421 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 12:26:54.874324 => 12:26:54.877222
[0m12:26:54.877781 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m12:26:54.879874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:55.610883 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m12:26:55.613590 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m12:26:56.497105 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:2bd0c7bd-5ba8-4bf9-b514-99fd68e88f0c&page=queryresults
[0m12:26:59.029452 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 12:26:54.878038 => 12:26:59.029268
[0m12:26:59.030147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17b73bb7-d31b-42e7-ba86-bde00b81d5c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c1b2e950>]}
[0m12:26:59.030739 [info ] [Thread-1 (]: 3 of 11 OK created sql table model games.dim_platforms ......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.16s]
[0m12:26:59.031351 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m12:26:59.031819 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m12:26:59.032380 [info ] [Thread-1 (]: 4 of 11 START sql table model games.dim_price_overview ......................... [RUN]
[0m12:26:59.033113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m12:26:59.033513 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m12:26:59.036833 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m12:26:59.037535 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 12:26:59.033832 => 12:26:59.037327
[0m12:26:59.037933 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m12:26:59.040284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:59.713826 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m12:26:59.714590 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m12:27:00.281602 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:2828647f-41ae-402a-9e60-46180dda3cd7&page=queryresults
[0m12:27:22.673354 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 12:26:59.038208 => 12:27:22.673156
[0m12:27:22.674150 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17b73bb7-d31b-42e7-ba86-bde00b81d5c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c1119cc0>]}
[0m12:27:22.674793 [info ] [Thread-1 (]: 4 of 11 OK created sql table model games.dim_price_overview .................... [[32mCREATE TABLE (1.1k rows, 114.2 KiB processed)[0m in 23.64s]
[0m12:27:22.675465 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m12:27:22.675947 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m12:27:22.676437 [info ] [Thread-1 (]: 5 of 11 START sql table model games.dim_publishers ............................. [RUN]
[0m12:27:22.677306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m12:27:22.677802 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m12:27:22.680924 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m12:27:22.681608 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 12:27:22.678106 => 12:27:22.681395
[0m12:27:22.682017 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m12:27:22.684423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:27:23.456299 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m12:27:23.458190 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m12:27:24.087590 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:2d478026-028a-4577-a0c5-e0b329a35593&page=queryresults
[0m12:27:27.071780 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 12:27:22.682307 => 12:27:27.070903
[0m12:27:27.074888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17b73bb7-d31b-42e7-ba86-bde00b81d5c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c1108d00>]}
[0m12:27:27.077432 [info ] [Thread-1 (]: 5 of 11 OK created sql table model games.dim_publishers ........................ [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.40s]
[0m12:27:27.080266 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m12:27:27.082276 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m12:27:27.084690 [info ] [Thread-1 (]: 6 of 11 START sql table model games.dim_release ................................ [RUN]
[0m12:27:27.087650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m12:27:27.089480 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m12:27:27.096331 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m12:27:27.096984 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 12:27:27.090812 => 12:27:27.096794
[0m12:27:27.097379 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m12:27:27.099593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:27:27.819620 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m12:27:27.820329 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m12:27:28.345589 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:1be300ef-4d9c-4707-9de9-9074dab7b5af&page=queryresults
[0m12:27:30.772610 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 12:27:27.097635 => 12:27:30.771738
[0m12:27:30.775856 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17b73bb7-d31b-42e7-ba86-bde00b81d5c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c11092d0>]}
[0m12:27:30.778401 [info ] [Thread-1 (]: 6 of 11 OK created sql table model games.dim_release ........................... [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 3.69s]
[0m12:27:30.781221 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m12:27:30.783267 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m12:27:30.785388 [info ] [Thread-1 (]: 7 of 11 START sql table model games.dim_support_language ....................... [RUN]
[0m12:27:30.788806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m12:27:30.790696 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m12:27:30.802030 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m12:27:30.803939 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 12:27:30.791997 => 12:27:30.803454
[0m12:27:30.804866 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m12:27:30.817304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:27:31.518042 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m12:27:31.518793 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m12:27:32.145532 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d0e965b4-5f43-435e-8b04-0a03b3b68c5b&page=queryresults
[0m12:27:34.678619 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 12:27:30.805525 => 12:27:34.678412
[0m12:27:34.679406 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17b73bb7-d31b-42e7-ba86-bde00b81d5c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c114fee0>]}
[0m12:27:34.680044 [info ] [Thread-1 (]: 7 of 11 OK created sql table model games.dim_support_language .................. [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 3.89s]
[0m12:27:34.680651 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m12:27:34.681093 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m12:27:34.681618 [info ] [Thread-1 (]: 8 of 11 START sql table model games.fct_game_pricing ........................... [RUN]
[0m12:27:34.682315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m12:27:34.682764 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m12:27:34.686171 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m12:27:34.686965 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 12:27:34.683056 => 12:27:34.686710
[0m12:27:34.687487 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m12:27:34.689920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:27:35.343303 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m12:27:35.344103 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para el análisis de precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        formatted_initial_price,
        SUM(price_with_tax) AS total_sales,
        SUM(discount_amount) AS total_discounts,
        COUNT(*) AS num_sales,
        MAX(discount_pct) AS max_discount,
        MIN(initial_price) AS min_price,
        MAX(initial_price) AS max_price,
        SUM(price_with_tax) AS total_sales_with_tax,
        SUM(final_price) AS total_sales_with_tax_discounted
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id, formatted_initial_price
)

SELECT
    fct.app_id,
    fct.formatted_initial_price,
    fct.total_sales,
    fct.total_discounts,
    fct.num_sales,
    fct.max_discount,
    fct.min_price,
    fct.max_price,
    fct.total_sales_with_tax,
    fct.total_sales_with_tax_discounted,
    games.name AS game_name,
    games.description AS game_description,
    games.is_free AS game_is_free,
    games.fullgame_app_id,
    games.fullgame_name,
    games.type,
    games.genre_id,
    games.type_genre,
FROM
    game_sales AS fct
INNER JOIN
    `pristine-flames-400818`.`games`.`dim_games` AS games
ON
    fct.app_id = games.app_id
    );
  
[0m12:27:35.899767 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:bc7c5ec3-3322-473d-98d2-701f483973d0&page=queryresults
[0m12:27:38.727231 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 12:27:34.687771 => 12:27:38.726221
[0m12:27:38.730341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17b73bb7-d31b-42e7-ba86-bde00b81d5c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c111ae30>]}
[0m12:27:38.732474 [info ] [Thread-1 (]: 8 of 11 OK created sql table model games.fct_game_pricing ...................... [[32mCREATE TABLE (1.1k rows, 839.8 KiB processed)[0m in 4.05s]
[0m12:27:38.733097 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m12:27:38.734035 [debug] [Thread-1 (]: Began running node model.games.top_10_discounted_games
[0m12:27:38.734515 [info ] [Thread-1 (]: 9 of 11 START sql table model games.top_10_discounted_games .................... [RUN]
[0m12:27:38.735171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.fct_game_pricing, now model.games.top_10_discounted_games)
[0m12:27:38.735562 [debug] [Thread-1 (]: Began compiling node model.games.top_10_discounted_games
[0m12:27:38.738256 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_discounted_games"
[0m12:27:38.738922 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (compile): 12:27:38.735820 => 12:27:38.738694
[0m12:27:38.739284 [debug] [Thread-1 (]: Began executing node model.games.top_10_discounted_games
[0m12:27:38.741389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:27:39.456940 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_discounted_games"
[0m12:27:39.457577 [debug] [Thread-1 (]: On model.games.top_10_discounted_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_discounted_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_discounted_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 descuentos más grandes
SELECT
    app_id,
    game_name,
    total_discounts
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY total_discounts DESC
LIMIT 10
    );
  
[0m12:27:40.052524 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:aeb9f740-30d8-461a-bf16-0ed154d76d45&page=queryresults
[0m12:27:42.266098 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (execute): 12:27:38.739537 => 12:27:42.265614
[0m12:27:42.267930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17b73bb7-d31b-42e7-ba86-bde00b81d5c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c1275900>]}
[0m12:27:42.269321 [info ] [Thread-1 (]: 9 of 11 OK created sql table model games.top_10_discounted_games ............... [[32mCREATE TABLE (10.0 rows, 61.3 KiB processed)[0m in 3.53s]
[0m12:27:42.270823 [debug] [Thread-1 (]: Finished running node model.games.top_10_discounted_games
[0m12:27:42.271905 [debug] [Thread-1 (]: Began running node model.games.top_10_high_tax_games
[0m12:27:42.273209 [info ] [Thread-1 (]: 10 of 11 START sql table model games.top_10_high_tax_games ..................... [RUN]
[0m12:27:42.274906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_discounted_games, now model.games.top_10_high_tax_games)
[0m12:27:42.275927 [debug] [Thread-1 (]: Began compiling node model.games.top_10_high_tax_games
[0m12:27:42.282765 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_high_tax_games"
[0m12:27:42.284337 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (compile): 12:27:42.276617 => 12:27:42.283837
[0m12:27:42.285291 [debug] [Thread-1 (]: Began executing node model.games.top_10_high_tax_games
[0m12:27:42.299287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:27:43.011728 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_high_tax_games"
[0m12:27:43.012375 [debug] [Thread-1 (]: On model.games.top_10_high_tax_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_high_tax_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_high_tax_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos con más impuestos
SELECT
    app_id,
    game_name,
    SUM(total_sales_with_tax) AS total_taxes
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
GROUP BY app_id
ORDER BY total_taxes, game_name DESC
LIMIT 10
    );
  
[0m12:27:43.646538 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:21ebe08a-2b90-4a49-8dc0-130910924471&page=queryresults
[0m12:27:44.160261 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column game_name which is neither grouped nor aggregated at [16:5]')
[0m12:27:45.292441 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:2202cbf4-6348-4fe1-aa9a-694ecf1a7620&page=queryresults
[0m12:27:45.763282 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:2202cbf4-6348-4fe1-aa9a-694ecf1a7620&page=queryresults
[0m12:27:45.766281 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (execute): 12:27:42.285842 => 12:27:45.765357
[0m12:27:45.776815 [debug] [Thread-1 (]: Database Error in model top_10_high_tax_games (models/report/top_10_high_tax_games.sql)
  SELECT list expression references column game_name which is neither grouped nor aggregated at [16:5]
  compiled Code at target/run/games/models/report/top_10_high_tax_games.sql
[0m12:27:45.777957 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17b73bb7-d31b-42e7-ba86-bde00b81d5c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c12f2980>]}
[0m12:27:45.779391 [error] [Thread-1 (]: 10 of 11 ERROR creating sql table model games.top_10_high_tax_games ............ [[31mERROR[0m in 3.50s]
[0m12:27:45.780720 [debug] [Thread-1 (]: Finished running node model.games.top_10_high_tax_games
[0m12:27:45.781565 [debug] [Thread-1 (]: Began running node model.games.top_10_most_expensive_games
[0m12:27:45.782590 [info ] [Thread-1 (]: 11 of 11 START sql table model games.top_10_most_expensive_games ............... [RUN]
[0m12:27:45.783848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_high_tax_games, now model.games.top_10_most_expensive_games)
[0m12:27:45.784608 [debug] [Thread-1 (]: Began compiling node model.games.top_10_most_expensive_games
[0m12:27:45.789664 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_most_expensive_games"
[0m12:27:45.790702 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (compile): 12:27:45.785299 => 12:27:45.790394
[0m12:27:45.791241 [debug] [Thread-1 (]: Began executing node model.games.top_10_most_expensive_games
[0m12:27:45.794322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:27:46.471449 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_most_expensive_games"
[0m12:27:46.472133 [debug] [Thread-1 (]: On model.games.top_10_most_expensive_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_most_expensive_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_most_expensive_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos más caros
SELECT
    app_id,
    game_name,
    max_price,
    formatted_initial_price,
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY max_price DESC
LIMIT 10
    );
  
[0m12:27:47.109722 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a4750d67-7b9e-4b5d-a68d-4b83564dc8bd&page=queryresults
[0m12:27:49.495069 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (execute): 12:27:45.791612 => 12:27:49.494828
[0m12:27:49.495950 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17b73bb7-d31b-42e7-ba86-bde00b81d5c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c12f3a00>]}
[0m12:27:49.496645 [info ] [Thread-1 (]: 11 of 11 OK created sql table model games.top_10_most_expensive_games .......... [[32mCREATE TABLE (10.0 rows, 66.9 KiB processed)[0m in 3.71s]
[0m12:27:49.497376 [debug] [Thread-1 (]: Finished running node model.games.top_10_most_expensive_games
[0m12:27:49.499088 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:27:49.499525 [debug] [MainThread]: Connection 'model.games.top_10_most_expensive_games' was properly closed.
[0m12:27:49.499974 [info ] [MainThread]: 
[0m12:27:49.500406 [info ] [MainThread]: Finished running 11 table models in 0 hours 1 minutes and 3.68 seconds (63.68s).
[0m12:27:49.502952 [debug] [MainThread]: Command end result
[0m12:27:49.514292 [info ] [MainThread]: 
[0m12:27:49.514864 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:27:49.515289 [info ] [MainThread]: 
[0m12:27:49.515656 [error] [MainThread]:   Database Error in model top_10_high_tax_games (models/report/top_10_high_tax_games.sql)
  SELECT list expression references column game_name which is neither grouped nor aggregated at [16:5]
  compiled Code at target/run/games/models/report/top_10_high_tax_games.sql
[0m12:27:49.516036 [info ] [MainThread]: 
[0m12:27:49.516424 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m12:27:49.517028 [debug] [MainThread]: Command `dbt run` failed at 12:27:49.516923 after 64.17 seconds
[0m12:27:49.517432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c5d1eb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c1d247f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c1b570d0>]}
[0m12:27:49.517850 [debug] [MainThread]: Flushing usage events
[0m12:28:42.862449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4d8a1ead0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4d6b88070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4d6b880d0>]}


============================== 12:28:42.864515 | 9cd1a600-8835-4367-be5b-536d887a12a5 ==============================
[0m12:28:42.864515 [info ] [MainThread]: Running with dbt=1.6.5
[0m12:28:42.865039 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'profiles_dir': '../dbt/', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:28:43.150840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9cd1a600-8835-4367-be5b-536d887a12a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4d7ffa620>]}
[0m12:28:43.166769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9cd1a600-8835-4367-be5b-536d887a12a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4d4b249d0>]}
[0m12:28:43.167411 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m12:28:43.180968 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m12:28:43.244735 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:28:43.245328 [debug] [MainThread]: Partial parsing: updated file: games://models/report/top_10_high_tax_games.sql
[0m12:28:43.289080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9cd1a600-8835-4367-be5b-536d887a12a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4d49e5de0>]}
[0m12:28:43.298395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9cd1a600-8835-4367-be5b-536d887a12a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4d4957460>]}
[0m12:28:43.298907 [info ] [MainThread]: Found 11 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m12:28:43.299277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cd1a600-8835-4367-be5b-536d887a12a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4d4957400>]}
[0m12:28:43.300694 [info ] [MainThread]: 
[0m12:28:43.301372 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:28:43.302749 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m12:28:43.303200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:44.043292 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m12:28:44.045059 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:44.821290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cd1a600-8835-4367-be5b-536d887a12a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4d4954c40>]}
[0m12:28:44.824494 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:28:44.826175 [info ] [MainThread]: 
[0m12:28:44.834251 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m12:28:44.836522 [info ] [Thread-1 (]: 1 of 11 START sql table model games.dim_developers ............................. [RUN]
[0m12:28:44.839441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m12:28:44.841234 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m12:28:44.869793 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m12:28:44.871298 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 12:28:44.842540 => 12:28:44.870813
[0m12:28:44.872202 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m12:28:44.891866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:45.653503 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m12:28:45.654279 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS developer_id,
    developers_name
FROM
    developers_cte
    );
  
[0m12:28:46.132238 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7bd8348d-08cf-4739-a81d-93fbf82e8099&page=queryresults
[0m12:28:48.551748 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 12:28:44.872721 => 12:28:48.551455
[0m12:28:48.552753 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cd1a600-8835-4367-be5b-536d887a12a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4d492e4a0>]}
[0m12:28:48.553514 [info ] [Thread-1 (]: 1 of 11 OK created sql table model games.dim_developers ........................ [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 3.71s]
[0m12:28:48.554300 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m12:28:48.554919 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m12:28:48.555649 [info ] [Thread-1 (]: 2 of 11 START sql table model games.dim_games .................................. [RUN]
[0m12:28:48.556508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m12:28:48.557025 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m12:28:48.566073 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m12:28:48.566810 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 12:28:48.557354 => 12:28:48.566592
[0m12:28:48.567224 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m12:28:48.569657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:49.269980 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m12:28:49.271975 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m12:28:49.849453 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:8c092f9c-cdf8-4085-9836-8b6e919ef52a&page=queryresults
[0m12:28:52.540967 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 12:28:48.567495 => 12:28:52.540740
[0m12:28:52.541823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cd1a600-8835-4367-be5b-536d887a12a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4d492ed40>]}
[0m12:28:52.542505 [info ] [Thread-1 (]: 2 of 11 OK created sql table model games.dim_games ............................. [[32mCREATE TABLE (2.7k rows, 753.9 KiB processed)[0m in 3.99s]
[0m12:28:52.543156 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m12:28:52.543628 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m12:28:52.544093 [info ] [Thread-1 (]: 3 of 11 START sql table model games.dim_platforms .............................. [RUN]
[0m12:28:52.544864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m12:28:52.545333 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m12:28:52.548321 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m12:28:52.548991 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 12:28:52.545618 => 12:28:52.548780
[0m12:28:52.549382 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m12:28:52.551696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:53.264267 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m12:28:53.265729 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m12:28:53.871239 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:3c6ad38b-7f3c-45e9-bd54-ae5f01001318&page=queryresults
[0m12:28:56.829923 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 12:28:52.549647 => 12:28:56.829739
[0m12:28:56.830654 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cd1a600-8835-4367-be5b-536d887a12a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4d492e920>]}
[0m12:28:56.831190 [info ] [Thread-1 (]: 3 of 11 OK created sql table model games.dim_platforms ......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.29s]
[0m12:28:56.831750 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m12:28:56.832155 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m12:28:56.832564 [info ] [Thread-1 (]: 4 of 11 START sql table model games.dim_price_overview ......................... [RUN]
[0m12:28:56.833144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m12:28:56.833584 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m12:28:56.836417 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m12:28:56.837065 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 12:28:56.833852 => 12:28:56.836865
[0m12:28:56.837421 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m12:28:56.839560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:57.558513 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m12:28:57.559239 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m12:28:58.138544 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a110267e-aa7a-47d6-9cab-ec04d3c0f59c&page=queryresults
[0m12:29:00.701381 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 12:28:56.837671 => 12:29:00.700761
[0m12:29:00.704284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cd1a600-8835-4367-be5b-536d887a12a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4d411db10>]}
[0m12:29:00.706741 [info ] [Thread-1 (]: 4 of 11 OK created sql table model games.dim_price_overview .................... [[32mCREATE TABLE (1.1k rows, 114.2 KiB processed)[0m in 3.87s]
[0m12:29:00.709453 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m12:29:00.710966 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m12:29:00.713024 [info ] [Thread-1 (]: 5 of 11 START sql table model games.dim_publishers ............................. [RUN]
[0m12:29:00.715296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m12:29:00.717618 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m12:29:00.726622 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m12:29:00.728348 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 12:29:00.719797 => 12:29:00.727885
[0m12:29:00.729337 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m12:29:00.733462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:01.442742 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m12:29:01.443855 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m12:29:01.994641 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:71ffadba-a1c6-4815-a0f5-834b2466b46d&page=queryresults
[0m12:29:04.594181 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 12:29:00.730029 => 12:29:04.593990
[0m12:29:04.594898 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cd1a600-8835-4367-be5b-536d887a12a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4d4100af0>]}
[0m12:29:04.595456 [info ] [Thread-1 (]: 5 of 11 OK created sql table model games.dim_publishers ........................ [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 3.88s]
[0m12:29:04.596040 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m12:29:04.596461 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m12:29:04.596885 [info ] [Thread-1 (]: 6 of 11 START sql table model games.dim_release ................................ [RUN]
[0m12:29:04.597486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m12:29:04.597937 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m12:29:04.600728 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m12:29:04.601370 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 12:29:04.598216 => 12:29:04.601167
[0m12:29:04.601764 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m12:29:04.604042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:05.412283 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m12:29:05.412942 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m12:29:05.990655 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:caef9201-bf06-41eb-b52f-7ac4f2981fdd&page=queryresults
[0m12:29:08.459343 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 12:29:04.602046 => 12:29:08.459151
[0m12:29:08.460079 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cd1a600-8835-4367-be5b-536d887a12a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4d4100dc0>]}
[0m12:29:08.460628 [info ] [Thread-1 (]: 6 of 11 OK created sql table model games.dim_release ........................... [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 3.86s]
[0m12:29:08.461193 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m12:29:08.461708 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m12:29:08.462192 [info ] [Thread-1 (]: 7 of 11 START sql table model games.dim_support_language ....................... [RUN]
[0m12:29:08.462978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m12:29:08.463374 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m12:29:08.466407 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m12:29:08.467187 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 12:29:08.463630 => 12:29:08.466967
[0m12:29:08.467581 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m12:29:08.473796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:09.187463 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m12:29:09.190145 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m12:29:09.901150 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ff10e847-f996-4bda-8ca4-79a2291482d0&page=queryresults
[0m12:29:12.371173 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 12:29:08.467834 => 12:29:12.370589
[0m12:29:12.372808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cd1a600-8835-4367-be5b-536d887a12a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4d413b910>]}
[0m12:29:12.374129 [info ] [Thread-1 (]: 7 of 11 OK created sql table model games.dim_support_language .................. [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 3.91s]
[0m12:29:12.375587 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m12:29:12.376622 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m12:29:12.377848 [info ] [Thread-1 (]: 8 of 11 START sql table model games.fct_game_pricing ........................... [RUN]
[0m12:29:12.379395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m12:29:12.380321 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m12:29:12.387340 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m12:29:12.388934 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 12:29:12.380975 => 12:29:12.388401
[0m12:29:12.389867 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m12:29:12.395219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:13.092301 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m12:29:13.093078 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para el análisis de precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        formatted_initial_price,
        SUM(price_with_tax) AS total_sales,
        SUM(discount_amount) AS total_discounts,
        COUNT(*) AS num_sales,
        MAX(discount_pct) AS max_discount,
        MIN(initial_price) AS min_price,
        MAX(initial_price) AS max_price,
        SUM(price_with_tax) AS total_sales_with_tax,
        SUM(final_price) AS total_sales_with_tax_discounted
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id, formatted_initial_price
)

SELECT
    fct.app_id,
    fct.formatted_initial_price,
    fct.total_sales,
    fct.total_discounts,
    fct.num_sales,
    fct.max_discount,
    fct.min_price,
    fct.max_price,
    fct.total_sales_with_tax,
    fct.total_sales_with_tax_discounted,
    games.name AS game_name,
    games.description AS game_description,
    games.is_free AS game_is_free,
    games.fullgame_app_id,
    games.fullgame_name,
    games.type,
    games.genre_id,
    games.type_genre,
FROM
    game_sales AS fct
INNER JOIN
    `pristine-flames-400818`.`games`.`dim_games` AS games
ON
    fct.app_id = games.app_id
    );
  
[0m12:29:13.702023 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b3375593-dac7-4ac8-aba0-30023abcc08f&page=queryresults
[0m12:29:16.571345 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 12:29:12.390537 => 12:29:16.571133
[0m12:29:16.572108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cd1a600-8835-4367-be5b-536d887a12a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4d411dfc0>]}
[0m12:29:16.572715 [info ] [Thread-1 (]: 8 of 11 OK created sql table model games.fct_game_pricing ...................... [[32mCREATE TABLE (1.1k rows, 839.8 KiB processed)[0m in 4.19s]
[0m12:29:16.573359 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m12:29:16.574276 [debug] [Thread-1 (]: Began running node model.games.top_10_discounted_games
[0m12:29:16.574786 [info ] [Thread-1 (]: 9 of 11 START sql table model games.top_10_discounted_games .................... [RUN]
[0m12:29:16.575451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.fct_game_pricing, now model.games.top_10_discounted_games)
[0m12:29:16.575857 [debug] [Thread-1 (]: Began compiling node model.games.top_10_discounted_games
[0m12:29:16.578606 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_discounted_games"
[0m12:29:16.579225 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (compile): 12:29:16.576139 => 12:29:16.579020
[0m12:29:16.579589 [debug] [Thread-1 (]: Began executing node model.games.top_10_discounted_games
[0m12:29:16.581689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:17.318276 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_discounted_games"
[0m12:29:17.319027 [debug] [Thread-1 (]: On model.games.top_10_discounted_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_discounted_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_discounted_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 descuentos más grandes
SELECT
    app_id,
    game_name,
    total_discounts
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY total_discounts DESC
LIMIT 10
    );
  
[0m12:29:17.727977 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:6777c79e-c15c-4133-8458-e1bcd31ee4a9&page=queryresults
[0m12:29:19.858071 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (execute): 12:29:16.579851 => 12:29:19.857887
[0m12:29:19.858824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cd1a600-8835-4367-be5b-536d887a12a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4d427bb50>]}
[0m12:29:19.859379 [info ] [Thread-1 (]: 9 of 11 OK created sql table model games.top_10_discounted_games ............... [[32mCREATE TABLE (10.0 rows, 61.3 KiB processed)[0m in 3.28s]
[0m12:29:19.859988 [debug] [Thread-1 (]: Finished running node model.games.top_10_discounted_games
[0m12:29:19.860456 [debug] [Thread-1 (]: Began running node model.games.top_10_high_tax_games
[0m12:29:19.860901 [info ] [Thread-1 (]: 10 of 11 START sql table model games.top_10_high_tax_games ..................... [RUN]
[0m12:29:19.861606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_discounted_games, now model.games.top_10_high_tax_games)
[0m12:29:19.861982 [debug] [Thread-1 (]: Began compiling node model.games.top_10_high_tax_games
[0m12:29:19.864717 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_high_tax_games"
[0m12:29:19.865375 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (compile): 12:29:19.862320 => 12:29:19.865136
[0m12:29:19.865754 [debug] [Thread-1 (]: Began executing node model.games.top_10_high_tax_games
[0m12:29:19.874339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:20.622336 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_high_tax_games"
[0m12:29:20.623093 [debug] [Thread-1 (]: On model.games.top_10_high_tax_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_high_tax_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_high_tax_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos con más impuestos
SELECT
    app_id,
    game_name,
    SUM(total_taxes) AS total_taxes
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
GROUP BY app_id, game_name
ORDER BY total_taxes DESC, game_name DESC
LIMIT 10;
    );
  
[0m12:29:20.902524 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:28aacf53-b0ec-40c5-9087-dba16bd4dd22&page=queryresults
[0m12:29:20.906579 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [22:9]')
[0m12:29:22.097260 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:1aca5ad7-c058-476f-b922-740ac268ef3b&page=queryresults
[0m12:29:22.101918 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:1aca5ad7-c058-476f-b922-740ac268ef3b&page=queryresults
[0m12:29:22.104955 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (execute): 12:29:19.866014 => 12:29:22.104030
[0m12:29:22.107770 [debug] [Thread-1 (]: Database Error in model top_10_high_tax_games (models/report/top_10_high_tax_games.sql)
  Syntax error: Expected ")" but got ";" at [22:9]
  compiled Code at target/run/games/models/report/top_10_high_tax_games.sql
[0m12:29:22.108216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cd1a600-8835-4367-be5b-536d887a12a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4d41003a0>]}
[0m12:29:22.108776 [error] [Thread-1 (]: 10 of 11 ERROR creating sql table model games.top_10_high_tax_games ............ [[31mERROR[0m in 2.25s]
[0m12:29:22.109376 [debug] [Thread-1 (]: Finished running node model.games.top_10_high_tax_games
[0m12:29:22.109867 [debug] [Thread-1 (]: Began running node model.games.top_10_most_expensive_games
[0m12:29:22.110436 [info ] [Thread-1 (]: 11 of 11 START sql table model games.top_10_most_expensive_games ............... [RUN]
[0m12:29:22.111142 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_high_tax_games, now model.games.top_10_most_expensive_games)
[0m12:29:22.111516 [debug] [Thread-1 (]: Began compiling node model.games.top_10_most_expensive_games
[0m12:29:22.114332 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_most_expensive_games"
[0m12:29:22.115132 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (compile): 12:29:22.111793 => 12:29:22.114891
[0m12:29:22.115620 [debug] [Thread-1 (]: Began executing node model.games.top_10_most_expensive_games
[0m12:29:22.117898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:22.877864 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_most_expensive_games"
[0m12:29:22.880560 [debug] [Thread-1 (]: On model.games.top_10_most_expensive_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_most_expensive_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_most_expensive_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos más caros
SELECT
    app_id,
    game_name,
    max_price,
    formatted_initial_price,
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY max_price DESC
LIMIT 10
    );
  
[0m12:29:23.438741 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a78fad91-feb2-4875-9664-bad097ac2438&page=queryresults
[0m12:29:25.556968 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (execute): 12:29:22.115876 => 12:29:25.556777
[0m12:29:25.557786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cd1a600-8835-4367-be5b-536d887a12a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4d4100b20>]}
[0m12:29:25.558377 [info ] [Thread-1 (]: 11 of 11 OK created sql table model games.top_10_most_expensive_games .......... [[32mCREATE TABLE (10.0 rows, 66.9 KiB processed)[0m in 3.45s]
[0m12:29:25.559058 [debug] [Thread-1 (]: Finished running node model.games.top_10_most_expensive_games
[0m12:29:25.561271 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:29:25.561666 [debug] [MainThread]: Connection 'model.games.top_10_most_expensive_games' was properly closed.
[0m12:29:25.562076 [info ] [MainThread]: 
[0m12:29:25.562463 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 42.26 seconds (42.26s).
[0m12:29:25.564506 [debug] [MainThread]: Command end result
[0m12:29:25.573407 [info ] [MainThread]: 
[0m12:29:25.573885 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:29:25.574263 [info ] [MainThread]: 
[0m12:29:25.574624 [error] [MainThread]:   Database Error in model top_10_high_tax_games (models/report/top_10_high_tax_games.sql)
  Syntax error: Expected ")" but got ";" at [22:9]
  compiled Code at target/run/games/models/report/top_10_high_tax_games.sql
[0m12:29:25.574976 [info ] [MainThread]: 
[0m12:29:25.575335 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m12:29:25.575938 [debug] [MainThread]: Command `dbt run` failed at 12:29:25.575842 after 42.72 seconds
[0m12:29:25.576313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4d8a1ead0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4d42c9210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4d4957100>]}
[0m12:29:25.576702 [debug] [MainThread]: Flushing usage events
[0m12:29:35.247606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f050541ab30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05034b8070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05034b80d0>]}


============================== 12:29:35.249672 | 2c2288eb-f2a0-4979-81b4-1db7849c274d ==============================
[0m12:29:35.249672 [info ] [MainThread]: Running with dbt=1.6.5
[0m12:29:35.250163 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:29:35.527131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c2288eb-f2a0-4979-81b4-1db7849c274d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f050143ec50>]}
[0m12:29:35.542735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c2288eb-f2a0-4979-81b4-1db7849c274d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0501458640>]}
[0m12:29:35.543290 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m12:29:35.556405 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m12:29:35.621073 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:29:35.621629 [debug] [MainThread]: Partial parsing: updated file: games://models/report/top_10_high_tax_games.sql
[0m12:29:35.665185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c2288eb-f2a0-4979-81b4-1db7849c274d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0500b45e40>]}
[0m12:29:35.674571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c2288eb-f2a0-4979-81b4-1db7849c274d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f050128b4c0>]}
[0m12:29:35.675032 [info ] [MainThread]: Found 11 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m12:29:35.675381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c2288eb-f2a0-4979-81b4-1db7849c274d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f050128b460>]}
[0m12:29:35.676824 [info ] [MainThread]: 
[0m12:29:35.677483 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:29:35.678866 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m12:29:35.679289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:36.461133 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m12:29:36.462891 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:29:37.153163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c2288eb-f2a0-4979-81b4-1db7849c274d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0501288ca0>]}
[0m12:29:37.156414 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:29:37.158088 [info ] [MainThread]: 
[0m12:29:37.166191 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m12:29:37.168420 [info ] [Thread-1 (]: 1 of 11 START sql table model games.dim_developers ............................. [RUN]
[0m12:29:37.171320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m12:29:37.173125 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m12:29:37.204663 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m12:29:37.206208 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 12:29:37.174396 => 12:29:37.205750
[0m12:29:37.206980 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m12:29:37.226476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:38.012757 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m12:29:38.013464 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS developer_id,
    developers_name
FROM
    developers_cte
    );
  
[0m12:29:38.579650 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:3d3fcf18-eb36-49fc-bbbd-46bf14300d8b&page=queryresults
[0m12:29:41.392074 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 12:29:37.207502 => 12:29:41.391762
[0m12:29:41.393190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c2288eb-f2a0-4979-81b4-1db7849c274d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0501266620>]}
[0m12:29:41.394125 [info ] [Thread-1 (]: 1 of 11 OK created sql table model games.dim_developers ........................ [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.22s]
[0m12:29:41.395196 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m12:29:41.395982 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m12:29:41.396778 [info ] [Thread-1 (]: 2 of 11 START sql table model games.dim_games .................................. [RUN]
[0m12:29:41.397674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m12:29:41.398211 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m12:29:41.408043 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m12:29:41.408788 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 12:29:41.398607 => 12:29:41.408570
[0m12:29:41.409205 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m12:29:41.411640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:42.135344 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m12:29:42.136100 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m12:29:42.533434 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:08193406-ef9d-463b-add2-2441981e94a0&page=queryresults
[0m12:29:45.217392 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 12:29:41.409502 => 12:29:45.216519
[0m12:29:45.220662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c2288eb-f2a0-4979-81b4-1db7849c274d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0501266f20>]}
[0m12:29:45.223265 [info ] [Thread-1 (]: 2 of 11 OK created sql table model games.dim_games ............................. [[32mCREATE TABLE (2.7k rows, 753.9 KiB processed)[0m in 3.82s]
[0m12:29:45.226084 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m12:29:45.228150 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m12:29:45.230563 [info ] [Thread-1 (]: 3 of 11 START sql table model games.dim_platforms .............................. [RUN]
[0m12:29:45.233484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m12:29:45.235347 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m12:29:45.245881 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m12:29:45.247471 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 12:29:45.236643 => 12:29:45.246985
[0m12:29:45.248229 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m12:29:45.250400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:45.971266 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m12:29:45.971978 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m12:29:46.530773 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:1ad8dc32-58e1-4e2a-9b1c-a821f04629a9&page=queryresults
[0m12:29:48.979482 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 12:29:45.248483 => 12:29:48.978605
[0m12:29:48.982585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c2288eb-f2a0-4979-81b4-1db7849c274d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0501264880>]}
[0m12:29:48.985142 [info ] [Thread-1 (]: 3 of 11 OK created sql table model games.dim_platforms ......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 3.75s]
[0m12:29:48.987979 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m12:29:48.990053 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m12:29:48.992474 [info ] [Thread-1 (]: 4 of 11 START sql table model games.dim_price_overview ......................... [RUN]
[0m12:29:48.995416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m12:29:48.997245 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m12:29:49.009164 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m12:29:49.010448 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 12:29:48.998567 => 12:29:49.010204
[0m12:29:49.010867 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m12:29:49.013095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:49.829344 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m12:29:49.830121 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m12:29:50.362268 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:6541b152-a4e2-46e6-8826-d148f4c8a464&page=queryresults
[0m12:29:52.893832 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 12:29:49.011124 => 12:29:52.893647
[0m12:29:52.894535 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c2288eb-f2a0-4979-81b4-1db7849c274d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0500a55b70>]}
[0m12:29:52.895110 [info ] [Thread-1 (]: 4 of 11 OK created sql table model games.dim_price_overview .................... [[32mCREATE TABLE (1.1k rows, 114.2 KiB processed)[0m in 3.90s]
[0m12:29:52.895722 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m12:29:52.896185 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m12:29:52.896620 [info ] [Thread-1 (]: 5 of 11 START sql table model games.dim_publishers ............................. [RUN]
[0m12:29:52.897437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m12:29:52.897865 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m12:29:52.900562 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m12:29:52.901209 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 12:29:52.898147 => 12:29:52.901005
[0m12:29:52.901599 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m12:29:52.903803 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:53.655154 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m12:29:53.655890 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m12:29:54.416004 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ef5a20a9-8e96-4b56-b62d-a85ce16afdb1&page=queryresults
[0m12:29:57.153211 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 12:29:52.901874 => 12:29:57.152338
[0m12:29:57.156327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c2288eb-f2a0-4979-81b4-1db7849c274d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0500a38b80>]}
[0m12:29:57.159030 [info ] [Thread-1 (]: 5 of 11 OK created sql table model games.dim_publishers ........................ [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.26s]
[0m12:29:57.161903 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m12:29:57.163970 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m12:29:57.166056 [info ] [Thread-1 (]: 6 of 11 START sql table model games.dim_release ................................ [RUN]
[0m12:29:57.169299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m12:29:57.171203 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m12:29:57.181369 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m12:29:57.182917 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 12:29:57.172502 => 12:29:57.182412
[0m12:29:57.183845 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m12:29:57.188479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:57.936268 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m12:29:57.936993 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m12:29:58.531989 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:61f752f0-9e6e-42df-bbde-30339fb1f825&page=queryresults
[0m12:30:01.055796 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 12:29:57.184501 => 12:30:01.054921
[0m12:30:01.059122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c2288eb-f2a0-4979-81b4-1db7849c274d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0500a38e50>]}
[0m12:30:01.061733 [info ] [Thread-1 (]: 6 of 11 OK created sql table model games.dim_release ........................... [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 3.89s]
[0m12:30:01.064576 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m12:30:01.066672 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m12:30:01.069083 [info ] [Thread-1 (]: 7 of 11 START sql table model games.dim_support_language ....................... [RUN]
[0m12:30:01.072188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m12:30:01.074035 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m12:30:01.080843 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m12:30:01.081531 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 12:30:01.075367 => 12:30:01.081308
[0m12:30:01.081926 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m12:30:01.088260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:01.806206 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m12:30:01.806965 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m12:30:02.401615 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:55e65911-1123-4075-8df7-c8defcc4630c&page=queryresults
[0m12:30:04.843643 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 12:30:01.082185 => 12:30:04.842768
[0m12:30:04.846743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c2288eb-f2a0-4979-81b4-1db7849c274d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0500a8be20>]}
[0m12:30:04.849296 [info ] [Thread-1 (]: 7 of 11 OK created sql table model games.dim_support_language .................. [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 3.78s]
[0m12:30:04.852112 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m12:30:04.854133 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m12:30:04.856535 [info ] [Thread-1 (]: 8 of 11 START sql table model games.fct_game_pricing ........................... [RUN]
[0m12:30:04.859460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m12:30:04.861295 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m12:30:04.873626 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m12:30:04.875690 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 12:30:04.862606 => 12:30:04.875028
[0m12:30:04.876686 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m12:30:04.881936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:05.586295 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m12:30:05.587099 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para el análisis de precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        formatted_initial_price,
        SUM(price_with_tax) AS total_sales,
        SUM(discount_amount) AS total_discounts,
        COUNT(*) AS num_sales,
        MAX(discount_pct) AS max_discount,
        MIN(initial_price) AS min_price,
        MAX(initial_price) AS max_price,
        SUM(price_with_tax) AS total_sales_with_tax,
        SUM(final_price) AS total_sales_with_tax_discounted
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id, formatted_initial_price
)

SELECT
    fct.app_id,
    fct.formatted_initial_price,
    fct.total_sales,
    fct.total_discounts,
    fct.num_sales,
    fct.max_discount,
    fct.min_price,
    fct.max_price,
    fct.total_sales_with_tax,
    fct.total_sales_with_tax_discounted,
    games.name AS game_name,
    games.description AS game_description,
    games.is_free AS game_is_free,
    games.fullgame_app_id,
    games.fullgame_name,
    games.type,
    games.genre_id,
    games.type_genre,
FROM
    game_sales AS fct
INNER JOIN
    `pristine-flames-400818`.`games`.`dim_games` AS games
ON
    fct.app_id = games.app_id
    );
  
[0m12:30:06.317331 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ab5046e1-9903-40e2-8a41-8b56ae60f93c&page=queryresults
[0m12:30:08.915377 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 12:30:04.877368 => 12:30:08.915194
[0m12:30:08.916080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c2288eb-f2a0-4979-81b4-1db7849c274d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0500a56200>]}
[0m12:30:08.916663 [info ] [Thread-1 (]: 8 of 11 OK created sql table model games.fct_game_pricing ...................... [[32mCREATE TABLE (1.1k rows, 839.8 KiB processed)[0m in 4.06s]
[0m12:30:08.917274 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m12:30:08.918176 [debug] [Thread-1 (]: Began running node model.games.top_10_discounted_games
[0m12:30:08.918651 [info ] [Thread-1 (]: 9 of 11 START sql table model games.top_10_discounted_games .................... [RUN]
[0m12:30:08.919278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.fct_game_pricing, now model.games.top_10_discounted_games)
[0m12:30:08.919674 [debug] [Thread-1 (]: Began compiling node model.games.top_10_discounted_games
[0m12:30:08.922646 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_discounted_games"
[0m12:30:08.923338 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (compile): 12:30:08.919951 => 12:30:08.923118
[0m12:30:08.923758 [debug] [Thread-1 (]: Began executing node model.games.top_10_discounted_games
[0m12:30:08.926123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:09.729283 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_discounted_games"
[0m12:30:09.730008 [debug] [Thread-1 (]: On model.games.top_10_discounted_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_discounted_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_discounted_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 descuentos más grandes
SELECT
    app_id,
    game_name,
    total_discounts
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY total_discounts DESC
LIMIT 10
    );
  
[0m12:30:10.306896 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:4d4bb281-ea1d-42a2-87f1-db77970cca60&page=queryresults
[0m12:30:12.457548 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (execute): 12:30:08.924055 => 12:30:12.456666
[0m12:30:12.460824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c2288eb-f2a0-4979-81b4-1db7849c274d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0500bae830>]}
[0m12:30:12.463397 [info ] [Thread-1 (]: 9 of 11 OK created sql table model games.top_10_discounted_games ............... [[32mCREATE TABLE (10.0 rows, 61.3 KiB processed)[0m in 3.54s]
[0m12:30:12.466204 [debug] [Thread-1 (]: Finished running node model.games.top_10_discounted_games
[0m12:30:12.468256 [debug] [Thread-1 (]: Began running node model.games.top_10_high_tax_games
[0m12:30:12.470727 [info ] [Thread-1 (]: 10 of 11 START sql table model games.top_10_high_tax_games ..................... [RUN]
[0m12:30:12.473817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_discounted_games, now model.games.top_10_high_tax_games)
[0m12:30:12.475707 [debug] [Thread-1 (]: Began compiling node model.games.top_10_high_tax_games
[0m12:30:12.481808 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_high_tax_games"
[0m12:30:12.482516 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (compile): 12:30:12.477006 => 12:30:12.482275
[0m12:30:12.483012 [debug] [Thread-1 (]: Began executing node model.games.top_10_high_tax_games
[0m12:30:12.491070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:13.219152 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_high_tax_games"
[0m12:30:13.219910 [debug] [Thread-1 (]: On model.games.top_10_high_tax_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_high_tax_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_high_tax_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos con más impuestos
SELECT
    app_id,
    game_name,
    SUM(total_taxes) AS total_taxes
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
GROUP BY app_id, game_name
ORDER BY total_taxes DESC, game_name DESC
LIMIT 10
    );
  
[0m12:30:13.742064 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ba4cf00f-fd4f-432f-acbd-80d5bf2f3397&page=queryresults
[0m12:30:14.215319 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: total_taxes; Did you mean total_sales? at [17:9]')
[0m12:30:14.793242 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:208df3ae-7769-4232-ba41-4b1bc3ce5d51&page=queryresults
[0m12:30:15.258871 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:208df3ae-7769-4232-ba41-4b1bc3ce5d51&page=queryresults
[0m12:30:15.262013 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (execute): 12:30:12.483285 => 12:30:15.261045
[0m12:30:15.265472 [debug] [Thread-1 (]: Database Error in model top_10_high_tax_games (models/report/top_10_high_tax_games.sql)
  Unrecognized name: total_taxes; Did you mean total_sales? at [17:9]
  compiled Code at target/run/games/models/report/top_10_high_tax_games.sql
[0m12:30:15.265919 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c2288eb-f2a0-4979-81b4-1db7849c274d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0500a007f0>]}
[0m12:30:15.266507 [error] [Thread-1 (]: 10 of 11 ERROR creating sql table model games.top_10_high_tax_games ............ [[31mERROR[0m in 2.79s]
[0m12:30:15.267147 [debug] [Thread-1 (]: Finished running node model.games.top_10_high_tax_games
[0m12:30:15.267614 [debug] [Thread-1 (]: Began running node model.games.top_10_most_expensive_games
[0m12:30:15.268197 [info ] [Thread-1 (]: 11 of 11 START sql table model games.top_10_most_expensive_games ............... [RUN]
[0m12:30:15.268847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_high_tax_games, now model.games.top_10_most_expensive_games)
[0m12:30:15.269231 [debug] [Thread-1 (]: Began compiling node model.games.top_10_most_expensive_games
[0m12:30:15.272022 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_most_expensive_games"
[0m12:30:15.272721 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (compile): 12:30:15.269495 => 12:30:15.272483
[0m12:30:15.273159 [debug] [Thread-1 (]: Began executing node model.games.top_10_most_expensive_games
[0m12:30:15.275517 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:15.993183 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_most_expensive_games"
[0m12:30:15.993864 [debug] [Thread-1 (]: On model.games.top_10_most_expensive_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_most_expensive_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_most_expensive_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos más caros
SELECT
    app_id,
    game_name,
    max_price,
    formatted_initial_price,
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY max_price DESC
LIMIT 10
    );
  
[0m12:30:16.395523 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e6662bdf-d47c-4780-b3fb-17bc0a243d3e&page=queryresults
[0m12:30:19.385801 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (execute): 12:30:15.273419 => 12:30:19.384907
[0m12:30:19.388981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c2288eb-f2a0-4979-81b4-1db7849c274d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0500a1ebf0>]}
[0m12:30:19.391586 [info ] [Thread-1 (]: 11 of 11 OK created sql table model games.top_10_most_expensive_games .......... [[32mCREATE TABLE (10.0 rows, 66.9 KiB processed)[0m in 4.12s]
[0m12:30:19.394421 [debug] [Thread-1 (]: Finished running node model.games.top_10_most_expensive_games
[0m12:30:19.400470 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:30:19.402041 [debug] [MainThread]: Connection 'model.games.top_10_most_expensive_games' was properly closed.
[0m12:30:19.402468 [info ] [MainThread]: 
[0m12:30:19.402885 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 43.73 seconds (43.73s).
[0m12:30:19.404995 [debug] [MainThread]: Command end result
[0m12:30:19.413643 [info ] [MainThread]: 
[0m12:30:19.414068 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:30:19.414387 [info ] [MainThread]: 
[0m12:30:19.414743 [error] [MainThread]:   Database Error in model top_10_high_tax_games (models/report/top_10_high_tax_games.sql)
  Unrecognized name: total_taxes; Did you mean total_sales? at [17:9]
  compiled Code at target/run/games/models/report/top_10_high_tax_games.sql
[0m12:30:19.415076 [info ] [MainThread]: 
[0m12:30:19.415414 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m12:30:19.415943 [debug] [MainThread]: Command `dbt run` failed at 12:30:19.415849 after 44.18 seconds
[0m12:30:19.416297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f050541ab30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0500baebc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f050128b160>]}
[0m12:30:19.416666 [debug] [MainThread]: Flushing usage events
[0m12:31:43.764470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2969335180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29674c4070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29674c40d0>]}


============================== 12:31:43.766784 | 624714b3-abaf-4618-afeb-99603e0cdd23 ==============================
[0m12:31:43.766784 [info ] [MainThread]: Running with dbt=1.6.5
[0m12:31:43.767307 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'send_anonymous_usage_stats': 'True'}
[0m12:31:44.070815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '624714b3-abaf-4618-afeb-99603e0cdd23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f296894dcf0>]}
[0m12:31:44.087342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '624714b3-abaf-4618-afeb-99603e0cdd23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29654649d0>]}
[0m12:31:44.088253 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m12:31:44.102768 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m12:31:44.172630 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:31:44.173224 [debug] [MainThread]: Partial parsing: updated file: games://models/report/top_10_high_tax_games.sql
[0m12:31:44.218917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '624714b3-abaf-4618-afeb-99603e0cdd23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2964b59e10>]}
[0m12:31:44.229274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '624714b3-abaf-4618-afeb-99603e0cdd23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2965297460>]}
[0m12:31:44.229861 [info ] [MainThread]: Found 11 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m12:31:44.230272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '624714b3-abaf-4618-afeb-99603e0cdd23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2965297490>]}
[0m12:31:44.231853 [info ] [MainThread]: 
[0m12:31:44.232554 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:31:44.234251 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m12:31:44.234916 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:44.953707 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m12:31:44.955498 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:31:45.631487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '624714b3-abaf-4618-afeb-99603e0cdd23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2965296230>]}
[0m12:31:45.632979 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:31:45.633362 [info ] [MainThread]: 
[0m12:31:45.635349 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m12:31:45.635855 [info ] [Thread-1 (]: 1 of 11 START sql table model games.dim_developers ............................. [RUN]
[0m12:31:45.636506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m12:31:45.636890 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m12:31:45.644067 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m12:31:45.644779 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 12:31:45.637162 => 12:31:45.644561
[0m12:31:45.645182 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m12:31:45.657768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:46.422626 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m12:31:46.423578 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS developer_id,
    developers_name
FROM
    developers_cte
    );
  
[0m12:31:47.085192 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5562925b-f123-4ad6-88fe-ab2be6c467db&page=queryresults
[0m12:31:49.821436 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 12:31:45.645464 => 12:31:49.821124
[0m12:31:49.822576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '624714b3-abaf-4618-afeb-99603e0cdd23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2965272530>]}
[0m12:31:49.823485 [info ] [Thread-1 (]: 1 of 11 OK created sql table model games.dim_developers ........................ [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.19s]
[0m12:31:49.824454 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m12:31:49.825140 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m12:31:49.825847 [info ] [Thread-1 (]: 2 of 11 START sql table model games.dim_games .................................. [RUN]
[0m12:31:49.826718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m12:31:49.827248 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m12:31:49.836699 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m12:31:49.837439 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 12:31:49.827623 => 12:31:49.837225
[0m12:31:49.837851 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m12:31:49.840270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:50.434211 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m12:31:50.436882 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m12:31:51.027606 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:671c71bf-6074-4f9a-883f-74cf2306ab7d&page=queryresults
[0m12:31:53.468416 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 12:31:49.838143 => 12:31:53.467563
[0m12:31:53.471612 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '624714b3-abaf-4618-afeb-99603e0cdd23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2965270850>]}
[0m12:31:53.474143 [info ] [Thread-1 (]: 2 of 11 OK created sql table model games.dim_games ............................. [[32mCREATE TABLE (2.7k rows, 753.9 KiB processed)[0m in 3.64s]
[0m12:31:53.476970 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m12:31:53.479022 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m12:31:53.481373 [info ] [Thread-1 (]: 3 of 11 START sql table model games.dim_platforms .............................. [RUN]
[0m12:31:53.484338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m12:31:53.486149 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m12:31:53.492877 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m12:31:53.493566 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 12:31:53.487468 => 12:31:53.493336
[0m12:31:53.493947 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m12:31:53.496090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:54.225038 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m12:31:54.225729 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m12:31:54.780015 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:48ec3fb8-a056-44ae-95fc-c10c25a6471d&page=queryresults
[0m12:31:57.252795 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 12:31:53.494209 => 12:31:57.251932
[0m12:31:57.255901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '624714b3-abaf-4618-afeb-99603e0cdd23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2965272da0>]}
[0m12:31:57.258459 [info ] [Thread-1 (]: 3 of 11 OK created sql table model games.dim_platforms ......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 3.77s]
[0m12:31:57.261408 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m12:31:57.263490 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m12:31:57.265598 [info ] [Thread-1 (]: 4 of 11 START sql table model games.dim_price_overview ......................... [RUN]
[0m12:31:57.268854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m12:31:57.270760 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m12:31:57.281054 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m12:31:57.282579 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 12:31:57.272067 => 12:31:57.282063
[0m12:31:57.283509 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m12:31:57.288009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:57.989843 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m12:31:57.990605 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m12:31:58.537087 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:4716f57c-9452-49f5-9dcf-db32a365feb9&page=queryresults
[0m12:32:01.252436 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 12:31:57.284160 => 12:32:01.251818
[0m12:32:01.254654 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '624714b3-abaf-4618-afeb-99603e0cdd23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2964a61bd0>]}
[0m12:32:01.256413 [info ] [Thread-1 (]: 4 of 11 OK created sql table model games.dim_price_overview .................... [[32mCREATE TABLE (1.1k rows, 114.2 KiB processed)[0m in 3.99s]
[0m12:32:01.258336 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m12:32:01.259755 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m12:32:01.261553 [info ] [Thread-1 (]: 5 of 11 START sql table model games.dim_publishers ............................. [RUN]
[0m12:32:01.263623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m12:32:01.264863 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m12:32:01.273370 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m12:32:01.275367 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 12:32:01.265742 => 12:32:01.274730
[0m12:32:01.276632 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m12:32:01.282977 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:32:02.025561 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m12:32:02.026255 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m12:32:02.689945 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ad00547c-a84d-4bde-a992-9b1630339b1f&page=queryresults
[0m12:32:05.374714 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 12:32:01.277519 => 12:32:05.373827
[0m12:32:05.377823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '624714b3-abaf-4618-afeb-99603e0cdd23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2964a44c40>]}
[0m12:32:05.380392 [info ] [Thread-1 (]: 5 of 11 OK created sql table model games.dim_publishers ........................ [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.11s]
[0m12:32:05.383206 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m12:32:05.385222 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m12:32:05.387614 [info ] [Thread-1 (]: 6 of 11 START sql table model games.dim_release ................................ [RUN]
[0m12:32:05.390584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m12:32:05.392401 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m12:32:05.403641 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m12:32:05.405576 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 12:32:05.393697 => 12:32:05.404948
[0m12:32:05.406507 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m12:32:05.411314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:32:06.145900 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m12:32:06.146622 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m12:32:06.542963 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9f309727-b65e-48c1-b3d5-ae29de3125ac&page=queryresults
[0m12:32:09.010433 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 12:32:05.407162 => 12:32:09.009558
[0m12:32:09.013762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '624714b3-abaf-4618-afeb-99603e0cdd23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2964a451b0>]}
[0m12:32:09.016339 [info ] [Thread-1 (]: 6 of 11 OK created sql table model games.dim_release ........................... [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 3.62s]
[0m12:32:09.019231 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m12:32:09.021293 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m12:32:09.023718 [info ] [Thread-1 (]: 7 of 11 START sql table model games.dim_support_language ....................... [RUN]
[0m12:32:09.026948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m12:32:09.028802 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m12:32:09.039724 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m12:32:09.041427 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 12:32:09.030109 => 12:32:09.040944
[0m12:32:09.042360 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m12:32:09.054244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:32:09.743246 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m12:32:09.743961 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m12:32:10.302042 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9e5ceecd-a9a5-46ea-aada-1c71f67c1134&page=queryresults
[0m12:32:12.706380 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 12:32:09.043044 => 12:32:12.705357
[0m12:32:12.709512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '624714b3-abaf-4618-afeb-99603e0cdd23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2964a97e80>]}
[0m12:32:12.712077 [info ] [Thread-1 (]: 7 of 11 OK created sql table model games.dim_support_language .................. [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 3.68s]
[0m12:32:12.714887 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m12:32:12.716919 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m12:32:12.718989 [info ] [Thread-1 (]: 8 of 11 START sql table model games.fct_game_pricing ........................... [RUN]
[0m12:32:12.722177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m12:32:12.724066 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m12:32:12.735341 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m12:32:12.736921 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 12:32:12.725371 => 12:32:12.736420
[0m12:32:12.737842 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m12:32:12.742556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:32:13.465107 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m12:32:13.465833 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para el análisis de precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        formatted_initial_price,
        SUM(price_with_tax) AS total_sales,
        SUM(discount_amount) AS total_discounts,
        COUNT(*) AS num_sales,
        MAX(discount_pct) AS max_discount,
        MIN(initial_price) AS min_price,
        MAX(initial_price) AS max_price,
        SUM(price_with_tax) AS total_sales_with_tax,
        SUM(final_price) AS total_sales_with_tax_discounted
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id, formatted_initial_price
)

SELECT
    fct.app_id,
    fct.formatted_initial_price,
    fct.total_sales,
    fct.total_discounts,
    fct.num_sales,
    fct.max_discount,
    fct.min_price,
    fct.max_price,
    fct.total_sales_with_tax,
    fct.total_sales_with_tax_discounted,
    games.name AS game_name,
    games.description AS game_description,
    games.is_free AS game_is_free,
    games.fullgame_app_id,
    games.fullgame_name,
    games.type,
    games.genre_id,
    games.type_genre,
FROM
    game_sales AS fct
INNER JOIN
    `pristine-flames-400818`.`games`.`dim_games` AS games
ON
    fct.app_id = games.app_id
    );
  
[0m12:32:14.211912 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:bee2e0d1-68e0-4715-bc6b-a0af049c966b&page=queryresults
[0m12:32:16.442110 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 12:32:12.738514 => 12:32:16.441232
[0m12:32:16.445254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '624714b3-abaf-4618-afeb-99603e0cdd23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2964a637f0>]}
[0m12:32:16.447851 [info ] [Thread-1 (]: 8 of 11 OK created sql table model games.fct_game_pricing ...................... [[32mCREATE TABLE (1.1k rows, 839.8 KiB processed)[0m in 3.72s]
[0m12:32:16.450873 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m12:32:16.454366 [debug] [Thread-1 (]: Began running node model.games.top_10_discounted_games
[0m12:32:16.456537 [info ] [Thread-1 (]: 9 of 11 START sql table model games.top_10_discounted_games .................... [RUN]
[0m12:32:16.459537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.fct_game_pricing, now model.games.top_10_discounted_games)
[0m12:32:16.461394 [debug] [Thread-1 (]: Began compiling node model.games.top_10_discounted_games
[0m12:32:16.466926 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_discounted_games"
[0m12:32:16.467616 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (compile): 12:32:16.462725 => 12:32:16.467394
[0m12:32:16.468006 [debug] [Thread-1 (]: Began executing node model.games.top_10_discounted_games
[0m12:32:16.470149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:32:17.205162 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_discounted_games"
[0m12:32:17.205869 [debug] [Thread-1 (]: On model.games.top_10_discounted_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_discounted_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_discounted_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 descuentos más grandes
SELECT
    app_id,
    game_name,
    total_discounts
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY total_discounts DESC
LIMIT 10
    );
  
[0m12:32:17.814212 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:6523ed94-fad1-4d44-8533-baab26805ad7&page=queryresults
[0m12:32:20.253854 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (execute): 12:32:16.468259 => 12:32:20.252886
[0m12:32:20.257164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '624714b3-abaf-4618-afeb-99603e0cdd23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2964bba680>]}
[0m12:32:20.259728 [info ] [Thread-1 (]: 9 of 11 OK created sql table model games.top_10_discounted_games ............... [[32mCREATE TABLE (10.0 rows, 61.3 KiB processed)[0m in 3.80s]
[0m12:32:20.262583 [debug] [Thread-1 (]: Finished running node model.games.top_10_discounted_games
[0m12:32:20.264627 [debug] [Thread-1 (]: Began running node model.games.top_10_high_tax_games
[0m12:32:20.267078 [info ] [Thread-1 (]: 10 of 11 START sql table model games.top_10_high_tax_games ..................... [RUN]
[0m12:32:20.270188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_discounted_games, now model.games.top_10_high_tax_games)
[0m12:32:20.272092 [debug] [Thread-1 (]: Began compiling node model.games.top_10_high_tax_games
[0m12:32:20.278647 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_high_tax_games"
[0m12:32:20.279393 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (compile): 12:32:20.273400 => 12:32:20.279139
[0m12:32:20.279784 [debug] [Thread-1 (]: Began executing node model.games.top_10_high_tax_games
[0m12:32:20.288852 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:32:21.023229 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_high_tax_games"
[0m12:32:21.023954 [debug] [Thread-1 (]: On model.games.top_10_high_tax_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_high_tax_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_high_tax_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos con más impuestos
SELECT
    app_id,
    game_name,
    SUM(total_sales_with_tax) AS total_taxes
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
GROUP BY app_id, game_name
ORDER BY total_taxes DESC, game_name DESC
LIMIT 10
    );
  
[0m12:32:21.580403 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5119fc81-3ceb-49ac-a439-b54b69e47562&page=queryresults
[0m12:32:23.733096 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (execute): 12:32:20.280039 => 12:32:23.732211
[0m12:32:23.736209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '624714b3-abaf-4618-afeb-99603e0cdd23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2964a3bbb0>]}
[0m12:32:23.738799 [info ] [Thread-1 (]: 10 of 11 OK created sql table model games.top_10_high_tax_games ................ [[32mCREATE TABLE (10.0 rows, 61.3 KiB processed)[0m in 3.47s]
[0m12:32:23.741576 [debug] [Thread-1 (]: Finished running node model.games.top_10_high_tax_games
[0m12:32:23.743628 [debug] [Thread-1 (]: Began running node model.games.top_10_most_expensive_games
[0m12:32:23.745985 [info ] [Thread-1 (]: 11 of 11 START sql table model games.top_10_most_expensive_games ............... [RUN]
[0m12:32:23.748961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_high_tax_games, now model.games.top_10_most_expensive_games)
[0m12:32:23.750816 [debug] [Thread-1 (]: Began compiling node model.games.top_10_most_expensive_games
[0m12:32:23.759280 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_most_expensive_games"
[0m12:32:23.760095 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (compile): 12:32:23.752111 => 12:32:23.759825
[0m12:32:23.760493 [debug] [Thread-1 (]: Began executing node model.games.top_10_most_expensive_games
[0m12:32:23.762736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:32:24.476439 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_most_expensive_games"
[0m12:32:24.477164 [debug] [Thread-1 (]: On model.games.top_10_most_expensive_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_most_expensive_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_most_expensive_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos más caros
SELECT
    app_id,
    game_name,
    max_price,
    formatted_initial_price,
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY max_price DESC
LIMIT 10
    );
  
[0m12:32:25.031522 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d45e3584-b51e-4737-b13b-03404188d97d&page=queryresults
[0m12:32:27.447691 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (execute): 12:32:23.760747 => 12:32:27.446816
[0m12:32:27.450798 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '624714b3-abaf-4618-afeb-99603e0cdd23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2964a0fb80>]}
[0m12:32:27.453333 [info ] [Thread-1 (]: 11 of 11 OK created sql table model games.top_10_most_expensive_games .......... [[32mCREATE TABLE (10.0 rows, 66.9 KiB processed)[0m in 3.70s]
[0m12:32:27.456155 [debug] [Thread-1 (]: Finished running node model.games.top_10_most_expensive_games
[0m12:32:27.461985 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:32:27.463563 [debug] [MainThread]: Connection 'model.games.top_10_most_expensive_games' was properly closed.
[0m12:32:27.465228 [info ] [MainThread]: 
[0m12:32:27.466920 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 43.23 seconds (43.23s).
[0m12:32:27.476928 [debug] [MainThread]: Command end result
[0m12:32:27.515549 [info ] [MainThread]: 
[0m12:32:27.517401 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:32:27.519042 [info ] [MainThread]: 
[0m12:32:27.520692 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m12:32:27.523196 [debug] [MainThread]: Command `dbt run` succeeded at 12:32:27.522748 after 43.77 seconds
[0m12:32:27.524911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2969335180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2964bb4f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2965297580>]}
[0m12:32:27.526706 [debug] [MainThread]: Flushing usage events
[0m13:16:05.007802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7400e2aa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73fefc0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73fefc00d0>]}


============================== 13:16:05.013361 | df1a85b6-c679-4690-b826-a7f31b066fef ==============================
[0m13:16:05.013361 [info ] [MainThread]: Running with dbt=1.6.5
[0m13:16:05.014021 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '../dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:16:05.500042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df1a85b6-c679-4690-b826-a7f31b066fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f740040d3f0>]}
[0m13:16:05.516291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df1a85b6-c679-4690-b826-a7f31b066fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73fcf5c9d0>]}
[0m13:16:05.516895 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m13:16:05.530720 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m13:16:05.576564 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:16:05.577001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'df1a85b6-c679-4690-b826-a7f31b066fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f740040ce50>]}
[0m13:16:06.618147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df1a85b6-c679-4690-b826-a7f31b066fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73fc6ed5d0>]}
[0m13:16:06.628026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df1a85b6-c679-4690-b826-a7f31b066fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73fc6ed6f0>]}
[0m13:16:06.628555 [info ] [MainThread]: Found 11 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m13:16:06.628958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df1a85b6-c679-4690-b826-a7f31b066fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73fcdcc5b0>]}
[0m13:16:06.630490 [info ] [MainThread]: 
[0m13:16:06.631350 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:16:06.632817 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m13:16:06.633168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:06.633623 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: '/opt/airflow/credentials.json''
[0m13:16:06.634616 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:16:06.634928 [debug] [MainThread]: Connection 'list_pristine-flames-400818' was properly closed.
[0m13:16:06.635237 [info ] [MainThread]: 
[0m13:16:06.635575 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.00 seconds (0.00s).
[0m13:16:06.636003 [error] [MainThread]: Encountered an error:
Database Error
  [Errno 2] No such file or directory: '/opt/airflow/credentials.json'
[0m13:16:06.636523 [debug] [MainThread]: Command `dbt run` failed at 13:16:06.636432 after 1.64 seconds
[0m13:16:06.636866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7400e2aa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73fc6efe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73fc6efe80>]}
[0m13:16:06.637237 [debug] [MainThread]: Flushing usage events
[0m13:18:07.835005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8916c1eb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8914d88070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8914d880d0>]}


============================== 13:18:07.837130 | bcaa4558-1e00-4e88-85e6-2fbd66a32445 ==============================
[0m13:18:07.837130 [info ] [MainThread]: Running with dbt=1.6.5
[0m13:18:07.837637 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:18:08.122433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bcaa4558-1e00-4e88-85e6-2fbd66a32445', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8912d0ac50>]}
[0m13:18:08.138324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bcaa4558-1e00-4e88-85e6-2fbd66a32445', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8912d24640>]}
[0m13:18:08.139052 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m13:18:08.152614 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m13:18:08.197741 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:18:08.198178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bcaa4558-1e00-4e88-85e6-2fbd66a32445', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89164ccc40>]}
[0m13:18:09.206329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bcaa4558-1e00-4e88-85e6-2fbd66a32445', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89124d16c0>]}
[0m13:18:09.216176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bcaa4558-1e00-4e88-85e6-2fbd66a32445', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8912d32d10>]}
[0m13:18:09.216710 [info ] [MainThread]: Found 11 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m13:18:09.217105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcaa4558-1e00-4e88-85e6-2fbd66a32445', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8912b84460>]}
[0m13:18:09.218694 [info ] [MainThread]: 
[0m13:18:09.219538 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:18:09.221304 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m13:18:09.221840 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:10.067958 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m13:18:10.068505 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:18:10.723987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcaa4558-1e00-4e88-85e6-2fbd66a32445', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8912b846a0>]}
[0m13:18:10.727284 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:18:10.728967 [info ] [MainThread]: 
[0m13:18:10.736322 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m13:18:10.738691 [info ] [Thread-1 (]: 1 of 11 START sql table model games.dim_developers ............................. [RUN]
[0m13:18:10.741912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m13:18:10.743861 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m13:18:10.764791 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m13:18:10.765842 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 13:18:10.745172 => 13:18:10.765518
[0m13:18:10.766472 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m13:18:10.786676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:18:11.579972 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m13:18:11.580683 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS developer_id,
    developers_name
FROM
    developers_cte
    );
  
[0m13:18:12.388594 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5ad5f00d-0f63-4bb7-a591-af3d55ea8101&page=queryresults
[0m13:18:14.831126 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 13:18:10.766933 => 13:18:14.830806
[0m13:18:14.832204 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcaa4558-1e00-4e88-85e6-2fbd66a32445', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89122340d0>]}
[0m13:18:14.832997 [info ] [Thread-1 (]: 1 of 11 OK created sql table model games.dim_developers ........................ [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.09s]
[0m13:18:14.833842 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m13:18:14.834463 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m13:18:14.835311 [info ] [Thread-1 (]: 2 of 11 START sql table model games.dim_games .................................. [RUN]
[0m13:18:14.836258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m13:18:14.836866 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m13:18:14.840247 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m13:18:14.841013 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 13:18:14.837202 => 13:18:14.840771
[0m13:18:14.841471 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m13:18:14.843971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:18:15.550834 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m13:18:15.551496 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m13:18:16.162816 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5755f059-41ad-486d-bcab-18f413641e8b&page=queryresults
[0m13:18:18.582776 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 13:18:14.841800 => 13:18:18.582590
[0m13:18:18.583490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcaa4558-1e00-4e88-85e6-2fbd66a32445', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8912235240>]}
[0m13:18:18.584038 [info ] [Thread-1 (]: 2 of 11 OK created sql table model games.dim_games ............................. [[32mCREATE TABLE (2.7k rows, 753.9 KiB processed)[0m in 3.75s]
[0m13:18:18.584616 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m13:18:18.585028 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m13:18:18.585543 [info ] [Thread-1 (]: 3 of 11 START sql table model games.dim_platforms .............................. [RUN]
[0m13:18:18.586186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m13:18:18.586632 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m13:18:18.589416 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m13:18:18.590015 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 13:18:18.586895 => 13:18:18.589825
[0m13:18:18.590375 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m13:18:18.592504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:18:19.306205 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m13:18:19.308913 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m13:18:19.861127 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b9cbbbcd-8193-40a9-a20f-903b7fdce95a&page=queryresults
[0m13:18:22.436541 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 13:18:18.590638 => 13:18:22.436354
[0m13:18:22.437261 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcaa4558-1e00-4e88-85e6-2fbd66a32445', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89122342b0>]}
[0m13:18:22.437809 [info ] [Thread-1 (]: 3 of 11 OK created sql table model games.dim_platforms ......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 3.85s]
[0m13:18:22.438461 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m13:18:22.438933 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m13:18:22.439366 [info ] [Thread-1 (]: 4 of 11 START sql table model games.dim_price_overview ......................... [RUN]
[0m13:18:22.440006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m13:18:22.440466 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m13:18:22.448777 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m13:18:22.449455 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 13:18:22.440739 => 13:18:22.449261
[0m13:18:22.449826 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m13:18:22.452060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:18:23.187851 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m13:18:23.190733 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m13:18:23.854511 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:970fd7bf-af86-4513-9125-a7794704e333&page=queryresults
[0m13:18:26.295598 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 13:18:22.450080 => 13:18:26.295416
[0m13:18:26.296309 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcaa4558-1e00-4e88-85e6-2fbd66a32445', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f891245f6a0>]}
[0m13:18:26.296880 [info ] [Thread-1 (]: 4 of 11 OK created sql table model games.dim_price_overview .................... [[32mCREATE TABLE (1.1k rows, 114.2 KiB processed)[0m in 3.86s]
[0m13:18:26.297498 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m13:18:26.297965 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m13:18:26.298392 [info ] [Thread-1 (]: 5 of 11 START sql table model games.dim_publishers ............................. [RUN]
[0m13:18:26.299109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m13:18:26.299638 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m13:18:26.302473 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m13:18:26.303154 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 13:18:26.300073 => 13:18:26.302938
[0m13:18:26.303547 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m13:18:26.305730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:18:27.022911 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m13:18:27.025820 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m13:18:27.654357 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:4c3d12a8-cdf0-4223-a2a6-5a63c0377a32&page=queryresults
[0m13:18:30.363939 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 13:18:26.303810 => 13:18:30.363053
[0m13:18:30.367140 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcaa4558-1e00-4e88-85e6-2fbd66a32445', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f891245f6a0>]}
[0m13:18:30.369717 [info ] [Thread-1 (]: 5 of 11 OK created sql table model games.dim_publishers ........................ [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.07s]
[0m13:18:30.372575 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m13:18:30.374657 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m13:18:30.377093 [info ] [Thread-1 (]: 6 of 11 START sql table model games.dim_release ................................ [RUN]
[0m13:18:30.380085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m13:18:30.381915 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m13:18:30.392274 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m13:18:30.393787 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 13:18:30.383265 => 13:18:30.393298
[0m13:18:30.394812 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m13:18:30.400010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:18:31.121410 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m13:18:31.124133 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m13:18:31.684611 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5fef1ff2-ef80-488a-80ff-e16961d91ab9&page=queryresults
[0m13:18:34.075234 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 13:18:30.395552 => 13:18:34.074338
[0m13:18:34.078449 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcaa4558-1e00-4e88-85e6-2fbd66a32445', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89122ec400>]}
[0m13:18:34.081196 [info ] [Thread-1 (]: 6 of 11 OK created sql table model games.dim_release ........................... [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 3.70s]
[0m13:18:34.084062 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m13:18:34.086180 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m13:18:34.088650 [info ] [Thread-1 (]: 7 of 11 START sql table model games.dim_support_language ....................... [RUN]
[0m13:18:34.091757 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m13:18:34.093669 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m13:18:34.103304 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m13:18:34.104911 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 13:18:34.095025 => 13:18:34.104364
[0m13:18:34.105863 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m13:18:34.110954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:18:34.833000 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m13:18:34.833688 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m13:18:35.454723 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:242bd428-3c92-48a8-bf21-ebb5eca2b9ef&page=queryresults
[0m13:18:38.162522 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 13:18:34.106548 => 13:18:38.161600
[0m13:18:38.165660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcaa4558-1e00-4e88-85e6-2fbd66a32445', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89124d3ee0>]}
[0m13:18:38.168261 [info ] [Thread-1 (]: 7 of 11 OK created sql table model games.dim_support_language .................. [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.07s]
[0m13:18:38.171109 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m13:18:38.173198 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m13:18:38.175688 [info ] [Thread-1 (]: 8 of 11 START sql table model games.fct_game_pricing ........................... [RUN]
[0m13:18:38.178699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m13:18:38.180555 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m13:18:38.192402 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m13:18:38.194243 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 13:18:38.181870 => 13:18:38.193754
[0m13:18:38.195201 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m13:18:38.200104 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:18:38.903010 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m13:18:38.904232 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para el análisis de precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        formatted_initial_price,
        SUM(price_with_tax) AS total_sales,
        SUM(discount_amount) AS total_discounts,
        COUNT(*) AS num_sales,
        MAX(discount_pct) AS max_discount,
        MIN(initial_price) AS min_price,
        MAX(initial_price) AS max_price,
        SUM(price_with_tax) AS total_sales_with_tax,
        SUM(final_price) AS total_sales_with_tax_discounted
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id, formatted_initial_price
)

SELECT
    fct.app_id,
    fct.formatted_initial_price,
    fct.total_sales,
    fct.total_discounts,
    fct.num_sales,
    fct.max_discount,
    fct.min_price,
    fct.max_price,
    fct.total_sales_with_tax,
    fct.total_sales_with_tax_discounted,
    games.name AS game_name,
    games.description AS game_description,
    games.is_free AS game_is_free,
    games.fullgame_app_id,
    games.fullgame_name,
    games.type,
    games.genre_id,
    games.type_genre,
    dp.platform_id,
    dp.windows,
    dp.mac,
    dp.linux
FROM
    game_sales AS fct
INNER JOIN
    `pristine-flames-400818`.`games`.`dim_games` AS games
ON
    fct.app_id = games.app_id
LEFT JOIN
    `pristine-flames-400818`.`games`.`dim_platforms` AS dp
ON
    fct.platform_id = dp.platform_id;
    );
  
[0m13:18:39.248452 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:df3a6164-b7db-4345-b2b5-8be2134e1d06&page=queryresults
[0m13:18:39.252853 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [65:37]')
[0m13:18:40.301017 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d8c77a1a-89d3-4027-9143-70137657c419&page=queryresults
[0m13:18:40.302327 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d8c77a1a-89d3-4027-9143-70137657c419&page=queryresults
[0m13:18:40.303200 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 13:18:38.195864 => 13:18:40.302935
[0m13:18:40.307063 [debug] [Thread-1 (]: Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Syntax error: Expected ")" but got ";" at [65:37]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m13:18:40.307751 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcaa4558-1e00-4e88-85e6-2fbd66a32445', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8912296530>]}
[0m13:18:40.308321 [error] [Thread-1 (]: 8 of 11 ERROR creating sql table model games.fct_game_pricing .................. [[31mERROR[0m in 2.13s]
[0m13:18:40.308884 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m13:18:40.309778 [debug] [Thread-1 (]: Began running node model.games.top_10_discounted_games
[0m13:18:40.310192 [info ] [Thread-1 (]: 9 of 11 SKIP relation games.top_10_discounted_games ............................ [[33mSKIP[0m]
[0m13:18:40.310649 [debug] [Thread-1 (]: Finished running node model.games.top_10_discounted_games
[0m13:18:40.311076 [debug] [Thread-1 (]: Began running node model.games.top_10_high_tax_games
[0m13:18:40.311539 [info ] [Thread-1 (]: 10 of 11 SKIP relation games.top_10_high_tax_games ............................. [[33mSKIP[0m]
[0m13:18:40.312007 [debug] [Thread-1 (]: Finished running node model.games.top_10_high_tax_games
[0m13:18:40.312438 [debug] [Thread-1 (]: Began running node model.games.top_10_most_expensive_games
[0m13:18:40.312856 [info ] [Thread-1 (]: 11 of 11 SKIP relation games.top_10_most_expensive_games ....................... [[33mSKIP[0m]
[0m13:18:40.313387 [debug] [Thread-1 (]: Finished running node model.games.top_10_most_expensive_games
[0m13:18:40.314788 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:18:40.315130 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m13:18:40.315498 [info ] [MainThread]: 
[0m13:18:40.315865 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 31.10 seconds (31.10s).
[0m13:18:40.317590 [debug] [MainThread]: Command end result
[0m13:18:40.332199 [info ] [MainThread]: 
[0m13:18:40.332716 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:18:40.333099 [info ] [MainThread]: 
[0m13:18:40.333480 [error] [MainThread]:   Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Syntax error: Expected ")" but got ";" at [65:37]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m13:18:40.333877 [info ] [MainThread]: 
[0m13:18:40.334279 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=3 TOTAL=11
[0m13:18:40.334923 [debug] [MainThread]: Command `dbt run` failed at 13:18:40.334809 after 32.51 seconds
[0m13:18:40.335341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8916c1eb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8912b7c520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8912d322f0>]}
[0m13:18:40.335780 [debug] [MainThread]: Flushing usage events
[0m13:19:14.660548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc54151ead0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53f6b0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53f6b00d0>]}


============================== 13:19:14.662616 | 0cb98eda-76dc-44f2-94b7-65a49c4f5db7 ==============================
[0m13:19:14.662616 [info ] [MainThread]: Running with dbt=1.6.5
[0m13:19:14.663107 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'profiles_dir': '../dbt/', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:19:14.939279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0cb98eda-76dc-44f2-94b7-65a49c4f5db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc540b6a620>]}
[0m13:19:14.955010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0cb98eda-76dc-44f2-94b7-65a49c4f5db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53d6509d0>]}
[0m13:19:14.955592 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m13:19:14.968890 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m13:19:15.033239 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:19:15.033890 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m13:19:15.078327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0cb98eda-76dc-44f2-94b7-65a49c4f5db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53cd41e40>]}
[0m13:19:15.087541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0cb98eda-76dc-44f2-94b7-65a49c4f5db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53d4834c0>]}
[0m13:19:15.088000 [info ] [MainThread]: Found 11 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m13:19:15.088345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cb98eda-76dc-44f2-94b7-65a49c4f5db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53d483460>]}
[0m13:19:15.089755 [info ] [MainThread]: 
[0m13:19:15.090399 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:19:15.091794 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m13:19:15.092205 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:15.768323 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m13:19:15.770319 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:19:16.517695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cb98eda-76dc-44f2-94b7-65a49c4f5db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53d482470>]}
[0m13:19:16.518420 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:19:16.518809 [info ] [MainThread]: 
[0m13:19:16.520931 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m13:19:16.521428 [info ] [Thread-1 (]: 1 of 11 START sql table model games.dim_developers ............................. [RUN]
[0m13:19:16.522079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m13:19:16.522447 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m13:19:16.529519 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m13:19:16.530270 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 13:19:16.522722 => 13:19:16.529972
[0m13:19:16.530934 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m13:19:16.544521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:17.272007 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m13:19:17.272708 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS developer_id,
    developers_name
FROM
    developers_cte
    );
  
[0m13:19:17.923403 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9671d506-9969-4154-8627-e346f849bed5&page=queryresults
[0m13:19:20.385337 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 13:19:16.531369 => 13:19:20.385154
[0m13:19:20.386044 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb98eda-76dc-44f2-94b7-65a49c4f5db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53d45e5f0>]}
[0m13:19:20.386649 [info ] [Thread-1 (]: 1 of 11 OK created sql table model games.dim_developers ........................ [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 3.86s]
[0m13:19:20.387280 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m13:19:20.387719 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m13:19:20.388263 [info ] [Thread-1 (]: 2 of 11 START sql table model games.dim_games .................................. [RUN]
[0m13:19:20.388868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m13:19:20.389240 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m13:19:20.397934 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m13:19:20.398668 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 13:19:20.389517 => 13:19:20.398412
[0m13:19:20.399057 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m13:19:20.401276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:21.132368 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m13:19:21.133238 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m13:19:21.673181 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:8681d864-8a11-417c-bbb2-ef33387bc7b9&page=queryresults
[0m13:19:24.166813 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 13:19:20.399310 => 13:19:24.166628
[0m13:19:24.167532 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb98eda-76dc-44f2-94b7-65a49c4f5db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53d45c910>]}
[0m13:19:24.168071 [info ] [Thread-1 (]: 2 of 11 OK created sql table model games.dim_games ............................. [[32mCREATE TABLE (2.7k rows, 753.9 KiB processed)[0m in 3.78s]
[0m13:19:24.168636 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m13:19:24.169077 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m13:19:24.169579 [info ] [Thread-1 (]: 3 of 11 START sql table model games.dim_platforms .............................. [RUN]
[0m13:19:24.170170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m13:19:24.170566 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m13:19:24.173302 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m13:19:24.173903 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 13:19:24.170824 => 13:19:24.173712
[0m13:19:24.174261 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m13:19:24.176363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:24.892220 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m13:19:24.892827 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m13:19:25.479030 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:eb75ced1-af49-4a50-86ed-ce90f5ed7b82&page=queryresults
[0m13:19:28.492898 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 13:19:24.174556 => 13:19:28.492709
[0m13:19:28.493576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb98eda-76dc-44f2-94b7-65a49c4f5db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53d45c820>]}
[0m13:19:28.494109 [info ] [Thread-1 (]: 3 of 11 OK created sql table model games.dim_platforms ......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.32s]
[0m13:19:28.494677 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m13:19:28.495119 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m13:19:28.495537 [info ] [Thread-1 (]: 4 of 11 START sql table model games.dim_price_overview ......................... [RUN]
[0m13:19:28.496356 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m13:19:28.496728 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m13:19:28.499581 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m13:19:28.500183 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 13:19:28.496984 => 13:19:28.499994
[0m13:19:28.500541 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m13:19:28.502650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:29.364368 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m13:19:29.367251 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m13:19:29.945927 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5c8041f8-da1e-4f1a-8f8f-cd9f66880f1a&page=queryresults
[0m13:19:32.417942 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 13:19:28.500794 => 13:19:32.417480
[0m13:19:32.418785 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb98eda-76dc-44f2-94b7-65a49c4f5db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53cc3ce80>]}
[0m13:19:32.419337 [info ] [Thread-1 (]: 4 of 11 OK created sql table model games.dim_price_overview .................... [[32mCREATE TABLE (1.1k rows, 114.2 KiB processed)[0m in 3.92s]
[0m13:19:32.419897 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m13:19:32.420334 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m13:19:32.420940 [info ] [Thread-1 (]: 5 of 11 START sql table model games.dim_publishers ............................. [RUN]
[0m13:19:32.421533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m13:19:32.421890 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m13:19:32.424567 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m13:19:32.425163 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 13:19:32.422143 => 13:19:32.424976
[0m13:19:32.425521 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m13:19:32.427693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:33.170613 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m13:19:33.173716 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m13:19:33.750271 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:63ded3ad-1484-48b0-8b9b-195a8241283d&page=queryresults
[0m13:19:36.350194 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 13:19:32.425776 => 13:19:36.349313
[0m13:19:36.353352 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb98eda-76dc-44f2-94b7-65a49c4f5db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53cc1ba60>]}
[0m13:19:36.355957 [info ] [Thread-1 (]: 5 of 11 OK created sql table model games.dim_publishers ........................ [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 3.93s]
[0m13:19:36.358790 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m13:19:36.360822 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m13:19:36.363248 [info ] [Thread-1 (]: 6 of 11 START sql table model games.dim_release ................................ [RUN]
[0m13:19:36.366178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m13:19:36.368028 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m13:19:36.375085 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m13:19:36.375836 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 13:19:36.369331 => 13:19:36.375579
[0m13:19:36.376396 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m13:19:36.378962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:37.122038 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m13:19:37.122732 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m13:19:37.625628 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a0bc1283-0f3f-4c5e-b6a8-927090f45502&page=queryresults
[0m13:19:40.072675 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 13:19:36.376712 => 13:19:40.071790
[0m13:19:40.076019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb98eda-76dc-44f2-94b7-65a49c4f5db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53cc1bd30>]}
[0m13:19:40.078581 [info ] [Thread-1 (]: 6 of 11 OK created sql table model games.dim_release ........................... [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 3.71s]
[0m13:19:40.081375 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m13:19:40.083394 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m13:19:40.085802 [info ] [Thread-1 (]: 7 of 11 START sql table model games.dim_support_language ....................... [RUN]
[0m13:19:40.088934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m13:19:40.090793 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m13:19:40.100320 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m13:19:40.101808 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 13:19:40.092094 => 13:19:40.101328
[0m13:19:40.102744 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m13:19:40.114436 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:40.854462 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m13:19:40.855083 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m13:19:41.442793 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:36573004-7fce-4dc7-8cac-3af64b1a6e26&page=queryresults
[0m13:19:44.252097 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 13:19:40.103402 => 13:19:44.251235
[0m13:19:44.255156 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb98eda-76dc-44f2-94b7-65a49c4f5db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53cc83e20>]}
[0m13:19:44.257693 [info ] [Thread-1 (]: 7 of 11 OK created sql table model games.dim_support_language .................. [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.17s]
[0m13:19:44.260487 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m13:19:44.262516 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m13:19:44.264587 [info ] [Thread-1 (]: 8 of 11 START sql table model games.fct_game_pricing ........................... [RUN]
[0m13:19:44.267743 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m13:19:44.269589 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m13:19:44.277148 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m13:19:44.277827 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 13:19:44.270916 => 13:19:44.277609
[0m13:19:44.278194 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m13:19:44.280389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:45.006398 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m13:19:45.009284 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para el análisis de precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        formatted_initial_price,
        SUM(price_with_tax) AS total_sales,
        SUM(discount_amount) AS total_discounts,
        COUNT(*) AS num_sales,
        MAX(discount_pct) AS max_discount,
        MIN(initial_price) AS min_price,
        MAX(initial_price) AS max_price,
        SUM(price_with_tax) AS total_sales_with_tax,
        SUM(final_price) AS total_sales_with_tax_discounted
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id, formatted_initial_price
)

SELECT
    fct.app_id,
    fct.formatted_initial_price,
    fct.total_sales,
    fct.total_discounts,
    fct.num_sales,
    fct.max_discount,
    fct.min_price,
    fct.max_price,
    fct.total_sales_with_tax,
    fct.total_sales_with_tax_discounted,
    games.name AS game_name,
    games.description AS game_description,
    games.is_free AS game_is_free,
    games.fullgame_app_id,
    games.fullgame_name,
    games.type,
    games.genre_id,
    games.type_genre,
    dp.platform_id,
    dp.windows,
    dp.mac,
    dp.linux
FROM
    game_sales AS fct
INNER JOIN
    `pristine-flames-400818`.`games`.`dim_games` AS games
ON
    fct.app_id = games.app_id
LEFT JOIN
    `pristine-flames-400818`.`games`.`dim_platforms` AS dp
ON
    fct.platform_id = dp.platform_id
    );
  
[0m13:19:45.580618 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9b8a61c9-b732-4f2b-96b2-f4b3984a8a3d&page=queryresults
[0m13:19:46.072045 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name platform_id not found inside fct at [65:9]')
[0m13:19:47.339674 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:0663510d-804f-4a66-bab4-25f4dbcee0b4&page=queryresults
[0m13:19:47.853784 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:0663510d-804f-4a66-bab4-25f4dbcee0b4&page=queryresults
[0m13:19:47.856828 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 13:19:44.278447 => 13:19:47.855912
[0m13:19:47.860611 [debug] [Thread-1 (]: Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Name platform_id not found inside fct at [65:9]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m13:19:47.861050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb98eda-76dc-44f2-94b7-65a49c4f5db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53cc6b100>]}
[0m13:19:47.861599 [error] [Thread-1 (]: 8 of 11 ERROR creating sql table model games.fct_game_pricing .................. [[31mERROR[0m in 3.59s]
[0m13:19:47.862157 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m13:19:47.863055 [debug] [Thread-1 (]: Began running node model.games.top_10_discounted_games
[0m13:19:47.863462 [info ] [Thread-1 (]: 9 of 11 SKIP relation games.top_10_discounted_games ............................ [[33mSKIP[0m]
[0m13:19:47.863882 [debug] [Thread-1 (]: Finished running node model.games.top_10_discounted_games
[0m13:19:47.864275 [debug] [Thread-1 (]: Began running node model.games.top_10_high_tax_games
[0m13:19:47.864738 [info ] [Thread-1 (]: 10 of 11 SKIP relation games.top_10_high_tax_games ............................. [[33mSKIP[0m]
[0m13:19:47.865189 [debug] [Thread-1 (]: Finished running node model.games.top_10_high_tax_games
[0m13:19:47.865643 [debug] [Thread-1 (]: Began running node model.games.top_10_most_expensive_games
[0m13:19:47.866207 [info ] [Thread-1 (]: 11 of 11 SKIP relation games.top_10_most_expensive_games ....................... [[33mSKIP[0m]
[0m13:19:47.866721 [debug] [Thread-1 (]: Finished running node model.games.top_10_most_expensive_games
[0m13:19:47.868360 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:19:47.868748 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m13:19:47.869141 [info ] [MainThread]: 
[0m13:19:47.869482 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 32.78 seconds (32.78s).
[0m13:19:47.871229 [debug] [MainThread]: Command end result
[0m13:19:47.879929 [info ] [MainThread]: 
[0m13:19:47.880421 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:19:47.880773 [info ] [MainThread]: 
[0m13:19:47.881143 [error] [MainThread]:   Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Name platform_id not found inside fct at [65:9]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m13:19:47.881532 [info ] [MainThread]: 
[0m13:19:47.881958 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=3 TOTAL=11
[0m13:19:47.882629 [debug] [MainThread]: Command `dbt run` failed at 13:19:47.882502 after 33.23 seconds
[0m13:19:47.883081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc54151ead0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc540b6bdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53d634d00>]}
[0m13:19:47.883515 [debug] [MainThread]: Flushing usage events
[0m14:22:41.065926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa931132b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa92f294070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa92f2940d0>]}


============================== 14:22:41.068350 | 7d1de069-f3ef-47df-83b1-f79920d89797 ==============================
[0m14:22:41.068350 [info ] [MainThread]: Running with dbt=1.6.5
[0m14:22:41.068824 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:22:41.372772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d1de069-f3ef-47df-83b1-f79920d89797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa92d21ac50>]}
[0m14:22:41.388461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d1de069-f3ef-47df-83b1-f79920d89797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa92d234640>]}
[0m14:22:41.389099 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m14:22:41.402411 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m14:22:41.479400 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:22:41.479950 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m14:22:41.523356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d1de069-f3ef-47df-83b1-f79920d89797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa92d0e6020>]}
[0m14:22:41.532628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d1de069-f3ef-47df-83b1-f79920d89797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa92d067520>]}
[0m14:22:41.533081 [info ] [MainThread]: Found 11 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m14:22:41.533581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d1de069-f3ef-47df-83b1-f79920d89797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa92d0674c0>]}
[0m14:22:41.535061 [info ] [MainThread]: 
[0m14:22:41.535738 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:22:41.537021 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m14:22:41.537483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:42.375658 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m14:22:42.377723 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:22:43.075050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d1de069-f3ef-47df-83b1-f79920d89797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa92d066b30>]}
[0m14:22:43.075823 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:22:43.076201 [info ] [MainThread]: 
[0m14:22:43.078146 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m14:22:43.078688 [info ] [Thread-1 (]: 1 of 11 START sql table model games.dim_developers ............................. [RUN]
[0m14:22:43.079347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m14:22:43.079772 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m14:22:43.089402 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m14:22:43.090288 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 14:22:43.080063 => 14:22:43.089994
[0m14:22:43.090787 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m14:22:43.105954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:43.825831 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m14:22:43.826528 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS developer_id,
    developers_name
FROM
    developers_cte
    );
  
[0m14:22:44.493972 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:6a4d5734-153a-481c-8e37-6de9c3b434d7&page=queryresults
[0m14:22:45.196345 [info ] [MainThread]: [33mThe bigquery adapter does not support query cancellation. Some queries may still be running![0m
[0m14:22:46.938347 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 14:22:43.091214 => 14:22:46.938125
[0m14:22:46.939350 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d1de069-f3ef-47df-83b1-f79920d89797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa92c7b40d0>]}
[0m14:22:46.940147 [info ] [Thread-1 (]: 1 of 11 OK created sql table model games.dim_developers ........................ [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 3.86s]
[0m14:22:46.940860 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m14:22:46.941268 [info ] [MainThread]: 
[0m14:22:46.941649 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m14:22:46.942002 [info ] [MainThread]: 
[0m14:22:46.942384 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
[0m14:22:46.942764 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:22:46.943064 [debug] [MainThread]: Connection 'model.games.dim_developers' was properly closed.
[0m14:22:46.943376 [info ] [MainThread]: 
[0m14:22:46.943715 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 5.41 seconds (5.41s).
[0m14:22:46.944137 [error] [MainThread]: Encountered an error:

[0m14:22:46.949451 [error] [MainThread]: Traceback (most recent call last):
  File "/home/tomi/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 87, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/tomi/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 72, in wrapper
    return func(*args, **kwargs)
  File "/home/tomi/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 143, in wrapper
    return func(*args, **kwargs)
  File "/home/tomi/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 172, in wrapper
    return func(*args, **kwargs)
  File "/home/tomi/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 219, in wrapper
    return func(*args, **kwargs)
  File "/home/tomi/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 259, in wrapper
    return func(*args, **kwargs)
  File "/home/tomi/.local/lib/python3.10/site-packages/dbt/cli/main.py", line 580, in run
    results = task.run()
  File "/home/tomi/.local/lib/python3.10/site-packages/dbt/task/runnable.py", line 469, in run
    result = self.execute_with_hooks(selected_uids)
  File "/home/tomi/.local/lib/python3.10/site-packages/dbt/task/runnable.py", line 430, in execute_with_hooks
    res = self.execute_nodes()
  File "/home/tomi/.local/lib/python3.10/site-packages/dbt/task/runnable.py", line 356, in execute_nodes
    self.run_queue(pool)
  File "/home/tomi/.local/lib/python3.10/site-packages/dbt/task/runnable.py", line 269, in run_queue
    node = self.job_queue.get()
  File "/home/tomi/.local/lib/python3.10/site-packages/dbt/graph/queue.py", line 125, in get
    _, node_id = self.inner.get(block=block, timeout=timeout)
  File "/usr/lib/python3.10/queue.py", line 171, in get
    self.not_empty.wait()
  File "/usr/lib/python3.10/threading.py", line 320, in wait
    waiter.acquire()
KeyboardInterrupt

[0m14:22:46.950158 [debug] [MainThread]: Command `dbt run` failed at 14:22:46.950056 after 5.89 seconds
[0m14:22:46.950526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa931132b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa92c7b6530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa92c7b6560>]}
[0m14:22:46.950904 [debug] [MainThread]: Flushing usage events
[0m14:23:10.967020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bdd71ea70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bdb8b0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bdb8b00d0>]}


============================== 14:23:10.969086 | 823cbdcb-bb52-4ef3-935a-1ee762bcdb4a ==============================
[0m14:23:10.969086 [info ] [MainThread]: Running with dbt=1.6.5
[0m14:23:10.969579 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'send_anonymous_usage_stats': 'True'}
[0m14:23:11.245963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '823cbdcb-bb52-4ef3-935a-1ee762bcdb4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bdcd693f0>]}
[0m14:23:11.261682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '823cbdcb-bb52-4ef3-935a-1ee762bcdb4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bd98509d0>]}
[0m14:23:11.262241 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m14:23:11.275851 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m14:23:11.340418 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:23:11.340987 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m14:23:11.385202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '823cbdcb-bb52-4ef3-935a-1ee762bcdb4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bd8f3df90>]}
[0m14:23:11.394555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '823cbdcb-bb52-4ef3-935a-1ee762bcdb4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bd9687610>]}
[0m14:23:11.395015 [info ] [MainThread]: Found 11 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m14:23:11.395361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '823cbdcb-bb52-4ef3-935a-1ee762bcdb4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bd96875b0>]}
[0m14:23:11.396714 [info ] [MainThread]: 
[0m14:23:11.397364 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:23:11.398663 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m14:23:11.399201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:12.167122 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m14:23:12.169121 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:23:12.906563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '823cbdcb-bb52-4ef3-935a-1ee762bcdb4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bd9686c20>]}
[0m14:23:12.907706 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:23:12.908294 [info ] [MainThread]: 
[0m14:23:12.911023 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m14:23:12.911688 [info ] [Thread-1 (]: 1 of 11 START sql table model games.dim_developers ............................. [RUN]
[0m14:23:12.912544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m14:23:12.913062 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m14:23:12.921826 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m14:23:12.922578 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 14:23:12.913429 => 14:23:12.922341
[0m14:23:12.922995 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m14:23:12.936084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:23:13.738283 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m14:23:13.739430 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS developer_id,
    developers_name
FROM
    developers_cte
    );
  
[0m14:23:14.330742 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:3ac005e3-8390-44cb-8431-d4c47bdb3f09&page=queryresults
[0m14:23:16.811972 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 14:23:12.923282 => 14:23:16.811662
[0m14:23:16.813122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '823cbdcb-bb52-4ef3-935a-1ee762bcdb4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bd965c610>]}
[0m14:23:16.814030 [info ] [Thread-1 (]: 1 of 11 OK created sql table model games.dim_developers ........................ [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 3.90s]
[0m14:23:16.814968 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m14:23:16.815573 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m14:23:16.816300 [info ] [Thread-1 (]: 2 of 11 START sql table model games.dim_games .................................. [RUN]
[0m14:23:16.817171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m14:23:16.817709 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m14:23:16.827833 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m14:23:16.828582 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 14:23:16.818088 => 14:23:16.828361
[0m14:23:16.828994 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m14:23:16.831558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:23:17.527338 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m14:23:17.530051 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m14:23:18.136889 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:338c59bd-99fb-48a2-8beb-9f8ee112919a&page=queryresults
[0m14:23:20.303943 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 14:23:16.829281 => 14:23:20.303734
[0m14:23:20.304812 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '823cbdcb-bb52-4ef3-935a-1ee762bcdb4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bd965f040>]}
[0m14:23:20.305498 [info ] [Thread-1 (]: 2 of 11 OK created sql table model games.dim_games ............................. [[32mCREATE TABLE (2.7k rows, 753.9 KiB processed)[0m in 3.49s]
[0m14:23:20.306156 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m14:23:20.306697 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m14:23:20.307238 [info ] [Thread-1 (]: 3 of 11 START sql table model games.dim_platforms .............................. [RUN]
[0m14:23:20.307964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m14:23:20.308538 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m14:23:20.312051 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m14:23:20.313220 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 14:23:20.308822 => 14:23:20.312895
[0m14:23:20.313860 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m14:23:20.316341 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:23:20.612631 [info ] [MainThread]: [33mThe bigquery adapter does not support query cancellation. Some queries may still be running![0m
[0m14:23:21.005529 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m14:23:21.006209 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m14:23:21.519336 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f421a735-7e79-4b4f-9cbc-4572d9fcb15c&page=queryresults
[0m14:23:23.946012 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 14:23:20.314245 => 14:23:23.945782
[0m14:23:23.946880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '823cbdcb-bb52-4ef3-935a-1ee762bcdb4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bd965efe0>]}
[0m14:23:23.947567 [info ] [Thread-1 (]: 3 of 11 OK created sql table model games.dim_platforms ......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 3.64s]
[0m14:23:23.948285 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m14:23:23.948784 [info ] [MainThread]: 
[0m14:23:23.949201 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m14:23:23.949569 [info ] [MainThread]: 
[0m14:23:23.949967 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:23:23.950342 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:23:23.950683 [debug] [MainThread]: Connection 'model.games.dim_platforms' was properly closed.
[0m14:23:23.951053 [info ] [MainThread]: 
[0m14:23:23.951435 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 12.55 seconds (12.55s).
[0m14:23:23.951918 [error] [MainThread]: Encountered an error:

[0m14:23:23.953197 [error] [MainThread]: Traceback (most recent call last):
  File "/home/tomi/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 87, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/tomi/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 72, in wrapper
    return func(*args, **kwargs)
  File "/home/tomi/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 143, in wrapper
    return func(*args, **kwargs)
  File "/home/tomi/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 172, in wrapper
    return func(*args, **kwargs)
  File "/home/tomi/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 219, in wrapper
    return func(*args, **kwargs)
  File "/home/tomi/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 259, in wrapper
    return func(*args, **kwargs)
  File "/home/tomi/.local/lib/python3.10/site-packages/dbt/cli/main.py", line 580, in run
    results = task.run()
  File "/home/tomi/.local/lib/python3.10/site-packages/dbt/task/runnable.py", line 469, in run
    result = self.execute_with_hooks(selected_uids)
  File "/home/tomi/.local/lib/python3.10/site-packages/dbt/task/runnable.py", line 430, in execute_with_hooks
    res = self.execute_nodes()
  File "/home/tomi/.local/lib/python3.10/site-packages/dbt/task/runnable.py", line 356, in execute_nodes
    self.run_queue(pool)
  File "/home/tomi/.local/lib/python3.10/site-packages/dbt/task/runnable.py", line 269, in run_queue
    node = self.job_queue.get()
  File "/home/tomi/.local/lib/python3.10/site-packages/dbt/graph/queue.py", line 125, in get
    _, node_id = self.inner.get(block=block, timeout=timeout)
  File "/usr/lib/python3.10/queue.py", line 171, in get
    self.not_empty.wait()
  File "/usr/lib/python3.10/threading.py", line 320, in wait
    waiter.acquire()
KeyboardInterrupt

[0m14:23:23.953956 [debug] [MainThread]: Command `dbt run` failed at 14:23:23.953851 after 12.99 seconds
[0m14:23:23.954330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bdd71ea70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bd8ff8550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bd8ffb760>]}
[0m14:23:23.954732 [debug] [MainThread]: Flushing usage events
[0m14:23:34.232776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73cff0d180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ce164070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ce1640d0>]}


============================== 14:23:34.235096 | b916b788-b758-4fb8-9141-0ce9347214a5 ==============================
[0m14:23:34.235096 [info ] [MainThread]: Running with dbt=1.6.5
[0m14:23:34.235699 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '../dbt/', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:23:34.516199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b916b788-b758-4fb8-9141-0ce9347214a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73cf42dcf0>]}
[0m14:23:34.533401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b916b788-b758-4fb8-9141-0ce9347214a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73cbf049d0>]}
[0m14:23:34.534047 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m14:23:34.547767 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m14:23:34.614606 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:23:34.615224 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m14:23:34.663451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b916b788-b758-4fb8-9141-0ce9347214a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73cbde1ff0>]}
[0m14:23:34.673414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b916b788-b758-4fb8-9141-0ce9347214a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73cbd37640>]}
[0m14:23:34.673990 [info ] [MainThread]: Found 11 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m14:23:34.674483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b916b788-b758-4fb8-9141-0ce9347214a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73cbd37670>]}
[0m14:23:34.676076 [info ] [MainThread]: 
[0m14:23:34.676834 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:23:34.678247 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m14:23:34.678901 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:35.435996 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m14:23:35.436488 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:23:36.090572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b916b788-b758-4fb8-9141-0ce9347214a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73cbd36ce0>]}
[0m14:23:36.092323 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:23:36.093243 [info ] [MainThread]: 
[0m14:23:36.097694 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m14:23:36.098929 [info ] [Thread-1 (]: 1 of 11 START sql table model games.dim_developers ............................. [RUN]
[0m14:23:36.100579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m14:23:36.101612 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m14:23:36.118883 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m14:23:36.119978 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 14:23:36.102302 => 14:23:36.119646
[0m14:23:36.120640 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m14:23:36.138125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:23:36.849671 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m14:23:36.850362 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS developer_id,
    developers_name
FROM
    developers_cte
    );
  
[0m14:23:37.442788 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:aeff64c3-3c6a-48ae-bafd-7d8f979a836c&page=queryresults
[0m14:23:40.212312 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 14:23:36.121090 => 14:23:40.212000
[0m14:23:40.213446 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b916b788-b758-4fb8-9141-0ce9347214a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73cbd14760>]}
[0m14:23:40.214348 [info ] [Thread-1 (]: 1 of 11 OK created sql table model games.dim_developers ........................ [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.11s]
[0m14:23:40.215259 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m14:23:40.215850 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m14:23:40.216563 [info ] [Thread-1 (]: 2 of 11 START sql table model games.dim_games .................................. [RUN]
[0m14:23:40.217419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m14:23:40.217963 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m14:23:40.227211 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m14:23:40.227963 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 14:23:40.218341 => 14:23:40.227735
[0m14:23:40.228372 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m14:23:40.230719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:23:41.064241 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m14:23:41.064967 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m14:23:41.519252 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f30fa518-e2d8-4167-a9c6-96114797040e&page=queryresults
[0m14:23:43.689030 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 14:23:40.228659 => 14:23:43.688819
[0m14:23:43.689829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b916b788-b758-4fb8-9141-0ce9347214a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73cbd14af0>]}
[0m14:23:43.690514 [info ] [Thread-1 (]: 2 of 11 OK created sql table model games.dim_games ............................. [[32mCREATE TABLE (2.7k rows, 753.9 KiB processed)[0m in 3.47s]
[0m14:23:43.691235 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m14:23:43.691756 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m14:23:43.692372 [info ] [Thread-1 (]: 3 of 11 START sql table model games.dim_platforms .............................. [RUN]
[0m14:23:43.693086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m14:23:43.693470 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m14:23:43.696203 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m14:23:43.696818 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 14:23:43.693732 => 14:23:43.696621
[0m14:23:43.697200 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m14:23:43.699342 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:23:44.361040 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m14:23:44.363751 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m14:23:44.836156 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c8d4ecaa-ff30-4270-b57b-aa9b042c1cb7&page=queryresults
[0m14:23:47.187516 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 14:23:43.697476 => 14:23:47.186661
[0m14:23:47.190632 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b916b788-b758-4fb8-9141-0ce9347214a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73cbd170a0>]}
[0m14:23:47.193182 [info ] [Thread-1 (]: 3 of 11 OK created sql table model games.dim_platforms ......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 3.50s]
[0m14:23:47.195973 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m14:23:47.197969 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m14:23:47.200379 [info ] [Thread-1 (]: 4 of 11 START sql table model games.dim_price_overview ......................... [RUN]
[0m14:23:47.203320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m14:23:47.205142 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m14:23:47.215412 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m14:23:47.216874 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 14:23:47.206423 => 14:23:47.216376
[0m14:23:47.217789 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m14:23:47.222355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:23:47.955113 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m14:23:47.955811 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m14:23:48.547050 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:df97e1e8-431b-4c44-85fa-20a11e159303&page=queryresults
[0m14:23:51.236731 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 14:23:47.218443 => 14:23:51.235857
[0m14:23:51.240200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b916b788-b758-4fb8-9141-0ce9347214a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73cb4f9f00>]}
[0m14:23:51.242125 [info ] [Thread-1 (]: 4 of 11 OK created sql table model games.dim_price_overview .................... [[32mCREATE TABLE (1.1k rows, 114.2 KiB processed)[0m in 4.04s]
[0m14:23:51.244452 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m14:23:51.245794 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m14:23:51.247110 [info ] [Thread-1 (]: 5 of 11 START sql table model games.dim_publishers ............................. [RUN]
[0m14:23:51.248698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m14:23:51.249663 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m14:23:51.255007 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m14:23:51.256283 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 14:23:51.250238 => 14:23:51.255886
[0m14:23:51.256977 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m14:23:51.260612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:23:51.960985 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m14:23:51.962527 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m14:23:52.510618 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:593f5d0f-9336-4325-ab55-83274ce6385f&page=queryresults
[0m14:23:54.942841 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 14:23:51.257462 => 14:23:54.941947
[0m14:23:54.945938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b916b788-b758-4fb8-9141-0ce9347214a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73cb4e8e80>]}
[0m14:23:54.948499 [info ] [Thread-1 (]: 5 of 11 OK created sql table model games.dim_publishers ........................ [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 3.70s]
[0m14:23:54.951313 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m14:23:54.953336 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m14:23:54.955747 [info ] [Thread-1 (]: 6 of 11 START sql table model games.dim_release ................................ [RUN]
[0m14:23:54.958693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m14:23:54.960520 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m14:23:54.969810 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m14:23:54.971284 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 14:23:54.961801 => 14:23:54.970787
[0m14:23:54.972196 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m14:23:54.976596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:23:55.719666 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m14:23:55.722299 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m14:23:56.340925 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ad9e234c-7f67-4127-aa2e-5bcfa6891325&page=queryresults
[0m14:23:58.751398 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 14:23:54.972843 => 14:23:58.750540
[0m14:23:58.754699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b916b788-b758-4fb8-9141-0ce9347214a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73cb4e9150>]}
[0m14:23:58.757242 [info ] [Thread-1 (]: 6 of 11 OK created sql table model games.dim_release ........................... [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 3.80s]
[0m14:23:58.760047 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m14:23:58.762057 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m14:23:58.764482 [info ] [Thread-1 (]: 7 of 11 START sql table model games.dim_support_language ....................... [RUN]
[0m14:23:58.767588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m14:23:58.769433 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m14:23:58.780009 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m14:23:58.781535 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 14:23:58.770762 => 14:23:58.781033
[0m14:23:58.782455 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m14:23:58.794614 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:23:59.530201 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m14:23:59.532899 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m14:24:00.132873 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5450990f-aecd-4809-a9b1-613355df2ee9&page=queryresults
[0m14:24:02.566108 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 14:23:58.783131 => 14:24:02.565245
[0m14:24:02.569230 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b916b788-b758-4fb8-9141-0ce9347214a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73cb320040>]}
[0m14:24:02.571792 [info ] [Thread-1 (]: 7 of 11 OK created sql table model games.dim_support_language .................. [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 3.80s]
[0m14:24:02.574612 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m14:24:02.577414 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m14:24:02.579865 [info ] [Thread-1 (]: 8 of 11 START sql table model games.fct_game_pricing ........................... [RUN]
[0m14:24:02.583188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m14:24:02.585057 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m14:24:02.597581 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m14:24:02.599135 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 14:24:02.586349 => 14:24:02.598657
[0m14:24:02.600034 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m14:24:02.604518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:03.302055 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m14:24:03.304858 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      WITH combined_data AS (
    SELECT
        dd.developer_id,
        dp.publisher_id,
        dr.release_id,
        dpl.platform_id,
        dsl.support_language_id,
        dg.app_id,
        dpo.purchase_id
    FROM
        `pristine-flames-400818`.`games`.`dim_developers` AS dd
    CROSS JOIN
        `pristine-flames-400818`.`games`.`dim_publishers` AS dp
    CROSS JOIN
        `pristine-flames-400818`.`games`.`dim_release` AS dr
    CROSS JOIN
        `pristine-flames-400818`.`games`.`dim_platforms` AS dpl
    CROSS JOIN
        `pristine-flames-400818`.`games`.`dim_support_language` AS dsl
    CROSS JOIN
        `pristine-flames-400818`.`games`.`dim_games` AS dg
    CROSS JOIN
        `pristine-flames-400818`.`games`.`dim_price_overview` AS dpo
)

-- Selecciona los datos combinados
SELECT *
FROM combined_data
    );
  
[0m14:24:03.926575 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:50040ad9-a107-4f69-92ee-8c199c5e4cfa&page=queryresults
[0m14:24:04.417054 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name support_language_id not found inside dsl at [19:13]')
[0m14:24:05.932032 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:6ef3975a-23c4-41cf-9679-ce5620731912&page=queryresults
[0m14:24:06.422403 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:6ef3975a-23c4-41cf-9679-ce5620731912&page=queryresults
[0m14:24:06.425416 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 14:24:02.600562 => 14:24:06.424508
[0m14:24:06.438547 [debug] [Thread-1 (]: Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Name support_language_id not found inside dsl at [19:13]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m14:24:06.440650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b916b788-b758-4fb8-9141-0ce9347214a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73cb311d80>]}
[0m14:24:06.443257 [error] [Thread-1 (]: 8 of 11 ERROR creating sql table model games.fct_game_pricing .................. [[31mERROR[0m in 3.86s]
[0m14:24:06.446013 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m14:24:06.449522 [debug] [Thread-1 (]: Began running node model.games.top_10_discounted_games
[0m14:24:06.451532 [info ] [Thread-1 (]: 9 of 11 SKIP relation games.top_10_discounted_games ............................ [[33mSKIP[0m]
[0m14:24:06.453620 [debug] [Thread-1 (]: Finished running node model.games.top_10_discounted_games
[0m14:24:06.455544 [debug] [Thread-1 (]: Began running node model.games.top_10_high_tax_games
[0m14:24:06.457273 [info ] [Thread-1 (]: 10 of 11 SKIP relation games.top_10_high_tax_games ............................. [[33mSKIP[0m]
[0m14:24:06.458873 [debug] [Thread-1 (]: Finished running node model.games.top_10_high_tax_games
[0m14:24:06.460212 [debug] [Thread-1 (]: Began running node model.games.top_10_most_expensive_games
[0m14:24:06.461404 [info ] [Thread-1 (]: 11 of 11 SKIP relation games.top_10_most_expensive_games ....................... [[33mSKIP[0m]
[0m14:24:06.462563 [debug] [Thread-1 (]: Finished running node model.games.top_10_most_expensive_games
[0m14:24:06.465461 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:24:06.466135 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m14:24:06.466875 [info ] [MainThread]: 
[0m14:24:06.467567 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 31.79 seconds (31.79s).
[0m14:24:06.470744 [debug] [MainThread]: Command end result
[0m14:24:06.483666 [info ] [MainThread]: 
[0m14:24:06.484241 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:24:06.484697 [info ] [MainThread]: 
[0m14:24:06.485147 [error] [MainThread]:   Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Name support_language_id not found inside dsl at [19:13]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m14:24:06.485620 [info ] [MainThread]: 
[0m14:24:06.486095 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=3 TOTAL=11
[0m14:24:06.487102 [debug] [MainThread]: Command `dbt run` failed at 14:24:06.486819 after 32.26 seconds
[0m14:24:06.487764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73cff0d180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73cb320040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73cb4fa380>]}
[0m14:24:06.488255 [debug] [MainThread]: Flushing usage events
[0m14:24:21.434229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a522ab30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a33c0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a33c00d0>]}


============================== 14:24:21.436392 | b0ccb528-1c2b-43ca-9fca-251c5d93dd58 ==============================
[0m14:24:21.436392 [info ] [MainThread]: Running with dbt=1.6.5
[0m14:24:21.436865 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '../dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:24:21.722257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0ccb528-1c2b-43ca-9fca-251c5d93dd58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a1342c50>]}
[0m14:24:21.739230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0ccb528-1c2b-43ca-9fca-251c5d93dd58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a135c640>]}
[0m14:24:21.739884 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m14:24:21.754108 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m14:24:21.820142 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:24:21.820734 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m14:24:21.866635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0ccb528-1c2b-43ca-9fca-251c5d93dd58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a084a020>]}
[0m14:24:21.876161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0ccb528-1c2b-43ca-9fca-251c5d93dd58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a118f670>]}
[0m14:24:21.876646 [info ] [MainThread]: Found 11 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m14:24:21.877005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0ccb528-1c2b-43ca-9fca-251c5d93dd58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a118f6a0>]}
[0m14:24:21.878400 [info ] [MainThread]: 
[0m14:24:21.879084 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:24:21.880421 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m14:24:21.881034 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:24:22.773532 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m14:24:22.775795 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:24:23.440425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0ccb528-1c2b-43ca-9fca-251c5d93dd58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a118ed10>]}
[0m14:24:23.441284 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:24:23.441701 [info ] [MainThread]: 
[0m14:24:23.443917 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m14:24:23.444512 [info ] [Thread-1 (]: 1 of 11 START sql table model games.dim_developers ............................. [RUN]
[0m14:24:23.445238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m14:24:23.445671 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m14:24:23.454039 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m14:24:23.454832 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 14:24:23.445974 => 14:24:23.454590
[0m14:24:23.455272 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m14:24:23.470561 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:24.228916 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m14:24:24.229655 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS developer_id,
    developers_name
FROM
    developers_cte
    );
  
[0m14:24:24.772290 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d699c89b-7fac-48be-a9e4-8867638e2e8a&page=queryresults
[0m14:24:26.967451 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 14:24:23.455575 => 14:24:26.967133
[0m14:24:26.968520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0ccb528-1c2b-43ca-9fca-251c5d93dd58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a116aad0>]}
[0m14:24:26.969305 [info ] [Thread-1 (]: 1 of 11 OK created sql table model games.dim_developers ........................ [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 3.52s]
[0m14:24:26.970148 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m14:24:26.970757 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m14:24:26.971473 [info ] [Thread-1 (]: 2 of 11 START sql table model games.dim_games .................................. [RUN]
[0m14:24:26.972329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m14:24:26.972861 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m14:24:26.981879 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m14:24:26.982651 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 14:24:26.973220 => 14:24:26.982409
[0m14:24:26.983068 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m14:24:26.985259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:27.654635 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m14:24:27.657384 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m14:24:28.329125 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:bf00bf30-af64-482b-98fb-10f62e92cbb7&page=queryresults
[0m14:24:31.335741 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 14:24:26.983325 => 14:24:31.334856
[0m14:24:31.338930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0ccb528-1c2b-43ca-9fca-251c5d93dd58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a116b0a0>]}
[0m14:24:31.341493 [info ] [Thread-1 (]: 2 of 11 OK created sql table model games.dim_games ............................. [[32mCREATE TABLE (2.7k rows, 753.9 KiB processed)[0m in 4.37s]
[0m14:24:31.344351 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m14:24:31.346381 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m14:24:31.348800 [info ] [Thread-1 (]: 3 of 11 START sql table model games.dim_platforms .............................. [RUN]
[0m14:24:31.351784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m14:24:31.353623 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m14:24:31.363579 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m14:24:31.365083 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 14:24:31.354948 => 14:24:31.364572
[0m14:24:31.365996 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m14:24:31.370442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:32.120649 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m14:24:32.123343 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m14:24:32.698700 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7835afbc-e5a4-4bd9-9631-08f1739fee6c&page=queryresults
[0m14:24:35.104129 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 14:24:31.366665 => 14:24:35.103225
[0m14:24:35.107416 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0ccb528-1c2b-43ca-9fca-251c5d93dd58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a1168b50>]}
[0m14:24:35.110075 [info ] [Thread-1 (]: 3 of 11 OK created sql table model games.dim_platforms ......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 3.76s]
[0m14:24:35.113213 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m14:24:35.115355 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m14:24:35.117807 [info ] [Thread-1 (]: 4 of 11 START sql table model games.dim_price_overview ......................... [RUN]
[0m14:24:35.120820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m14:24:35.122680 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m14:24:35.131055 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m14:24:35.132551 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 14:24:35.123715 => 14:24:35.132063
[0m14:24:35.133408 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m14:24:35.137571 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:35.845763 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m14:24:35.848644 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m14:24:36.324513 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5d78f696-52e8-4ca6-8385-e4ae41962d92&page=queryresults
[0m14:24:39.382675 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 14:24:35.133930 => 14:24:39.381762
[0m14:24:39.385967 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0ccb528-1c2b-43ca-9fca-251c5d93dd58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a0751f30>]}
[0m14:24:39.388566 [info ] [Thread-1 (]: 4 of 11 OK created sql table model games.dim_price_overview .................... [[32mCREATE TABLE (1.1k rows, 114.2 KiB processed)[0m in 4.27s]
[0m14:24:39.391623 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m14:24:39.393822 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m14:24:39.396387 [info ] [Thread-1 (]: 5 of 11 START sql table model games.dim_publishers ............................. [RUN]
[0m14:24:39.399696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m14:24:39.401646 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m14:24:39.410387 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m14:24:39.412080 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 14:24:39.403036 => 14:24:39.411540
[0m14:24:39.413106 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m14:24:39.417936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:40.176427 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m14:24:40.177044 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m14:24:40.763178 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:60bd6b37-ad27-499d-b648-00e7c8b20392&page=queryresults
[0m14:24:43.205504 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 14:24:39.413657 => 14:24:43.204612
[0m14:24:43.208658 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0ccb528-1c2b-43ca-9fca-251c5d93dd58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a0740d00>]}
[0m14:24:43.211262 [info ] [Thread-1 (]: 5 of 11 OK created sql table model games.dim_publishers ........................ [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 3.81s]
[0m14:24:43.214093 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m14:24:43.216143 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m14:24:43.218574 [info ] [Thread-1 (]: 6 of 11 START sql table model games.dim_release ................................ [RUN]
[0m14:24:43.221520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m14:24:43.223300 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m14:24:43.231036 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m14:24:43.232532 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 14:24:43.224199 => 14:24:43.232021
[0m14:24:43.233402 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m14:24:43.237484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:43.905920 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m14:24:43.908621 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m14:24:44.482815 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a761568b-568a-449a-aedc-a9942ce4b2e2&page=queryresults
[0m14:24:46.728671 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 14:24:43.233922 => 14:24:46.727749
[0m14:24:46.732118 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0ccb528-1c2b-43ca-9fca-251c5d93dd58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a0741120>]}
[0m14:24:46.734833 [info ] [Thread-1 (]: 6 of 11 OK created sql table model games.dim_release ........................... [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 3.51s]
[0m14:24:46.737819 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m14:24:46.740036 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m14:24:46.742732 [info ] [Thread-1 (]: 7 of 11 START sql table model games.dim_support_language ....................... [RUN]
[0m14:24:46.745945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m14:24:46.747644 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m14:24:46.755509 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m14:24:46.757032 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 14:24:46.748561 => 14:24:46.756539
[0m14:24:46.757799 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m14:24:46.768674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:47.479854 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m14:24:47.482680 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m14:24:47.928947 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:4cd30a13-df4b-4fb9-afbd-855888cf6fe9&page=queryresults
[0m14:24:50.311026 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 14:24:46.758332 => 14:24:50.310823
[0m14:24:50.311878 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0ccb528-1c2b-43ca-9fca-251c5d93dd58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a0778040>]}
[0m14:24:50.312460 [info ] [Thread-1 (]: 7 of 11 OK created sql table model games.dim_support_language .................. [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 3.57s]
[0m14:24:50.313096 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m14:24:50.314028 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m14:24:50.314522 [info ] [Thread-1 (]: 8 of 11 START sql table model games.fct_game_pricing ........................... [RUN]
[0m14:24:50.315190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m14:24:50.315590 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m14:24:50.319394 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m14:24:50.320124 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 14:24:50.315850 => 14:24:50.319895
[0m14:24:50.320523 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m14:24:50.323023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:51.029399 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m14:24:51.030089 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      WITH combined_data AS (
    SELECT
        dd.developer_id,
        dp.publisher_id,
        dr.release_id,
        dpl.platform_id,
        dsl.language_id,
        dg.app_id,
        dpo.purchase_id
    FROM
        `pristine-flames-400818`.`games`.`dim_developers` AS dd
    CROSS JOIN
        `pristine-flames-400818`.`games`.`dim_publishers` AS dp
    CROSS JOIN
        `pristine-flames-400818`.`games`.`dim_release` AS dr
    CROSS JOIN
        `pristine-flames-400818`.`games`.`dim_platforms` AS dpl
    CROSS JOIN
        `pristine-flames-400818`.`games`.`dim_support_language` AS dsl
    CROSS JOIN
        `pristine-flames-400818`.`games`.`dim_games` AS dg
    CROSS JOIN
        `pristine-flames-400818`.`games`.`dim_price_overview` AS dpo
)

-- Selecciona los datos combinados
SELECT *
FROM combined_data
    );
  
[0m14:24:51.614309 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7633bfbc-f287-4baa-b403-816e578d5b3d&page=queryresults
[0m14:29:51.968316 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      WITH combined_data AS (
    SELECT
        dd.developer_id,
        dp.publisher_id,
        dr.release_id,
        dpl.platform_id,
        dsl.language_id,
        dg.app_id,
        dpo.purchase_id
    FROM
        `pristine-flames-400818`.`games`.`dim_developers` AS dd
    CROSS JOIN
        `pristine-flames-400818`.`games`.`dim_publishers` AS dp
    CROSS JOIN
        `pristine-flames-400818`.`games`.`dim_release` AS dr
    CROSS JOIN
        `pristine-flames-400818`.`games`.`dim_platforms` AS dpl
    CROSS JOIN
        `pristine-flames-400818`.`games`.`dim_support_language` AS dsl
    CROSS JOIN
        `pristine-flames-400818`.`games`.`dim_games` AS dg
    CROSS JOIN
        `pristine-flames-400818`.`games`.`dim_price_overview` AS dpo
)

-- Selecciona los datos combinados
SELECT *
FROM combined_data
    );
  
[0m14:29:51.970599 [debug] [Thread-1 (]: BigQuery adapter: Runtime Error
  Query exceeded configured timeout of 300s
[0m14:29:51.972895 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 14:24:50.320783 => 14:29:51.972004
[0m14:29:51.983688 [debug] [Thread-1 (]: Runtime Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Query exceeded configured timeout of 300s
[0m14:29:51.985695 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0ccb528-1c2b-43ca-9fca-251c5d93dd58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a0768af0>]}
[0m14:29:51.988363 [error] [Thread-1 (]: 8 of 11 ERROR creating sql table model games.fct_game_pricing .................. [[31mERROR[0m in 301.67s]
[0m14:29:51.990859 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m14:29:51.993638 [debug] [Thread-1 (]: Began running node model.games.top_10_discounted_games
[0m14:29:51.995547 [info ] [Thread-1 (]: 9 of 11 SKIP relation games.top_10_discounted_games ............................ [[33mSKIP[0m]
[0m14:29:51.996674 [debug] [Thread-1 (]: Finished running node model.games.top_10_discounted_games
[0m14:29:51.997697 [debug] [Thread-1 (]: Began running node model.games.top_10_high_tax_games
[0m14:29:51.998824 [info ] [Thread-1 (]: 10 of 11 SKIP relation games.top_10_high_tax_games ............................. [[33mSKIP[0m]
[0m14:29:51.999899 [debug] [Thread-1 (]: Finished running node model.games.top_10_high_tax_games
[0m14:29:52.000923 [debug] [Thread-1 (]: Began running node model.games.top_10_most_expensive_games
[0m14:29:52.002047 [info ] [Thread-1 (]: 11 of 11 SKIP relation games.top_10_most_expensive_games ....................... [[33mSKIP[0m]
[0m14:29:52.003192 [debug] [Thread-1 (]: Finished running node model.games.top_10_most_expensive_games
[0m14:29:52.006504 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:29:52.007376 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m14:29:52.008266 [info ] [MainThread]: 
[0m14:29:52.009139 [info ] [MainThread]: Finished running 11 table models in 0 hours 5 minutes and 30.13 seconds (330.13s).
[0m14:29:52.012693 [debug] [MainThread]: Command end result
[0m14:29:52.029322 [info ] [MainThread]: 
[0m14:29:52.030110 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:29:52.030665 [info ] [MainThread]: 
[0m14:29:52.031198 [error] [MainThread]:   Runtime Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Query exceeded configured timeout of 300s
[0m14:29:52.031750 [info ] [MainThread]: 
[0m14:29:52.032317 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=3 TOTAL=11
[0m14:29:52.033194 [debug] [MainThread]: Command `dbt run` failed at 14:29:52.033036 after 330.61 seconds
[0m14:29:52.033796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a522ab30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a118cf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a118f7c0>]}
[0m14:29:52.034414 [debug] [MainThread]: Flushing usage events
[0m15:00:22.407286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f384810d180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3846364070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38463640d0>]}


============================== 15:00:22.409620 | f03221fb-9847-4c89-b201-ff9c77dca8da ==============================
[0m15:00:22.409620 [info ] [MainThread]: Running with dbt=1.6.5
[0m15:00:22.410165 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'version_check': 'True', 'profiles_dir': '../dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'send_anonymous_usage_stats': 'True'}
[0m15:00:22.718270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f03221fb-9847-4c89-b201-ff9c77dca8da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38442eac50>]}
[0m15:00:22.735671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f03221fb-9847-4c89-b201-ff9c77dca8da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3844104640>]}
[0m15:00:22.736406 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m15:00:22.752312 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m15:00:22.826183 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:00:22.826954 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m15:00:22.881287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f03221fb-9847-4c89-b201-ff9c77dca8da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3843fedea0>]}
[0m15:00:22.897140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f03221fb-9847-4c89-b201-ff9c77dca8da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3843f37670>]}
[0m15:00:22.897767 [info ] [MainThread]: Found 11 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m15:00:22.898144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f03221fb-9847-4c89-b201-ff9c77dca8da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3843f376a0>]}
[0m15:00:22.900008 [info ] [MainThread]: 
[0m15:00:22.900758 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:00:22.902250 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m15:00:22.903379 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:23.744285 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m15:00:23.744773 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:00:24.392331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f03221fb-9847-4c89-b201-ff9c77dca8da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3843f36440>]}
[0m15:00:24.393165 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:00:24.393546 [info ] [MainThread]: 
[0m15:00:24.395596 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m15:00:24.396108 [info ] [Thread-1 (]: 1 of 11 START sql table model games.dim_developers ............................. [RUN]
[0m15:00:24.396735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m15:00:24.397101 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m15:00:24.404357 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m15:00:24.440775 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 15:00:24.397359 => 15:00:24.440443
[0m15:00:24.441294 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m15:00:24.454976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:25.170438 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m15:00:25.185639 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS developer_id,
    developers_name
FROM
    developers_cte
    );
  
[0m15:00:25.833923 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e32cce7e-7ad4-473a-9db7-de493aaabc58&page=queryresults
[0m15:00:28.314014 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 15:00:24.441582 => 15:00:28.313805
[0m15:00:28.314812 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f03221fb-9847-4c89-b201-ff9c77dca8da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3843f12a40>]}
[0m15:00:28.315446 [info ] [Thread-1 (]: 1 of 11 OK created sql table model games.dim_developers ........................ [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 3.92s]
[0m15:00:28.316105 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m15:00:28.316564 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m15:00:28.317512 [info ] [Thread-1 (]: 2 of 11 START sql table model games.dim_games .................................. [RUN]
[0m15:00:28.318146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m15:00:28.318529 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m15:00:28.327366 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m15:00:28.329209 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 15:00:28.318793 => 15:00:28.328864
[0m15:00:28.329686 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m15:00:28.332085 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:29.030962 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m15:00:29.032983 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m15:00:29.668061 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:1f043865-1350-469d-b9df-7e15267145f3&page=queryresults
[0m15:00:32.111484 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 15:00:28.329967 => 15:00:32.111279
[0m15:00:32.112232 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f03221fb-9847-4c89-b201-ff9c77dca8da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3843f13010>]}
[0m15:00:32.112804 [info ] [Thread-1 (]: 2 of 11 OK created sql table model games.dim_games ............................. [[32mCREATE TABLE (2.7k rows, 753.9 KiB processed)[0m in 3.79s]
[0m15:00:32.113406 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m15:00:32.113842 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m15:00:32.115011 [info ] [Thread-1 (]: 3 of 11 START sql table model games.dim_platforms .............................. [RUN]
[0m15:00:32.115903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m15:00:32.116343 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m15:00:32.119182 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m15:00:32.232929 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 15:00:32.116623 => 15:00:32.232583
[0m15:00:32.233393 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m15:00:32.236107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:32.928660 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m15:00:32.983339 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m15:00:33.574013 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:11d30f6e-e8dd-479f-8c69-c970e3d7e17d&page=queryresults
[0m15:00:36.306718 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 15:00:32.233676 => 15:00:36.306519
[0m15:00:36.307497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f03221fb-9847-4c89-b201-ff9c77dca8da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3843f13040>]}
[0m15:00:36.308153 [info ] [Thread-1 (]: 3 of 11 OK created sql table model games.dim_platforms ......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.19s]
[0m15:00:36.308883 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m15:00:36.309379 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m15:00:36.309897 [info ] [Thread-1 (]: 4 of 11 START sql table model games.dim_price_overview ......................... [RUN]
[0m15:00:36.310655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m15:00:36.311431 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m15:00:36.314924 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m15:00:36.315653 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 15:00:36.311806 => 15:00:36.315411
[0m15:00:36.316073 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m15:00:36.318632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:36.983038 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m15:00:36.983834 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m15:00:37.592879 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c7e2f536-37a4-49e0-9836-c3ed9f9212e7&page=queryresults
[0m15:00:40.325813 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 15:00:36.316453 => 15:00:40.325596
[0m15:00:40.326789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f03221fb-9847-4c89-b201-ff9c77dca8da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3843701c90>]}
[0m15:00:40.327614 [info ] [Thread-1 (]: 4 of 11 OK created sql table model games.dim_price_overview .................... [[32mCREATE TABLE (1.1k rows, 114.2 KiB processed)[0m in 4.02s]
[0m15:00:40.328501 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m15:00:40.329153 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m15:00:40.330174 [info ] [Thread-1 (]: 5 of 11 START sql table model games.dim_publishers ............................. [RUN]
[0m15:00:40.331239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m15:00:40.331790 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m15:00:40.335091 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m15:00:40.336178 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 15:00:40.332078 => 15:00:40.335929
[0m15:00:40.336605 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m15:00:40.339845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:41.029656 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m15:00:41.030846 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m15:00:41.588310 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ec4a042b-d4bc-46a2-bb36-41d971a0555f&page=queryresults
[0m15:00:44.597167 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 15:00:40.336874 => 15:00:44.596928
[0m15:00:44.598020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f03221fb-9847-4c89-b201-ff9c77dca8da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38438ecd30>]}
[0m15:00:44.601781 [info ] [Thread-1 (]: 5 of 11 OK created sql table model games.dim_publishers ........................ [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.27s]
[0m15:00:44.602617 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m15:00:44.603262 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m15:00:44.603958 [info ] [Thread-1 (]: 6 of 11 START sql table model games.dim_release ................................ [RUN]
[0m15:00:44.604851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m15:00:44.605645 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m15:00:44.610543 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m15:00:44.645872 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 15:00:44.606016 => 15:00:44.645281
[0m15:00:44.646414 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m15:00:44.648931 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:45.321455 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m15:00:45.357703 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m15:00:45.880445 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:62759656-ee6d-4a86-a158-256e8e0e6aed&page=queryresults
[0m15:00:48.270836 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 15:00:44.646776 => 15:00:48.270627
[0m15:00:48.271660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f03221fb-9847-4c89-b201-ff9c77dca8da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38438ed210>]}
[0m15:00:48.272262 [info ] [Thread-1 (]: 6 of 11 OK created sql table model games.dim_release ........................... [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 3.67s]
[0m15:00:48.272901 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m15:00:48.273352 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m15:00:48.273939 [info ] [Thread-1 (]: 7 of 11 START sql table model games.dim_support_language ....................... [RUN]
[0m15:00:48.274871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m15:00:48.275407 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m15:00:48.278591 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m15:00:48.280539 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 15:00:48.275791 => 15:00:48.280214
[0m15:00:48.281010 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m15:00:48.290936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:49.004435 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m15:00:49.006518 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m15:00:49.487266 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b365d86a-92b1-4bc4-9fd3-ea2b62afea98&page=queryresults
[0m15:00:52.158395 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 15:00:48.281290 => 15:00:52.158205
[0m15:00:52.159154 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f03221fb-9847-4c89-b201-ff9c77dca8da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3843737eb0>]}
[0m15:00:52.159853 [info ] [Thread-1 (]: 7 of 11 OK created sql table model games.dim_support_language .................. [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 3.88s]
[0m15:00:52.160728 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m15:00:52.161434 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m15:00:52.162194 [info ] [Thread-1 (]: 8 of 11 START sql table model games.fct_game_pricing ........................... [RUN]
[0m15:00:52.163144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m15:00:52.163664 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m15:00:52.167596 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m15:00:52.267464 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 15:00:52.163988 => 15:00:52.267171
[0m15:00:52.267909 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m15:00:52.270371 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:53.011876 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m15:00:53.036938 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para el análisis de precios de juegos
-- WITH game_sales AS (
--     SELECT
--         app_id,
--         formatted_initial_price,
--         SUM(price_with_tax) AS total_sales,
--         SUM(discount_amount) AS total_discounts,
--         COUNT(*) AS num_sales,
--         MAX(discount_pct) AS max_discount,
--         MIN(initial_price) AS min_price,
--         MAX(initial_price) AS max_price,
--         SUM(price_with_tax) AS total_sales_with_tax,
--         SUM(final_price) AS total_sales_with_tax_discounted
--     FROM
--         `pristine-flames-400818`.`games`.`dim_price_overview`
--     GROUP BY app_id, formatted_initial_price
-- )

WITH game_sales AS (
    SELECT
        ROW_NUMBER() OVER() AS app_id,
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)


SELECT
   fct.app_id
FROM
    game_sales AS fct
INNER JOIN
    `pristine-flames-400818`.`games`.`dim_games` AS games
ON
    fct.app_id = games.app_id
    );
  
[0m15:00:53.740931 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c71cee5b-1f7d-4991-a30a-0b00f5c82b8f&page=queryresults
[0m15:02:18.688681 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 15:00:52.268177 => 15:02:18.688483
[0m15:02:18.689460 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f03221fb-9847-4c89-b201-ff9c77dca8da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3843703d00>]}
[0m15:02:18.690048 [info ] [Thread-1 (]: 8 of 11 OK created sql table model games.fct_game_pricing ...................... [[32mCREATE TABLE (4.0 rows, 21.2 KiB processed)[0m in 86.53s]
[0m15:02:18.690802 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m15:02:18.691747 [debug] [Thread-1 (]: Began running node model.games.top_10_discounted_games
[0m15:02:18.692225 [info ] [Thread-1 (]: 9 of 11 START sql table model games.top_10_discounted_games .................... [RUN]
[0m15:02:18.692911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.fct_game_pricing, now model.games.top_10_discounted_games)
[0m15:02:18.693308 [debug] [Thread-1 (]: Began compiling node model.games.top_10_discounted_games
[0m15:02:18.696141 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_discounted_games"
[0m15:02:18.814821 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (compile): 15:02:18.693576 => 15:02:18.814535
[0m15:02:18.815258 [debug] [Thread-1 (]: Began executing node model.games.top_10_discounted_games
[0m15:02:18.817638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:19.526115 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_discounted_games"
[0m15:02:19.567129 [debug] [Thread-1 (]: On model.games.top_10_discounted_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_discounted_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_discounted_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 descuentos más grandes
SELECT
    app_id,
    game_name,
    total_discounts
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY total_discounts DESC
LIMIT 10
    );
  
[0m15:02:20.181755 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:81af4965-d779-4861-839d-5b82e6314e35&page=queryresults
[0m15:02:20.661832 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: game_name at [16:5]')
[0m15:02:21.328866 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:cb14b185-0438-4a7e-a339-4c7a073e3f9a&page=queryresults
[0m15:02:21.824002 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:cb14b185-0438-4a7e-a339-4c7a073e3f9a&page=queryresults
[0m15:02:21.824841 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (execute): 15:02:18.815530 => 15:02:21.824596
[0m15:02:21.827980 [debug] [Thread-1 (]: Database Error in model top_10_discounted_games (models/report/top_10_discounted_games.sql)
  Unrecognized name: game_name at [16:5]
  compiled Code at target/run/games/models/report/top_10_discounted_games.sql
[0m15:02:21.828706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f03221fb-9847-4c89-b201-ff9c77dca8da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f384385a320>]}
[0m15:02:21.829613 [error] [Thread-1 (]: 9 of 11 ERROR creating sql table model games.top_10_discounted_games ........... [[31mERROR[0m in 3.14s]
[0m15:02:21.830395 [debug] [Thread-1 (]: Finished running node model.games.top_10_discounted_games
[0m15:02:21.831002 [debug] [Thread-1 (]: Began running node model.games.top_10_high_tax_games
[0m15:02:21.831658 [info ] [Thread-1 (]: 10 of 11 START sql table model games.top_10_high_tax_games ..................... [RUN]
[0m15:02:21.832610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_discounted_games, now model.games.top_10_high_tax_games)
[0m15:02:21.833245 [debug] [Thread-1 (]: Began compiling node model.games.top_10_high_tax_games
[0m15:02:21.836811 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_high_tax_games"
[0m15:02:21.837891 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (compile): 15:02:21.833877 => 15:02:21.837641
[0m15:02:21.838443 [debug] [Thread-1 (]: Began executing node model.games.top_10_high_tax_games
[0m15:02:21.849702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:22.537572 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_high_tax_games"
[0m15:02:22.538572 [debug] [Thread-1 (]: On model.games.top_10_high_tax_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_high_tax_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_high_tax_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos con más impuestos
SELECT
    app_id,
    game_name,
    SUM(total_sales_with_tax) AS total_taxes
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
GROUP BY app_id, game_name
ORDER BY total_taxes DESC, game_name DESC
LIMIT 10
    );
  
[0m15:02:23.176504 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:bc657df5-b8bb-40f2-a17e-f0aff18793f2&page=queryresults
[0m15:02:23.666082 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: game_name at [16:5]')
[0m15:02:25.207729 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a3221df6-5176-490f-b9d4-ff9ccc6690e3&page=queryresults
[0m15:02:25.667160 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a3221df6-5176-490f-b9d4-ff9ccc6690e3&page=queryresults
[0m15:02:25.667908 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (execute): 15:02:21.838808 => 15:02:25.667679
[0m15:02:25.669201 [debug] [Thread-1 (]: Database Error in model top_10_high_tax_games (models/report/top_10_high_tax_games.sql)
  Unrecognized name: game_name at [16:5]
  compiled Code at target/run/games/models/report/top_10_high_tax_games.sql
[0m15:02:25.669688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f03221fb-9847-4c89-b201-ff9c77dca8da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38438c5690>]}
[0m15:02:25.670294 [error] [Thread-1 (]: 10 of 11 ERROR creating sql table model games.top_10_high_tax_games ............ [[31mERROR[0m in 3.84s]
[0m15:02:25.671350 [debug] [Thread-1 (]: Finished running node model.games.top_10_high_tax_games
[0m15:02:25.672398 [debug] [Thread-1 (]: Began running node model.games.top_10_most_expensive_games
[0m15:02:25.673091 [info ] [Thread-1 (]: 11 of 11 START sql table model games.top_10_most_expensive_games ............... [RUN]
[0m15:02:25.673941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_high_tax_games, now model.games.top_10_most_expensive_games)
[0m15:02:25.674647 [debug] [Thread-1 (]: Began compiling node model.games.top_10_most_expensive_games
[0m15:02:25.678043 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_most_expensive_games"
[0m15:02:25.679116 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (compile): 15:02:25.675101 => 15:02:25.678878
[0m15:02:25.679521 [debug] [Thread-1 (]: Began executing node model.games.top_10_most_expensive_games
[0m15:02:25.681954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:26.346247 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_most_expensive_games"
[0m15:02:26.347356 [debug] [Thread-1 (]: On model.games.top_10_most_expensive_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_most_expensive_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_most_expensive_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos más caros
SELECT
    app_id,
    game_name,
    max_price,
    formatted_initial_price,
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY max_price DESC
LIMIT 10
    );
  
[0m15:02:26.898056 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:cf209e16-3738-4112-a62a-c809593011a0&page=queryresults
[0m15:02:27.404275 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: game_name at [16:5]')
[0m15:02:28.483370 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:bfabb2c6-8ba5-485f-b67f-5cfd18751320&page=queryresults
[0m15:02:28.992521 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:bfabb2c6-8ba5-485f-b67f-5cfd18751320&page=queryresults
[0m15:02:28.993231 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (execute): 15:02:25.679784 => 15:02:28.993029
[0m15:02:28.994436 [debug] [Thread-1 (]: Database Error in model top_10_most_expensive_games (models/report/top_10_most_expensive_games.sql)
  Unrecognized name: game_name at [16:5]
  compiled Code at target/run/games/models/report/top_10_most_expensive_games.sql
[0m15:02:28.994921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f03221fb-9847-4c89-b201-ff9c77dca8da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38438c5540>]}
[0m15:02:28.995504 [error] [Thread-1 (]: 11 of 11 ERROR creating sql table model games.top_10_most_expensive_games ...... [[31mERROR[0m in 3.32s]
[0m15:02:28.996110 [debug] [Thread-1 (]: Finished running node model.games.top_10_most_expensive_games
[0m15:02:28.998672 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:02:28.999117 [debug] [MainThread]: Connection 'model.games.top_10_most_expensive_games' was properly closed.
[0m15:02:28.999603 [info ] [MainThread]: 
[0m15:02:29.000046 [info ] [MainThread]: Finished running 11 table models in 0 hours 2 minutes and 6.10 seconds (126.10s).
[0m15:02:29.002216 [debug] [MainThread]: Command end result
[0m15:02:29.019693 [info ] [MainThread]: 
[0m15:02:29.020271 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m15:02:29.020706 [info ] [MainThread]: 
[0m15:02:29.021096 [error] [MainThread]:   Database Error in model top_10_discounted_games (models/report/top_10_discounted_games.sql)
  Unrecognized name: game_name at [16:5]
  compiled Code at target/run/games/models/report/top_10_discounted_games.sql
[0m15:02:29.021519 [info ] [MainThread]: 
[0m15:02:29.021992 [error] [MainThread]:   Database Error in model top_10_high_tax_games (models/report/top_10_high_tax_games.sql)
  Unrecognized name: game_name at [16:5]
  compiled Code at target/run/games/models/report/top_10_high_tax_games.sql
[0m15:02:29.022456 [info ] [MainThread]: 
[0m15:02:29.022970 [error] [MainThread]:   Database Error in model top_10_most_expensive_games (models/report/top_10_most_expensive_games.sql)
  Unrecognized name: game_name at [16:5]
  compiled Code at target/run/games/models/report/top_10_most_expensive_games.sql
[0m15:02:29.023487 [info ] [MainThread]: 
[0m15:02:29.024042 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=3 SKIP=0 TOTAL=11
[0m15:02:29.024784 [debug] [MainThread]: Command `dbt run` failed at 15:02:29.024666 after 126.63 seconds
[0m15:02:29.025246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f384810d180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3843ffbc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3843ffbd60>]}
[0m15:02:29.025713 [debug] [MainThread]: Flushing usage events
[0m15:03:59.457738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4beb0aa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4bcd64070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4bcd640d0>]}


============================== 15:03:59.463356 | ab4d2e4e-fe3f-4839-8d30-754f21ec0e94 ==============================
[0m15:03:59.463356 [info ] [MainThread]: Running with dbt=1.6.5
[0m15:03:59.463851 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '../dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'send_anonymous_usage_stats': 'True'}
[0m15:04:02.503050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab4d2e4e-fe3f-4839-8d30-754f21ec0e94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4be0553f0>]}
[0m15:04:02.518831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab4d2e4e-fe3f-4839-8d30-754f21ec0e94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4bab049d0>]}
[0m15:04:02.519484 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m15:04:02.533041 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m15:04:03.045017 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:04:03.045572 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m15:04:03.148238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab4d2e4e-fe3f-4839-8d30-754f21ec0e94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4ba9e1e10>]}
[0m15:04:03.694471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab4d2e4e-fe3f-4839-8d30-754f21ec0e94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4ba937430>]}
[0m15:04:03.696574 [info ] [MainThread]: Found 11 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m15:04:03.698284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab4d2e4e-fe3f-4839-8d30-754f21ec0e94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4ba9373d0>]}
[0m15:04:03.705090 [info ] [MainThread]: 
[0m15:04:03.708329 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:04:03.714788 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m15:04:03.716764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:04.543797 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m15:04:04.545759 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:04:05.301962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab4d2e4e-fe3f-4839-8d30-754f21ec0e94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4ba934c10>]}
[0m15:04:05.397137 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:04:05.398998 [info ] [MainThread]: 
[0m15:04:05.401643 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m15:04:05.402168 [info ] [Thread-1 (]: 1 of 11 START sql table model games.dim_developers ............................. [RUN]
[0m15:04:05.402863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m15:04:05.403257 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m15:04:05.410804 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m15:04:05.476112 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 15:04:05.403520 => 15:04:05.474845
[0m15:04:05.507206 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m15:04:05.544550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:06.352549 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m15:04:06.378260 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS developer_id,
    developers_name
FROM
    developers_cte
    );
  
[0m15:04:07.059911 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e98f9921-1578-4d99-8e80-5ed7c5ca7b4d&page=queryresults
[0m15:04:11.592491 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 15:04:05.508924 => 15:04:11.592307
[0m15:04:11.593190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab4d2e4e-fe3f-4839-8d30-754f21ec0e94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4ba916410>]}
[0m15:04:11.593764 [info ] [Thread-1 (]: 1 of 11 OK created sql table model games.dim_developers ........................ [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 6.19s]
[0m15:04:11.594370 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m15:04:11.594904 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m15:04:11.595460 [info ] [Thread-1 (]: 2 of 11 START sql table model games.dim_games .................................. [RUN]
[0m15:04:11.596083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m15:04:11.596445 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m15:04:11.604170 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m15:04:11.707066 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 15:04:11.596701 => 15:04:11.705929
[0m15:04:11.708970 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m15:04:11.719039 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:12.506607 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m15:04:12.519379 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m15:04:13.106024 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:bf1ccdb0-ed72-46d5-957a-b89320f260cf&page=queryresults
[0m15:04:15.500909 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 15:04:11.710279 => 15:04:15.500721
[0m15:04:15.501643 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab4d2e4e-fe3f-4839-8d30-754f21ec0e94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4ba914880>]}
[0m15:04:15.502234 [info ] [Thread-1 (]: 2 of 11 OK created sql table model games.dim_games ............................. [[32mCREATE TABLE (2.7k rows, 753.9 KiB processed)[0m in 3.91s]
[0m15:04:15.502846 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m15:04:15.503278 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m15:04:15.503710 [info ] [Thread-1 (]: 3 of 11 START sql table model games.dim_platforms .............................. [RUN]
[0m15:04:15.504885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m15:04:15.505299 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m15:04:15.508196 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m15:04:15.509017 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 15:04:15.505570 => 15:04:15.508759
[0m15:04:15.509486 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m15:04:15.511873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:16.233667 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m15:04:16.234312 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m15:04:16.766858 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ebc7ef97-47e3-4e6d-a8e4-9d6ac4e9ec29&page=queryresults
[0m15:04:19.472930 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 15:04:15.509790 => 15:04:19.472737
[0m15:04:19.473727 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab4d2e4e-fe3f-4839-8d30-754f21ec0e94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4ba916890>]}
[0m15:04:19.474364 [info ] [Thread-1 (]: 3 of 11 OK created sql table model games.dim_platforms ......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 3.97s]
[0m15:04:19.474971 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m15:04:19.475423 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m15:04:19.475927 [info ] [Thread-1 (]: 4 of 11 START sql table model games.dim_price_overview ......................... [RUN]
[0m15:04:19.476571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m15:04:19.476975 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m15:04:19.480048 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m15:04:19.488554 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 15:04:19.477272 => 15:04:19.488214
[0m15:04:19.489008 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m15:04:19.491379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:20.234940 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m15:04:20.253687 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m15:04:20.793547 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b3d99a77-8420-4b7a-a534-4206c9a6f3e9&page=queryresults
[0m15:04:23.210706 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 15:04:19.489283 => 15:04:23.210461
[0m15:04:23.211647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab4d2e4e-fe3f-4839-8d30-754f21ec0e94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4ba101c30>]}
[0m15:04:23.212408 [info ] [Thread-1 (]: 4 of 11 OK created sql table model games.dim_price_overview .................... [[32mCREATE TABLE (1.1k rows, 114.2 KiB processed)[0m in 3.74s]
[0m15:04:23.213150 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m15:04:23.213714 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m15:04:23.214411 [info ] [Thread-1 (]: 5 of 11 START sql table model games.dim_publishers ............................. [RUN]
[0m15:04:23.215230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m15:04:23.215741 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m15:04:23.219154 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m15:04:23.279326 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 15:04:23.216086 => 15:04:23.278967
[0m15:04:23.279917 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m15:04:23.283296 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:23.982377 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m15:04:23.995431 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m15:04:24.609383 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b6b25f9e-0cd9-4d29-bd2a-5999e6587c78&page=queryresults
[0m15:04:27.295446 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 15:04:23.280294 => 15:04:27.294950
[0m15:04:27.297226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab4d2e4e-fe3f-4839-8d30-754f21ec0e94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4ba2eceb0>]}
[0m15:04:27.298404 [info ] [Thread-1 (]: 5 of 11 OK created sql table model games.dim_publishers ........................ [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.08s]
[0m15:04:27.299615 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m15:04:27.300487 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m15:04:27.301458 [info ] [Thread-1 (]: 6 of 11 START sql table model games.dim_release ................................ [RUN]
[0m15:04:27.302777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m15:04:27.303437 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m15:04:27.307933 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m15:04:27.374753 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 15:04:27.303885 => 15:04:27.373598
[0m15:04:27.377264 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m15:04:27.386076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:28.111391 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m15:04:28.319710 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m15:04:28.927555 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:2aa36896-74a8-4aa8-b638-dd89fa05c77c&page=queryresults
[0m15:04:31.605102 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 15:04:27.378713 => 15:04:31.604912
[0m15:04:31.605920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab4d2e4e-fe3f-4839-8d30-754f21ec0e94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4ba2ad6c0>]}
[0m15:04:31.606606 [info ] [Thread-1 (]: 6 of 11 OK created sql table model games.dim_release ........................... [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.30s]
[0m15:04:31.607271 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m15:04:31.607757 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m15:04:31.608227 [info ] [Thread-1 (]: 7 of 11 START sql table model games.dim_support_language ....................... [RUN]
[0m15:04:31.608909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m15:04:31.609289 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m15:04:31.612272 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m15:04:31.651685 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 15:04:31.609625 => 15:04:31.650619
[0m15:04:31.653634 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m15:04:31.680568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:32.423991 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m15:04:32.426939 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m15:04:32.972697 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:39cb992c-cf5b-4948-9cb5-c7e46485fc7d&page=queryresults
[0m15:04:35.359460 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 15:04:31.654975 => 15:04:35.358595
[0m15:04:35.362547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab4d2e4e-fe3f-4839-8d30-754f21ec0e94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4ba137e20>]}
[0m15:04:35.365096 [info ] [Thread-1 (]: 7 of 11 OK created sql table model games.dim_support_language .................. [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 3.75s]
[0m15:04:35.367916 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m15:04:35.369942 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m15:04:35.372263 [info ] [Thread-1 (]: 8 of 11 START sql table model games.fct_game_pricing ........................... [RUN]
[0m15:04:35.375147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m15:04:35.376946 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m15:04:35.388478 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m15:04:35.393959 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 15:04:35.378240 => 15:04:35.393508
[0m15:04:35.394982 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m15:04:35.399308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:36.084651 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m15:04:36.085325 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para el análisis de precios de juegos
-- WITH game_sales AS (
--     SELECT
--         app_id,
--         formatted_initial_price,
--         SUM(price_with_tax) AS total_sales,
--         SUM(discount_amount) AS total_discounts,
--         COUNT(*) AS num_sales,
--         MAX(discount_pct) AS max_discount,
--         MIN(initial_price) AS min_price,
--         MAX(initial_price) AS max_price,
--         SUM(price_with_tax) AS total_sales_with_tax,
--         SUM(final_price) AS total_sales_with_tax_discounted
--     FROM
--         `pristine-flames-400818`.`games`.`dim_price_overview`
--     GROUP BY app_id, formatted_initial_price
-- )

WITH game_sales AS (
    SELECT
        app_id,
    FROM
        `pristine-flames-400818`.`games`.`dim_games`
)


SELECT
   fct.app_id
FROM
    game_sales AS fct
INNER JOIN
    `pristine-flames-400818`.`games`.`dim_games` AS games
ON
    fct.app_id = games.app_id
    );
  
[0m15:04:36.661416 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:1db62a9a-bd6f-421d-a746-c7ca82dd589c&page=queryresults
[0m15:04:38.835211 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 15:04:35.395629 => 15:04:38.834308
[0m15:04:38.838295 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab4d2e4e-fe3f-4839-8d30-754f21ec0e94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4ba103430>]}
[0m15:04:38.840889 [info ] [Thread-1 (]: 8 of 11 OK created sql table model games.fct_game_pricing ...................... [[32mCREATE TABLE (2.7k rows, 21.2 KiB processed)[0m in 3.46s]
[0m15:04:38.843726 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m15:04:38.847305 [debug] [Thread-1 (]: Began running node model.games.top_10_discounted_games
[0m15:04:38.850247 [info ] [Thread-1 (]: 9 of 11 START sql table model games.top_10_discounted_games .................... [RUN]
[0m15:04:38.853324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.fct_game_pricing, now model.games.top_10_discounted_games)
[0m15:04:38.855202 [debug] [Thread-1 (]: Began compiling node model.games.top_10_discounted_games
[0m15:04:38.864184 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_discounted_games"
[0m15:04:38.878846 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (compile): 15:04:38.856514 => 15:04:38.878141
[0m15:04:38.880138 [debug] [Thread-1 (]: Began executing node model.games.top_10_discounted_games
[0m15:04:38.886942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:39.590001 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_discounted_games"
[0m15:04:39.594657 [debug] [Thread-1 (]: On model.games.top_10_discounted_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_discounted_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_discounted_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 descuentos más grandes
SELECT
    app_id,
    game_name,
    total_discounts
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY total_discounts DESC
LIMIT 10
    );
  
[0m15:04:40.176878 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:6fe3dc33-046d-4023-b096-f5d7791d4210&page=queryresults
[0m15:04:40.662234 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: game_name at [16:5]')
[0m15:04:41.969044 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:3f964972-3336-48d2-a374-e54f0ffb59a8&page=queryresults
[0m15:04:42.461750 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:3f964972-3336-48d2-a374-e54f0ffb59a8&page=queryresults
[0m15:04:42.465077 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (execute): 15:04:38.881042 => 15:04:42.464134
[0m15:04:42.477056 [debug] [Thread-1 (]: Database Error in model top_10_discounted_games (models/report/top_10_discounted_games.sql)
  Unrecognized name: game_name at [16:5]
  compiled Code at target/run/games/models/report/top_10_discounted_games.sql
[0m15:04:42.478604 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab4d2e4e-fe3f-4839-8d30-754f21ec0e94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4ba25a890>]}
[0m15:04:42.480430 [error] [Thread-1 (]: 9 of 11 ERROR creating sql table model games.top_10_discounted_games ........... [[31mERROR[0m in 3.63s]
[0m15:04:42.482384 [debug] [Thread-1 (]: Finished running node model.games.top_10_discounted_games
[0m15:04:42.483860 [debug] [Thread-1 (]: Began running node model.games.top_10_high_tax_games
[0m15:04:42.485638 [info ] [Thread-1 (]: 10 of 11 START sql table model games.top_10_high_tax_games ..................... [RUN]
[0m15:04:42.487922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_discounted_games, now model.games.top_10_high_tax_games)
[0m15:04:42.488888 [debug] [Thread-1 (]: Began compiling node model.games.top_10_high_tax_games
[0m15:04:42.495141 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_high_tax_games"
[0m15:04:42.496363 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (compile): 15:04:42.489686 => 15:04:42.495971
[0m15:04:42.497107 [debug] [Thread-1 (]: Began executing node model.games.top_10_high_tax_games
[0m15:04:42.508937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:43.201220 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_high_tax_games"
[0m15:04:43.247579 [debug] [Thread-1 (]: On model.games.top_10_high_tax_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_high_tax_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_high_tax_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos con más impuestos
SELECT
    app_id,
    game_name,
    SUM(total_sales_with_tax) AS total_taxes
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
GROUP BY app_id, game_name
ORDER BY total_taxes DESC, game_name DESC
LIMIT 10
    );
  
[0m15:04:43.801483 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:bf6cc756-a66d-4a24-9829-55d78c5b61c8&page=queryresults
[0m15:04:44.297209 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: game_name at [16:5]')
[0m15:04:45.150033 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:4045db1d-e212-415e-b3a2-f19a0e157a97&page=queryresults
[0m15:04:45.659339 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:4045db1d-e212-415e-b3a2-f19a0e157a97&page=queryresults
[0m15:04:45.662260 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (execute): 15:04:42.497633 => 15:04:45.661335
[0m15:04:45.667612 [debug] [Thread-1 (]: Database Error in model top_10_high_tax_games (models/report/top_10_high_tax_games.sql)
  Unrecognized name: game_name at [16:5]
  compiled Code at target/run/games/models/report/top_10_high_tax_games.sql
[0m15:04:45.669517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab4d2e4e-fe3f-4839-8d30-754f21ec0e94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4ba2aee30>]}
[0m15:04:45.672111 [error] [Thread-1 (]: 10 of 11 ERROR creating sql table model games.top_10_high_tax_games ............ [[31mERROR[0m in 3.18s]
[0m15:04:45.674964 [debug] [Thread-1 (]: Finished running node model.games.top_10_high_tax_games
[0m15:04:45.677010 [debug] [Thread-1 (]: Began running node model.games.top_10_most_expensive_games
[0m15:04:45.679389 [info ] [Thread-1 (]: 11 of 11 START sql table model games.top_10_most_expensive_games ............... [RUN]
[0m15:04:45.682275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_high_tax_games, now model.games.top_10_most_expensive_games)
[0m15:04:45.684137 [debug] [Thread-1 (]: Began compiling node model.games.top_10_most_expensive_games
[0m15:04:45.693644 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_most_expensive_games"
[0m15:04:45.794617 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (compile): 15:04:45.685448 => 15:04:45.793483
[0m15:04:45.796535 [debug] [Thread-1 (]: Began executing node model.games.top_10_most_expensive_games
[0m15:04:45.806329 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:46.515322 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_most_expensive_games"
[0m15:04:46.564601 [debug] [Thread-1 (]: On model.games.top_10_most_expensive_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_most_expensive_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_most_expensive_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos más caros
SELECT
    app_id,
    game_name,
    max_price,
    formatted_initial_price,
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY max_price DESC
LIMIT 10
    );
  
[0m15:04:47.249275 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:8a9bf39e-ef22-48a9-8def-ccf095ec6220&page=queryresults
[0m15:04:47.752266 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: game_name at [16:5]')
[0m15:04:48.661781 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:46fb88d6-5c19-4fe6-9eb3-6da0829be8e9&page=queryresults
[0m15:04:49.155305 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:46fb88d6-5c19-4fe6-9eb3-6da0829be8e9&page=queryresults
[0m15:04:49.156934 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (execute): 15:04:45.797867 => 15:04:49.156448
[0m15:04:49.159684 [debug] [Thread-1 (]: Database Error in model top_10_most_expensive_games (models/report/top_10_most_expensive_games.sql)
  Unrecognized name: game_name at [16:5]
  compiled Code at target/run/games/models/report/top_10_most_expensive_games.sql
[0m15:04:49.160697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab4d2e4e-fe3f-4839-8d30-754f21ec0e94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4ba9f75e0>]}
[0m15:04:49.162014 [error] [Thread-1 (]: 11 of 11 ERROR creating sql table model games.top_10_most_expensive_games ...... [[31mERROR[0m in 3.48s]
[0m15:04:49.163456 [debug] [Thread-1 (]: Finished running node model.games.top_10_most_expensive_games
[0m15:04:49.166516 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:04:49.167380 [debug] [MainThread]: Connection 'model.games.top_10_most_expensive_games' was properly closed.
[0m15:04:49.168261 [info ] [MainThread]: 
[0m15:04:49.169136 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 45.46 seconds (45.46s).
[0m15:04:49.174187 [debug] [MainThread]: Command end result
[0m15:04:49.210708 [info ] [MainThread]: 
[0m15:04:49.211178 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m15:04:49.211494 [info ] [MainThread]: 
[0m15:04:49.211835 [error] [MainThread]:   Database Error in model top_10_discounted_games (models/report/top_10_discounted_games.sql)
  Unrecognized name: game_name at [16:5]
  compiled Code at target/run/games/models/report/top_10_discounted_games.sql
[0m15:04:49.212221 [info ] [MainThread]: 
[0m15:04:49.212587 [error] [MainThread]:   Database Error in model top_10_high_tax_games (models/report/top_10_high_tax_games.sql)
  Unrecognized name: game_name at [16:5]
  compiled Code at target/run/games/models/report/top_10_high_tax_games.sql
[0m15:04:49.212952 [info ] [MainThread]: 
[0m15:04:49.213266 [error] [MainThread]:   Database Error in model top_10_most_expensive_games (models/report/top_10_most_expensive_games.sql)
  Unrecognized name: game_name at [16:5]
  compiled Code at target/run/games/models/report/top_10_most_expensive_games.sql
[0m15:04:49.213604 [info ] [MainThread]: 
[0m15:04:49.213969 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=3 SKIP=0 TOTAL=11
[0m15:04:49.214579 [debug] [MainThread]: Command `dbt run` failed at 15:04:49.214457 after 49.86 seconds
[0m15:04:49.214998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4beb0aa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4be054e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4baaf62c0>]}
[0m15:04:49.215390 [debug] [MainThread]: Flushing usage events
[0m15:23:39.016348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f247e332ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f247c494070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f247c4940d0>]}


============================== 15:23:39.018470 | 24ec4a8d-52ac-4c89-a837-df4ffd0d414d ==============================
[0m15:23:39.018470 [info ] [MainThread]: Running with dbt=1.6.5
[0m15:23:39.018965 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:23:39.300304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24ec4a8d-52ac-4c89-a837-df4ffd0d414d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f247d906620>]}
[0m15:23:39.316560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24ec4a8d-52ac-4c89-a837-df4ffd0d414d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f247a4349d0>]}
[0m15:23:39.317238 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m15:23:39.331098 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m15:23:39.397473 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m15:23:39.398008 [debug] [MainThread]: Partial parsing: added file: games://models/report/platform.sql
[0m15:23:39.398420 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m15:23:39.398832 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m15:23:39.449558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24ec4a8d-52ac-4c89-a837-df4ffd0d414d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2479942590>]}
[0m15:23:39.459351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24ec4a8d-52ac-4c89-a837-df4ffd0d414d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f247a2675b0>]}
[0m15:23:39.459820 [info ] [MainThread]: Found 12 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m15:23:39.460167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24ec4a8d-52ac-4c89-a837-df4ffd0d414d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f247a267550>]}
[0m15:23:39.461617 [info ] [MainThread]: 
[0m15:23:39.462270 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:23:39.463746 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m15:23:39.464164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:40.269816 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m15:23:40.270256 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:40.943841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24ec4a8d-52ac-4c89-a837-df4ffd0d414d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f247a264e50>]}
[0m15:23:40.944679 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:23:40.945026 [info ] [MainThread]: 
[0m15:23:40.947057 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m15:23:40.947527 [info ] [Thread-1 (]: 1 of 12 START sql table model games.dim_developers ............................. [RUN]
[0m15:23:40.948123 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m15:23:40.948539 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m15:23:40.955407 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m15:23:40.956075 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 15:23:40.948791 => 15:23:40.955841
[0m15:23:40.956474 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m15:23:40.969843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:41.678543 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m15:23:41.679271 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS developer_id,
    developers_name
FROM
    developers_cte
    );
  
[0m15:23:42.307230 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:35ca4bf0-186b-4f31-aebb-488e53b807cc&page=queryresults
[0m15:23:45.062039 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 15:23:40.956765 => 15:23:45.061767
[0m15:23:45.063081 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24ec4a8d-52ac-4c89-a837-df4ffd0d414d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f247a2426b0>]}
[0m15:23:45.063929 [info ] [Thread-1 (]: 1 of 12 OK created sql table model games.dim_developers ........................ [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.12s]
[0m15:23:45.064804 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m15:23:45.065461 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m15:23:45.066445 [info ] [Thread-1 (]: 2 of 12 START sql table model games.dim_games .................................. [RUN]
[0m15:23:45.067334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m15:23:45.067842 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m15:23:45.077845 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m15:23:45.078602 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 15:23:45.068182 => 15:23:45.078374
[0m15:23:45.079075 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m15:23:45.081716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:45.768178 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m15:23:45.770905 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m15:23:46.274771 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:0a01993a-7e1e-4a4c-b93b-1c6f9834a565&page=queryresults
[0m15:23:48.709515 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 15:23:45.079400 => 15:23:48.708540
[0m15:23:48.712829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24ec4a8d-52ac-4c89-a837-df4ffd0d414d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f247a242ec0>]}
[0m15:23:48.715637 [info ] [Thread-1 (]: 2 of 12 OK created sql table model games.dim_games ............................. [[32mCREATE TABLE (2.7k rows, 753.9 KiB processed)[0m in 3.65s]
[0m15:23:48.718537 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m15:23:48.720591 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m15:23:48.722613 [info ] [Thread-1 (]: 3 of 12 START sql table model games.dim_platforms .............................. [RUN]
[0m15:23:48.724903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m15:23:48.726520 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m15:23:48.732993 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m15:23:48.734236 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 15:23:48.727309 => 15:23:48.733847
[0m15:23:48.735053 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m15:23:48.739072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:49.459845 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m15:23:49.460505 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m15:23:50.044170 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b3cb0abe-cdc1-49d6-bc33-77cf48e77361&page=queryresults
[0m15:23:52.777195 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 15:23:48.735581 => 15:23:52.776997
[0m15:23:52.777977 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24ec4a8d-52ac-4c89-a837-df4ffd0d414d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24799f7fd0>]}
[0m15:23:52.778628 [info ] [Thread-1 (]: 3 of 12 OK created sql table model games.dim_platforms ......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.05s]
[0m15:23:52.779297 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m15:23:52.779777 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m15:23:52.780368 [info ] [Thread-1 (]: 4 of 12 START sql table model games.dim_price_overview ......................... [RUN]
[0m15:23:52.781098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m15:23:52.781535 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m15:23:52.784841 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m15:23:52.785540 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 15:23:52.781839 => 15:23:52.785321
[0m15:23:52.785961 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m15:23:52.788421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:53.483323 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m15:23:53.484003 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        platform_id,
        windows,
        mac,
        linux,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    platform_id,
    windows,
    mac,
    linux,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m15:23:54.154851 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9ccd32db-60f5-46cc-9bc8-ca1b27f3318f&page=queryresults
[0m15:23:54.391779 [info ] [MainThread]: [33mThe bigquery adapter does not support query cancellation. Some queries may still be running![0m
[0m15:23:54.648117 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: platform_id at [24:9]')
[0m15:23:55.126673 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5f4d055c-b89f-4481-9d7a-81f5ba7d784f&page=queryresults
[0m15:23:55.616575 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5f4d055c-b89f-4481-9d7a-81f5ba7d784f&page=queryresults
[0m15:23:55.617407 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 15:23:52.786259 => 15:23:55.617175
[0m15:23:55.620590 [debug] [Thread-1 (]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Unrecognized name: platform_id at [24:9]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m15:23:55.621126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24ec4a8d-52ac-4c89-a837-df4ffd0d414d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f247982ba60>]}
[0m15:23:55.621768 [error] [Thread-1 (]: 4 of 12 ERROR creating sql table model games.dim_price_overview ................ [[31mERROR[0m in 2.84s]
[0m15:23:55.622418 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m15:23:55.622876 [info ] [MainThread]: 
[0m15:23:55.623264 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m15:23:55.623604 [info ] [MainThread]: 
[0m15:23:55.623972 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:23:55.624564 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:23:55.624950 [debug] [MainThread]: Connection 'model.games.dim_price_overview' was properly closed.
[0m15:23:55.625349 [info ] [MainThread]: 
[0m15:23:55.625762 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 16.16 seconds (16.16s).
[0m15:23:55.626247 [error] [MainThread]: Encountered an error:

[0m15:23:55.627427 [error] [MainThread]: Traceback (most recent call last):
  File "/home/tomi/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 87, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/tomi/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 72, in wrapper
    return func(*args, **kwargs)
  File "/home/tomi/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 143, in wrapper
    return func(*args, **kwargs)
  File "/home/tomi/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 172, in wrapper
    return func(*args, **kwargs)
  File "/home/tomi/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 219, in wrapper
    return func(*args, **kwargs)
  File "/home/tomi/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 259, in wrapper
    return func(*args, **kwargs)
  File "/home/tomi/.local/lib/python3.10/site-packages/dbt/cli/main.py", line 580, in run
    results = task.run()
  File "/home/tomi/.local/lib/python3.10/site-packages/dbt/task/runnable.py", line 469, in run
    result = self.execute_with_hooks(selected_uids)
  File "/home/tomi/.local/lib/python3.10/site-packages/dbt/task/runnable.py", line 430, in execute_with_hooks
    res = self.execute_nodes()
  File "/home/tomi/.local/lib/python3.10/site-packages/dbt/task/runnable.py", line 356, in execute_nodes
    self.run_queue(pool)
  File "/home/tomi/.local/lib/python3.10/site-packages/dbt/task/runnable.py", line 269, in run_queue
    node = self.job_queue.get()
  File "/home/tomi/.local/lib/python3.10/site-packages/dbt/graph/queue.py", line 125, in get
    _, node_id = self.inner.get(block=block, timeout=timeout)
  File "/usr/lib/python3.10/queue.py", line 171, in get
    self.not_empty.wait()
  File "/usr/lib/python3.10/threading.py", line 320, in wait
    waiter.acquire()
KeyboardInterrupt

[0m15:23:55.628524 [debug] [MainThread]: Command `dbt run` failed at 15:23:55.628381 after 16.62 seconds
[0m15:23:55.629142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f247e332ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2479819240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24798193c0>]}
[0m15:23:55.629688 [debug] [MainThread]: Flushing usage events
[0m15:25:51.634676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff16d0d180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff14f64070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff14f640d0>]}


============================== 15:25:51.636780 | c92cfca8-07d1-4390-9b69-1960091f0624 ==============================
[0m15:25:51.636780 [info ] [MainThread]: Running with dbt=1.6.5
[0m15:25:51.637282 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'profiles_dir': '../dbt/', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:25:51.917578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c92cfca8-07d1-4390-9b69-1960091f0624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff1622dcf0>]}
[0m15:25:51.933766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c92cfca8-07d1-4390-9b69-1960091f0624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff12d049d0>]}
[0m15:25:51.934384 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m15:25:51.947766 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m15:25:52.011002 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:25:52.011588 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m15:25:52.055590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c92cfca8-07d1-4390-9b69-1960091f0624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff12be23b0>]}
[0m15:25:52.064786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c92cfca8-07d1-4390-9b69-1960091f0624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff12b3b9a0>]}
[0m15:25:52.065246 [info ] [MainThread]: Found 12 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m15:25:52.065589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c92cfca8-07d1-4390-9b69-1960091f0624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff12b3b9d0>]}
[0m15:25:52.067059 [info ] [MainThread]: 
[0m15:25:52.067702 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:25:52.069080 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m15:25:52.069418 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:53.134149 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m15:25:53.134708 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:25:53.800793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c92cfca8-07d1-4390-9b69-1960091f0624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff12b3a890>]}
[0m15:25:53.801669 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:25:53.802069 [info ] [MainThread]: 
[0m15:25:53.804196 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m15:25:53.804771 [info ] [Thread-1 (]: 1 of 12 START sql table model games.dim_developers ............................. [RUN]
[0m15:25:53.805476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m15:25:53.805953 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m15:25:53.813400 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m15:25:53.814180 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 15:25:53.806231 => 15:25:53.813921
[0m15:25:53.814668 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m15:25:53.828403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:54.612361 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m15:25:54.613186 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS developer_id,
    developers_name
FROM
    developers_cte
    );
  
[0m15:25:55.191236 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7a12c787-1e2f-470f-bd80-3e9ac923b45c&page=queryresults
[0m15:25:57.981574 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 15:25:53.814925 => 15:25:57.981267
[0m15:25:57.982693 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c92cfca8-07d1-4390-9b69-1960091f0624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff12b1ad40>]}
[0m15:25:57.983599 [info ] [Thread-1 (]: 1 of 12 OK created sql table model games.dim_developers ........................ [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.18s]
[0m15:25:57.984447 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m15:25:57.985050 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m15:25:57.985760 [info ] [Thread-1 (]: 2 of 12 START sql table model games.dim_games .................................. [RUN]
[0m15:25:57.986624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m15:25:57.987162 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m15:25:57.996478 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m15:25:57.997232 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 15:25:57.987535 => 15:25:57.997005
[0m15:25:57.997640 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m15:25:57.999944 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:58.790102 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m15:25:58.790832 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m15:25:59.236186 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5a489e06-e0a4-4fea-b7b6-b57c9dc428c7&page=queryresults
[0m15:26:01.906025 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 15:25:57.997925 => 15:26:01.905157
[0m15:26:01.909124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c92cfca8-07d1-4390-9b69-1960091f0624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff12b1b3a0>]}
[0m15:26:01.911701 [info ] [Thread-1 (]: 2 of 12 OK created sql table model games.dim_games ............................. [[32mCREATE TABLE (2.7k rows, 753.9 KiB processed)[0m in 3.92s]
[0m15:26:01.914539 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m15:26:01.916579 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m15:26:01.918691 [info ] [Thread-1 (]: 3 of 12 START sql table model games.dim_platforms .............................. [RUN]
[0m15:26:01.921870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m15:26:01.923766 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m15:26:01.931253 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m15:26:01.931981 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 15:26:01.925055 => 15:26:01.931732
[0m15:26:01.932376 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m15:26:01.934553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:02.665743 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m15:26:02.668427 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m15:26:03.249895 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:3fb98338-1306-438a-80da-75159158373f&page=queryresults
[0m15:26:05.980390 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 15:26:01.932627 => 15:26:05.979518
[0m15:26:05.983470 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c92cfca8-07d1-4390-9b69-1960091f0624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff12b18b50>]}
[0m15:26:05.986000 [info ] [Thread-1 (]: 3 of 12 OK created sql table model games.dim_platforms ......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.06s]
[0m15:26:05.988811 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m15:26:05.990859 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m15:26:05.993260 [info ] [Thread-1 (]: 4 of 12 START sql table model games.dim_price_overview ......................... [RUN]
[0m15:26:05.996244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m15:26:05.998061 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m15:26:06.004800 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m15:26:06.005491 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 15:26:05.999374 => 15:26:06.005261
[0m15:26:06.005881 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m15:26:06.008112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:06.714920 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m15:26:06.715713 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        platform_id,
        windows,
        mac,
        linux,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    platform_id,
    windows,
    mac,
    linux,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m15:26:07.346763 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9b56c525-7a96-4056-baa8-2df11e2eaa4d&page=queryresults
[0m15:26:07.823153 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: platform_id at [24:9]')
[0m15:26:08.273791 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:0a31bc6a-436e-4da2-8326-c513418e4efe&page=queryresults
[0m15:26:08.751904 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:0a31bc6a-436e-4da2-8326-c513418e4efe&page=queryresults
[0m15:26:08.754930 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 15:26:06.006132 => 15:26:08.753955
[0m15:26:08.758387 [debug] [Thread-1 (]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Unrecognized name: platform_id at [24:9]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m15:26:08.758834 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c92cfca8-07d1-4390-9b69-1960091f0624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff12307970>]}
[0m15:26:08.759375 [error] [Thread-1 (]: 4 of 12 ERROR creating sql table model games.dim_price_overview ................ [[31mERROR[0m in 2.76s]
[0m15:26:08.759932 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m15:26:08.760370 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m15:26:08.760785 [info ] [Thread-1 (]: 5 of 12 START sql table model games.dim_publishers ............................. [RUN]
[0m15:26:08.761383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m15:26:08.761751 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m15:26:08.764826 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m15:26:08.765651 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 15:26:08.762136 => 15:26:08.765418
[0m15:26:08.766088 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m15:26:08.768500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:09.513410 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m15:26:09.516098 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m15:26:10.128433 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:3dbd7d9b-4565-4fbc-b3cf-aa805c1dac65&page=queryresults
[0m15:26:12.901610 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 15:26:08.766384 => 15:26:12.901426
[0m15:26:12.902379 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c92cfca8-07d1-4390-9b69-1960091f0624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff124f10c0>]}
[0m15:26:12.902987 [info ] [Thread-1 (]: 5 of 12 OK created sql table model games.dim_publishers ........................ [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.14s]
[0m15:26:12.903604 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m15:26:12.904046 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m15:26:12.904576 [info ] [Thread-1 (]: 6 of 12 START sql table model games.dim_release ................................ [RUN]
[0m15:26:12.905198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m15:26:12.905582 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m15:26:12.908450 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m15:26:12.909073 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 15:26:12.905854 => 15:26:12.908877
[0m15:26:12.909449 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m15:26:12.911718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:13.630843 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m15:26:13.633795 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m15:26:14.188601 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:add01d66-d007-47da-bb3f-bc724e8d819d&page=queryresults
[0m15:26:16.864053 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 15:26:12.909713 => 15:26:16.863686
[0m15:26:16.865430 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c92cfca8-07d1-4390-9b69-1960091f0624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff12be02e0>]}
[0m15:26:16.866542 [info ] [Thread-1 (]: 6 of 12 OK created sql table model games.dim_release ........................... [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 3.96s]
[0m15:26:16.867707 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m15:26:16.868547 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m15:26:16.869723 [info ] [Thread-1 (]: 7 of 12 START sql table model games.dim_support_language ....................... [RUN]
[0m15:26:16.871214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m15:26:16.872110 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m15:26:16.878178 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m15:26:16.879570 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 15:26:16.872733 => 15:26:16.879118
[0m15:26:16.880452 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m15:26:16.893889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:17.635995 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m15:26:17.636756 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m15:26:18.195068 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e5fb9b79-8428-4df6-aa30-b7738751cd19&page=queryresults
[0m15:26:21.753639 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 15:26:16.881085 => 15:26:21.752760
[0m15:26:21.756735 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c92cfca8-07d1-4390-9b69-1960091f0624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff12317c70>]}
[0m15:26:21.759326 [info ] [Thread-1 (]: 7 of 12 OK created sql table model games.dim_support_language .................. [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.89s]
[0m15:26:21.762127 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m15:26:21.764195 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m15:26:21.766518 [info ] [Thread-1 (]: 8 of 12 SKIP relation games.fct_game_pricing ................................... [[33mSKIP[0m]
[0m15:26:21.768689 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m15:26:21.772258 [debug] [Thread-1 (]: Began running node model.games.platform
[0m15:26:21.774238 [info ] [Thread-1 (]: 9 of 12 SKIP relation games.platform ........................................... [[33mSKIP[0m]
[0m15:26:21.775940 [debug] [Thread-1 (]: Finished running node model.games.platform
[0m15:26:21.776392 [debug] [Thread-1 (]: Began running node model.games.top_10_discounted_games
[0m15:26:21.776939 [info ] [Thread-1 (]: 10 of 12 SKIP relation games.top_10_discounted_games ........................... [[33mSKIP[0m]
[0m15:26:21.777504 [debug] [Thread-1 (]: Finished running node model.games.top_10_discounted_games
[0m15:26:21.777969 [debug] [Thread-1 (]: Began running node model.games.top_10_high_tax_games
[0m15:26:21.778414 [info ] [Thread-1 (]: 11 of 12 SKIP relation games.top_10_high_tax_games ............................. [[33mSKIP[0m]
[0m15:26:21.779010 [debug] [Thread-1 (]: Finished running node model.games.top_10_high_tax_games
[0m15:26:21.779428 [debug] [Thread-1 (]: Began running node model.games.top_10_most_expensive_games
[0m15:26:21.779824 [info ] [Thread-1 (]: 12 of 12 SKIP relation games.top_10_most_expensive_games ....................... [[33mSKIP[0m]
[0m15:26:21.780331 [debug] [Thread-1 (]: Finished running node model.games.top_10_most_expensive_games
[0m15:26:21.781549 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:26:21.781875 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m15:26:21.782229 [info ] [MainThread]: 
[0m15:26:21.782577 [info ] [MainThread]: Finished running 12 table models in 0 hours 0 minutes and 29.71 seconds (29.71s).
[0m15:26:21.784154 [debug] [MainThread]: Command end result
[0m15:26:21.793112 [info ] [MainThread]: 
[0m15:26:21.793606 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:26:21.793968 [info ] [MainThread]: 
[0m15:26:21.794327 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Unrecognized name: platform_id at [24:9]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m15:26:21.794737 [info ] [MainThread]: 
[0m15:26:21.795116 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=5 TOTAL=12
[0m15:26:21.795693 [debug] [MainThread]: Command `dbt run` failed at 15:26:21.795603 after 30.17 seconds
[0m15:26:21.796066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff16d0d180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff164187f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff12316470>]}
[0m15:26:21.796434 [debug] [MainThread]: Flushing usage events
[0m15:29:36.067452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5655529180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5653584070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56535840d0>]}


============================== 15:29:36.069526 | efe750d1-86fb-4e7f-8aab-ea77c26e8827 ==============================
[0m15:29:36.069526 [info ] [MainThread]: Running with dbt=1.6.5
[0m15:29:36.070014 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:29:36.367434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efe750d1-86fb-4e7f-8aab-ea77c26e8827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5651506c50>]}
[0m15:29:36.384105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'efe750d1-86fb-4e7f-8aab-ea77c26e8827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5651520640>]}
[0m15:29:36.384753 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m15:29:36.398894 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m15:29:36.465001 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:29:36.465550 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m15:29:36.508709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'efe750d1-86fb-4e7f-8aab-ea77c26e8827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56513e6470>]}
[0m15:29:36.517975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'efe750d1-86fb-4e7f-8aab-ea77c26e8827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f565135ba60>]}
[0m15:29:36.518432 [info ] [MainThread]: Found 12 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m15:29:36.518817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efe750d1-86fb-4e7f-8aab-ea77c26e8827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f565135ba00>]}
[0m15:29:36.520266 [info ] [MainThread]: 
[0m15:29:36.520914 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:29:36.522293 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m15:29:36.522744 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:37.380693 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m15:29:37.383053 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:29:38.095011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efe750d1-86fb-4e7f-8aab-ea77c26e8827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5651359300>]}
[0m15:29:38.098202 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:29:38.099915 [info ] [MainThread]: 
[0m15:29:38.108010 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m15:29:38.110196 [info ] [Thread-1 (]: 1 of 12 START sql table model games.dim_developers ............................. [RUN]
[0m15:29:38.113138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m15:29:38.114982 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m15:29:38.143442 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m15:29:38.144966 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 15:29:38.116269 => 15:29:38.144480
[0m15:29:38.145779 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m15:29:38.165214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:29:38.944522 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m15:29:38.945298 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS developer_id,
    developers_name
FROM
    developers_cte
    );
  
[0m15:29:39.554187 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c8535b11-5e39-4d6e-8904-7955f3c4ea53&page=queryresults
[0m15:29:41.967658 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 15:29:38.146297 => 15:29:41.967446
[0m15:29:41.968426 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efe750d1-86fb-4e7f-8aab-ea77c26e8827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f565133ad10>]}
[0m15:29:41.969032 [info ] [Thread-1 (]: 1 of 12 OK created sql table model games.dim_developers ........................ [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 3.86s]
[0m15:29:41.969666 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m15:29:41.970121 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m15:29:41.970583 [info ] [Thread-1 (]: 2 of 12 START sql table model games.dim_games .................................. [RUN]
[0m15:29:41.971309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m15:29:41.971722 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m15:29:41.981461 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m15:29:41.982168 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 15:29:41.972008 => 15:29:41.981969
[0m15:29:41.982574 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m15:29:41.984772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:29:42.671985 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m15:29:42.674724 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m15:29:43.121050 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:6bdb1d02-74e7-44f6-938f-00e802af013c&page=queryresults
[0m15:29:45.537322 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 15:29:41.982827 => 15:29:45.537133
[0m15:29:45.538004 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efe750d1-86fb-4e7f-8aab-ea77c26e8827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f565133b010>]}
[0m15:29:45.538558 [info ] [Thread-1 (]: 2 of 12 OK created sql table model games.dim_games ............................. [[32mCREATE TABLE (2.7k rows, 753.9 KiB processed)[0m in 3.57s]
[0m15:29:45.539129 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m15:29:45.539569 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m15:29:45.540078 [info ] [Thread-1 (]: 3 of 12 START sql table model games.dim_platforms .............................. [RUN]
[0m15:29:45.540670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m15:29:45.541036 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m15:29:45.543770 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m15:29:45.544367 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 15:29:45.541295 => 15:29:45.544180
[0m15:29:45.544726 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m15:29:45.546787 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:29:46.284782 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m15:29:46.285720 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m15:29:46.921577 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a0c8041b-f019-4ac0-9acf-c6d145e87fc7&page=queryresults
[0m15:29:49.593355 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 15:29:45.544982 => 15:29:49.592482
[0m15:29:49.596504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efe750d1-86fb-4e7f-8aab-ea77c26e8827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5650ceff70>]}
[0m15:29:49.599069 [info ] [Thread-1 (]: 3 of 12 OK created sql table model games.dim_platforms ......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.06s]
[0m15:29:49.601865 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m15:29:49.603920 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m15:29:49.606389 [info ] [Thread-1 (]: 4 of 12 START sql table model games.dim_price_overview ......................... [RUN]
[0m15:29:49.609366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m15:29:49.611221 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m15:29:49.618220 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m15:29:49.618967 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 15:29:49.612519 => 15:29:49.618716
[0m15:29:49.619366 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m15:29:49.621567 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:29:50.330799 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m15:29:50.331558 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    platform_id,
    windows,
    mac,
    linux
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte, dim_platforms
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m15:29:50.625389 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:6dcc463a-eeb8-49c0-930e-cd44b8126e9a&page=queryresults
[0m15:29:50.627326 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got "(" at [57:11]')
[0m15:29:51.401463 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:144fba91-9e2b-4779-b17c-7b9b100edace&page=queryresults
[0m15:29:51.405799 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:144fba91-9e2b-4779-b17c-7b9b100edace&page=queryresults
[0m15:29:51.409340 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 15:29:49.619621 => 15:29:51.408375
[0m15:29:51.422530 [debug] [Thread-1 (]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Syntax error: Expected ")" but got "(" at [57:11]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m15:29:51.423179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efe750d1-86fb-4e7f-8aab-ea77c26e8827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5650b23a00>]}
[0m15:29:51.423955 [error] [Thread-1 (]: 4 of 12 ERROR creating sql table model games.dim_price_overview ................ [[31mERROR[0m in 1.82s]
[0m15:29:51.424684 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m15:29:51.425308 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m15:29:51.425978 [info ] [Thread-1 (]: 5 of 12 START sql table model games.dim_publishers ............................. [RUN]
[0m15:29:51.426659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m15:29:51.427043 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m15:29:51.429932 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m15:29:51.430560 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 15:29:51.427308 => 15:29:51.430357
[0m15:29:51.430932 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m15:29:51.433149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:29:52.175697 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m15:29:52.176460 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m15:29:52.780162 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:55253929-c50f-42c1-8caa-e8829d6aa37b&page=queryresults
[0m15:29:55.450150 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 15:29:51.431193 => 15:29:55.449956
[0m15:29:55.451020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efe750d1-86fb-4e7f-8aab-ea77c26e8827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5650b23a00>]}
[0m15:29:55.451600 [info ] [Thread-1 (]: 5 of 12 OK created sql table model games.dim_publishers ........................ [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.02s]
[0m15:29:55.452239 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m15:29:55.452683 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m15:29:55.453161 [info ] [Thread-1 (]: 6 of 12 START sql table model games.dim_release ................................ [RUN]
[0m15:29:55.453850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m15:29:55.454275 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m15:29:55.457277 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m15:29:55.457893 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 15:29:55.454692 => 15:29:55.457701
[0m15:29:55.458267 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m15:29:55.460549 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:29:56.130512 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m15:29:56.131776 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m15:29:56.702965 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:891b60c7-e3e9-4a9f-af9d-40865aaf53e0&page=queryresults
[0m15:29:59.395224 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 15:29:55.458539 => 15:29:59.394004
[0m15:29:59.399299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efe750d1-86fb-4e7f-8aab-ea77c26e8827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5650b23b50>]}
[0m15:29:59.402510 [info ] [Thread-1 (]: 6 of 12 OK created sql table model games.dim_release ........................... [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 3.95s]
[0m15:29:59.406091 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m15:29:59.409124 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m15:29:59.412417 [info ] [Thread-1 (]: 7 of 12 START sql table model games.dim_support_language ....................... [RUN]
[0m15:29:59.414885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m15:29:59.416158 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m15:29:59.423249 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m15:29:59.424486 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 15:29:59.417280 => 15:29:59.424098
[0m15:29:59.425241 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m15:29:59.435705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:30:00.165380 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m15:30:00.168249 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m15:30:00.890750 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:af7b0d6d-2ab9-4a7a-97f3-4300f6eb6bb3&page=queryresults
[0m15:30:03.575151 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 15:29:59.425763 => 15:30:03.574247
[0m15:30:03.578235 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efe750d1-86fb-4e7f-8aab-ea77c26e8827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5650cb2cb0>]}
[0m15:30:03.580844 [info ] [Thread-1 (]: 7 of 12 OK created sql table model games.dim_support_language .................. [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.16s]
[0m15:30:03.583645 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m15:30:03.585673 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m15:30:03.587647 [info ] [Thread-1 (]: 8 of 12 SKIP relation games.fct_game_pricing ................................... [[33mSKIP[0m]
[0m15:30:03.590058 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m15:30:03.593626 [debug] [Thread-1 (]: Began running node model.games.platform
[0m15:30:03.595625 [info ] [Thread-1 (]: 9 of 12 SKIP relation games.platform ........................................... [[33mSKIP[0m]
[0m15:30:03.597697 [debug] [Thread-1 (]: Finished running node model.games.platform
[0m15:30:03.599727 [debug] [Thread-1 (]: Began running node model.games.top_10_discounted_games
[0m15:30:03.602048 [info ] [Thread-1 (]: 10 of 12 SKIP relation games.top_10_discounted_games ........................... [[33mSKIP[0m]
[0m15:30:03.603716 [debug] [Thread-1 (]: Finished running node model.games.top_10_discounted_games
[0m15:30:03.605107 [debug] [Thread-1 (]: Began running node model.games.top_10_high_tax_games
[0m15:30:03.606693 [info ] [Thread-1 (]: 11 of 12 SKIP relation games.top_10_high_tax_games ............................. [[33mSKIP[0m]
[0m15:30:03.607994 [debug] [Thread-1 (]: Finished running node model.games.top_10_high_tax_games
[0m15:30:03.609051 [debug] [Thread-1 (]: Began running node model.games.top_10_most_expensive_games
[0m15:30:03.610225 [info ] [Thread-1 (]: 12 of 12 SKIP relation games.top_10_most_expensive_games ....................... [[33mSKIP[0m]
[0m15:30:03.611347 [debug] [Thread-1 (]: Finished running node model.games.top_10_most_expensive_games
[0m15:30:03.614122 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:30:03.614928 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m15:30:03.615675 [info ] [MainThread]: 
[0m15:30:03.616371 [info ] [MainThread]: Finished running 12 table models in 0 hours 0 minutes and 27.09 seconds (27.09s).
[0m15:30:03.619204 [debug] [MainThread]: Command end result
[0m15:30:03.632030 [info ] [MainThread]: 
[0m15:30:03.632603 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:30:03.633007 [info ] [MainThread]: 
[0m15:30:03.633409 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Syntax error: Expected ")" but got "(" at [57:11]
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m15:30:03.633824 [info ] [MainThread]: 
[0m15:30:03.634250 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=5 TOTAL=12
[0m15:30:03.634925 [debug] [MainThread]: Command `dbt run` failed at 15:30:03.634807 after 27.57 seconds
[0m15:30:03.635372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5655529180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5650cb13c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5650cb2260>]}
[0m15:30:03.635835 [debug] [MainThread]: Flushing usage events
[0m15:30:34.884112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb55862ab00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb556788070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5567880d0>]}


============================== 15:30:34.886232 | 8ff9be65-1ef9-46a2-a06d-ec0f2e2bc9c2 ==============================
[0m15:30:34.886232 [info ] [MainThread]: Running with dbt=1.6.5
[0m15:30:34.886719 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:30:35.176054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ff9be65-1ef9-46a2-a06d-ec0f2e2bc9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb557c29cf0>]}
[0m15:30:35.192475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ff9be65-1ef9-46a2-a06d-ec0f2e2bc9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5547249d0>]}
[0m15:30:35.193174 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m15:30:35.207269 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m15:30:35.275235 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:30:35.275862 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m15:30:35.321443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ff9be65-1ef9-46a2-a06d-ec0f2e2bc9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5545e6440>]}
[0m15:30:35.331324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ff9be65-1ef9-46a2-a06d-ec0f2e2bc9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb55455ba30>]}
[0m15:30:35.331795 [info ] [MainThread]: Found 12 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m15:30:35.332148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ff9be65-1ef9-46a2-a06d-ec0f2e2bc9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb55455b9d0>]}
[0m15:30:35.333668 [info ] [MainThread]: 
[0m15:30:35.334424 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:30:35.335892 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m15:30:35.336326 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:30:36.100234 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m15:30:36.100955 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:30:36.789718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ff9be65-1ef9-46a2-a06d-ec0f2e2bc9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5545592d0>]}
[0m15:30:36.791067 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:30:36.791851 [info ] [MainThread]: 
[0m15:30:36.795121 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m15:30:36.796009 [info ] [Thread-1 (]: 1 of 12 START sql table model games.dim_developers ............................. [RUN]
[0m15:30:36.797182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m15:30:36.797903 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m15:30:36.810647 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m15:30:36.811861 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 15:30:36.798390 => 15:30:36.811470
[0m15:30:36.812565 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m15:30:36.830200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:30:37.520984 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m15:30:37.521750 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS developer_id,
    developers_name
FROM
    developers_cte
    );
  
[0m15:30:38.062644 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b0135181-b6aa-4235-8652-8217926b00c3&page=queryresults
[0m15:30:40.833702 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 15:30:36.813053 => 15:30:40.833515
[0m15:30:40.834433 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ff9be65-1ef9-46a2-a06d-ec0f2e2bc9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb55453ad40>]}
[0m15:30:40.835015 [info ] [Thread-1 (]: 1 of 12 OK created sql table model games.dim_developers ........................ [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.04s]
[0m15:30:40.835583 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m15:30:40.836021 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m15:30:40.836498 [info ] [Thread-1 (]: 2 of 12 START sql table model games.dim_games .................................. [RUN]
[0m15:30:40.837077 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m15:30:40.837434 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m15:30:40.845254 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m15:30:40.845915 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 15:30:40.837689 => 15:30:40.845727
[0m15:30:40.846316 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m15:30:40.848746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:30:41.544811 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m15:30:41.545419 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m15:30:42.126392 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:923e1f6d-637f-4954-b658-56fde91e90b5&page=queryresults
[0m15:30:44.547395 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 15:30:40.846609 => 15:30:44.546528
[0m15:30:44.550472 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ff9be65-1ef9-46a2-a06d-ec0f2e2bc9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb55453b310>]}
[0m15:30:44.553044 [info ] [Thread-1 (]: 2 of 12 OK created sql table model games.dim_games ............................. [[32mCREATE TABLE (2.7k rows, 753.9 KiB processed)[0m in 3.71s]
[0m15:30:44.556029 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m15:30:44.558099 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m15:30:44.560561 [info ] [Thread-1 (]: 3 of 12 START sql table model games.dim_platforms .............................. [RUN]
[0m15:30:44.563523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m15:30:44.565415 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m15:30:44.574840 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m15:30:44.576363 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 15:30:44.566733 => 15:30:44.575879
[0m15:30:44.577287 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m15:30:44.582812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:30:45.285830 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m15:30:45.288492 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m15:30:45.778343 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:67f83457-9819-4a32-8a62-75a116c9066a&page=queryresults
[0m15:30:48.801560 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 15:30:44.577985 => 15:30:48.800680
[0m15:30:48.804690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ff9be65-1ef9-46a2-a06d-ec0f2e2bc9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb554538e20>]}
[0m15:30:48.807286 [info ] [Thread-1 (]: 3 of 12 OK created sql table model games.dim_platforms ......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.24s]
[0m15:30:48.810075 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m15:30:48.812149 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m15:30:48.814509 [info ] [Thread-1 (]: 4 of 12 START sql table model games.dim_price_overview ......................... [RUN]
[0m15:30:48.817445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m15:30:48.819191 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m15:30:48.827485 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m15:30:48.828944 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 15:30:48.820174 => 15:30:48.828555
[0m15:30:48.829706 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m15:30:48.834117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:30:49.557869 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m15:30:49.558567 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    platform_id,
    windows,
    mac,
    linux,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte, dim_platforms
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m15:30:49.960468 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:8b1405f4-5715-4d9f-973d-12d510e6d403&page=queryresults
[0m15:30:49.964701 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "dim_platforms" must be qualified with a dataset (e.g. dataset.table).')
[0m15:30:51.104365 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:cf5b0277-5f3c-40e2-812c-824affe978d5&page=queryresults
[0m15:30:51.108566 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:cf5b0277-5f3c-40e2-812c-824affe978d5&page=queryresults
[0m15:30:51.111472 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 15:30:48.830235 => 15:30:51.110549
[0m15:30:51.124807 [debug] [Thread-1 (]: Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Table "dim_platforms" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m15:30:51.125948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ff9be65-1ef9-46a2-a06d-ec0f2e2bc9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb54fc27910>]}
[0m15:30:51.126583 [error] [Thread-1 (]: 4 of 12 ERROR creating sql table model games.dim_price_overview ................ [[31mERROR[0m in 2.31s]
[0m15:30:51.127206 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m15:30:51.127646 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m15:30:51.128156 [info ] [Thread-1 (]: 5 of 12 START sql table model games.dim_publishers ............................. [RUN]
[0m15:30:51.128940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m15:30:51.129394 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m15:30:51.132248 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m15:30:51.132869 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 15:30:51.129673 => 15:30:51.132677
[0m15:30:51.133239 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m15:30:51.135409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:30:51.883355 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m15:30:51.885775 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m15:30:52.347779 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7f95f2fa-3f3e-40f2-85fa-7985edf87c4d&page=queryresults
[0m15:30:55.131347 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 15:30:51.133499 => 15:30:55.130406
[0m15:30:55.134419 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ff9be65-1ef9-46a2-a06d-ec0f2e2bc9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb54fc27f70>]}
[0m15:30:55.136970 [info ] [Thread-1 (]: 5 of 12 OK created sql table model games.dim_publishers ........................ [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.01s]
[0m15:30:55.139774 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m15:30:55.141781 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m15:30:55.143877 [info ] [Thread-1 (]: 6 of 12 START sql table model games.dim_release ................................ [RUN]
[0m15:30:55.147074 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m15:30:55.148909 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m15:30:55.156211 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m15:30:55.156898 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 15:30:55.150204 => 15:30:55.156678
[0m15:30:55.157288 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m15:30:55.159553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:30:55.910304 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m15:30:55.912964 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m15:30:56.471042 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:837db861-1934-46ba-b138-666855ffbd54&page=queryresults
[0m15:30:58.982068 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 15:30:55.157540 => 15:30:58.981212
[0m15:30:58.985393 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ff9be65-1ef9-46a2-a06d-ec0f2e2bc9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb54fc26740>]}
[0m15:30:58.988171 [info ] [Thread-1 (]: 6 of 12 OK created sql table model games.dim_release ........................... [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 3.84s]
[0m15:30:58.991011 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m15:30:58.993052 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m15:30:58.995413 [info ] [Thread-1 (]: 7 of 12 START sql table model games.dim_support_language ....................... [RUN]
[0m15:30:58.998543 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m15:30:59.000369 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m15:30:59.009740 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m15:30:59.011272 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 15:30:59.001656 => 15:30:59.010784
[0m15:30:59.012197 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m15:30:59.024160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:30:59.724962 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m15:30:59.727628 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m15:31:00.268071 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:93335da0-6210-4a15-8099-b6a61158699d&page=queryresults
[0m15:31:03.086176 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 15:30:59.012855 => 15:31:03.085308
[0m15:31:03.089279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ff9be65-1ef9-46a2-a06d-ec0f2e2bc9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb54fd86620>]}
[0m15:31:03.091841 [info ] [Thread-1 (]: 7 of 12 OK created sql table model games.dim_support_language .................. [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.09s]
[0m15:31:03.094796 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m15:31:03.096814 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m15:31:03.099084 [info ] [Thread-1 (]: 8 of 12 SKIP relation games.fct_game_pricing ................................... [[33mSKIP[0m]
[0m15:31:03.101200 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m15:31:03.104455 [debug] [Thread-1 (]: Began running node model.games.platform
[0m15:31:03.106796 [info ] [Thread-1 (]: 9 of 12 SKIP relation games.platform ........................................... [[33mSKIP[0m]
[0m15:31:03.108803 [debug] [Thread-1 (]: Finished running node model.games.platform
[0m15:31:03.110165 [debug] [Thread-1 (]: Began running node model.games.top_10_discounted_games
[0m15:31:03.111764 [info ] [Thread-1 (]: 10 of 12 SKIP relation games.top_10_discounted_games ........................... [[33mSKIP[0m]
[0m15:31:03.113397 [debug] [Thread-1 (]: Finished running node model.games.top_10_discounted_games
[0m15:31:03.114476 [debug] [Thread-1 (]: Began running node model.games.top_10_high_tax_games
[0m15:31:03.115615 [info ] [Thread-1 (]: 11 of 12 SKIP relation games.top_10_high_tax_games ............................. [[33mSKIP[0m]
[0m15:31:03.116668 [debug] [Thread-1 (]: Finished running node model.games.top_10_high_tax_games
[0m15:31:03.117707 [debug] [Thread-1 (]: Began running node model.games.top_10_most_expensive_games
[0m15:31:03.118769 [info ] [Thread-1 (]: 12 of 12 SKIP relation games.top_10_most_expensive_games ....................... [[33mSKIP[0m]
[0m15:31:03.119608 [debug] [Thread-1 (]: Finished running node model.games.top_10_most_expensive_games
[0m15:31:03.122163 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:31:03.122911 [debug] [MainThread]: Connection 'model.games.dim_support_language' was properly closed.
[0m15:31:03.123650 [info ] [MainThread]: 
[0m15:31:03.124229 [info ] [MainThread]: Finished running 12 table models in 0 hours 0 minutes and 27.79 seconds (27.79s).
[0m15:31:03.126845 [debug] [MainThread]: Command end result
[0m15:31:03.140305 [info ] [MainThread]: 
[0m15:31:03.141084 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:31:03.141619 [info ] [MainThread]: 
[0m15:31:03.142154 [error] [MainThread]:   Database Error in model dim_price_overview (models/transform/dim_price_overview.sql)
  Table "dim_platforms" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/games/models/transform/dim_price_overview.sql
[0m15:31:03.142718 [info ] [MainThread]: 
[0m15:31:03.143294 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=5 TOTAL=12
[0m15:31:03.144096 [debug] [MainThread]: Command `dbt run` failed at 15:31:03.143959 after 28.27 seconds
[0m15:31:03.144605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb55862ab00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb557e147f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb54fd84670>]}
[0m15:31:03.145123 [debug] [MainThread]: Flushing usage events
[0m15:31:15.965730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b13a22a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b11a80070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b11a800d0>]}


============================== 15:31:15.967843 | b3bfbc31-3686-48a4-8171-65191fe2c6f0 ==============================
[0m15:31:15.967843 [info ] [MainThread]: Running with dbt=1.6.5
[0m15:31:15.968378 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:31:16.243914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3bfbc31-3686-48a4-8171-65191fe2c6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b12fb13f0>]}
[0m15:31:16.259654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3bfbc31-3686-48a4-8171-65191fe2c6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b0fa209d0>]}
[0m15:31:16.260232 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m15:31:16.273330 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m15:31:16.338193 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:31:16.338754 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m15:31:16.382239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3bfbc31-3686-48a4-8171-65191fe2c6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b0f8e63e0>]}
[0m15:31:16.391419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3bfbc31-3686-48a4-8171-65191fe2c6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b0f857970>]}
[0m15:31:16.391871 [info ] [MainThread]: Found 12 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m15:31:16.392215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3bfbc31-3686-48a4-8171-65191fe2c6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b0f855db0>]}
[0m15:31:16.393727 [info ] [MainThread]: 
[0m15:31:16.394391 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:31:16.395819 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m15:31:16.396238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:17.074818 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m15:31:17.076799 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:31:17.757451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3bfbc31-3686-48a4-8171-65191fe2c6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b0f8551e0>]}
[0m15:31:17.758162 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:31:17.758513 [info ] [MainThread]: 
[0m15:31:17.760389 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m15:31:17.760882 [info ] [Thread-1 (]: 1 of 12 START sql table model games.dim_developers ............................. [RUN]
[0m15:31:17.761519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m15:31:17.761909 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m15:31:17.769004 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m15:31:17.769671 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 15:31:17.762183 => 15:31:17.769435
[0m15:31:17.770083 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m15:31:17.783289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:18.544477 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m15:31:18.545265 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS developer_id,
    developers_name
FROM
    developers_cte
    );
  
[0m15:31:19.090407 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:77ec1ae8-3949-498a-aced-c2394a8a3ce4&page=queryresults
[0m15:31:21.503512 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 15:31:17.770341 => 15:31:21.503202
[0m15:31:21.504632 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3bfbc31-3686-48a4-8171-65191fe2c6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b0f838970>]}
[0m15:31:21.505533 [info ] [Thread-1 (]: 1 of 12 OK created sql table model games.dim_developers ........................ [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 3.74s]
[0m15:31:21.506392 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m15:31:21.507005 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m15:31:21.507710 [info ] [Thread-1 (]: 2 of 12 START sql table model games.dim_games .................................. [RUN]
[0m15:31:21.508575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m15:31:21.509104 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m15:31:21.518375 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m15:31:21.519134 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 15:31:21.509483 => 15:31:21.518914
[0m15:31:21.519545 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m15:31:21.521885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:22.354024 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m15:31:22.354724 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m15:31:22.898044 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7b846726-3ea6-445e-acea-6185efcd0673&page=queryresults
[0m15:31:25.597658 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 15:31:21.519836 => 15:31:25.597470
[0m15:31:25.598375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3bfbc31-3686-48a4-8171-65191fe2c6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b0f83b370>]}
[0m15:31:25.598956 [info ] [Thread-1 (]: 2 of 12 OK created sql table model games.dim_games ............................. [[32mCREATE TABLE (2.7k rows, 753.9 KiB processed)[0m in 4.09s]
[0m15:31:25.599537 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m15:31:25.599964 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m15:31:25.600408 [info ] [Thread-1 (]: 3 of 12 START sql table model games.dim_platforms .............................. [RUN]
[0m15:31:25.601104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m15:31:25.601611 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m15:31:25.604359 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m15:31:25.605022 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 15:31:25.601890 => 15:31:25.604782
[0m15:31:25.605402 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m15:31:25.607532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:26.301763 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m15:31:26.304529 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m15:31:26.888602 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:21e6d65e-3ecf-4f8b-bb22-17028dadded9&page=queryresults
[0m15:31:29.389454 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 15:31:25.605670 => 15:31:29.388573
[0m15:31:29.392565 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3bfbc31-3686-48a4-8171-65191fe2c6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b0f838be0>]}
[0m15:31:29.395113 [info ] [Thread-1 (]: 3 of 12 OK created sql table model games.dim_platforms ......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 3.79s]
[0m15:31:29.397904 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m15:31:29.399956 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m15:31:29.402065 [info ] [Thread-1 (]: 4 of 12 START sql table model games.dim_price_overview ......................... [RUN]
[0m15:31:29.405318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m15:31:29.407218 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m15:31:29.414304 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m15:31:29.415125 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 15:31:29.408531 => 15:31:29.414896
[0m15:31:29.415514 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m15:31:29.417786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:30.110297 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m15:31:30.113244 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    platform_id,
    windows,
    mac,
    linux,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte, games.dim_platforms
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m15:31:30.604828 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5a128e6e-0c21-4e73-9c17-43d7b38f9c16&page=queryresults
[0m15:31:38.767495 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 15:31:29.415782 => 15:31:38.767316
[0m15:31:38.768194 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3bfbc31-3686-48a4-8171-65191fe2c6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b0ee1a0b0>]}
[0m15:31:38.768753 [info ] [Thread-1 (]: 4 of 12 OK created sql table model games.dim_price_overview .................... [[32mCREATE TABLE (3.1m rows, 199.1 KiB processed)[0m in 9.36s]
[0m15:31:38.769361 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m15:31:38.769820 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m15:31:38.770416 [info ] [Thread-1 (]: 5 of 12 START sql table model games.dim_publishers ............................. [RUN]
[0m15:31:38.771232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m15:31:38.771632 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m15:31:38.774486 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m15:31:38.775144 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 15:31:38.771908 => 15:31:38.774938
[0m15:31:38.775538 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m15:31:38.778027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:39.505980 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m15:31:39.506709 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m15:31:39.982189 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7e4dbe1e-fbd4-45e5-9f5b-c02c6b2a2ed0&page=queryresults
[0m15:31:43.188608 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 15:31:38.775842 => 15:31:43.188426
[0m15:31:43.189304 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3bfbc31-3686-48a4-8171-65191fe2c6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b0efcae30>]}
[0m15:31:43.189862 [info ] [Thread-1 (]: 5 of 12 OK created sql table model games.dim_publishers ........................ [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.42s]
[0m15:31:43.190497 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m15:31:43.190979 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m15:31:43.191540 [info ] [Thread-1 (]: 6 of 12 START sql table model games.dim_release ................................ [RUN]
[0m15:31:43.192181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m15:31:43.192575 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m15:31:43.195356 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m15:31:43.195973 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 15:31:43.192868 => 15:31:43.195784
[0m15:31:43.196335 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m15:31:43.198405 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:43.936600 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m15:31:43.939387 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m15:31:44.569411 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d1d81868-8e77-4f4a-bc32-65aa8932eb36&page=queryresults
[0m15:31:47.021496 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 15:31:43.196591 => 15:31:47.020626
[0m15:31:47.024849 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3bfbc31-3686-48a4-8171-65191fe2c6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b0ee09090>]}
[0m15:31:47.027423 [info ] [Thread-1 (]: 6 of 12 OK created sql table model games.dim_release ........................... [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 3.83s]
[0m15:31:47.030241 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m15:31:47.032314 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m15:31:47.034729 [info ] [Thread-1 (]: 7 of 12 START sql table model games.dim_support_language ....................... [RUN]
[0m15:31:47.037849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m15:31:47.039729 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m15:31:47.050541 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m15:31:47.052164 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 15:31:47.041043 => 15:31:47.051653
[0m15:31:47.053090 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m15:31:47.065257 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:47.799058 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m15:31:47.799705 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m15:31:48.319335 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:4f2f516d-a380-4a8a-b0c0-66d990c97991&page=queryresults
[0m15:31:50.741881 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 15:31:47.053749 => 15:31:50.741013
[0m15:31:50.744996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3bfbc31-3686-48a4-8171-65191fe2c6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b0ee406a0>]}
[0m15:31:50.747542 [info ] [Thread-1 (]: 7 of 12 OK created sql table model games.dim_support_language .................. [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 3.71s]
[0m15:31:50.750328 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m15:31:50.752365 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m15:31:50.754761 [info ] [Thread-1 (]: 8 of 12 START sql table model games.fct_game_pricing ........................... [RUN]
[0m15:31:50.757690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m15:31:50.759533 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m15:31:50.766890 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m15:31:50.767581 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 15:31:50.760828 => 15:31:50.767361
[0m15:31:50.767977 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m15:31:50.770191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:51.479041 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m15:31:51.479862 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para el análisis de precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        formatted_initial_price,
        platform_id,
        SUM(price_with_tax) AS total_sales,
        SUM(discount_amount) AS total_discounts,
        COUNT(*) AS num_sales,
        MAX(discount_pct) AS max_discount,
        MIN(initial_price) AS min_price,
        MAX(initial_price) AS max_price,
        SUM(price_with_tax) AS total_sales_with_tax,
        SUM(final_price) AS total_sales_with_tax_discounted
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id, platform_id, formatted_initial_price
)

SELECT
    fct.app_id,
    fct.formatted_initial_price,
    fct.total_sales,
    fct.total_discounts,
    fct.num_sales,
    fct.max_discount,
    fct.min_price,
    fct.max_price,
    fct.total_sales_with_tax,
    fct.total_sales_with_tax_discounted,
    games.name AS game_name,
    games.description AS game_description,
    games.is_free AS game_is_free,
    games.fullgame_app_id,
    games.fullgame_name,
    games.type,
    games.genre_id,
    games.type_genre,
FROM
    game_sales AS fct
INNER JOIN
    `pristine-flames-400818`.`games`.`dim_games` AS games
ON
    fct.app_id = games.app_id
INNER JOIN 
    `pristine-flames-400818`.`games`.`dim_platforms` AS dp
ON
    fct.platform_id = dp.platform_id
    );
  
[0m15:31:52.068785 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:70408802-fc7c-4f31-a90b-e8172d40c657&page=queryresults
[0m15:32:00.542690 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 15:31:50.768233 => 15:32:00.542503
[0m15:32:00.543374 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3bfbc31-3686-48a4-8171-65191fe2c6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b0ee430d0>]}
[0m15:32:00.543913 [info ] [Thread-1 (]: 8 of 12 OK created sql table model games.fct_game_pricing ...................... [[32mCREATE TABLE (3.1m rows, 252.5 MiB processed)[0m in 9.79s]
[0m15:32:00.544493 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m15:32:00.545333 [debug] [Thread-1 (]: Began running node model.games.platform
[0m15:32:00.545779 [info ] [Thread-1 (]: 9 of 12 START sql table model games.platform ................................... [RUN]
[0m15:32:00.546419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.fct_game_pricing, now model.games.platform)
[0m15:32:00.546817 [debug] [Thread-1 (]: Began compiling node model.games.platform
[0m15:32:00.549853 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.platform"
[0m15:32:00.550462 [debug] [Thread-1 (]: Timing info for model.games.platform (compile): 15:32:00.547097 => 15:32:00.550264
[0m15:32:00.550862 [debug] [Thread-1 (]: Began executing node model.games.platform
[0m15:32:00.553666 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.platform"
[0m15:32:00.554156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:32:00.587288 [debug] [Thread-1 (]: On model.games.platform: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.platform"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`platform`
      
    
    

    OPTIONS()
    as (
      -- Informe de Ingresos por Plataforma
SELECT
    dp.platform_id,
    SUM(fs.price_with_tax) AS total_sales
FROM
    `pristine-flames-400818`.`games`.`dim_platforms` dp
JOIN
    `pristine-flames-400818`.`games`.`fct_game_pricing` fs
ON
    dp.platform_id = fs.platform_id
GROUP BY dp.platform_id
ORDER BY total_sales DESC;
    );
  
[0m15:32:01.284968 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:48f9aac7-3e19-4789-8fe2-5cd9a9a14326&page=queryresults
[0m15:32:01.289120 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [24:26]')
[0m15:32:01.573296 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:6932c12f-b759-420d-84b5-893c1f91991e&page=queryresults
[0m15:32:01.576587 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:6932c12f-b759-420d-84b5-893c1f91991e&page=queryresults
[0m15:32:01.577224 [debug] [Thread-1 (]: Timing info for model.games.platform (execute): 15:32:00.551116 => 15:32:01.577030
[0m15:32:01.580039 [debug] [Thread-1 (]: Database Error in model platform (models/report/platform.sql)
  Syntax error: Expected ")" but got ";" at [24:26]
  compiled Code at target/run/games/models/report/platform.sql
[0m15:32:01.580517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3bfbc31-3686-48a4-8171-65191fe2c6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b0ef99ae0>]}
[0m15:32:01.581108 [error] [Thread-1 (]: 9 of 12 ERROR creating sql table model games.platform .......................... [[31mERROR[0m in 1.03s]
[0m15:32:01.581722 [debug] [Thread-1 (]: Finished running node model.games.platform
[0m15:32:01.582171 [debug] [Thread-1 (]: Began running node model.games.top_10_discounted_games
[0m15:32:01.582726 [info ] [Thread-1 (]: 10 of 12 START sql table model games.top_10_discounted_games ................... [RUN]
[0m15:32:01.583443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.platform, now model.games.top_10_discounted_games)
[0m15:32:01.583847 [debug] [Thread-1 (]: Began compiling node model.games.top_10_discounted_games
[0m15:32:01.586844 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_discounted_games"
[0m15:32:01.587518 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (compile): 15:32:01.584134 => 15:32:01.587304
[0m15:32:01.587937 [debug] [Thread-1 (]: Began executing node model.games.top_10_discounted_games
[0m15:32:01.597549 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:32:02.334218 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_discounted_games"
[0m15:32:02.334993 [debug] [Thread-1 (]: On model.games.top_10_discounted_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_discounted_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_discounted_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 descuentos más grandes
SELECT
    app_id,
    game_name,
    total_discounts
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY total_discounts DESC
LIMIT 10
    );
  
[0m15:32:02.784847 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7b580e74-0792-43d2-9252-4e82f70cf4a3&page=queryresults
[0m15:32:05.172634 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (execute): 15:32:01.588223 => 15:32:05.172451
[0m15:32:05.173338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3bfbc31-3686-48a4-8171-65191fe2c6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b0ee36da0>]}
[0m15:32:05.173898 [info ] [Thread-1 (]: 10 of 12 OK created sql table model games.top_10_discounted_games .............. [[32mCREATE TABLE (10.0 rows, 162.8 MiB processed)[0m in 3.59s]
[0m15:32:05.174510 [debug] [Thread-1 (]: Finished running node model.games.top_10_discounted_games
[0m15:32:05.174993 [debug] [Thread-1 (]: Began running node model.games.top_10_high_tax_games
[0m15:32:05.175552 [info ] [Thread-1 (]: 11 of 12 START sql table model games.top_10_high_tax_games ..................... [RUN]
[0m15:32:05.176217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_discounted_games, now model.games.top_10_high_tax_games)
[0m15:32:05.176598 [debug] [Thread-1 (]: Began compiling node model.games.top_10_high_tax_games
[0m15:32:05.179407 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_high_tax_games"
[0m15:32:05.180040 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (compile): 15:32:05.176870 => 15:32:05.179842
[0m15:32:05.180424 [debug] [Thread-1 (]: Began executing node model.games.top_10_high_tax_games
[0m15:32:05.182581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:32:05.852428 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_high_tax_games"
[0m15:32:05.853509 [debug] [Thread-1 (]: On model.games.top_10_high_tax_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_high_tax_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_high_tax_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos con más impuestos
SELECT
    app_id,
    game_name,
    SUM(total_sales_with_tax) AS total_taxes
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
GROUP BY app_id, game_name
ORDER BY total_taxes DESC, game_name DESC
LIMIT 10
    );
  
[0m15:32:06.387293 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:54f5956e-4680-41f7-9fb6-6344714d7b4a&page=queryresults
[0m15:32:21.867283 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (execute): 15:32:05.180694 => 15:32:21.866663
[0m15:32:21.869473 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3bfbc31-3686-48a4-8171-65191fe2c6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b0ee03bb0>]}
[0m15:32:21.871262 [info ] [Thread-1 (]: 11 of 12 OK created sql table model games.top_10_high_tax_games ................ [[32mCREATE TABLE (10.0 rows, 162.8 MiB processed)[0m in 16.69s]
[0m15:32:21.873246 [debug] [Thread-1 (]: Finished running node model.games.top_10_high_tax_games
[0m15:32:21.874684 [debug] [Thread-1 (]: Began running node model.games.top_10_most_expensive_games
[0m15:32:21.876362 [info ] [Thread-1 (]: 12 of 12 START sql table model games.top_10_most_expensive_games ............... [RUN]
[0m15:32:21.878417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_high_tax_games, now model.games.top_10_most_expensive_games)
[0m15:32:21.879709 [debug] [Thread-1 (]: Began compiling node model.games.top_10_most_expensive_games
[0m15:32:21.888342 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_most_expensive_games"
[0m15:32:21.890581 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (compile): 15:32:21.880615 => 15:32:21.889835
[0m15:32:21.891617 [debug] [Thread-1 (]: Began executing node model.games.top_10_most_expensive_games
[0m15:32:21.896681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:32:22.598215 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_most_expensive_games"
[0m15:32:22.598983 [debug] [Thread-1 (]: On model.games.top_10_most_expensive_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_most_expensive_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_most_expensive_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos más caros
SELECT
    app_id,
    game_name,
    max_price,
    formatted_initial_price,
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY max_price DESC
LIMIT 10
    );
  
[0m15:32:23.117267 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:0eb660e4-e95c-4db0-9bd4-abcf432fabc7&page=queryresults
[0m15:32:25.785729 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (execute): 15:32:21.892288 => 15:32:25.785544
[0m15:32:25.786453 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3bfbc31-3686-48a4-8171-65191fe2c6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b0ee032b0>]}
[0m15:32:25.787062 [info ] [Thread-1 (]: 12 of 12 OK created sql table model games.top_10_most_expensive_games .......... [[32mCREATE TABLE (10.0 rows, 177.7 MiB processed)[0m in 3.91s]
[0m15:32:25.787675 [debug] [Thread-1 (]: Finished running node model.games.top_10_most_expensive_games
[0m15:32:25.789140 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:32:25.789473 [debug] [MainThread]: Connection 'model.games.top_10_most_expensive_games' was properly closed.
[0m15:32:25.789843 [info ] [MainThread]: 
[0m15:32:25.790225 [info ] [MainThread]: Finished running 12 table models in 0 hours 1 minutes and 9.40 seconds (69.40s).
[0m15:32:25.792465 [debug] [MainThread]: Command end result
[0m15:32:25.807316 [info ] [MainThread]: 
[0m15:32:25.807755 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:32:25.808116 [info ] [MainThread]: 
[0m15:32:25.808484 [error] [MainThread]:   Database Error in model platform (models/report/platform.sql)
  Syntax error: Expected ")" but got ";" at [24:26]
  compiled Code at target/run/games/models/report/platform.sql
[0m15:32:25.808881 [info ] [MainThread]: 
[0m15:32:25.809249 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m15:32:25.809847 [debug] [MainThread]: Command `dbt run` failed at 15:32:25.809753 after 69.85 seconds
[0m15:32:25.810226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b13a22a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b12fb13f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b0c586b30>]}
[0m15:32:25.810659 [debug] [MainThread]: Flushing usage events
[0m15:33:24.955506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc64891d180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6469c0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6469c00d0>]}


============================== 15:33:24.957735 | 31ee374b-41da-4f8b-878c-6d0e12dcaf14 ==============================
[0m15:33:24.957735 [info ] [MainThread]: Running with dbt=1.6.5
[0m15:33:24.958208 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:33:25.250991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31ee374b-41da-4f8b-878c-6d0e12dcaf14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc647e92620>]}
[0m15:33:25.267289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31ee374b-41da-4f8b-878c-6d0e12dcaf14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc64495c9d0>]}
[0m15:33:25.267971 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m15:33:25.282512 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m15:33:25.349484 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:33:25.350058 [debug] [MainThread]: Partial parsing: updated file: games://models/report/platform.sql
[0m15:33:25.395871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31ee374b-41da-4f8b-878c-6d0e12dcaf14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc63fd4e380>]}
[0m15:33:25.405664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31ee374b-41da-4f8b-878c-6d0e12dcaf14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6447939d0>]}
[0m15:33:25.406207 [info ] [MainThread]: Found 12 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m15:33:25.406616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31ee374b-41da-4f8b-878c-6d0e12dcaf14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc644793a00>]}
[0m15:33:25.408227 [info ] [MainThread]: 
[0m15:33:25.409156 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:33:25.410806 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m15:33:25.411230 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:26.116605 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m15:33:26.117208 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:33:26.778359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31ee374b-41da-4f8b-878c-6d0e12dcaf14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6447928c0>]}
[0m15:33:26.779161 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:33:26.779547 [info ] [MainThread]: 
[0m15:33:26.781666 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m15:33:26.782306 [info ] [Thread-1 (]: 1 of 12 START sql table model games.dim_developers ............................. [RUN]
[0m15:33:26.783201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m15:33:26.783651 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m15:33:26.791511 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m15:33:26.792232 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 15:33:26.783943 => 15:33:26.792018
[0m15:33:26.792640 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m15:33:26.807195 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:27.508365 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m15:33:27.509032 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS developer_id,
    developers_name
FROM
    developers_cte
    );
  
[0m15:33:27.945275 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9a224f7f-0e15-4c7e-98f0-e328656af137&page=queryresults
[0m15:33:30.984806 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 15:33:26.792925 => 15:33:30.984616
[0m15:33:30.985530 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31ee374b-41da-4f8b-878c-6d0e12dcaf14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc644772d40>]}
[0m15:33:30.986148 [info ] [Thread-1 (]: 1 of 12 OK created sql table model games.dim_developers ........................ [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.20s]
[0m15:33:30.986815 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m15:33:30.987282 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m15:33:30.987813 [info ] [Thread-1 (]: 2 of 12 START sql table model games.dim_games .................................. [RUN]
[0m15:33:30.988472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m15:33:30.988840 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m15:33:30.998343 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m15:33:30.999083 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 15:33:30.989105 => 15:33:30.998881
[0m15:33:30.999464 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m15:33:31.001859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:31.665393 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m15:33:31.666208 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m15:33:32.090574 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:94767731-e8f8-463d-8751-000d20fb95cb&page=queryresults
[0m15:33:34.452258 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 15:33:30.999780 => 15:33:34.451886
[0m15:33:34.453777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31ee374b-41da-4f8b-878c-6d0e12dcaf14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc644770eb0>]}
[0m15:33:34.454920 [info ] [Thread-1 (]: 2 of 12 OK created sql table model games.dim_games ............................. [[32mCREATE TABLE (2.7k rows, 753.9 KiB processed)[0m in 3.47s]
[0m15:33:34.456033 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m15:33:34.456841 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m15:33:34.457797 [info ] [Thread-1 (]: 3 of 12 START sql table model games.dim_platforms .............................. [RUN]
[0m15:33:34.458989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m15:33:34.459737 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m15:33:34.464894 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m15:33:34.466136 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 15:33:34.460267 => 15:33:34.465706
[0m15:33:34.466990 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m15:33:34.471035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:35.141008 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m15:33:35.141642 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m15:33:35.578066 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:44d0d6ee-93d6-43b4-b927-d418d7606cdf&page=queryresults
[0m15:33:37.946610 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 15:33:34.467565 => 15:33:37.946089
[0m15:33:37.948315 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31ee374b-41da-4f8b-878c-6d0e12dcaf14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc644770dc0>]}
[0m15:33:37.949698 [info ] [Thread-1 (]: 3 of 12 OK created sql table model games.dim_platforms ......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 3.49s]
[0m15:33:37.951517 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m15:33:37.952718 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m15:33:37.954028 [info ] [Thread-1 (]: 4 of 12 START sql table model games.dim_price_overview ......................... [RUN]
[0m15:33:37.955620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m15:33:37.956577 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m15:33:37.962402 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m15:33:37.963685 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 15:33:37.957237 => 15:33:37.963280
[0m15:33:37.964574 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m15:33:37.968760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:38.673653 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m15:33:38.674784 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    platform_id,
    windows,
    mac,
    linux,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte, games.dim_platforms
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m15:33:39.238413 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:64de09e8-4407-4134-8342-e288640234be&page=queryresults
[0m15:33:44.334110 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 15:33:37.965267 => 15:33:44.333845
[0m15:33:44.335106 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31ee374b-41da-4f8b-878c-6d0e12dcaf14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc63fc4d1b0>]}
[0m15:33:44.335951 [info ] [Thread-1 (]: 4 of 12 OK created sql table model games.dim_price_overview .................... [[32mCREATE TABLE (3.1m rows, 199.1 KiB processed)[0m in 6.38s]
[0m15:33:44.336937 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m15:33:44.337654 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m15:33:44.338446 [info ] [Thread-1 (]: 5 of 12 START sql table model games.dim_publishers ............................. [RUN]
[0m15:33:44.339283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m15:33:44.339751 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m15:33:44.343270 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m15:33:44.343998 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 15:33:44.340077 => 15:33:44.343784
[0m15:33:44.344419 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m15:33:44.346853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:45.038261 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m15:33:45.039669 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m15:33:45.517671 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:789f9ec1-d804-4390-afcc-d490c81b70c3&page=queryresults
[0m15:33:48.278978 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 15:33:44.344710 => 15:33:48.278720
[0m15:33:48.279876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31ee374b-41da-4f8b-878c-6d0e12dcaf14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc63fde5030>]}
[0m15:33:48.280599 [info ] [Thread-1 (]: 5 of 12 OK created sql table model games.dim_publishers ........................ [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 3.94s]
[0m15:33:48.281390 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m15:33:48.281970 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m15:33:48.282833 [info ] [Thread-1 (]: 6 of 12 START sql table model games.dim_release ................................ [RUN]
[0m15:33:48.283860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m15:33:48.284435 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m15:33:48.288585 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m15:33:48.289531 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 15:33:48.284832 => 15:33:48.289244
[0m15:33:48.290085 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m15:33:48.293267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:48.988588 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m15:33:48.989720 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m15:33:49.512515 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:af764d6e-c6ae-4592-9a87-5549a1156b89&page=queryresults
[0m15:33:52.197772 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 15:33:48.290472 => 15:33:52.197463
[0m15:33:52.198946 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31ee374b-41da-4f8b-878c-6d0e12dcaf14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc63fc4c310>]}
[0m15:33:52.199842 [info ] [Thread-1 (]: 6 of 12 OK created sql table model games.dim_release ........................... [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 3.92s]
[0m15:33:52.200806 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m15:33:52.201500 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m15:33:52.202337 [info ] [Thread-1 (]: 7 of 12 START sql table model games.dim_support_language ....................... [RUN]
[0m15:33:52.203473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m15:33:52.204254 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m15:33:52.209001 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m15:33:52.210115 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 15:33:52.204787 => 15:33:52.209744
[0m15:33:52.210804 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m15:33:52.221370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:52.934973 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m15:33:52.936607 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m15:33:53.383238 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:81545f9c-8798-4051-bb0c-079a2e1538e7&page=queryresults
[0m15:33:56.056372 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 15:33:52.211257 => 15:33:56.056004
[0m15:33:56.057700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31ee374b-41da-4f8b-878c-6d0e12dcaf14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc63fc804c0>]}
[0m15:33:56.058880 [info ] [Thread-1 (]: 7 of 12 OK created sql table model games.dim_support_language .................. [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 3.85s]
[0m15:33:56.060245 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m15:33:56.061141 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m15:33:56.062167 [info ] [Thread-1 (]: 8 of 12 START sql table model games.fct_game_pricing ........................... [RUN]
[0m15:33:56.063440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m15:33:56.064184 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m15:33:56.069871 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m15:33:56.070991 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 15:33:56.064714 => 15:33:56.070640
[0m15:33:56.071775 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m15:33:56.075206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:56.759665 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m15:33:56.760397 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para el análisis de precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        formatted_initial_price,
        platform_id,
        SUM(price_with_tax) AS total_sales,
        SUM(discount_amount) AS total_discounts,
        COUNT(*) AS num_sales,
        MAX(discount_pct) AS max_discount,
        MIN(initial_price) AS min_price,
        MAX(initial_price) AS max_price,
        SUM(price_with_tax) AS total_sales_with_tax,
        SUM(final_price) AS total_sales_with_tax_discounted
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id, platform_id, formatted_initial_price
)

SELECT
    fct.app_id,
    fct.formatted_initial_price,
    fct.total_sales,
    fct.total_discounts,
    fct.num_sales,
    fct.max_discount,
    fct.min_price,
    fct.max_price,
    fct.total_sales_with_tax,
    fct.total_sales_with_tax_discounted,
    games.name AS game_name,
    games.description AS game_description,
    games.is_free AS game_is_free,
    games.fullgame_app_id,
    games.fullgame_name,
    games.type,
    games.genre_id,
    games.type_genre,
FROM
    game_sales AS fct
INNER JOIN
    `pristine-flames-400818`.`games`.`dim_games` AS games
ON
    fct.app_id = games.app_id
INNER JOIN 
    `pristine-flames-400818`.`games`.`dim_platforms` AS dp
ON
    fct.platform_id = dp.platform_id
    );
  
[0m15:33:57.231659 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b1d3bdae-3901-43dd-9dcd-60e1f11feac0&page=queryresults
[0m15:34:06.132176 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 15:33:56.072317 => 15:34:06.131640
[0m15:34:06.133894 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31ee374b-41da-4f8b-878c-6d0e12dcaf14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc644773010>]}
[0m15:34:06.135272 [info ] [Thread-1 (]: 8 of 12 OK created sql table model games.fct_game_pricing ...................... [[32mCREATE TABLE (3.1m rows, 252.5 MiB processed)[0m in 10.07s]
[0m15:34:06.136656 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m15:34:06.138132 [debug] [Thread-1 (]: Began running node model.games.platform
[0m15:34:06.139256 [info ] [Thread-1 (]: 9 of 12 START sql table model games.platform ................................... [RUN]
[0m15:34:06.140772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.fct_game_pricing, now model.games.platform)
[0m15:34:06.141691 [debug] [Thread-1 (]: Began compiling node model.games.platform
[0m15:34:06.146638 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.platform"
[0m15:34:06.147602 [debug] [Thread-1 (]: Timing info for model.games.platform (compile): 15:34:06.142232 => 15:34:06.147293
[0m15:34:06.148253 [debug] [Thread-1 (]: Began executing node model.games.platform
[0m15:34:06.152268 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.platform"
[0m15:34:06.152990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:06.188024 [debug] [Thread-1 (]: On model.games.platform: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.platform"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`platform`
      
    
    

    OPTIONS()
    as (
      -- Informe de Ingresos por Plataforma
SELECT
    dp.platform_id,
    SUM(fs.price_with_tax) AS total_sales
FROM
    `pristine-flames-400818`.`games`.`dim_platforms` dp
JOIN
    `pristine-flames-400818`.`games`.`fct_game_pricing` fs
ON
    dp.platform_id = fs.platform_id
GROUP BY dp.platform_id
ORDER BY total_sales DESC
    );
  
[0m15:34:07.026877 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d55582c9-1e3f-4258-bc41-3722b0c8121f&page=queryresults
[0m15:34:07.526976 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name platform_id not found inside fs at [22:25]')
[0m15:34:08.658373 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:84c448a1-3ad5-48db-b51c-6c73252d21e2&page=queryresults
[0m15:34:09.138752 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:84c448a1-3ad5-48db-b51c-6c73252d21e2&page=queryresults
[0m15:34:09.139815 [debug] [Thread-1 (]: Timing info for model.games.platform (execute): 15:34:06.148646 => 15:34:09.139496
[0m15:34:09.144107 [debug] [Thread-1 (]: Database Error in model platform (models/report/platform.sql)
  Name platform_id not found inside fs at [22:25]
  compiled Code at target/run/games/models/report/platform.sql
[0m15:34:09.144771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31ee374b-41da-4f8b-878c-6d0e12dcaf14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc63fdd9780>]}
[0m15:34:09.145544 [error] [Thread-1 (]: 9 of 12 ERROR creating sql table model games.platform .......................... [[31mERROR[0m in 3.00s]
[0m15:34:09.146349 [debug] [Thread-1 (]: Finished running node model.games.platform
[0m15:34:09.146952 [debug] [Thread-1 (]: Began running node model.games.top_10_discounted_games
[0m15:34:09.147660 [info ] [Thread-1 (]: 10 of 12 START sql table model games.top_10_discounted_games ................... [RUN]
[0m15:34:09.148657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.platform, now model.games.top_10_discounted_games)
[0m15:34:09.149313 [debug] [Thread-1 (]: Began compiling node model.games.top_10_discounted_games
[0m15:34:09.153509 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_discounted_games"
[0m15:34:09.154507 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (compile): 15:34:09.149776 => 15:34:09.154165
[0m15:34:09.155091 [debug] [Thread-1 (]: Began executing node model.games.top_10_discounted_games
[0m15:34:09.166160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:09.839421 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_discounted_games"
[0m15:34:09.840350 [debug] [Thread-1 (]: On model.games.top_10_discounted_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_discounted_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_discounted_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 descuentos más grandes
SELECT
    app_id,
    game_name,
    total_discounts
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY total_discounts DESC
LIMIT 10
    );
  
[0m15:34:10.264229 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d27aeeba-9c0e-47e9-a8c5-ffd04d6e554d&page=queryresults
[0m15:34:12.724889 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (execute): 15:34:09.155472 => 15:34:12.724004
[0m15:34:12.728065 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31ee374b-41da-4f8b-878c-6d0e12dcaf14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc63fc276a0>]}
[0m15:34:12.730666 [info ] [Thread-1 (]: 10 of 12 OK created sql table model games.top_10_discounted_games .............. [[32mCREATE TABLE (10.0 rows, 162.8 MiB processed)[0m in 3.58s]
[0m15:34:12.733513 [debug] [Thread-1 (]: Finished running node model.games.top_10_discounted_games
[0m15:34:12.735591 [debug] [Thread-1 (]: Began running node model.games.top_10_high_tax_games
[0m15:34:12.737996 [info ] [Thread-1 (]: 11 of 12 START sql table model games.top_10_high_tax_games ..................... [RUN]
[0m15:34:12.740998 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_discounted_games, now model.games.top_10_high_tax_games)
[0m15:34:12.742858 [debug] [Thread-1 (]: Began compiling node model.games.top_10_high_tax_games
[0m15:34:12.752447 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_high_tax_games"
[0m15:34:12.754012 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (compile): 15:34:12.744156 => 15:34:12.753521
[0m15:34:12.754968 [debug] [Thread-1 (]: Began executing node model.games.top_10_high_tax_games
[0m15:34:12.759331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:13.449640 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_high_tax_games"
[0m15:34:13.450342 [debug] [Thread-1 (]: On model.games.top_10_high_tax_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_high_tax_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_high_tax_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos con más impuestos
SELECT
    app_id,
    game_name,
    SUM(total_sales_with_tax) AS total_taxes
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
GROUP BY app_id, game_name
ORDER BY total_taxes DESC, game_name DESC
LIMIT 10
    );
  
[0m15:34:13.879726 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f7d15277-282c-4903-82a5-fea260555bf6&page=queryresults
[0m15:34:16.043225 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (execute): 15:34:12.755640 => 15:34:16.042311
[0m15:34:16.046311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31ee374b-41da-4f8b-878c-6d0e12dcaf14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc63fc24100>]}
[0m15:34:16.048916 [info ] [Thread-1 (]: 11 of 12 OK created sql table model games.top_10_high_tax_games ................ [[32mCREATE TABLE (10.0 rows, 162.8 MiB processed)[0m in 3.31s]
[0m15:34:16.051773 [debug] [Thread-1 (]: Finished running node model.games.top_10_high_tax_games
[0m15:34:16.053834 [debug] [Thread-1 (]: Began running node model.games.top_10_most_expensive_games
[0m15:34:16.056285 [info ] [Thread-1 (]: 12 of 12 START sql table model games.top_10_most_expensive_games ............... [RUN]
[0m15:34:16.059270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_high_tax_games, now model.games.top_10_most_expensive_games)
[0m15:34:16.061106 [debug] [Thread-1 (]: Began compiling node model.games.top_10_most_expensive_games
[0m15:34:16.071396 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_most_expensive_games"
[0m15:34:16.072954 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (compile): 15:34:16.062411 => 15:34:16.072462
[0m15:34:16.073887 [debug] [Thread-1 (]: Began executing node model.games.top_10_most_expensive_games
[0m15:34:16.078618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:16.770215 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_most_expensive_games"
[0m15:34:16.773068 [debug] [Thread-1 (]: On model.games.top_10_most_expensive_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_most_expensive_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_most_expensive_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos más caros
SELECT
    app_id,
    game_name,
    max_price,
    formatted_initial_price,
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY max_price DESC
LIMIT 10
    );
  
[0m15:34:17.301464 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:964678c7-7a68-4eb3-a5a8-1e66688107ca&page=queryresults
[0m15:34:19.410697 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (execute): 15:34:16.074568 => 15:34:19.410461
[0m15:34:19.411416 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31ee374b-41da-4f8b-878c-6d0e12dcaf14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc63fc27010>]}
[0m15:34:19.411969 [info ] [Thread-1 (]: 12 of 12 OK created sql table model games.top_10_most_expensive_games .......... [[32mCREATE TABLE (10.0 rows, 177.7 MiB processed)[0m in 3.35s]
[0m15:34:19.412539 [debug] [Thread-1 (]: Finished running node model.games.top_10_most_expensive_games
[0m15:34:19.413931 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:34:19.414255 [debug] [MainThread]: Connection 'model.games.top_10_most_expensive_games' was properly closed.
[0m15:34:19.414660 [info ] [MainThread]: 
[0m15:34:19.415000 [info ] [MainThread]: Finished running 12 table models in 0 hours 0 minutes and 54.01 seconds (54.01s).
[0m15:34:19.417144 [debug] [MainThread]: Command end result
[0m15:34:19.431934 [info ] [MainThread]: 
[0m15:34:19.432349 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:34:19.432663 [info ] [MainThread]: 
[0m15:34:19.432974 [error] [MainThread]:   Database Error in model platform (models/report/platform.sql)
  Name platform_id not found inside fs at [22:25]
  compiled Code at target/run/games/models/report/platform.sql
[0m15:34:19.433322 [info ] [MainThread]: 
[0m15:34:19.433667 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m15:34:19.434196 [debug] [MainThread]: Command `dbt run` failed at 15:34:19.434102 after 54.49 seconds
[0m15:34:19.434588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc64891d180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc63d3c9bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc63d3c9f90>]}
[0m15:34:19.434951 [debug] [MainThread]: Flushing usage events
[0m15:35:24.482231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f273af22b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2738fc4070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2738fc40d0>]}


============================== 15:35:24.484326 | ee1afddc-c198-44ae-b31b-ece2f11b4f39 ==============================
[0m15:35:24.484326 [info ] [MainThread]: Running with dbt=1.6.5
[0m15:35:24.484866 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'profiles_dir': '../dbt/', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'send_anonymous_usage_stats': 'True'}
[0m15:35:24.768411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee1afddc-c198-44ae-b31b-ece2f11b4f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f273a4b1cf0>]}
[0m15:35:24.784157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee1afddc-c198-44ae-b31b-ece2f11b4f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2736f609d0>]}
[0m15:35:24.784713 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m15:35:24.799004 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m15:35:24.864165 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:35:24.864731 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m15:35:24.910324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee1afddc-c198-44ae-b31b-ece2f11b4f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f273644a3b0>]}
[0m15:35:24.919789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee1afddc-c198-44ae-b31b-ece2f11b4f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2736d97a00>]}
[0m15:35:24.920257 [info ] [MainThread]: Found 12 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m15:35:24.920605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee1afddc-c198-44ae-b31b-ece2f11b4f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2736d97a30>]}
[0m15:35:24.922049 [info ] [MainThread]: 
[0m15:35:24.922744 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:35:24.924129 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m15:35:24.924539 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:35:25.748326 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m15:35:25.748742 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:35:26.432312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee1afddc-c198-44ae-b31b-ece2f11b4f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2736d968f0>]}
[0m15:35:26.433145 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:35:26.433531 [info ] [MainThread]: 
[0m15:35:26.435608 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m15:35:26.436107 [info ] [Thread-1 (]: 1 of 12 START sql table model games.dim_developers ............................. [RUN]
[0m15:35:26.436832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m15:35:26.437228 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m15:35:26.444329 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m15:35:26.445070 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 15:35:26.437488 => 15:35:26.444815
[0m15:35:26.445557 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m15:35:26.458391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:27.221579 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m15:35:27.222470 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS developer_id,
    developers_name
FROM
    developers_cte
    );
  
[0m15:35:27.837823 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:522e8018-5888-4757-b73c-e8846bc0b7c3&page=queryresults
[0m15:35:30.278509 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 15:35:26.445841 => 15:35:30.278179
[0m15:35:30.279654 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee1afddc-c198-44ae-b31b-ece2f11b4f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2736d78970>]}
[0m15:35:30.280607 [info ] [Thread-1 (]: 1 of 12 OK created sql table model games.dim_developers ........................ [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 3.84s]
[0m15:35:30.281612 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m15:35:30.282224 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m15:35:30.282966 [info ] [Thread-1 (]: 2 of 12 START sql table model games.dim_games .................................. [RUN]
[0m15:35:30.283870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m15:35:30.284419 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m15:35:30.293766 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m15:35:30.294534 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 15:35:30.284803 => 15:35:30.294293
[0m15:35:30.294946 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m15:35:30.297311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:31.025130 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m15:35:31.027953 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m15:35:31.675910 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:00e1d366-69b1-4028-954c-ae06c33522f4&page=queryresults
[0m15:35:34.359516 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 15:35:30.295238 => 15:35:34.358635
[0m15:35:34.362770 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee1afddc-c198-44ae-b31b-ece2f11b4f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2736d7b340>]}
[0m15:35:34.365351 [info ] [Thread-1 (]: 2 of 12 OK created sql table model games.dim_games ............................. [[32mCREATE TABLE (2.7k rows, 753.9 KiB processed)[0m in 4.08s]
[0m15:35:34.368274 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m15:35:34.370325 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m15:35:34.372451 [info ] [Thread-1 (]: 3 of 12 START sql table model games.dim_platforms .............................. [RUN]
[0m15:35:34.374745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m15:35:34.376115 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m15:35:34.382673 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m15:35:34.383905 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 15:35:34.376936 => 15:35:34.383493
[0m15:35:34.384646 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m15:35:34.388367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:35.104525 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m15:35:35.107258 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m15:35:35.728910 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c39268b1-22eb-4445-bece-d0d9557fbaf3&page=queryresults
[0m15:35:38.310559 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 15:35:34.385184 => 15:35:38.309625
[0m15:35:38.313723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee1afddc-c198-44ae-b31b-ece2f11b4f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2736d7b2e0>]}
[0m15:35:38.316332 [info ] [Thread-1 (]: 3 of 12 OK created sql table model games.dim_platforms ......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 3.94s]
[0m15:35:38.319238 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m15:35:38.321358 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m15:35:38.323937 [info ] [Thread-1 (]: 4 of 12 START sql table model games.dim_price_overview ......................... [RUN]
[0m15:35:38.327027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m15:35:38.328974 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m15:35:38.341107 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m15:35:38.342894 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 15:35:38.330664 => 15:35:38.342320
[0m15:35:38.343909 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m15:35:38.349008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:39.071627 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m15:35:39.075058 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    platform_id,
    windows,
    mac,
    linux,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte, games.dim_platforms
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m15:35:39.775271 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:40be2fa3-9c3d-491b-aee1-8fc130ccaab7&page=queryresults
[0m15:35:46.013655 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 15:35:38.344584 => 15:35:46.013468
[0m15:35:46.014348 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee1afddc-c198-44ae-b31b-ece2f11b4f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2736349420>]}
[0m15:35:46.014962 [info ] [Thread-1 (]: 4 of 12 OK created sql table model games.dim_price_overview .................... [[32mCREATE TABLE (3.1m rows, 199.1 KiB processed)[0m in 7.69s]
[0m15:35:46.015570 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m15:35:46.016043 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m15:35:46.016522 [info ] [Thread-1 (]: 5 of 12 START sql table model games.dim_publishers ............................. [RUN]
[0m15:35:46.017360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m15:35:46.017773 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m15:35:46.020866 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m15:35:46.021562 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 15:35:46.018072 => 15:35:46.021352
[0m15:35:46.022002 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m15:35:46.024625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:46.769255 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m15:35:46.771989 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m15:35:47.253377 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:36e87f58-9f52-4072-b211-f4055202b567&page=queryresults
[0m15:35:49.945186 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 15:35:46.022306 => 15:35:49.944281
[0m15:35:49.948435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee1afddc-c198-44ae-b31b-ece2f11b4f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27364e51e0>]}
[0m15:35:49.951168 [info ] [Thread-1 (]: 5 of 12 OK created sql table model games.dim_publishers ........................ [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 3.93s]
[0m15:35:49.954130 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m15:35:49.956242 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m15:35:49.958722 [info ] [Thread-1 (]: 6 of 12 START sql table model games.dim_release ................................ [RUN]
[0m15:35:49.961721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m15:35:49.963031 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m15:35:49.970846 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m15:35:49.972296 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 15:35:49.963960 => 15:35:49.971885
[0m15:35:49.973080 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m15:35:49.977524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:50.711382 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m15:35:50.714067 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m15:35:51.134729 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:4fd215e3-4dec-4044-a87e-596ae0cfac62&page=queryresults
[0m15:35:53.515274 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 15:35:49.973635 => 15:35:53.514277
[0m15:35:53.518679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee1afddc-c198-44ae-b31b-ece2f11b4f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2736348520>]}
[0m15:35:53.521258 [info ] [Thread-1 (]: 6 of 12 OK created sql table model games.dim_release ........................... [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 3.56s]
[0m15:35:53.524153 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m15:35:53.526233 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m15:35:53.528731 [info ] [Thread-1 (]: 7 of 12 START sql table model games.dim_support_language ....................... [RUN]
[0m15:35:53.531897 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m15:35:53.533771 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m15:35:53.543206 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m15:35:53.544777 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 15:35:53.535141 => 15:35:53.544285
[0m15:35:53.545724 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m15:35:53.557720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:54.323971 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m15:35:54.324671 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m15:35:54.755726 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:911832d8-0120-4a86-bb14-238b925b0905&page=queryresults
[0m15:35:57.385901 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 15:35:53.546397 => 15:35:57.385598
[0m15:35:57.387018 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee1afddc-c198-44ae-b31b-ece2f11b4f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2736380940>]}
[0m15:35:57.388008 [info ] [Thread-1 (]: 7 of 12 OK created sql table model games.dim_support_language .................. [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 3.86s]
[0m15:35:57.389189 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m15:35:57.389897 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m15:35:57.390703 [info ] [Thread-1 (]: 8 of 12 START sql table model games.fct_game_pricing ........................... [RUN]
[0m15:35:57.391705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m15:35:57.392309 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m15:35:57.397744 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m15:35:57.398803 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 15:35:57.392731 => 15:35:57.398470
[0m15:35:57.399417 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m15:35:57.403096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:58.098826 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m15:35:58.101806 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para el análisis de precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        formatted_initial_price,
        platform_id,
        SUM(price_with_tax) AS total_sales,
        SUM(discount_amount) AS total_discounts,
        COUNT(*) AS num_sales,
        MAX(discount_pct) AS max_discount,
        MIN(initial_price) AS min_price,
        MAX(initial_price) AS max_price,
        SUM(price_with_tax) AS total_sales_with_tax,
        SUM(final_price) AS total_sales_with_tax_discounted
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id, platform_id, formatted_initial_price
)

SELECT
    fct.app_id,
    fct.formatted_initial_price,
    fct.total_sales,
    fct.platform_id
    fct.total_discounts,
    fct.num_sales,
    fct.max_discount,
    fct.min_price,
    fct.max_price,
    fct.total_sales_with_tax,
    fct.total_sales_with_tax_discounted,
    games.name AS game_name,
    games.description AS game_description,
    games.is_free AS game_is_free,
    games.fullgame_app_id,
    games.fullgame_name,
    games.type,
    games.genre_id,
    games.type_genre,
FROM
    game_sales AS fct
INNER JOIN
    `pristine-flames-400818`.`games`.`dim_games` AS games
ON
    fct.app_id = games.app_id
INNER JOIN 
    `pristine-flames-400818`.`games`.`dim_platforms` AS dp
ON
    fct.platform_id = dp.platform_id
    );
  
[0m15:35:58.421535 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:99a04504-a256-4576-9443-1b5ab9ffa1f1&page=queryresults
[0m15:35:58.425830 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got "." at [39:8]')
[0m15:35:58.937372 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5e09a3f7-df4d-4e0e-a87e-94913a7a646b&page=queryresults
[0m15:35:58.940457 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5e09a3f7-df4d-4e0e-a87e-94913a7a646b&page=queryresults
[0m15:35:58.942617 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 15:35:57.399850 => 15:35:58.941938
[0m15:35:58.951728 [debug] [Thread-1 (]: Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Syntax error: Expected ")" but got "." at [39:8]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m15:35:58.953190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee1afddc-c198-44ae-b31b-ece2f11b4f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27363805e0>]}
[0m15:35:58.955023 [error] [Thread-1 (]: 8 of 12 ERROR creating sql table model games.fct_game_pricing .................. [[31mERROR[0m in 1.56s]
[0m15:35:58.956994 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m15:35:58.959880 [debug] [Thread-1 (]: Began running node model.games.platform
[0m15:35:58.961504 [info ] [Thread-1 (]: 9 of 12 SKIP relation games.platform ........................................... [[33mSKIP[0m]
[0m15:35:58.963121 [debug] [Thread-1 (]: Finished running node model.games.platform
[0m15:35:58.964551 [debug] [Thread-1 (]: Began running node model.games.top_10_discounted_games
[0m15:35:58.966070 [info ] [Thread-1 (]: 10 of 12 SKIP relation games.top_10_discounted_games ........................... [[33mSKIP[0m]
[0m15:35:58.967350 [debug] [Thread-1 (]: Finished running node model.games.top_10_discounted_games
[0m15:35:58.968396 [debug] [Thread-1 (]: Began running node model.games.top_10_high_tax_games
[0m15:35:58.969527 [info ] [Thread-1 (]: 11 of 12 SKIP relation games.top_10_high_tax_games ............................. [[33mSKIP[0m]
[0m15:35:58.970696 [debug] [Thread-1 (]: Finished running node model.games.top_10_high_tax_games
[0m15:35:58.971784 [debug] [Thread-1 (]: Began running node model.games.top_10_most_expensive_games
[0m15:35:58.972709 [info ] [Thread-1 (]: 12 of 12 SKIP relation games.top_10_most_expensive_games ....................... [[33mSKIP[0m]
[0m15:35:58.973595 [debug] [Thread-1 (]: Finished running node model.games.top_10_most_expensive_games
[0m15:35:58.976126 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:35:58.976815 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m15:35:58.977430 [info ] [MainThread]: 
[0m15:35:58.978025 [info ] [MainThread]: Finished running 12 table models in 0 hours 0 minutes and 34.05 seconds (34.05s).
[0m15:35:58.980971 [debug] [MainThread]: Command end result
[0m15:35:58.994641 [info ] [MainThread]: 
[0m15:35:58.995329 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:35:58.995877 [info ] [MainThread]: 
[0m15:35:58.996454 [error] [MainThread]:   Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Syntax error: Expected ")" but got "." at [39:8]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m15:35:58.996976 [info ] [MainThread]: 
[0m15:35:58.997485 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=4 TOTAL=12
[0m15:35:58.998264 [debug] [MainThread]: Command `dbt run` failed at 15:35:58.998124 after 34.52 seconds
[0m15:35:58.998791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f273af22b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27364e51e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27363825c0>]}
[0m15:35:58.999321 [debug] [MainThread]: Flushing usage events
[0m15:36:13.925650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e1f35180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e0094070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e00940d0>]}


============================== 15:36:13.927735 | 735fce85-bf2a-437c-9c83-f160a65c6bd5 ==============================
[0m15:36:13.927735 [info ] [MainThread]: Running with dbt=1.6.5
[0m15:36:13.928195 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'profiles_dir': '../dbt/', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:36:14.212305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '735fce85-bf2a-437c-9c83-f160a65c6bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e150a620>]}
[0m15:36:14.228307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '735fce85-bf2a-437c-9c83-f160a65c6bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8de0349d0>]}
[0m15:36:14.228934 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m15:36:14.242107 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m15:36:14.306543 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:36:14.307169 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m15:36:14.352119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '735fce85-bf2a-437c-9c83-f160a65c6bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8dd746380>]}
[0m15:36:14.361999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '735fce85-bf2a-437c-9c83-f160a65c6bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8dde6b9d0>]}
[0m15:36:14.362783 [info ] [MainThread]: Found 12 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m15:36:14.363299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '735fce85-bf2a-437c-9c83-f160a65c6bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8dde6ba00>]}
[0m15:36:14.365205 [info ] [MainThread]: 
[0m15:36:14.366015 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:36:14.367461 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m15:36:14.367903 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:36:15.090002 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m15:36:15.090768 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:36:15.809710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '735fce85-bf2a-437c-9c83-f160a65c6bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8dde6a8c0>]}
[0m15:36:15.812927 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:36:15.814627 [info ] [MainThread]: 
[0m15:36:15.822901 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m15:36:15.825296 [info ] [Thread-1 (]: 1 of 12 START sql table model games.dim_developers ............................. [RUN]
[0m15:36:15.828267 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m15:36:15.830097 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m15:36:15.849364 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m15:36:15.850510 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 15:36:15.831426 => 15:36:15.850165
[0m15:36:15.851182 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m15:36:15.868035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:36:16.737581 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m15:36:16.738373 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS developer_id,
    developers_name
FROM
    developers_cte
    );
  
[0m15:36:17.302217 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:86df2c7e-2e6d-42c8-a843-4190e56ded22&page=queryresults
[0m15:36:19.750771 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 15:36:15.851626 => 15:36:19.750442
[0m15:36:19.751907 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '735fce85-bf2a-437c-9c83-f160a65c6bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8dde4ee30>]}
[0m15:36:19.752822 [info ] [Thread-1 (]: 1 of 12 OK created sql table model games.dim_developers ........................ [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 3.92s]
[0m15:36:19.753806 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m15:36:19.754411 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m15:36:19.755135 [info ] [Thread-1 (]: 2 of 12 START sql table model games.dim_games .................................. [RUN]
[0m15:36:19.755994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m15:36:19.756530 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m15:36:19.766899 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m15:36:19.767680 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 15:36:19.756910 => 15:36:19.767455
[0m15:36:19.768110 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m15:36:19.770767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:36:20.371195 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m15:36:20.372050 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m15:36:20.944028 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:3f429d23-3911-45c7-b42f-00c0e71a6dd9&page=queryresults
[0m15:36:23.657980 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 15:36:19.768415 => 15:36:23.657102
[0m15:36:23.661128 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '735fce85-bf2a-437c-9c83-f160a65c6bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8dde4f400>]}
[0m15:36:23.663762 [info ] [Thread-1 (]: 2 of 12 OK created sql table model games.dim_games ............................. [[32mCREATE TABLE (2.7k rows, 753.9 KiB processed)[0m in 3.91s]
[0m15:36:23.666689 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m15:36:23.668807 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m15:36:23.671067 [info ] [Thread-1 (]: 3 of 12 START sql table model games.dim_platforms .............................. [RUN]
[0m15:36:23.674331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m15:36:23.675808 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m15:36:23.683401 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m15:36:23.684782 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 15:36:23.676786 => 15:36:23.684364
[0m15:36:23.686245 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m15:36:23.690502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:36:24.398587 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m15:36:24.401367 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m15:36:24.949929 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a34a9d3a-cbac-4750-b76e-5e4d1c3b79c2&page=queryresults
[0m15:36:27.612143 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 15:36:23.687118 => 15:36:27.611443
[0m15:36:27.614843 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '735fce85-bf2a-437c-9c83-f160a65c6bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8dde4f0d0>]}
[0m15:36:27.615438 [info ] [Thread-1 (]: 3 of 12 OK created sql table model games.dim_platforms ......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 3.94s]
[0m15:36:27.616075 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m15:36:27.616553 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m15:36:27.617039 [info ] [Thread-1 (]: 4 of 12 START sql table model games.dim_price_overview ......................... [RUN]
[0m15:36:27.617734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m15:36:27.618164 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m15:36:27.621180 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m15:36:27.622070 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 15:36:27.618448 => 15:36:27.621826
[0m15:36:27.622554 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m15:36:27.624917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:36:28.344393 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m15:36:28.346433 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    platform_id,
    windows,
    mac,
    linux,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte, games.dim_platforms
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m15:36:28.779711 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:0f417c35-39ae-4825-b0f3-3e44cea5c055&page=queryresults
[0m15:36:33.956544 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 15:36:27.622829 => 15:36:33.955678
[0m15:36:33.959822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '735fce85-bf2a-437c-9c83-f160a65c6bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8dd639fc0>]}
[0m15:36:33.962446 [info ] [Thread-1 (]: 4 of 12 OK created sql table model games.dim_price_overview .................... [[32mCREATE TABLE (3.1m rows, 199.1 KiB processed)[0m in 6.34s]
[0m15:36:33.965276 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m15:36:33.967332 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m15:36:33.970000 [info ] [Thread-1 (]: 5 of 12 START sql table model games.dim_publishers ............................. [RUN]
[0m15:36:33.972978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m15:36:33.974861 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m15:36:33.981884 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m15:36:33.982749 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 15:36:33.976190 => 15:36:33.982431
[0m15:36:33.983183 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m15:36:33.985574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:36:34.707241 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m15:36:34.708700 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m15:36:35.136990 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:3187dd29-8b8d-4f52-ae15-c4d3f3490c27&page=queryresults
[0m15:36:40.012412 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 15:36:33.983456 => 15:36:40.011522
[0m15:36:40.015613 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '735fce85-bf2a-437c-9c83-f160a65c6bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8dd624ee0>]}
[0m15:36:40.018220 [info ] [Thread-1 (]: 5 of 12 OK created sql table model games.dim_publishers ........................ [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 6.04s]
[0m15:36:40.021092 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m15:36:40.023183 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m15:36:40.025130 [info ] [Thread-1 (]: 6 of 12 START sql table model games.dim_release ................................ [RUN]
[0m15:36:40.027252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m15:36:40.028612 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m15:36:40.036749 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m15:36:40.038320 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 15:36:40.029555 => 15:36:40.037824
[0m15:36:40.039200 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m15:36:40.043476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:36:40.775728 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m15:36:40.778374 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m15:36:41.323916 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:bde864f3-1919-462c-823b-92fdf2e202a0&page=queryresults
[0m15:36:43.752971 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 15:36:40.039813 => 15:36:43.752496
[0m15:36:43.754862 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '735fce85-bf2a-437c-9c83-f160a65c6bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8dd625150>]}
[0m15:36:43.756233 [info ] [Thread-1 (]: 6 of 12 OK created sql table model games.dim_release ........................... [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 3.73s]
[0m15:36:43.757707 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m15:36:43.758793 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m15:36:43.760038 [info ] [Thread-1 (]: 7 of 12 START sql table model games.dim_support_language ....................... [RUN]
[0m15:36:43.761637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m15:36:43.762603 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m15:36:43.769232 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m15:36:43.770751 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 15:36:43.763286 => 15:36:43.770249
[0m15:36:43.771701 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m15:36:43.783366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:36:44.501593 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m15:36:44.502437 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m15:36:45.039120 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:585c1bc3-5dd1-43d9-995a-5732df88f436&page=queryresults
[0m15:36:47.688679 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 15:36:43.772377 => 15:36:47.688045
[0m15:36:47.691231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '735fce85-bf2a-437c-9c83-f160a65c6bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8dd658220>]}
[0m15:36:47.693131 [info ] [Thread-1 (]: 7 of 12 OK created sql table model games.dim_support_language .................. [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 3.93s]
[0m15:36:47.695157 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m15:36:47.696613 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m15:36:47.698315 [info ] [Thread-1 (]: 8 of 12 START sql table model games.fct_game_pricing ........................... [RUN]
[0m15:36:47.700407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m15:36:47.701688 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m15:36:47.711114 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m15:36:47.712713 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 15:36:47.702611 => 15:36:47.712212
[0m15:36:47.713661 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m15:36:47.717977 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:36:48.573192 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m15:36:48.575021 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para el análisis de precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        formatted_initial_price,
        platform_id,
        SUM(price_with_tax) AS total_sales,
        SUM(discount_amount) AS total_discounts,
        COUNT(*) AS num_sales,
        MAX(discount_pct) AS max_discount,
        MIN(initial_price) AS min_price,
        MAX(initial_price) AS max_price,
        SUM(price_with_tax) AS total_sales_with_tax,
        SUM(final_price) AS total_sales_with_tax_discounted
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id, platform_id, formatted_initial_price
)

SELECT
    fct.app_id,
    fct.formatted_initial_price,
    fct.total_sales,
    fct.platform_id,
    fct.total_discounts,
    fct.num_sales,
    fct.max_discount,
    fct.min_price,
    fct.max_price,
    fct.total_sales_with_tax,
    fct.total_sales_with_tax_discounted,
    games.name AS game_name,
    games.description AS game_description,
    games.is_free AS game_is_free,
    games.fullgame_app_id,
    games.fullgame_name,
    games.type,
    games.genre_id,
    games.type_genre,
FROM
    game_sales AS fct
INNER JOIN
    `pristine-flames-400818`.`games`.`dim_games` AS games
ON
    fct.app_id = games.app_id
INNER JOIN 
    `pristine-flames-400818`.`games`.`dim_platforms` AS dp
ON
    fct.platform_id = dp.platform_id
    );
  
[0m15:36:49.020198 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:6a2617be-c46d-43f1-a198-c3dbe0267d61&page=queryresults
[0m15:36:58.314831 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 15:36:47.714240 => 15:36:58.314642
[0m15:36:58.315675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '735fce85-bf2a-437c-9c83-f160a65c6bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8dd639a20>]}
[0m15:36:58.316262 [info ] [Thread-1 (]: 8 of 12 OK created sql table model games.fct_game_pricing ...................... [[32mCREATE TABLE (3.1m rows, 252.5 MiB processed)[0m in 10.62s]
[0m15:36:58.316925 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m15:36:58.317900 [debug] [Thread-1 (]: Began running node model.games.platform
[0m15:36:58.318384 [info ] [Thread-1 (]: 9 of 12 START sql table model games.platform ................................... [RUN]
[0m15:36:58.319118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.fct_game_pricing, now model.games.platform)
[0m15:36:58.319498 [debug] [Thread-1 (]: Began compiling node model.games.platform
[0m15:36:58.322641 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.platform"
[0m15:36:58.323320 [debug] [Thread-1 (]: Timing info for model.games.platform (compile): 15:36:58.319768 => 15:36:58.323120
[0m15:36:58.323696 [debug] [Thread-1 (]: Began executing node model.games.platform
[0m15:36:58.326654 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.platform"
[0m15:36:58.327197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:36:58.359179 [debug] [Thread-1 (]: On model.games.platform: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.platform"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`platform`
      
    
    

    OPTIONS()
    as (
      -- Informe de Ingresos por Plataforma
SELECT
    dp.platform_id,
    SUM(fs.price_with_tax) AS total_sales
FROM
    `pristine-flames-400818`.`games`.`dim_platforms` dp
JOIN
    `pristine-flames-400818`.`games`.`fct_game_pricing` fs
ON
    dp.platform_id = fs.platform_id
GROUP BY dp.platform_id
ORDER BY total_sales DESC
    );
  
[0m15:36:59.060095 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5492636b-26a8-4783-9c11-a48cccc323e0&page=queryresults
[0m15:36:59.528942 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name price_with_tax not found inside fs at [16:12]')
[0m15:37:00.321344 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:fed41bfd-25cc-46a5-b1ac-973d32e9ce11&page=queryresults
[0m15:37:00.784237 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:fed41bfd-25cc-46a5-b1ac-973d32e9ce11&page=queryresults
[0m15:37:00.785887 [debug] [Thread-1 (]: Timing info for model.games.platform (execute): 15:36:58.323957 => 15:37:00.785403
[0m15:37:00.792842 [debug] [Thread-1 (]: Database Error in model platform (models/report/platform.sql)
  Name price_with_tax not found inside fs at [16:12]
  compiled Code at target/run/games/models/report/platform.sql
[0m15:37:00.793895 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '735fce85-bf2a-437c-9c83-f160a65c6bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8dd78ec50>]}
[0m15:37:00.795239 [error] [Thread-1 (]: 9 of 12 ERROR creating sql table model games.platform .......................... [[31mERROR[0m in 2.47s]
[0m15:37:00.796698 [debug] [Thread-1 (]: Finished running node model.games.platform
[0m15:37:00.797757 [debug] [Thread-1 (]: Began running node model.games.top_10_discounted_games
[0m15:37:00.799104 [info ] [Thread-1 (]: 10 of 12 START sql table model games.top_10_discounted_games ................... [RUN]
[0m15:37:00.800898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.platform, now model.games.top_10_discounted_games)
[0m15:37:00.801992 [debug] [Thread-1 (]: Began compiling node model.games.top_10_discounted_games
[0m15:37:00.808674 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_discounted_games"
[0m15:37:00.810186 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (compile): 15:37:00.802708 => 15:37:00.809694
[0m15:37:00.811151 [debug] [Thread-1 (]: Began executing node model.games.top_10_discounted_games
[0m15:37:00.825902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:37:01.550776 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_discounted_games"
[0m15:37:01.553493 [debug] [Thread-1 (]: On model.games.top_10_discounted_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_discounted_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_discounted_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 descuentos más grandes
SELECT
    app_id,
    game_name,
    total_discounts
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY total_discounts DESC
LIMIT 10
    );
  
[0m15:37:01.994667 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:64e0e816-c199-4e83-af6a-0375f06dfc11&page=queryresults
[0m15:37:04.426633 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (execute): 15:37:00.811823 => 15:37:04.425986
[0m15:37:04.428816 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '735fce85-bf2a-437c-9c83-f160a65c6bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8dd6521a0>]}
[0m15:37:04.430179 [info ] [Thread-1 (]: 10 of 12 OK created sql table model games.top_10_discounted_games .............. [[32mCREATE TABLE (10.0 rows, 162.8 MiB processed)[0m in 3.63s]
[0m15:37:04.431671 [debug] [Thread-1 (]: Finished running node model.games.top_10_discounted_games
[0m15:37:04.432738 [debug] [Thread-1 (]: Began running node model.games.top_10_high_tax_games
[0m15:37:04.433984 [info ] [Thread-1 (]: 11 of 12 START sql table model games.top_10_high_tax_games ..................... [RUN]
[0m15:37:04.435277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_discounted_games, now model.games.top_10_high_tax_games)
[0m15:37:04.436077 [debug] [Thread-1 (]: Began compiling node model.games.top_10_high_tax_games
[0m15:37:04.440960 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_high_tax_games"
[0m15:37:04.441979 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (compile): 15:37:04.436615 => 15:37:04.441650
[0m15:37:04.442624 [debug] [Thread-1 (]: Began executing node model.games.top_10_high_tax_games
[0m15:37:04.445987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:37:05.212211 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_high_tax_games"
[0m15:37:05.214029 [debug] [Thread-1 (]: On model.games.top_10_high_tax_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_high_tax_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_high_tax_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos con más impuestos
SELECT
    app_id,
    game_name,
    SUM(total_sales_with_tax) AS total_taxes
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
GROUP BY app_id, game_name
ORDER BY total_taxes DESC, game_name DESC
LIMIT 10
    );
  
[0m15:37:05.704920 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:31091b79-fa63-4317-8f82-2f4f656ba183&page=queryresults
[0m15:37:08.924189 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (execute): 15:37:04.443072 => 15:37:08.923980
[0m15:37:08.925020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '735fce85-bf2a-437c-9c83-f160a65c6bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8dd61f280>]}
[0m15:37:08.925668 [info ] [Thread-1 (]: 11 of 12 OK created sql table model games.top_10_high_tax_games ................ [[32mCREATE TABLE (10.0 rows, 162.8 MiB processed)[0m in 4.49s]
[0m15:37:08.926348 [debug] [Thread-1 (]: Finished running node model.games.top_10_high_tax_games
[0m15:37:08.927036 [debug] [Thread-1 (]: Began running node model.games.top_10_most_expensive_games
[0m15:37:08.927785 [info ] [Thread-1 (]: 12 of 12 START sql table model games.top_10_most_expensive_games ............... [RUN]
[0m15:37:08.928693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_high_tax_games, now model.games.top_10_most_expensive_games)
[0m15:37:08.929244 [debug] [Thread-1 (]: Began compiling node model.games.top_10_most_expensive_games
[0m15:37:08.932322 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_most_expensive_games"
[0m15:37:08.933127 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (compile): 15:37:08.929588 => 15:37:08.932817
[0m15:37:08.933569 [debug] [Thread-1 (]: Began executing node model.games.top_10_most_expensive_games
[0m15:37:08.936175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:37:09.772689 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_most_expensive_games"
[0m15:37:09.775393 [debug] [Thread-1 (]: On model.games.top_10_most_expensive_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_most_expensive_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_most_expensive_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos más caros
SELECT
    app_id,
    game_name,
    max_price,
    formatted_initial_price,
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY max_price DESC
LIMIT 10
    );
  
[0m15:37:10.190792 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:878389e9-4e64-4a39-bea5-54466dc7422a&page=queryresults
[0m15:37:12.612126 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (execute): 15:37:08.933894 => 15:37:12.611934
[0m15:37:12.612976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '735fce85-bf2a-437c-9c83-f160a65c6bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8dd61c1f0>]}
[0m15:37:12.613556 [info ] [Thread-1 (]: 12 of 12 OK created sql table model games.top_10_most_expensive_games .......... [[32mCREATE TABLE (10.0 rows, 177.7 MiB processed)[0m in 3.68s]
[0m15:37:12.614190 [debug] [Thread-1 (]: Finished running node model.games.top_10_most_expensive_games
[0m15:37:12.615683 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:37:12.616015 [debug] [MainThread]: Connection 'model.games.top_10_most_expensive_games' was properly closed.
[0m15:37:12.616410 [info ] [MainThread]: 
[0m15:37:12.616791 [info ] [MainThread]: Finished running 12 table models in 0 hours 0 minutes and 58.25 seconds (58.25s).
[0m15:37:12.618990 [debug] [MainThread]: Command end result
[0m15:37:12.635526 [info ] [MainThread]: 
[0m15:37:12.636037 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:37:12.636419 [info ] [MainThread]: 
[0m15:37:12.636813 [error] [MainThread]:   Database Error in model platform (models/report/platform.sql)
  Name price_with_tax not found inside fs at [16:12]
  compiled Code at target/run/games/models/report/platform.sql
[0m15:37:12.637234 [info ] [MainThread]: 
[0m15:37:12.637646 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m15:37:12.638265 [debug] [MainThread]: Command `dbt run` failed at 15:37:12.638168 after 58.72 seconds
[0m15:37:12.638684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e1f35180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8dc5a24d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8dc5a2590>]}
[0m15:37:12.639077 [debug] [MainThread]: Flushing usage events
[0m15:38:17.360102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f521eb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f33b4070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f33b40d0>]}


============================== 15:38:17.362644 | e6a77202-71da-4d98-8b1f-fd0b97ba615f ==============================
[0m15:38:17.362644 [info ] [MainThread]: Running with dbt=1.6.5
[0m15:38:17.363199 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '../dbt/', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:38:17.678222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6a77202-71da-4d98-8b1f-fd0b97ba615f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f1336c50>]}
[0m15:38:17.695077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6a77202-71da-4d98-8b1f-fd0b97ba615f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f13507c0>]}
[0m15:38:17.695751 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m15:38:17.710301 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m15:38:17.781429 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:38:17.782285 [debug] [MainThread]: Partial parsing: updated file: games://models/report/platform.sql
[0m15:38:17.829764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6a77202-71da-4d98-8b1f-fd0b97ba615f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f0a3e320>]}
[0m15:38:17.840890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6a77202-71da-4d98-8b1f-fd0b97ba615f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f1187970>]}
[0m15:38:17.841406 [info ] [MainThread]: Found 12 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m15:38:17.841803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6a77202-71da-4d98-8b1f-fd0b97ba615f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f11879a0>]}
[0m15:38:17.843353 [info ] [MainThread]: 
[0m15:38:17.844065 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:38:17.845469 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m15:38:17.845991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:18.622847 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m15:38:18.624626 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:19.339881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6a77202-71da-4d98-8b1f-fd0b97ba615f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f1186860>]}
[0m15:38:19.343111 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:38:19.344783 [info ] [MainThread]: 
[0m15:38:19.352758 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m15:38:19.354994 [info ] [Thread-1 (]: 1 of 12 START sql table model games.dim_developers ............................. [RUN]
[0m15:38:19.357902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m15:38:19.359770 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m15:38:19.384736 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m15:38:19.386092 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 15:38:19.361059 => 15:38:19.385638
[0m15:38:19.386898 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m15:38:19.405852 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:20.141958 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m15:38:20.142758 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS developer_id,
    developers_name
FROM
    developers_cte
    );
  
[0m15:38:20.728288 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:11e32cd2-f72c-41ab-8c50-d23fec13ee6c&page=queryresults
[0m15:38:23.676492 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 15:38:19.387449 => 15:38:23.676134
[0m15:38:23.677801 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6a77202-71da-4d98-8b1f-fd0b97ba615f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f13375e0>]}
[0m15:38:23.678790 [info ] [Thread-1 (]: 1 of 12 OK created sql table model games.dim_developers ........................ [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.32s]
[0m15:38:23.679867 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m15:38:23.680662 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m15:38:23.681429 [info ] [Thread-1 (]: 2 of 12 START sql table model games.dim_games .................................. [RUN]
[0m15:38:23.682540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m15:38:23.683190 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m15:38:23.694109 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m15:38:23.709514 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 15:38:23.683586 => 15:38:23.709212
[0m15:38:23.709980 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m15:38:23.712867 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:24.459081 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m15:38:24.460074 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m15:38:24.886578 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a7daa88c-636a-4cc2-bca5-d1c06c410167&page=queryresults
[0m15:38:27.620179 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 15:38:23.710270 => 15:38:27.619974
[0m15:38:27.620940 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6a77202-71da-4d98-8b1f-fd0b97ba615f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f1337b50>]}
[0m15:38:27.621517 [info ] [Thread-1 (]: 2 of 12 OK created sql table model games.dim_games ............................. [[32mCREATE TABLE (2.7k rows, 753.9 KiB processed)[0m in 3.94s]
[0m15:38:27.622112 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m15:38:27.622554 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m15:38:27.623079 [info ] [Thread-1 (]: 3 of 12 START sql table model games.dim_platforms .............................. [RUN]
[0m15:38:27.623705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m15:38:27.624082 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m15:38:27.627109 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m15:38:27.627790 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 15:38:27.624346 => 15:38:27.627590
[0m15:38:27.628167 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m15:38:27.630422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:28.348776 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m15:38:28.349426 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m15:38:28.956638 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:80b623bc-1ce2-4d37-aa57-1168b1eb2c00&page=queryresults
[0m15:38:31.439474 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 15:38:27.628432 => 15:38:31.439044
[0m15:38:31.441021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6a77202-71da-4d98-8b1f-fd0b97ba615f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f1336020>]}
[0m15:38:31.442291 [info ] [Thread-1 (]: 3 of 12 OK created sql table model games.dim_platforms ......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 3.82s]
[0m15:38:31.443686 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m15:38:31.444669 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m15:38:31.445853 [info ] [Thread-1 (]: 4 of 12 START sql table model games.dim_price_overview ......................... [RUN]
[0m15:38:31.447336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m15:38:31.448278 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m15:38:31.453859 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m15:38:31.454971 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 15:38:31.448934 => 15:38:31.454645
[0m15:38:31.455610 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m15:38:31.459226 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:32.184406 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m15:38:32.185319 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    platform_id,
    windows,
    mac,
    linux,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte, games.dim_platforms
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m15:38:32.651000 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:8ff3ca28-cbe0-4164-ad30-8f89d5fa7965&page=queryresults
[0m15:38:37.951131 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 15:38:31.456045 => 15:38:37.950230
[0m15:38:37.954283 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6a77202-71da-4d98-8b1f-fd0b97ba615f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f09561a0>]}
[0m15:38:37.956867 [info ] [Thread-1 (]: 4 of 12 OK created sql table model games.dim_price_overview .................... [[32mCREATE TABLE (3.1m rows, 199.1 KiB processed)[0m in 6.51s]
[0m15:38:37.959700 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m15:38:37.961727 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m15:38:37.964470 [info ] [Thread-1 (]: 5 of 12 START sql table model games.dim_publishers ............................. [RUN]
[0m15:38:37.967411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m15:38:37.969212 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m15:38:37.981518 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m15:38:37.984399 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 15:38:37.970536 => 15:38:37.983438
[0m15:38:37.986340 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m15:38:37.996102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:38.713293 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m15:38:38.717055 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m15:38:39.290209 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:308eee3a-7c69-4647-a7e1-4bc1e0173f0e&page=queryresults
[0m15:38:42.067852 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 15:38:37.987754 => 15:38:42.067652
[0m15:38:42.068580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6a77202-71da-4d98-8b1f-fd0b97ba615f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f0940d30>]}
[0m15:38:42.069161 [info ] [Thread-1 (]: 5 of 12 OK created sql table model games.dim_publishers ........................ [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.10s]
[0m15:38:42.069814 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m15:38:42.070294 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m15:38:42.070881 [info ] [Thread-1 (]: 6 of 12 START sql table model games.dim_release ................................ [RUN]
[0m15:38:42.071573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m15:38:42.071943 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m15:38:42.074729 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m15:38:42.075383 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 15:38:42.072226 => 15:38:42.075153
[0m15:38:42.075762 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m15:38:42.077814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:42.812576 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m15:38:42.815768 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m15:38:43.259584 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a0eb9906-8fa9-459b-89c4-2c9a782cbf41&page=queryresults
[0m15:38:45.665689 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 15:38:42.076027 => 15:38:45.665071
[0m15:38:45.668035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6a77202-71da-4d98-8b1f-fd0b97ba615f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f0941090>]}
[0m15:38:45.669852 [info ] [Thread-1 (]: 6 of 12 OK created sql table model games.dim_release ........................... [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 3.60s]
[0m15:38:45.672079 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m15:38:45.673795 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m15:38:45.675478 [info ] [Thread-1 (]: 7 of 12 START sql table model games.dim_support_language ....................... [RUN]
[0m15:38:45.677907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m15:38:45.679238 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m15:38:45.687785 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m15:38:45.689369 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 15:38:45.680164 => 15:38:45.688868
[0m15:38:45.690324 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m15:38:45.702499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:46.411166 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m15:38:46.414061 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m15:38:46.990838 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:53a1dbf2-a726-4c64-a5be-983c6e517f64&page=queryresults
[0m15:38:49.638043 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 15:38:45.690946 => 15:38:49.637554
[0m15:38:49.639899 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6a77202-71da-4d98-8b1f-fd0b97ba615f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f0974940>]}
[0m15:38:49.641356 [info ] [Thread-1 (]: 7 of 12 OK created sql table model games.dim_support_language .................. [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 3.96s]
[0m15:38:49.642852 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m15:38:49.643931 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m15:38:49.645193 [info ] [Thread-1 (]: 8 of 12 START sql table model games.fct_game_pricing ........................... [RUN]
[0m15:38:49.646578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m15:38:49.647397 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m15:38:49.653725 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m15:38:49.655031 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 15:38:49.647943 => 15:38:49.654630
[0m15:38:49.655934 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m15:38:49.659961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:50.318010 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m15:38:50.319757 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para el análisis de precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        formatted_initial_price,
        platform_id,
        SUM(price_with_tax) AS total_sales,
        SUM(discount_amount) AS total_discounts,
        COUNT(*) AS num_sales,
        MAX(discount_pct) AS max_discount,
        MIN(initial_price) AS min_price,
        MAX(initial_price) AS max_price,
        SUM(price_with_tax) AS total_sales_with_tax,
        SUM(final_price) AS total_sales_with_tax_discounted
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id, platform_id, formatted_initial_price
)

SELECT
    fct.app_id,
    fct.formatted_initial_price,
    fct.total_sales,
    fct.platform_id,
    fct.total_discounts,
    fct.num_sales,
    fct.max_discount,
    fct.min_price,
    fct.max_price,
    fct.total_sales_with_tax,
    fct.total_sales_with_tax_discounted,
    games.name AS game_name,
    games.description AS game_description,
    games.is_free AS game_is_free,
    games.fullgame_app_id,
    games.fullgame_name,
    games.type,
    games.genre_id,
    games.type_genre,
FROM
    game_sales AS fct
INNER JOIN
    `pristine-flames-400818`.`games`.`dim_games` AS games
ON
    fct.app_id = games.app_id
INNER JOIN 
    `pristine-flames-400818`.`games`.`dim_platforms` AS dp
ON
    fct.platform_id = dp.platform_id
    );
  
[0m15:38:50.818200 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:01a97079-096e-4e1e-90a5-65bea9035ec9&page=queryresults
[0m15:39:00.069011 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 15:38:49.656541 => 15:39:00.068548
[0m15:39:00.070690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6a77202-71da-4d98-8b1f-fd0b97ba615f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f0976410>]}
[0m15:39:00.072032 [info ] [Thread-1 (]: 8 of 12 OK created sql table model games.fct_game_pricing ...................... [[32mCREATE TABLE (3.1m rows, 252.5 MiB processed)[0m in 10.42s]
[0m15:39:00.073499 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m15:39:00.075423 [debug] [Thread-1 (]: Began running node model.games.platform
[0m15:39:00.076605 [info ] [Thread-1 (]: 9 of 12 START sql table model games.platform ................................... [RUN]
[0m15:39:00.078152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.fct_game_pricing, now model.games.platform)
[0m15:39:00.079113 [debug] [Thread-1 (]: Began compiling node model.games.platform
[0m15:39:00.085036 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.platform"
[0m15:39:00.086150 [debug] [Thread-1 (]: Timing info for model.games.platform (compile): 15:39:00.079782 => 15:39:00.085791
[0m15:39:00.086851 [debug] [Thread-1 (]: Began executing node model.games.platform
[0m15:39:00.091677 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.platform"
[0m15:39:00.092538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:00.127489 [debug] [Thread-1 (]: On model.games.platform: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.platform"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`platform`
      
    
    

    OPTIONS()
    as (
      -- Informe de Ingresos por Plataforma
SELECT
    dp.platform_id,
    SUM(fs.total_sales)
FROM
    `pristine-flames-400818`.`games`.`dim_platforms` dp
JOIN
    `pristine-flames-400818`.`games`.`fct_game_pricing` fs
ON
    dp.platform_id = fs.platform_id
GROUP BY dp.platform_id
ORDER BY total_sales DESC
    );
  
[0m15:39:01.118621 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:423390d7-a1a5-4cd3-bfba-c6fbe742c47b&page=queryresults
[0m15:39:01.581078 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('ORDER BY clause expression references column total_sales which is neither grouped nor aggregated at [24:10]')
[0m15:39:02.339259 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a4bfa879-b994-473b-a77a-2ad13ff5a412&page=queryresults
[0m15:39:02.819899 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a4bfa879-b994-473b-a77a-2ad13ff5a412&page=queryresults
[0m15:39:02.823073 [debug] [Thread-1 (]: Timing info for model.games.platform (execute): 15:39:00.087334 => 15:39:02.822084
[0m15:39:02.836862 [debug] [Thread-1 (]: Database Error in model platform (models/report/platform.sql)
  ORDER BY clause expression references column total_sales which is neither grouped nor aggregated at [24:10]
  compiled Code at target/run/games/models/report/platform.sql
[0m15:39:02.839043 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6a77202-71da-4d98-8b1f-fd0b97ba615f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f0aab190>]}
[0m15:39:02.841284 [error] [Thread-1 (]: 9 of 12 ERROR creating sql table model games.platform .......................... [[31mERROR[0m in 2.76s]
[0m15:39:02.843921 [debug] [Thread-1 (]: Finished running node model.games.platform
[0m15:39:02.845492 [debug] [Thread-1 (]: Began running node model.games.top_10_discounted_games
[0m15:39:02.847054 [info ] [Thread-1 (]: 10 of 12 START sql table model games.top_10_discounted_games ................... [RUN]
[0m15:39:02.848920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.platform, now model.games.top_10_discounted_games)
[0m15:39:02.850009 [debug] [Thread-1 (]: Began compiling node model.games.top_10_discounted_games
[0m15:39:02.856547 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_discounted_games"
[0m15:39:02.857710 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (compile): 15:39:02.850758 => 15:39:02.857360
[0m15:39:02.858360 [debug] [Thread-1 (]: Began executing node model.games.top_10_discounted_games
[0m15:39:02.869946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:03.539587 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_discounted_games"
[0m15:39:03.540891 [debug] [Thread-1 (]: On model.games.top_10_discounted_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_discounted_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_discounted_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 descuentos más grandes
SELECT
    app_id,
    game_name,
    total_discounts
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY total_discounts DESC
LIMIT 10
    );
  
[0m15:39:04.090676 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:45075be7-4ab7-4cc2-b679-2faae550d818&page=queryresults
[0m15:39:06.616060 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (execute): 15:39:02.858823 => 15:39:06.615787
[0m15:39:06.617047 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6a77202-71da-4d98-8b1f-fd0b97ba615f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f0900970>]}
[0m15:39:06.617868 [info ] [Thread-1 (]: 10 of 12 OK created sql table model games.top_10_discounted_games .............. [[32mCREATE TABLE (10.0 rows, 162.8 MiB processed)[0m in 3.77s]
[0m15:39:06.618738 [debug] [Thread-1 (]: Finished running node model.games.top_10_discounted_games
[0m15:39:06.619362 [debug] [Thread-1 (]: Began running node model.games.top_10_high_tax_games
[0m15:39:06.620078 [info ] [Thread-1 (]: 11 of 12 START sql table model games.top_10_high_tax_games ..................... [RUN]
[0m15:39:06.620960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_discounted_games, now model.games.top_10_high_tax_games)
[0m15:39:06.621516 [debug] [Thread-1 (]: Began compiling node model.games.top_10_high_tax_games
[0m15:39:06.625809 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_high_tax_games"
[0m15:39:06.626817 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (compile): 15:39:06.621945 => 15:39:06.626475
[0m15:39:06.627426 [debug] [Thread-1 (]: Began executing node model.games.top_10_high_tax_games
[0m15:39:06.630643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:07.317498 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_high_tax_games"
[0m15:39:07.318260 [debug] [Thread-1 (]: On model.games.top_10_high_tax_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_high_tax_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_high_tax_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos con más impuestos
SELECT
    app_id,
    game_name,
    SUM(total_sales_with_tax) AS total_taxes
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
GROUP BY app_id, game_name
ORDER BY total_taxes DESC, game_name DESC
LIMIT 10
    );
  
[0m15:39:07.756754 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:05c2c209-9c9e-4729-b277-71491ec4dd37&page=queryresults
[0m15:39:10.105992 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (execute): 15:39:06.627840 => 15:39:10.105782
[0m15:39:10.106762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6a77202-71da-4d98-8b1f-fd0b97ba615f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f096d4b0>]}
[0m15:39:10.107373 [info ] [Thread-1 (]: 11 of 12 OK created sql table model games.top_10_high_tax_games ................ [[32mCREATE TABLE (10.0 rows, 162.8 MiB processed)[0m in 3.49s]
[0m15:39:10.108023 [debug] [Thread-1 (]: Finished running node model.games.top_10_high_tax_games
[0m15:39:10.108525 [debug] [Thread-1 (]: Began running node model.games.top_10_most_expensive_games
[0m15:39:10.109254 [info ] [Thread-1 (]: 12 of 12 START sql table model games.top_10_most_expensive_games ............... [RUN]
[0m15:39:10.110164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_high_tax_games, now model.games.top_10_most_expensive_games)
[0m15:39:10.110643 [debug] [Thread-1 (]: Began compiling node model.games.top_10_most_expensive_games
[0m15:39:10.113929 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_most_expensive_games"
[0m15:39:10.114746 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (compile): 15:39:10.110948 => 15:39:10.114521
[0m15:39:10.115165 [debug] [Thread-1 (]: Began executing node model.games.top_10_most_expensive_games
[0m15:39:10.117620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:10.792275 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_most_expensive_games"
[0m15:39:10.793632 [debug] [Thread-1 (]: On model.games.top_10_most_expensive_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_most_expensive_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_most_expensive_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos más caros
SELECT
    app_id,
    game_name,
    max_price,
    formatted_initial_price,
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY max_price DESC
LIMIT 10
    );
  
[0m15:39:11.345412 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:bc1b3fad-f46a-4850-a60e-484a46971943&page=queryresults
[0m15:39:13.510450 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (execute): 15:39:10.115457 => 15:39:13.510068
[0m15:39:13.512044 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6a77202-71da-4d98-8b1f-fd0b97ba615f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f13347f0>]}
[0m15:39:13.513173 [info ] [Thread-1 (]: 12 of 12 OK created sql table model games.top_10_most_expensive_games .......... [[32mCREATE TABLE (10.0 rows, 177.7 MiB processed)[0m in 3.40s]
[0m15:39:13.514161 [debug] [Thread-1 (]: Finished running node model.games.top_10_most_expensive_games
[0m15:39:13.516395 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:39:13.517021 [debug] [MainThread]: Connection 'model.games.top_10_most_expensive_games' was properly closed.
[0m15:39:13.517650 [info ] [MainThread]: 
[0m15:39:13.518224 [info ] [MainThread]: Finished running 12 table models in 0 hours 0 minutes and 55.67 seconds (55.67s).
[0m15:39:13.521417 [debug] [MainThread]: Command end result
[0m15:39:13.538635 [info ] [MainThread]: 
[0m15:39:13.539090 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:39:13.539455 [info ] [MainThread]: 
[0m15:39:13.539807 [error] [MainThread]:   Database Error in model platform (models/report/platform.sql)
  ORDER BY clause expression references column total_sales which is neither grouped nor aggregated at [24:10]
  compiled Code at target/run/games/models/report/platform.sql
[0m15:39:13.540217 [info ] [MainThread]: 
[0m15:39:13.540659 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m15:39:13.541377 [debug] [MainThread]: Command `dbt run` failed at 15:39:13.541260 after 56.20 seconds
[0m15:39:13.541760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f521eb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3e9dbd960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3e9dbe3b0>]}
[0m15:39:13.542144 [debug] [MainThread]: Flushing usage events
[0m15:39:49.836197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0b0d12b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0aeeb0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0aeeb00d0>]}


============================== 15:39:49.838344 | c155e4b4-b1d7-4b0f-b028-befe02c75040 ==============================
[0m15:39:49.838344 [info ] [MainThread]: Running with dbt=1.6.5
[0m15:39:49.838882 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '../dbt/', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:39:50.119495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c155e4b4-b1d7-4b0f-b028-befe02c75040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ace36bc0>]}
[0m15:39:50.135348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c155e4b4-b1d7-4b0f-b028-befe02c75040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ace50640>]}
[0m15:39:50.136021 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m15:39:50.149354 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m15:39:50.214251 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:39:50.214810 [debug] [MainThread]: Partial parsing: updated file: games://models/report/platform.sql
[0m15:39:50.259209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c155e4b4-b1d7-4b0f-b028-befe02c75040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ac33a3e0>]}
[0m15:39:50.268450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c155e4b4-b1d7-4b0f-b028-befe02c75040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0acc87a30>]}
[0m15:39:50.268900 [info ] [MainThread]: Found 12 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m15:39:50.269237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c155e4b4-b1d7-4b0f-b028-befe02c75040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0acc87a60>]}
[0m15:39:50.270726 [info ] [MainThread]: 
[0m15:39:50.271375 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:39:50.272756 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m15:39:50.273180 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:51.084506 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m15:39:51.085759 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:39:51.786405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c155e4b4-b1d7-4b0f-b028-befe02c75040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0acc86920>]}
[0m15:39:51.787154 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:39:51.787532 [info ] [MainThread]: 
[0m15:39:51.789656 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m15:39:51.790148 [info ] [Thread-1 (]: 1 of 12 START sql table model games.dim_developers ............................. [RUN]
[0m15:39:51.790775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m15:39:51.791161 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m15:39:51.798595 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m15:39:51.799326 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 15:39:51.791416 => 15:39:51.799086
[0m15:39:51.799757 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m15:39:51.814563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:52.576751 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m15:39:52.577479 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS developer_id,
    developers_name
FROM
    developers_cte
    );
  
[0m15:39:53.170015 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7d59a51f-4f52-4aeb-87df-352b361446fc&page=queryresults
[0m15:39:56.020608 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 15:39:51.800050 => 15:39:56.020235
[0m15:39:56.021930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c155e4b4-b1d7-4b0f-b028-befe02c75040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0acc66c80>]}
[0m15:39:56.022851 [info ] [Thread-1 (]: 1 of 12 OK created sql table model games.dim_developers ........................ [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.23s]
[0m15:39:56.023826 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m15:39:56.024531 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m15:39:56.025372 [info ] [Thread-1 (]: 2 of 12 START sql table model games.dim_games .................................. [RUN]
[0m15:39:56.026467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m15:39:56.027135 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m15:39:56.038440 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m15:39:56.039193 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 15:39:56.027522 => 15:39:56.038976
[0m15:39:56.039607 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m15:39:56.042029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:56.811920 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m15:39:56.813847 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m15:39:57.342968 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:4f605b75-2ed1-4350-a597-9d6e835f9640&page=queryresults
[0m15:39:59.734695 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 15:39:56.039898 => 15:39:59.734062
[0m15:39:59.736860 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c155e4b4-b1d7-4b0f-b028-befe02c75040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0acc64e50>]}
[0m15:39:59.738637 [info ] [Thread-1 (]: 2 of 12 OK created sql table model games.dim_games ............................. [[32mCREATE TABLE (2.7k rows, 753.9 KiB processed)[0m in 3.71s]
[0m15:39:59.740596 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m15:39:59.742015 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m15:39:59.743736 [info ] [Thread-1 (]: 3 of 12 START sql table model games.dim_platforms .............................. [RUN]
[0m15:39:59.745820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m15:39:59.747110 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m15:39:59.755841 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m15:39:59.757846 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 15:39:59.748000 => 15:39:59.757198
[0m15:39:59.759114 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m15:39:59.764810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:00.470011 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m15:40:00.471290 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m15:40:01.091222 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c687c911-c506-455b-a7ea-62635e0c0f97&page=queryresults
[0m15:40:04.144513 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 15:39:59.759998 => 15:40:04.144314
[0m15:40:04.145264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c155e4b4-b1d7-4b0f-b028-befe02c75040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ac217fd0>]}
[0m15:40:04.145870 [info ] [Thread-1 (]: 3 of 12 OK created sql table model games.dim_platforms ......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.40s]
[0m15:40:04.146469 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m15:40:04.146912 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m15:40:04.147343 [info ] [Thread-1 (]: 4 of 12 START sql table model games.dim_price_overview ......................... [RUN]
[0m15:40:04.148054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m15:40:04.148425 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m15:40:04.151357 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m15:40:04.151995 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 15:40:04.148687 => 15:40:04.151784
[0m15:40:04.152392 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m15:40:04.156230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:04.842312 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m15:40:04.843336 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    platform_id,
    windows,
    mac,
    linux,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte, games.dim_platforms
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m15:40:05.462942 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:4045d7d7-1b5b-4bd3-8034-309d6bf21e9f&page=queryresults
[0m15:40:11.741686 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 15:40:04.152664 => 15:40:11.740813
[0m15:40:11.744820 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c155e4b4-b1d7-4b0f-b028-befe02c75040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ac24a350>]}
[0m15:40:11.747366 [info ] [Thread-1 (]: 4 of 12 OK created sql table model games.dim_price_overview .................... [[32mCREATE TABLE (3.1m rows, 199.1 KiB processed)[0m in 7.60s]
[0m15:40:11.750152 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m15:40:11.752217 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m15:40:11.754888 [info ] [Thread-1 (]: 5 of 12 START sql table model games.dim_publishers ............................. [RUN]
[0m15:40:11.757792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m15:40:11.759445 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m15:40:11.767372 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m15:40:11.768960 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 15:40:11.760362 => 15:40:11.768444
[0m15:40:11.769737 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m15:40:11.774221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:12.486237 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m15:40:12.489174 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m15:40:12.947926 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:16f8635d-39d4-4522-9a19-87897dc05eb7&page=queryresults
[0m15:40:15.622330 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 15:40:11.770271 => 15:40:15.621704
[0m15:40:15.624413 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c155e4b4-b1d7-4b0f-b028-befe02c75040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ac238dc0>]}
[0m15:40:15.625758 [info ] [Thread-1 (]: 5 of 12 OK created sql table model games.dim_publishers ........................ [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 3.87s]
[0m15:40:15.627221 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m15:40:15.628267 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m15:40:15.629410 [info ] [Thread-1 (]: 6 of 12 START sql table model games.dim_release ................................ [RUN]
[0m15:40:15.630617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m15:40:15.631358 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m15:40:15.636203 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m15:40:15.637172 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 15:40:15.631886 => 15:40:15.636861
[0m15:40:15.637781 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m15:40:15.641054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:16.378745 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m15:40:16.381524 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m15:40:17.014827 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:15f74203-f1ba-4fce-917b-2f014c61be57&page=queryresults
[0m15:40:19.395121 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 15:40:15.638212 => 15:40:19.394218
[0m15:40:19.398551 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c155e4b4-b1d7-4b0f-b028-befe02c75040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ac239180>]}
[0m15:40:19.399676 [info ] [Thread-1 (]: 6 of 12 OK created sql table model games.dim_release ........................... [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 3.77s]
[0m15:40:19.400307 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m15:40:19.400778 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m15:40:19.401259 [info ] [Thread-1 (]: 7 of 12 START sql table model games.dim_support_language ....................... [RUN]
[0m15:40:19.401992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m15:40:19.402397 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m15:40:19.405224 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m15:40:19.406009 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 15:40:19.402691 => 15:40:19.405754
[0m15:40:19.406388 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m15:40:19.414308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:20.109590 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m15:40:20.112336 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m15:40:20.510502 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:71cf501b-1e73-4fba-be6f-40c42cb78040&page=queryresults
[0m15:40:22.922066 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 15:40:19.406668 => 15:40:22.921856
[0m15:40:22.922769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c155e4b4-b1d7-4b0f-b028-befe02c75040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ac270670>]}
[0m15:40:22.923335 [info ] [Thread-1 (]: 7 of 12 OK created sql table model games.dim_support_language .................. [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 3.52s]
[0m15:40:22.923892 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m15:40:22.924329 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m15:40:22.924827 [info ] [Thread-1 (]: 8 of 12 START sql table model games.fct_game_pricing ........................... [RUN]
[0m15:40:22.925416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m15:40:22.925774 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m15:40:22.928951 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m15:40:22.929775 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 15:40:22.926027 => 15:40:22.929532
[0m15:40:22.930202 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m15:40:22.932522 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:23.644523 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m15:40:23.647415 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para el análisis de precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        formatted_initial_price,
        platform_id,
        SUM(price_with_tax) AS total_sales,
        SUM(discount_amount) AS total_discounts,
        COUNT(*) AS num_sales,
        MAX(discount_pct) AS max_discount,
        MIN(initial_price) AS min_price,
        MAX(initial_price) AS max_price,
        SUM(price_with_tax) AS total_sales_with_tax,
        SUM(final_price) AS total_sales_with_tax_discounted
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id, platform_id, formatted_initial_price
)

SELECT
    fct.app_id,
    fct.formatted_initial_price,
    fct.total_sales,
    fct.platform_id,
    fct.total_discounts,
    fct.num_sales,
    fct.max_discount,
    fct.min_price,
    fct.max_price,
    fct.total_sales_with_tax,
    fct.total_sales_with_tax_discounted,
    games.name AS game_name,
    games.description AS game_description,
    games.is_free AS game_is_free,
    games.fullgame_app_id,
    games.fullgame_name,
    games.type,
    games.genre_id,
    games.type_genre,
FROM
    game_sales AS fct
INNER JOIN
    `pristine-flames-400818`.`games`.`dim_games` AS games
ON
    fct.app_id = games.app_id
INNER JOIN 
    `pristine-flames-400818`.`games`.`dim_platforms` AS dp
ON
    fct.platform_id = dp.platform_id
    );
  
[0m15:40:24.255191 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:334968e8-c600-4a48-bded-0365e27104b4&page=queryresults
[0m15:40:32.939749 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 15:40:22.930459 => 15:40:32.938872
[0m15:40:32.942857 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c155e4b4-b1d7-4b0f-b028-befe02c75040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ac272da0>]}
[0m15:40:32.945395 [info ] [Thread-1 (]: 8 of 12 OK created sql table model games.fct_game_pricing ...................... [[32mCREATE TABLE (3.1m rows, 252.5 MiB processed)[0m in 10.02s]
[0m15:40:32.948232 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m15:40:32.951807 [debug] [Thread-1 (]: Began running node model.games.platform
[0m15:40:32.953960 [info ] [Thread-1 (]: 9 of 12 START sql table model games.platform ................................... [RUN]
[0m15:40:32.957000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.fct_game_pricing, now model.games.platform)
[0m15:40:32.958888 [debug] [Thread-1 (]: Began compiling node model.games.platform
[0m15:40:32.972356 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.platform"
[0m15:40:32.975408 [debug] [Thread-1 (]: Timing info for model.games.platform (compile): 15:40:32.960191 => 15:40:32.974426
[0m15:40:32.977308 [debug] [Thread-1 (]: Began executing node model.games.platform
[0m15:40:32.989216 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.platform"
[0m15:40:32.990627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:33.033358 [debug] [Thread-1 (]: On model.games.platform: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.platform"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`platform`
      
    
    

    OPTIONS()
    as (
      -- Informe de Ingresos por Plataforma
SELECT
    dp.platform_id,
    fs.total_sales
FROM
    `pristine-flames-400818`.`games`.`dim_platforms` dp
JOIN
    `pristine-flames-400818`.`games`.`fct_game_pricing` fs
ON
    dp.platform_id = fs.platform_id
GROUP BY dp.platform_id, fs.total_sales
ORDER BY fs.total_sales DESC
    );
  
[0m15:40:34.030099 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:611cfee3-e429-47a3-90dd-a5e6a208ac22&page=queryresults
[0m15:40:37.858962 [debug] [Thread-1 (]: Timing info for model.games.platform (execute): 15:40:32.978712 => 15:40:37.858341
[0m15:40:37.860990 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c155e4b4-b1d7-4b0f-b028-befe02c75040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ac3a17e0>]}
[0m15:40:37.862432 [info ] [Thread-1 (]: 9 of 12 OK created sql table model games.platform .............................. [[32mCREATE TABLE (432.2k rows, 71.1 MiB processed)[0m in 4.91s]
[0m15:40:37.863897 [debug] [Thread-1 (]: Finished running node model.games.platform
[0m15:40:37.864963 [debug] [Thread-1 (]: Began running node model.games.top_10_discounted_games
[0m15:40:37.866242 [info ] [Thread-1 (]: 10 of 12 START sql table model games.top_10_discounted_games ................... [RUN]
[0m15:40:37.867897 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.platform, now model.games.top_10_discounted_games)
[0m15:40:37.868838 [debug] [Thread-1 (]: Began compiling node model.games.top_10_discounted_games
[0m15:40:37.875133 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_discounted_games"
[0m15:40:37.876634 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (compile): 15:40:37.869501 => 15:40:37.876135
[0m15:40:37.877557 [debug] [Thread-1 (]: Began executing node model.games.top_10_discounted_games
[0m15:40:37.892860 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:38.596356 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_discounted_games"
[0m15:40:38.599151 [debug] [Thread-1 (]: On model.games.top_10_discounted_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_discounted_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_discounted_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 descuentos más grandes
SELECT
    app_id,
    game_name,
    total_discounts
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY total_discounts DESC
LIMIT 10
    );
  
[0m15:40:39.147499 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:2cc95f1c-77f7-4ab2-840d-fe9b769d2949&page=queryresults
[0m15:40:41.271020 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (execute): 15:40:37.878229 => 15:40:41.270584
[0m15:40:41.272551 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c155e4b4-b1d7-4b0f-b028-befe02c75040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ac265b40>]}
[0m15:40:41.273831 [info ] [Thread-1 (]: 10 of 12 OK created sql table model games.top_10_discounted_games .............. [[32mCREATE TABLE (10.0 rows, 162.8 MiB processed)[0m in 3.41s]
[0m15:40:41.275288 [debug] [Thread-1 (]: Finished running node model.games.top_10_discounted_games
[0m15:40:41.276337 [debug] [Thread-1 (]: Began running node model.games.top_10_high_tax_games
[0m15:40:41.277549 [info ] [Thread-1 (]: 11 of 12 START sql table model games.top_10_high_tax_games ..................... [RUN]
[0m15:40:41.278991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_discounted_games, now model.games.top_10_high_tax_games)
[0m15:40:41.279886 [debug] [Thread-1 (]: Began compiling node model.games.top_10_high_tax_games
[0m15:40:41.285751 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_high_tax_games"
[0m15:40:41.287155 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (compile): 15:40:41.280510 => 15:40:41.286701
[0m15:40:41.288038 [debug] [Thread-1 (]: Began executing node model.games.top_10_high_tax_games
[0m15:40:41.293071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:41.998805 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_high_tax_games"
[0m15:40:41.999630 [debug] [Thread-1 (]: On model.games.top_10_high_tax_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_high_tax_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_high_tax_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos con más impuestos
SELECT
    app_id,
    game_name,
    SUM(total_sales_with_tax) AS total_taxes
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
GROUP BY app_id, game_name
ORDER BY total_taxes DESC, game_name DESC
LIMIT 10
    );
  
[0m15:40:42.441116 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:2118db27-ff43-4de4-96bd-f89bc6d7c401&page=queryresults
[0m15:40:45.375542 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (execute): 15:40:41.288665 => 15:40:45.374669
[0m15:40:45.378673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c155e4b4-b1d7-4b0f-b028-befe02c75040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ac20c910>]}
[0m15:40:45.381212 [info ] [Thread-1 (]: 11 of 12 OK created sql table model games.top_10_high_tax_games ................ [[32mCREATE TABLE (10.0 rows, 162.8 MiB processed)[0m in 4.10s]
[0m15:40:45.384066 [debug] [Thread-1 (]: Finished running node model.games.top_10_high_tax_games
[0m15:40:45.386111 [debug] [Thread-1 (]: Began running node model.games.top_10_most_expensive_games
[0m15:40:45.388540 [info ] [Thread-1 (]: 12 of 12 START sql table model games.top_10_most_expensive_games ............... [RUN]
[0m15:40:45.391495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_high_tax_games, now model.games.top_10_most_expensive_games)
[0m15:40:45.393349 [debug] [Thread-1 (]: Began compiling node model.games.top_10_most_expensive_games
[0m15:40:45.404099 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_most_expensive_games"
[0m15:40:45.405771 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (compile): 15:40:45.394708 => 15:40:45.405272
[0m15:40:45.406725 [debug] [Thread-1 (]: Began executing node model.games.top_10_most_expensive_games
[0m15:40:45.411416 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:46.125996 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_most_expensive_games"
[0m15:40:46.128788 [debug] [Thread-1 (]: On model.games.top_10_most_expensive_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_most_expensive_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_most_expensive_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos más caros
SELECT
    app_id,
    game_name,
    max_price,
    formatted_initial_price,
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY max_price DESC
LIMIT 10
    );
  
[0m15:40:46.637407 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:1768fa0d-fd7e-4670-a571-521a4601608b&page=queryresults
[0m15:40:48.891585 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (execute): 15:40:45.407387 => 15:40:48.891398
[0m15:40:48.892388 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c155e4b4-b1d7-4b0f-b028-befe02c75040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ac222a40>]}
[0m15:40:48.892958 [info ] [Thread-1 (]: 12 of 12 OK created sql table model games.top_10_most_expensive_games .......... [[32mCREATE TABLE (10.0 rows, 177.7 MiB processed)[0m in 3.50s]
[0m15:40:48.893588 [debug] [Thread-1 (]: Finished running node model.games.top_10_most_expensive_games
[0m15:40:48.895069 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:40:48.895437 [debug] [MainThread]: Connection 'model.games.top_10_most_expensive_games' was properly closed.
[0m15:40:48.895852 [info ] [MainThread]: 
[0m15:40:48.896246 [info ] [MainThread]: Finished running 12 table models in 0 hours 0 minutes and 58.62 seconds (58.62s).
[0m15:40:48.898364 [debug] [MainThread]: Command end result
[0m15:40:48.913137 [info ] [MainThread]: 
[0m15:40:48.913555 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:40:48.913880 [info ] [MainThread]: 
[0m15:40:48.914214 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m15:40:48.914789 [debug] [MainThread]: Command `dbt run` succeeded at 15:40:48.914696 after 59.09 seconds
[0m15:40:48.915130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0b0d12b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ac2ad7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ac2aeb30>]}
[0m15:40:48.915484 [debug] [MainThread]: Flushing usage events
[0m15:42:41.405184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7bcf32ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7bb0c0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7bb0c00d0>]}


============================== 15:42:41.407477 | eb454b4d-9e51-4e24-ba7d-49a6b7252841 ==============================
[0m15:42:41.407477 [info ] [MainThread]: Running with dbt=1.6.5
[0m15:42:41.407978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:42:41.705395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb454b4d-9e51-4e24-ba7d-49a6b7252841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7bc512620>]}
[0m15:42:41.721898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb454b4d-9e51-4e24-ba7d-49a6b7252841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b90609d0>]}
[0m15:42:41.722602 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m15:42:41.736901 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m15:42:41.804469 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:42:41.805077 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m15:42:41.805505 [debug] [MainThread]: Partial parsing: updated file: games://models/report/platform.sql
[0m15:42:41.856002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb454b4d-9e51-4e24-ba7d-49a6b7252841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b874e4d0>]}
[0m15:42:41.866108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb454b4d-9e51-4e24-ba7d-49a6b7252841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b8e9b9d0>]}
[0m15:42:41.866656 [info ] [MainThread]: Found 12 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m15:42:41.867091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb454b4d-9e51-4e24-ba7d-49a6b7252841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b8e9ba00>]}
[0m15:42:41.868834 [info ] [MainThread]: 
[0m15:42:41.869643 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:42:41.871173 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m15:42:41.871654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:42.645231 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m15:42:42.647064 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:42:43.373202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb454b4d-9e51-4e24-ba7d-49a6b7252841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b8e9a8c0>]}
[0m15:42:43.374079 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:42:43.374505 [info ] [MainThread]: 
[0m15:42:43.376522 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m15:42:43.377081 [info ] [Thread-1 (]: 1 of 12 START sql table model games.dim_developers ............................. [RUN]
[0m15:42:43.377805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m15:42:43.378210 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m15:42:43.385485 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m15:42:43.386471 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 15:42:43.378493 => 15:42:43.385999
[0m15:42:43.386962 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m15:42:43.402304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:42:44.167531 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m15:42:44.169039 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS developer_id,
    developers_name
FROM
    developers_cte
    );
  
[0m15:42:44.763841 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e6e922a7-e293-4554-8bad-1370fb206a17&page=queryresults
[0m15:42:46.951977 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 15:42:43.387276 => 15:42:46.951796
[0m15:42:46.952707 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb454b4d-9e51-4e24-ba7d-49a6b7252841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b8e748e0>]}
[0m15:42:46.953343 [info ] [Thread-1 (]: 1 of 12 OK created sql table model games.dim_developers ........................ [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 3.58s]
[0m15:42:46.953962 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m15:42:46.954415 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m15:42:46.955028 [info ] [Thread-1 (]: 2 of 12 START sql table model games.dim_games .................................. [RUN]
[0m15:42:46.955665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m15:42:46.956044 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m15:42:46.963927 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m15:42:46.964628 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 15:42:46.956307 => 15:42:46.964410
[0m15:42:46.964997 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m15:42:46.967391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:42:47.698920 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m15:42:47.701649 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m15:42:48.169284 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f8f6d037-2793-43af-9bc0-b54c5e92fcb6&page=queryresults
[0m15:42:50.552388 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 15:42:46.965250 => 15:42:50.551857
[0m15:42:50.554520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb454b4d-9e51-4e24-ba7d-49a6b7252841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b8e77280>]}
[0m15:42:50.556098 [info ] [Thread-1 (]: 2 of 12 OK created sql table model games.dim_games ............................. [[32mCREATE TABLE (2.7k rows, 753.9 KiB processed)[0m in 3.60s]
[0m15:42:50.557790 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m15:42:50.559165 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m15:42:50.560613 [info ] [Thread-1 (]: 3 of 12 START sql table model games.dim_platforms .............................. [RUN]
[0m15:42:50.562388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m15:42:50.563492 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m15:42:50.570070 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m15:42:50.571469 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 15:42:50.564261 => 15:42:50.571039
[0m15:42:50.572172 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m15:42:50.576024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:42:51.274128 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m15:42:51.276947 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m15:42:51.875958 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:57aebee6-46bb-4563-b8ab-e5141aa2678e&page=queryresults
[0m15:42:54.300075 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 15:42:50.572644 => 15:42:54.299886
[0m15:42:54.300801 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb454b4d-9e51-4e24-ba7d-49a6b7252841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b862fb80>]}
[0m15:42:54.301375 [info ] [Thread-1 (]: 3 of 12 OK created sql table model games.dim_platforms ......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 3.74s]
[0m15:42:54.301957 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m15:42:54.302385 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m15:42:54.302926 [info ] [Thread-1 (]: 4 of 12 START sql table model games.dim_price_overview ......................... [RUN]
[0m15:42:54.303550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m15:42:54.303923 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m15:42:54.306884 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m15:42:54.307543 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 15:42:54.304187 => 15:42:54.307336
[0m15:42:54.307958 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m15:42:54.310659 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:42:54.973275 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m15:42:54.973940 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    platform_id,
    windows,
    mac,
    linux,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte, games.dim_platforms
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m15:42:55.598330 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:17c99224-735d-4c2a-894c-38ad181aacb6&page=queryresults
[0m15:43:00.786367 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 15:42:54.308242 => 15:43:00.786103
[0m15:43:00.787346 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb454b4d-9e51-4e24-ba7d-49a6b7252841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b8662530>]}
[0m15:43:00.788113 [info ] [Thread-1 (]: 4 of 12 OK created sql table model games.dim_price_overview .................... [[32mCREATE TABLE (3.1m rows, 199.1 KiB processed)[0m in 6.48s]
[0m15:43:00.788930 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m15:43:00.789528 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m15:43:00.790332 [info ] [Thread-1 (]: 5 of 12 START sql table model games.dim_publishers ............................. [RUN]
[0m15:43:00.791212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m15:43:00.791739 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m15:43:00.795626 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m15:43:00.796579 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 15:43:00.792111 => 15:43:00.796276
[0m15:43:00.797160 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m15:43:00.800751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:01.507639 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m15:43:01.508252 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m15:43:02.037524 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5347ddb9-d2d9-4e47-94ca-db8b375751aa&page=queryresults
[0m15:43:05.055345 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 15:43:00.797576 => 15:43:05.054865
[0m15:43:05.057054 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb454b4d-9e51-4e24-ba7d-49a6b7252841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b8650df0>]}
[0m15:43:05.058427 [info ] [Thread-1 (]: 5 of 12 OK created sql table model games.dim_publishers ........................ [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.27s]
[0m15:43:05.059913 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m15:43:05.060967 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m15:43:05.062220 [info ] [Thread-1 (]: 6 of 12 START sql table model games.dim_release ................................ [RUN]
[0m15:43:05.063783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m15:43:05.064724 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m15:43:05.071389 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m15:43:05.072908 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 15:43:05.065389 => 15:43:05.072429
[0m15:43:05.073829 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m15:43:05.078121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:05.843466 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m15:43:05.844195 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m15:43:06.432903 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:006ec2e8-9676-4070-8464-08e565946b93&page=queryresults
[0m15:43:08.875409 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 15:43:05.074502 => 15:43:08.874553
[0m15:43:08.878874 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb454b4d-9e51-4e24-ba7d-49a6b7252841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b86510c0>]}
[0m15:43:08.881404 [info ] [Thread-1 (]: 6 of 12 OK created sql table model games.dim_release ........................... [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 3.82s]
[0m15:43:08.884197 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m15:43:08.886193 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m15:43:08.888692 [info ] [Thread-1 (]: 7 of 12 START sql table model games.dim_support_language ....................... [RUN]
[0m15:43:08.891162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m15:43:08.892468 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m15:43:08.899585 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m15:43:08.900752 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 15:43:08.893353 => 15:43:08.900375
[0m15:43:08.901477 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m15:43:08.911903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:09.612406 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m15:43:09.615940 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m15:43:10.087315 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:3ea931aa-9004-404f-ae50-5fa7dcc778c7&page=queryresults
[0m15:43:12.493647 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 15:43:08.901994 => 15:43:12.492727
[0m15:43:12.496829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb454b4d-9e51-4e24-ba7d-49a6b7252841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b868c040>]}
[0m15:43:12.499466 [info ] [Thread-1 (]: 7 of 12 OK created sql table model games.dim_support_language .................. [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 3.61s]
[0m15:43:12.502403 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m15:43:12.504535 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m15:43:12.507015 [info ] [Thread-1 (]: 8 of 12 START sql table model games.fct_game_pricing ........................... [RUN]
[0m15:43:12.510149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m15:43:12.512104 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m15:43:12.522316 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m15:43:12.524037 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 15:43:12.513432 => 15:43:12.523509
[0m15:43:12.525118 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m15:43:12.529744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:13.265008 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m15:43:13.268192 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para el análisis de precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        formatted_initial_price,
        platform_id,
        formatted_price_with_tax
        SUM(price_with_tax) AS total_sales,
        SUM(discount_amount) AS total_discounts,
        COUNT(*) AS num_sales,
        MAX(discount_pct) AS max_discount,
        MIN(initial_price) AS min_price,
        MAX(initial_price) AS max_price,
        SUM(price_with_tax) AS total_sales_with_tax,
        SUM(final_price) AS total_sales_with_tax_discounted
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id, platform_id, formatted_initial_price, formatted_price_with_tax
)

SELECT
    fct.app_id,
    fct.formatted_initial_price,
    fct.total_sales,
    fct.platform_id,
    fct.formatted_price_with_tax
    fct.total_discounts,
    fct.num_sales,
    fct.max_discount,
    fct.min_price,
    fct.max_price,
    fct.total_sales_with_tax,
    fct.total_sales_with_tax_discounted,
    games.name AS game_name,
    games.description AS game_description,
    games.is_free AS game_is_free,
    games.fullgame_app_id,
    games.fullgame_name,
    games.type,
    games.genre_id,
    games.type_genre,
FROM
    game_sales AS fct
INNER JOIN
    `pristine-flames-400818`.`games`.`dim_games` AS games
ON
    fct.app_id = games.app_id
INNER JOIN 
    `pristine-flames-400818`.`games`.`dim_platforms` AS dp
ON
    fct.platform_id = dp.platform_id
    );
  
[0m15:43:13.555536 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:4ef223f5-2ee3-4359-8d1e-6be486faee40&page=queryresults
[0m15:43:13.559779 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got "(" at [22:12]')
[0m15:43:13.993895 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:bebc9ba1-723e-4120-b446-c25806b2d2d6&page=queryresults
[0m15:43:13.998087 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:bebc9ba1-723e-4120-b446-c25806b2d2d6&page=queryresults
[0m15:43:14.001103 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 15:43:12.525746 => 15:43:14.000183
[0m15:43:14.014199 [debug] [Thread-1 (]: Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Syntax error: Expected ")" but got "(" at [22:12]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m15:43:14.016221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb454b4d-9e51-4e24-ba7d-49a6b7252841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b8688d90>]}
[0m15:43:14.018821 [error] [Thread-1 (]: 8 of 12 ERROR creating sql table model games.fct_game_pricing .................. [[31mERROR[0m in 1.51s]
[0m15:43:14.021565 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m15:43:14.025064 [debug] [Thread-1 (]: Began running node model.games.platform
[0m15:43:14.026537 [info ] [Thread-1 (]: 9 of 12 SKIP relation games.platform ........................................... [[33mSKIP[0m]
[0m15:43:14.028109 [debug] [Thread-1 (]: Finished running node model.games.platform
[0m15:43:14.029543 [debug] [Thread-1 (]: Began running node model.games.top_10_discounted_games
[0m15:43:14.030736 [info ] [Thread-1 (]: 10 of 12 SKIP relation games.top_10_discounted_games ........................... [[33mSKIP[0m]
[0m15:43:14.031893 [debug] [Thread-1 (]: Finished running node model.games.top_10_discounted_games
[0m15:43:14.032941 [debug] [Thread-1 (]: Began running node model.games.top_10_high_tax_games
[0m15:43:14.034105 [info ] [Thread-1 (]: 11 of 12 SKIP relation games.top_10_high_tax_games ............................. [[33mSKIP[0m]
[0m15:43:14.035235 [debug] [Thread-1 (]: Finished running node model.games.top_10_high_tax_games
[0m15:43:14.036058 [debug] [Thread-1 (]: Began running node model.games.top_10_most_expensive_games
[0m15:43:14.036971 [info ] [Thread-1 (]: 12 of 12 SKIP relation games.top_10_most_expensive_games ....................... [[33mSKIP[0m]
[0m15:43:14.037855 [debug] [Thread-1 (]: Finished running node model.games.top_10_most_expensive_games
[0m15:43:14.040425 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:43:14.041044 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m15:43:14.041655 [info ] [MainThread]: 
[0m15:43:14.042229 [info ] [MainThread]: Finished running 12 table models in 0 hours 0 minutes and 32.17 seconds (32.17s).
[0m15:43:14.044963 [debug] [MainThread]: Command end result
[0m15:43:14.056937 [info ] [MainThread]: 
[0m15:43:14.057525 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:43:14.057999 [info ] [MainThread]: 
[0m15:43:14.058458 [error] [MainThread]:   Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Syntax error: Expected ")" but got "(" at [22:12]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m15:43:14.058946 [info ] [MainThread]: 
[0m15:43:14.059455 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=4 TOTAL=12
[0m15:43:14.060218 [debug] [MainThread]: Command `dbt run` failed at 15:43:14.060082 after 32.66 seconds
[0m15:43:14.060725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7bcf32ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b868c040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b8e9b400>]}
[0m15:43:14.061242 [debug] [MainThread]: Flushing usage events
[0m15:43:39.129793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed7302d1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed71088070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed710880d0>]}


============================== 15:43:39.132070 | 60f56641-a3ae-41a5-b45c-bc754ddfacf6 ==============================
[0m15:43:39.132070 [info ] [MainThread]: Running with dbt=1.6.5
[0m15:43:39.132568 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:43:39.425880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60f56641-a3ae-41a5-b45c-bc754ddfacf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed725d53f0>]}
[0m15:43:39.442024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60f56641-a3ae-41a5-b45c-bc754ddfacf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed6f0289d0>]}
[0m15:43:39.442705 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m15:43:39.456622 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m15:43:39.523512 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:43:39.524087 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m15:43:39.569972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60f56641-a3ae-41a5-b45c-bc754ddfacf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed6eee2350>]}
[0m15:43:39.579551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60f56641-a3ae-41a5-b45c-bc754ddfacf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed6ee5f9d0>]}
[0m15:43:39.580008 [info ] [MainThread]: Found 12 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m15:43:39.580349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60f56641-a3ae-41a5-b45c-bc754ddfacf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed6ee5f970>]}
[0m15:43:39.581796 [info ] [MainThread]: 
[0m15:43:39.582631 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:43:39.584435 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m15:43:39.584976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:43:40.328099 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m15:43:40.330125 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:43:41.026115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60f56641-a3ae-41a5-b45c-bc754ddfacf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed6ee5d270>]}
[0m15:43:41.027058 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:43:41.027591 [info ] [MainThread]: 
[0m15:43:41.029662 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m15:43:41.030226 [info ] [Thread-1 (]: 1 of 12 START sql table model games.dim_developers ............................. [RUN]
[0m15:43:41.030905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m15:43:41.031321 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m15:43:41.038700 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m15:43:41.039499 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 15:43:41.031611 => 15:43:41.039242
[0m15:43:41.039912 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m15:43:41.053937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:41.727887 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m15:43:41.728559 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS developer_id,
    developers_name
FROM
    developers_cte
    );
  
[0m15:43:42.339971 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:cbb17256-2af5-4956-a15c-4626714dc2b2&page=queryresults
[0m15:43:44.730786 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 15:43:41.040189 => 15:43:44.730467
[0m15:43:44.731913 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60f56641-a3ae-41a5-b45c-bc754ddfacf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed6ee3c940>]}
[0m15:43:44.732819 [info ] [Thread-1 (]: 1 of 12 OK created sql table model games.dim_developers ........................ [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 3.70s]
[0m15:43:44.733674 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m15:43:44.734268 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m15:43:44.734984 [info ] [Thread-1 (]: 2 of 12 START sql table model games.dim_games .................................. [RUN]
[0m15:43:44.735842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m15:43:44.736367 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m15:43:44.745585 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m15:43:44.746340 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 15:43:44.736744 => 15:43:44.746113
[0m15:43:44.746768 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m15:43:44.749101 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:45.398865 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m15:43:45.401567 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m15:43:46.011707 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:74c61ab1-1664-4f00-a39e-3992d23cbfa1&page=queryresults
[0m15:43:48.137601 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 15:43:44.747054 => 15:43:48.136723
[0m15:43:48.140752 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60f56641-a3ae-41a5-b45c-bc754ddfacf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed6ee3ccd0>]}
[0m15:43:48.143355 [info ] [Thread-1 (]: 2 of 12 OK created sql table model games.dim_games ............................. [[32mCREATE TABLE (2.7k rows, 753.9 KiB processed)[0m in 3.40s]
[0m15:43:48.146158 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m15:43:48.148213 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m15:43:48.150656 [info ] [Thread-1 (]: 3 of 12 START sql table model games.dim_platforms .............................. [RUN]
[0m15:43:48.153650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m15:43:48.155505 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m15:43:48.164483 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m15:43:48.165966 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 15:43:48.156817 => 15:43:48.165489
[0m15:43:48.166913 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m15:43:48.171199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:48.881340 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m15:43:48.882062 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m15:43:49.315749 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:23148cba-826d-459c-a907-de9cea19bbc8&page=queryresults
[0m15:43:51.709968 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 15:43:48.167568 => 15:43:51.709789
[0m15:43:51.710725 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60f56641-a3ae-41a5-b45c-bc754ddfacf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed6ee3f1c0>]}
[0m15:43:51.711287 [info ] [Thread-1 (]: 3 of 12 OK created sql table model games.dim_platforms ......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 3.56s]
[0m15:43:51.711888 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m15:43:51.712352 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m15:43:51.712917 [info ] [Thread-1 (]: 4 of 12 START sql table model games.dim_price_overview ......................... [RUN]
[0m15:43:51.713541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m15:43:51.713923 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m15:43:51.716865 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m15:43:51.717486 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 15:43:51.714191 => 15:43:51.717292
[0m15:43:51.717863 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m15:43:51.720063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:52.411697 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m15:43:52.414591 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    platform_id,
    windows,
    mac,
    linux,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte, games.dim_platforms
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m15:43:53.049412 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:760cb6eb-730c-4a77-9f07-4be88395c207&page=queryresults
[0m15:43:58.551098 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 15:43:51.718128 => 15:43:58.550202
[0m15:43:58.554914 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60f56641-a3ae-41a5-b45c-bc754ddfacf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed6e4222c0>]}
[0m15:43:58.557571 [info ] [Thread-1 (]: 4 of 12 OK created sql table model games.dim_price_overview .................... [[32mCREATE TABLE (3.1m rows, 199.1 KiB processed)[0m in 6.84s]
[0m15:43:58.560414 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m15:43:58.562447 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m15:43:58.565110 [info ] [Thread-1 (]: 5 of 12 START sql table model games.dim_publishers ............................. [RUN]
[0m15:43:58.568112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m15:43:58.569931 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m15:43:58.582075 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m15:43:58.584837 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 15:43:58.571238 => 15:43:58.583940
[0m15:43:58.586707 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m15:43:58.593790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:59.323339 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m15:43:59.324004 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m15:43:59.745720 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:efae6c1b-6a9f-4e50-aae0-e9b076057882&page=queryresults
[0m15:44:02.118025 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 15:43:58.588011 => 15:44:02.117094
[0m15:44:02.121269 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60f56641-a3ae-41a5-b45c-bc754ddfacf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed6e410d60>]}
[0m15:44:02.124071 [info ] [Thread-1 (]: 5 of 12 OK created sql table model games.dim_publishers ........................ [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 3.55s]
[0m15:44:02.126993 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m15:44:02.129088 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m15:44:02.131560 [info ] [Thread-1 (]: 6 of 12 START sql table model games.dim_release ................................ [RUN]
[0m15:44:02.134508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m15:44:02.135905 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m15:44:02.143383 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m15:44:02.144745 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 15:44:02.136862 => 15:44:02.144363
[0m15:44:02.145492 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m15:44:02.149695 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:44:02.811240 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m15:44:02.811996 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m15:44:03.234597 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7da3f5e0-3f69-4598-81a5-b3b3d07ac6bc&page=queryresults
[0m15:44:05.689637 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 15:44:02.146034 => 15:44:05.689406
[0m15:44:05.690638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60f56641-a3ae-41a5-b45c-bc754ddfacf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed6e411030>]}
[0m15:44:05.691379 [info ] [Thread-1 (]: 6 of 12 OK created sql table model games.dim_release ........................... [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 3.56s]
[0m15:44:05.692125 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m15:44:05.692698 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m15:44:05.693347 [info ] [Thread-1 (]: 7 of 12 START sql table model games.dim_support_language ....................... [RUN]
[0m15:44:05.694216 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m15:44:05.694741 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m15:44:05.698299 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m15:44:05.699148 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 15:44:05.695085 => 15:44:05.698892
[0m15:44:05.699648 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m15:44:05.707808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:44:06.393752 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m15:44:06.394412 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m15:44:06.960219 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ea4f637b-d3b7-4b17-818c-e4d960fbdab2&page=queryresults
[0m15:44:09.351933 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 15:44:05.699971 => 15:44:09.351074
[0m15:44:09.355005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60f56641-a3ae-41a5-b45c-bc754ddfacf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed6e444bb0>]}
[0m15:44:09.357540 [info ] [Thread-1 (]: 7 of 12 OK created sql table model games.dim_support_language .................. [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 3.66s]
[0m15:44:09.360349 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m15:44:09.362385 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m15:44:09.364854 [info ] [Thread-1 (]: 8 of 12 START sql table model games.fct_game_pricing ........................... [RUN]
[0m15:44:09.367905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m15:44:09.369874 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m15:44:09.379544 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m15:44:09.381111 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 15:44:09.371349 => 15:44:09.380598
[0m15:44:09.381886 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m15:44:09.386182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:44:10.102628 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m15:44:10.105508 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para el análisis de precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        formatted_initial_price,
        platform_id,
        formatted_price_with_tax
        SUM(price_with_tax) AS total_sales,
        SUM(discount_amount) AS total_discounts,
        COUNT(*) AS num_sales,
        MAX(discount_pct) AS max_discount,
        MIN(initial_price) AS min_price,
        MAX(initial_price) AS max_price,
        SUM(price_with_tax) AS total_sales_with_tax,
        SUM(final_price) AS total_sales_with_tax_discounted
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id, platform_id, formatted_initial_price, formatted_price_with_tax
)

SELECT
    fct.app_id,
    fct.formatted_initial_price,
    fct.total_sales,
    fct.platform_id,
    fct.formatted_price_with_tax,
    fct.total_discounts,
    fct.num_sales,
    fct.max_discount,
    fct.min_price,
    fct.max_price,
    fct.total_sales_with_tax,
    fct.total_sales_with_tax_discounted,
    games.name AS game_name,
    games.description AS game_description,
    games.is_free AS game_is_free,
    games.fullgame_app_id,
    games.fullgame_name,
    games.type,
    games.genre_id,
    games.type_genre,
FROM
    game_sales AS fct
INNER JOIN
    `pristine-flames-400818`.`games`.`dim_games` AS games
ON
    fct.app_id = games.app_id
INNER JOIN 
    `pristine-flames-400818`.`games`.`dim_platforms` AS dp
ON
    fct.platform_id = dp.platform_id
    );
  
[0m15:44:10.410760 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:131b35e7-0f91-427e-91df-cbb9d6b4cf81&page=queryresults
[0m15:44:10.411858 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got "(" at [22:12]')
[0m15:44:10.907381 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:62828c84-8d5d-4202-86a6-91ede8372750&page=queryresults
[0m15:44:10.911724 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:62828c84-8d5d-4202-86a6-91ede8372750&page=queryresults
[0m15:44:10.914812 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 15:44:09.382414 => 15:44:10.913827
[0m15:44:10.928055 [debug] [Thread-1 (]: Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Syntax error: Expected ")" but got "(" at [22:12]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m15:44:10.930188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60f56641-a3ae-41a5-b45c-bc754ddfacf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed6e447be0>]}
[0m15:44:10.932814 [error] [Thread-1 (]: 8 of 12 ERROR creating sql table model games.fct_game_pricing .................. [[31mERROR[0m in 1.56s]
[0m15:44:10.935607 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m15:44:10.938475 [debug] [Thread-1 (]: Began running node model.games.platform
[0m15:44:10.940124 [info ] [Thread-1 (]: 9 of 12 SKIP relation games.platform ........................................... [[33mSKIP[0m]
[0m15:44:10.941605 [debug] [Thread-1 (]: Finished running node model.games.platform
[0m15:44:10.942929 [debug] [Thread-1 (]: Began running node model.games.top_10_discounted_games
[0m15:44:10.944203 [info ] [Thread-1 (]: 10 of 12 SKIP relation games.top_10_discounted_games ........................... [[33mSKIP[0m]
[0m15:44:10.945377 [debug] [Thread-1 (]: Finished running node model.games.top_10_discounted_games
[0m15:44:10.946594 [debug] [Thread-1 (]: Began running node model.games.top_10_high_tax_games
[0m15:44:10.947736 [info ] [Thread-1 (]: 11 of 12 SKIP relation games.top_10_high_tax_games ............................. [[33mSKIP[0m]
[0m15:44:10.948860 [debug] [Thread-1 (]: Finished running node model.games.top_10_high_tax_games
[0m15:44:10.949914 [debug] [Thread-1 (]: Began running node model.games.top_10_most_expensive_games
[0m15:44:10.950919 [info ] [Thread-1 (]: 12 of 12 SKIP relation games.top_10_most_expensive_games ....................... [[33mSKIP[0m]
[0m15:44:10.951961 [debug] [Thread-1 (]: Finished running node model.games.top_10_most_expensive_games
[0m15:44:10.954376 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:44:10.955032 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m15:44:10.955728 [info ] [MainThread]: 
[0m15:44:10.956404 [info ] [MainThread]: Finished running 12 table models in 0 hours 0 minutes and 31.37 seconds (31.37s).
[0m15:44:10.959248 [debug] [MainThread]: Command end result
[0m15:44:10.971614 [info ] [MainThread]: 
[0m15:44:10.972160 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:44:10.972589 [info ] [MainThread]: 
[0m15:44:10.973001 [error] [MainThread]:   Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Syntax error: Expected ")" but got "(" at [22:12]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m15:44:10.973420 [info ] [MainThread]: 
[0m15:44:10.973864 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=4 TOTAL=12
[0m15:44:10.974550 [debug] [MainThread]: Command `dbt run` failed at 15:44:10.974422 after 31.85 seconds
[0m15:44:10.975003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed7302d1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed725d4e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed6ee5f370>]}
[0m15:44:10.975466 [debug] [MainThread]: Flushing usage events
[0m15:47:33.207701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb50c522b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb50a6bc070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb50a6bc0d0>]}


============================== 15:47:33.209755 | 34d26f93-3405-48ff-9c1c-3d2eee58507f ==============================
[0m15:47:33.209755 [info ] [MainThread]: Running with dbt=1.6.5
[0m15:47:33.210264 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '../dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:47:33.484941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34d26f93-3405-48ff-9c1c-3d2eee58507f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb50bb83070>]}
[0m15:47:33.500646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34d26f93-3405-48ff-9c1c-3d2eee58507f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb50865b490>]}
[0m15:47:33.501208 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m15:47:33.514360 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m15:47:33.579541 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:47:33.580090 [debug] [MainThread]: Partial parsing: updated file: games://models/report/platform.sql
[0m15:47:33.580493 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m15:47:33.627572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34d26f93-3405-48ff-9c1c-3d2eee58507f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb507d562c0>]}
[0m15:47:33.636852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34d26f93-3405-48ff-9c1c-3d2eee58507f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb508493a60>]}
[0m15:47:33.637304 [info ] [MainThread]: Found 12 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m15:47:33.637648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34d26f93-3405-48ff-9c1c-3d2eee58507f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5084939a0>]}
[0m15:47:33.639130 [info ] [MainThread]: 
[0m15:47:33.639781 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:47:33.641326 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m15:47:33.641790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:34.400597 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m15:47:34.402590 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:35.087778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34d26f93-3405-48ff-9c1c-3d2eee58507f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb508492830>]}
[0m15:47:35.091015 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:47:35.092690 [info ] [MainThread]: 
[0m15:47:35.100769 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m15:47:35.102987 [info ] [Thread-1 (]: 1 of 12 START sql table model games.dim_developers ............................. [RUN]
[0m15:47:35.105876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m15:47:35.107715 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m15:47:35.138636 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m15:47:35.140214 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 15:47:35.108998 => 15:47:35.139713
[0m15:47:35.141152 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m15:47:35.161710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:35.887198 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m15:47:35.887888 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS developer_id,
    developers_name
FROM
    developers_cte
    );
  
[0m15:47:36.340009 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:6908f69c-c6a1-4be8-bab2-22863d4f5eb5&page=queryresults
[0m15:47:38.754112 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 15:47:35.141835 => 15:47:38.753906
[0m15:47:38.754877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34d26f93-3405-48ff-9c1c-3d2eee58507f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb508472cb0>]}
[0m15:47:38.755472 [info ] [Thread-1 (]: 1 of 12 OK created sql table model games.dim_developers ........................ [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 3.65s]
[0m15:47:38.756090 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m15:47:38.756532 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m15:47:38.757075 [info ] [Thread-1 (]: 2 of 12 START sql table model games.dim_games .................................. [RUN]
[0m15:47:38.757793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m15:47:38.758209 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m15:47:38.766825 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m15:47:38.767580 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 15:47:38.758496 => 15:47:38.767343
[0m15:47:38.767960 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m15:47:38.770265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:39.470546 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m15:47:39.471179 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m15:47:39.975080 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d305bd7d-8aa0-4467-b659-afb0069fc493&page=queryresults
[0m15:47:42.409168 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 15:47:38.768219 => 15:47:42.408934
[0m15:47:42.410061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34d26f93-3405-48ff-9c1c-3d2eee58507f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb508470ee0>]}
[0m15:47:42.410722 [info ] [Thread-1 (]: 2 of 12 OK created sql table model games.dim_games ............................. [[32mCREATE TABLE (2.7k rows, 753.9 KiB processed)[0m in 3.65s]
[0m15:47:42.411401 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m15:47:42.411885 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m15:47:42.412450 [info ] [Thread-1 (]: 3 of 12 START sql table model games.dim_platforms .............................. [RUN]
[0m15:47:42.413153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m15:47:42.413555 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m15:47:42.416993 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m15:47:42.417766 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 15:47:42.413821 => 15:47:42.417522
[0m15:47:42.418193 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m15:47:42.420581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:43.127668 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m15:47:43.131647 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m15:47:43.709208 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c15ed66f-4bdf-4c3e-83b0-e9a7c3887588&page=queryresults
[0m15:47:46.269519 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 15:47:42.418471 => 15:47:46.269338
[0m15:47:46.270219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34d26f93-3405-48ff-9c1c-3d2eee58507f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb508470df0>]}
[0m15:47:46.270788 [info ] [Thread-1 (]: 3 of 12 OK created sql table model games.dim_platforms ......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 3.86s]
[0m15:47:46.271399 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m15:47:46.271934 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m15:47:46.272502 [info ] [Thread-1 (]: 4 of 12 START sql table model games.dim_price_overview ......................... [RUN]
[0m15:47:46.273144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m15:47:46.273516 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m15:47:46.276494 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m15:47:46.277125 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 15:47:46.273810 => 15:47:46.276927
[0m15:47:46.277505 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m15:47:46.279732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:47.022971 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m15:47:47.023760 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    platform_id,
    windows,
    mac,
    linux,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte, games.dim_platforms
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m15:47:47.425495 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:391f8aad-19c9-40a7-9e24-c66793b5229f&page=queryresults
[0m15:47:52.771388 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 15:47:46.277775 => 15:47:52.770512
[0m15:47:52.774555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34d26f93-3405-48ff-9c1c-3d2eee58507f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb507c5e260>]}
[0m15:47:52.777163 [info ] [Thread-1 (]: 4 of 12 OK created sql table model games.dim_price_overview .................... [[32mCREATE TABLE (3.1m rows, 199.1 KiB processed)[0m in 6.50s]
[0m15:47:52.779982 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m15:47:52.782010 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m15:47:52.784674 [info ] [Thread-1 (]: 5 of 12 START sql table model games.dim_publishers ............................. [RUN]
[0m15:47:52.787661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m15:47:52.789487 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m15:47:52.801780 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m15:47:52.804644 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 15:47:52.790804 => 15:47:52.803692
[0m15:47:52.806442 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m15:47:52.815626 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:53.554965 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m15:47:53.558184 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m15:47:54.024417 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:360ea972-913f-4069-9ec5-bf8a14de002f&page=queryresults
[0m15:47:56.426800 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 15:47:52.807765 => 15:47:56.426615
[0m15:47:56.427502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34d26f93-3405-48ff-9c1c-3d2eee58507f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb507c0ee00>]}
[0m15:47:56.428075 [info ] [Thread-1 (]: 5 of 12 OK created sql table model games.dim_publishers ........................ [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 3.64s]
[0m15:47:56.428689 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m15:47:56.429155 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m15:47:56.429716 [info ] [Thread-1 (]: 6 of 12 START sql table model games.dim_release ................................ [RUN]
[0m15:47:56.430357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m15:47:56.430786 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m15:47:56.433485 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m15:47:56.434130 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 15:47:56.431066 => 15:47:56.433904
[0m15:47:56.434536 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m15:47:56.436679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:57.112003 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m15:47:57.112705 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m15:47:57.521178 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:51597780-c637-4e3e-bc15-25ce3780ed19&page=queryresults
[0m15:48:00.217533 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 15:47:56.434812 => 15:48:00.216649
[0m15:48:00.220894 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34d26f93-3405-48ff-9c1c-3d2eee58507f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb507c4cf70>]}
[0m15:48:00.223521 [info ] [Thread-1 (]: 6 of 12 OK created sql table model games.dim_release ........................... [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 3.79s]
[0m15:48:00.226704 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m15:48:00.228861 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m15:48:00.231414 [info ] [Thread-1 (]: 7 of 12 START sql table model games.dim_support_language ....................... [RUN]
[0m15:48:00.234061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m15:48:00.235403 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m15:48:00.243065 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m15:48:00.244334 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 15:48:00.236337 => 15:48:00.243924
[0m15:48:00.245075 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m15:48:00.255923 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:00.936448 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m15:48:00.937151 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m15:48:01.369358 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9a874197-81d3-44ec-857e-045f0d90de8b&page=queryresults
[0m15:48:04.332943 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 15:48:00.245597 => 15:48:04.332751
[0m15:48:04.333664 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34d26f93-3405-48ff-9c1c-3d2eee58507f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb507c84a00>]}
[0m15:48:04.334240 [info ] [Thread-1 (]: 7 of 12 OK created sql table model games.dim_support_language .................. [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.10s]
[0m15:48:04.334837 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m15:48:04.335263 [debug] [Thread-1 (]: Began running node model.games.platform
[0m15:48:04.335775 [info ] [Thread-1 (]: 8 of 12 START sql table model games.platform ................................... [RUN]
[0m15:48:04.336382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.platform)
[0m15:48:04.336748 [debug] [Thread-1 (]: Began compiling node model.games.platform
[0m15:48:04.338640 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.platform"
[0m15:48:04.339281 [debug] [Thread-1 (]: Timing info for model.games.platform (compile): 15:48:04.337013 => 15:48:04.339067
[0m15:48:04.339660 [debug] [Thread-1 (]: Began executing node model.games.platform
[0m15:48:04.341878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:05.023247 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.platform"
[0m15:48:05.023942 [debug] [Thread-1 (]: On model.games.platform: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.platform"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`platform`
      
    
    

    OPTIONS()
    as (
      -- Informe de Ingresos por Plataforma
SELECT
    p.platform_id,
    s.total_sales,
    SUM(CASE WHEN p.windows = 1 THEN s.price_with_tax ELSE 0 END) AS total_sales_windows,
    SUM(CASE WHEN p.mac = 1 THEN s.price_with_tax ELSE 0 END) AS total_sales_mac,
    SUM(CASE WHEN p.linux = 1 THEN s.price_with_tax ELSE 0 END) AS total_sales_linux
FROM
    fct_sales s
JOIN
    dim_platforms p ON s.platform_id = p.platform_id
GROUP BY
    p.platform_id
ORDER BY
    total_sales DESC;
    );
  
[0m15:48:05.289569 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b12c9443-cae2-46dc-bd69-b81d244ac9d8&page=queryresults
[0m15:48:05.293677 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [27:21]')
[0m15:48:06.528550 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a521b83b-0a34-4361-a5f2-03a03db14f6f&page=queryresults
[0m15:48:06.531332 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a521b83b-0a34-4361-a5f2-03a03db14f6f&page=queryresults
[0m15:48:06.531983 [debug] [Thread-1 (]: Timing info for model.games.platform (execute): 15:48:04.339930 => 15:48:06.531784
[0m15:48:06.534821 [debug] [Thread-1 (]: Database Error in model platform (models/report/platform.sql)
  Syntax error: Expected ")" but got ";" at [27:21]
  compiled Code at target/run/games/models/report/platform.sql
[0m15:48:06.535292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34d26f93-3405-48ff-9c1c-3d2eee58507f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb507c86380>]}
[0m15:48:06.535871 [error] [Thread-1 (]: 8 of 12 ERROR creating sql table model games.platform .......................... [[31mERROR[0m in 2.20s]
[0m15:48:06.536462 [debug] [Thread-1 (]: Finished running node model.games.platform
[0m15:48:06.536892 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m15:48:06.537335 [info ] [Thread-1 (]: 9 of 12 START sql table model games.fct_game_pricing ........................... [RUN]
[0m15:48:06.537963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.platform, now model.games.fct_game_pricing)
[0m15:48:06.538443 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m15:48:06.541924 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m15:48:06.542566 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 15:48:06.538730 => 15:48:06.542362
[0m15:48:06.542948 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m15:48:06.545179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:07.255584 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m15:48:07.258467 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para el análisis de precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        formatted_initial_price,
        platform_id,
        formatted_price_with_tax,
        price_with_tax,
        SUM(price_with_tax) AS total_sales,
        SUM(discount_amount) AS total_discounts,
        COUNT(*) AS num_sales,
        MAX(discount_pct) AS max_discount,
        MIN(initial_price) AS min_price,
        MAX(initial_price) AS max_price,
        SUM(price_with_tax) AS total_sales_with_tax,
        SUM(final_price) AS total_sales_with_tax_discounted
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
)

SELECT
    fct.app_id,
    fct.formatted_initial_price,
    fct.total_sales,
    fct.platform_id,
    fct.formatted_price_with_tax,
    fct.total_discounts,
    fct.price_with_tax,
    fct.num_sales,
    fct.max_discount,
    fct.min_price,
    fct.max_price,
    fct.total_sales_with_tax,
    fct.total_sales_with_tax_discounted,
    games.name AS game_name,
    games.description AS game_description,
    games.is_free AS game_is_free,
    games.fullgame_app_id,
    games.fullgame_name,
    games.type,
    games.genre_id,
    games.type_genre,
FROM
    game_sales AS fct
INNER JOIN
    `pristine-flames-400818`.`games`.`dim_games` AS games
ON
    fct.app_id = games.app_id
INNER JOIN 
    `pristine-flames-400818`.`games`.`dim_platforms` AS dp
ON
    fct.platform_id = dp.platform_id
    );
  
[0m15:48:07.811021 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:aa4b8561-6ee0-440b-9090-90f38d82d444&page=queryresults
[0m15:48:08.283050 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column app_id which is neither grouped nor aggregated at [18:9]')
[0m15:48:08.880653 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ca240ece-9837-486f-9562-4837856c3820&page=queryresults
[0m15:48:09.345527 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ca240ece-9837-486f-9562-4837856c3820&page=queryresults
[0m15:48:09.346674 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 15:48:06.543217 => 15:48:09.346315
[0m15:48:09.348535 [debug] [Thread-1 (]: Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  SELECT list expression references column app_id which is neither grouped nor aggregated at [18:9]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m15:48:09.349265 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34d26f93-3405-48ff-9c1c-3d2eee58507f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb507dd8fd0>]}
[0m15:48:09.350174 [error] [Thread-1 (]: 9 of 12 ERROR creating sql table model games.fct_game_pricing .................. [[31mERROR[0m in 2.81s]
[0m15:48:09.351152 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m15:48:09.352415 [debug] [Thread-1 (]: Began running node model.games.top_10_discounted_games
[0m15:48:09.353133 [info ] [Thread-1 (]: 10 of 12 SKIP relation games.top_10_discounted_games ........................... [[33mSKIP[0m]
[0m15:48:09.353851 [debug] [Thread-1 (]: Finished running node model.games.top_10_discounted_games
[0m15:48:09.354542 [debug] [Thread-1 (]: Began running node model.games.top_10_high_tax_games
[0m15:48:09.355322 [info ] [Thread-1 (]: 11 of 12 SKIP relation games.top_10_high_tax_games ............................. [[33mSKIP[0m]
[0m15:48:09.356058 [debug] [Thread-1 (]: Finished running node model.games.top_10_high_tax_games
[0m15:48:09.356734 [debug] [Thread-1 (]: Began running node model.games.top_10_most_expensive_games
[0m15:48:09.357494 [info ] [Thread-1 (]: 12 of 12 SKIP relation games.top_10_most_expensive_games ....................... [[33mSKIP[0m]
[0m15:48:09.358213 [debug] [Thread-1 (]: Finished running node model.games.top_10_most_expensive_games
[0m15:48:09.360323 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:48:09.360903 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m15:48:09.361487 [info ] [MainThread]: 
[0m15:48:09.362053 [info ] [MainThread]: Finished running 12 table models in 0 hours 0 minutes and 35.72 seconds (35.72s).
[0m15:48:09.364954 [debug] [MainThread]: Command end result
[0m15:48:09.384815 [info ] [MainThread]: 
[0m15:48:09.385425 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:48:09.385906 [info ] [MainThread]: 
[0m15:48:09.386369 [error] [MainThread]:   Database Error in model platform (models/report/platform.sql)
  Syntax error: Expected ")" but got ";" at [27:21]
  compiled Code at target/run/games/models/report/platform.sql
[0m15:48:09.386845 [info ] [MainThread]: 
[0m15:48:09.387301 [error] [MainThread]:   Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  SELECT list expression references column app_id which is neither grouped nor aggregated at [18:9]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m15:48:09.387769 [info ] [MainThread]: 
[0m15:48:09.388207 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=3 TOTAL=12
[0m15:48:09.388874 [debug] [MainThread]: Command `dbt run` failed at 15:48:09.388752 after 36.19 seconds
[0m15:48:09.389321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb50c522b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb507ca1480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb507ca0b80>]}
[0m15:48:09.389778 [debug] [MainThread]: Flushing usage events
[0m15:48:23.339937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facd132e020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faccf388070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faccf3880d0>]}


============================== 15:48:23.342025 | ac524ac2-2ddd-42be-8f54-ffd3274aaec6 ==============================
[0m15:48:23.342025 [info ] [MainThread]: Running with dbt=1.6.5
[0m15:48:23.342521 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'send_anonymous_usage_stats': 'True'}
[0m15:48:23.618137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac524ac2-2ddd-42be-8f54-ffd3274aaec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faccd30ac50>]}
[0m15:48:23.634118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac524ac2-2ddd-42be-8f54-ffd3274aaec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faccd3247c0>]}
[0m15:48:23.634772 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m15:48:23.648041 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m15:48:23.714083 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:48:23.714660 [debug] [MainThread]: Partial parsing: updated file: games://models/report/platform.sql
[0m15:48:23.758226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac524ac2-2ddd-42be-8f54-ffd3274aaec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faccd1e2260>]}
[0m15:48:23.767519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac524ac2-2ddd-42be-8f54-ffd3274aaec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faccd15f8b0>]}
[0m15:48:23.767977 [info ] [MainThread]: Found 12 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m15:48:23.768327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac524ac2-2ddd-42be-8f54-ffd3274aaec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faccd15f7f0>]}
[0m15:48:23.769787 [info ] [MainThread]: 
[0m15:48:23.770438 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:48:23.771906 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m15:48:23.772329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:24.508349 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m15:48:24.510533 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:25.162849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac524ac2-2ddd-42be-8f54-ffd3274aaec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faccd15e680>]}
[0m15:48:25.163616 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:48:25.163979 [info ] [MainThread]: 
[0m15:48:25.165898 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m15:48:25.166531 [info ] [Thread-1 (]: 1 of 12 START sql table model games.dim_developers ............................. [RUN]
[0m15:48:25.167478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m15:48:25.167950 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m15:48:25.175568 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m15:48:25.176277 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 15:48:25.168359 => 15:48:25.176068
[0m15:48:25.176653 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m15:48:25.190572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:25.888748 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m15:48:25.889468 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS developer_id,
    developers_name
FROM
    developers_cte
    );
  
[0m15:48:26.310258 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a7662869-056d-446c-82e2-6d6e043eb39f&page=queryresults
[0m15:48:29.011928 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 15:48:25.176913 => 15:48:29.011616
[0m15:48:29.012925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac524ac2-2ddd-42be-8f54-ffd3274aaec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faccd136bf0>]}
[0m15:48:29.013709 [info ] [Thread-1 (]: 1 of 12 OK created sql table model games.dim_developers ........................ [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 3.85s]
[0m15:48:29.014558 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m15:48:29.015256 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m15:48:29.016017 [info ] [Thread-1 (]: 2 of 12 START sql table model games.dim_games .................................. [RUN]
[0m15:48:29.016914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m15:48:29.017406 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m15:48:29.026333 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m15:48:29.027096 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 15:48:29.017738 => 15:48:29.026877
[0m15:48:29.027475 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m15:48:29.029716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:29.738212 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m15:48:29.740708 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m15:48:30.270575 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:2e070091-fae2-4acb-8d2c-51e7585d4780&page=queryresults
[0m15:48:32.340130 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 15:48:29.027739 => 15:48:32.339262
[0m15:48:32.343316 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac524ac2-2ddd-42be-8f54-ffd3274aaec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faccd137250>]}
[0m15:48:32.345916 [info ] [Thread-1 (]: 2 of 12 OK created sql table model games.dim_games ............................. [[32mCREATE TABLE (2.7k rows, 753.9 KiB processed)[0m in 3.33s]
[0m15:48:32.348841 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m15:48:32.350951 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m15:48:32.353414 [info ] [Thread-1 (]: 3 of 12 START sql table model games.dim_platforms .............................. [RUN]
[0m15:48:32.356402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m15:48:32.358226 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m15:48:32.369074 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m15:48:32.370938 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 15:48:32.359572 => 15:48:32.370404
[0m15:48:32.371967 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m15:48:32.377238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:33.081887 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m15:48:33.084670 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m15:48:33.562660 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9d93d986-e926-477e-9e69-51c050cd5569&page=queryresults
[0m15:48:35.973028 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 15:48:32.372672 => 15:48:35.972843
[0m15:48:35.973706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac524ac2-2ddd-42be-8f54-ffd3274aaec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faccc8effa0>]}
[0m15:48:35.974243 [info ] [Thread-1 (]: 3 of 12 OK created sql table model games.dim_platforms ......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 3.62s]
[0m15:48:35.974851 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m15:48:35.975266 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m15:48:35.975692 [info ] [Thread-1 (]: 4 of 12 START sql table model games.dim_price_overview ......................... [RUN]
[0m15:48:35.976279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m15:48:35.976646 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m15:48:35.979522 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m15:48:35.980260 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 15:48:35.976906 => 15:48:35.980059
[0m15:48:35.980630 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m15:48:35.982828 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:37.695080 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m15:48:37.696429 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    platform_id,
    windows,
    mac,
    linux,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte, games.dim_platforms
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m15:48:38.226165 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9c0ef9b0-ec35-4a5f-a304-41238a324dd1&page=queryresults
[0m15:48:44.409010 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 15:48:35.980889 => 15:48:44.408130
[0m15:48:44.412252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac524ac2-2ddd-42be-8f54-ffd3274aaec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faccc71e260>]}
[0m15:48:44.414931 [info ] [Thread-1 (]: 4 of 12 OK created sql table model games.dim_price_overview .................... [[32mCREATE TABLE (3.1m rows, 199.1 KiB processed)[0m in 8.44s]
[0m15:48:44.417854 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m15:48:44.420117 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m15:48:44.423114 [info ] [Thread-1 (]: 5 of 12 START sql table model games.dim_publishers ............................. [RUN]
[0m15:48:44.426224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m15:48:44.428184 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m15:48:44.437147 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m15:48:44.438718 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 15:48:44.429529 => 15:48:44.438198
[0m15:48:44.439691 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m15:48:44.444651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:45.139080 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m15:48:45.140056 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m15:48:45.691983 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9164a73b-0abc-458f-b337-f333d0661047&page=queryresults
[0m15:48:48.059912 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 15:48:44.440337 => 15:48:48.058774
[0m15:48:48.063368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac524ac2-2ddd-42be-8f54-ffd3274aaec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faccc70cd90>]}
[0m15:48:48.065963 [info ] [Thread-1 (]: 5 of 12 OK created sql table model games.dim_publishers ........................ [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 3.64s]
[0m15:48:48.068820 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m15:48:48.070906 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m15:48:48.073331 [info ] [Thread-1 (]: 6 of 12 START sql table model games.dim_release ................................ [RUN]
[0m15:48:48.076456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m15:48:48.078278 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m15:48:48.089393 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m15:48:48.091157 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 15:48:48.079633 => 15:48:48.090673
[0m15:48:48.092082 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m15:48:48.097204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:48.755594 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m15:48:48.758272 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m15:48:49.309346 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:6893bb63-f071-4192-a8f4-c8725858f651&page=queryresults
[0m15:48:51.680074 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 15:48:48.092744 => 15:48:51.679199
[0m15:48:51.683377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac524ac2-2ddd-42be-8f54-ffd3274aaec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faccc70d030>]}
[0m15:48:51.685946 [info ] [Thread-1 (]: 6 of 12 OK created sql table model games.dim_release ........................... [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 3.61s]
[0m15:48:51.688822 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m15:48:51.690887 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m15:48:51.693022 [info ] [Thread-1 (]: 7 of 12 START sql table model games.dim_support_language ....................... [RUN]
[0m15:48:51.696443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m15:48:51.698308 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m15:48:51.708371 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m15:48:51.709878 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 15:48:51.699659 => 15:48:51.709404
[0m15:48:51.710855 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m15:48:51.722572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:52.450925 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m15:48:52.453729 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m15:48:52.897057 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b80b8ce6-ed70-48b8-be6a-ec8b6142c056&page=queryresults
[0m15:48:55.570090 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 15:48:51.711518 => 15:48:55.569904
[0m15:48:55.570773 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac524ac2-2ddd-42be-8f54-ffd3274aaec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faccc7444f0>]}
[0m15:48:55.571314 [info ] [Thread-1 (]: 7 of 12 OK created sql table model games.dim_support_language .................. [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 3.88s]
[0m15:48:55.571880 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m15:48:55.572291 [debug] [Thread-1 (]: Began running node model.games.platform
[0m15:48:55.572796 [info ] [Thread-1 (]: 8 of 12 START sql table model games.platform ................................... [RUN]
[0m15:48:55.573384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.platform)
[0m15:48:55.573743 [debug] [Thread-1 (]: Began compiling node model.games.platform
[0m15:48:55.575527 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.platform"
[0m15:48:55.576100 [debug] [Thread-1 (]: Timing info for model.games.platform (compile): 15:48:55.574000 => 15:48:55.575921
[0m15:48:55.576451 [debug] [Thread-1 (]: Began executing node model.games.platform
[0m15:48:55.578552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:56.292549 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.platform"
[0m15:48:56.295262 [debug] [Thread-1 (]: On model.games.platform: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.platform"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`platform`
      
    
    

    OPTIONS()
    as (
      -- Informe de Ingresos por Plataforma
SELECT
    p.platform_id,
    s.total_sales,
    SUM(CASE WHEN p.windows = 1 THEN s.price_with_tax ELSE 0 END) AS total_sales_windows,
    SUM(CASE WHEN p.mac = 1 THEN s.price_with_tax ELSE 0 END) AS total_sales_mac,
    SUM(CASE WHEN p.linux = 1 THEN s.price_with_tax ELSE 0 END) AS total_sales_linux
FROM
    fct_sales s
JOIN
    dim_platforms p ON s.platform_id = p.platform_id
GROUP BY
    p.platform_id
ORDER BY
    total_sales DESC
    );
  
[0m15:48:56.593825 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:1bad2d3b-1614-4168-b4ca-1b223de263bc&page=queryresults
[0m15:48:56.597934 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "dim_platforms" must be qualified with a dataset (e.g. dataset.table).')
[0m15:48:57.449400 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e0435a18-d8f0-43d7-b84f-818fd3aa1848&page=queryresults
[0m15:48:57.453523 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e0435a18-d8f0-43d7-b84f-818fd3aa1848&page=queryresults
[0m15:48:57.456547 [debug] [Thread-1 (]: Timing info for model.games.platform (execute): 15:48:55.576704 => 15:48:57.455645
[0m15:48:57.459876 [debug] [Thread-1 (]: Database Error in model platform (models/report/platform.sql)
  Table "dim_platforms" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/games/models/report/platform.sql
[0m15:48:57.460324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac524ac2-2ddd-42be-8f54-ffd3274aaec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faccc747ac0>]}
[0m15:48:57.460882 [error] [Thread-1 (]: 8 of 12 ERROR creating sql table model games.platform .......................... [[31mERROR[0m in 1.89s]
[0m15:48:57.461480 [debug] [Thread-1 (]: Finished running node model.games.platform
[0m15:48:57.461948 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m15:48:57.462476 [info ] [Thread-1 (]: 9 of 12 START sql table model games.fct_game_pricing ........................... [RUN]
[0m15:48:57.463111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.platform, now model.games.fct_game_pricing)
[0m15:48:57.463479 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m15:48:57.466831 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m15:48:57.467442 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 15:48:57.463736 => 15:48:57.467257
[0m15:48:57.467795 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m15:48:57.469900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:58.246561 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m15:48:58.247262 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para el análisis de precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        formatted_initial_price,
        platform_id,
        formatted_price_with_tax,
        price_with_tax,
        SUM(price_with_tax) AS total_sales,
        SUM(discount_amount) AS total_discounts,
        COUNT(*) AS num_sales,
        MAX(discount_pct) AS max_discount,
        MIN(initial_price) AS min_price,
        MAX(initial_price) AS max_price,
        SUM(price_with_tax) AS total_sales_with_tax,
        SUM(final_price) AS total_sales_with_tax_discounted
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
)

SELECT
    fct.app_id,
    fct.formatted_initial_price,
    fct.total_sales,
    fct.platform_id,
    fct.formatted_price_with_tax,
    fct.total_discounts,
    fct.price_with_tax,
    fct.num_sales,
    fct.max_discount,
    fct.min_price,
    fct.max_price,
    fct.total_sales_with_tax,
    fct.total_sales_with_tax_discounted,
    games.name AS game_name,
    games.description AS game_description,
    games.is_free AS game_is_free,
    games.fullgame_app_id,
    games.fullgame_name,
    games.type,
    games.genre_id,
    games.type_genre,
FROM
    game_sales AS fct
INNER JOIN
    `pristine-flames-400818`.`games`.`dim_games` AS games
ON
    fct.app_id = games.app_id
INNER JOIN 
    `pristine-flames-400818`.`games`.`dim_platforms` AS dp
ON
    fct.platform_id = dp.platform_id
    );
  
[0m15:48:58.737863 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:fe4ea0e3-e3d5-463d-92b9-642c593474b7&page=queryresults
[0m15:48:59.213380 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column app_id which is neither grouped nor aggregated at [18:9]')
[0m15:48:59.816562 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f147533c-dd03-40e2-a5c6-7986353931a7&page=queryresults
[0m15:49:00.294338 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f147533c-dd03-40e2-a5c6-7986353931a7&page=queryresults
[0m15:49:00.297504 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 15:48:57.468062 => 15:49:00.296554
[0m15:49:00.299371 [debug] [Thread-1 (]: Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  SELECT list expression references column app_id which is neither grouped nor aggregated at [18:9]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m15:49:00.299799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac524ac2-2ddd-42be-8f54-ffd3274aaec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faccd134a60>]}
[0m15:49:00.300377 [error] [Thread-1 (]: 9 of 12 ERROR creating sql table model games.fct_game_pricing .................. [[31mERROR[0m in 2.84s]
[0m15:49:00.300969 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m15:49:00.301942 [debug] [Thread-1 (]: Began running node model.games.top_10_discounted_games
[0m15:49:00.302381 [info ] [Thread-1 (]: 10 of 12 SKIP relation games.top_10_discounted_games ........................... [[33mSKIP[0m]
[0m15:49:00.302842 [debug] [Thread-1 (]: Finished running node model.games.top_10_discounted_games
[0m15:49:00.303267 [debug] [Thread-1 (]: Began running node model.games.top_10_high_tax_games
[0m15:49:00.303680 [info ] [Thread-1 (]: 11 of 12 SKIP relation games.top_10_high_tax_games ............................. [[33mSKIP[0m]
[0m15:49:00.304123 [debug] [Thread-1 (]: Finished running node model.games.top_10_high_tax_games
[0m15:49:00.304540 [debug] [Thread-1 (]: Began running node model.games.top_10_most_expensive_games
[0m15:49:00.304952 [info ] [Thread-1 (]: 12 of 12 SKIP relation games.top_10_most_expensive_games ....................... [[33mSKIP[0m]
[0m15:49:00.305391 [debug] [Thread-1 (]: Finished running node model.games.top_10_most_expensive_games
[0m15:49:00.306806 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:49:00.307167 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m15:49:00.307564 [info ] [MainThread]: 
[0m15:49:00.307949 [info ] [MainThread]: Finished running 12 table models in 0 hours 0 minutes and 36.54 seconds (36.54s).
[0m15:49:00.309914 [debug] [MainThread]: Command end result
[0m15:49:00.325271 [info ] [MainThread]: 
[0m15:49:00.325794 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:49:00.326143 [info ] [MainThread]: 
[0m15:49:00.326497 [error] [MainThread]:   Database Error in model platform (models/report/platform.sql)
  Table "dim_platforms" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/games/models/report/platform.sql
[0m15:49:00.326862 [info ] [MainThread]: 
[0m15:49:00.327210 [error] [MainThread]:   Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  SELECT list expression references column app_id which is neither grouped nor aggregated at [18:9]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m15:49:00.327568 [info ] [MainThread]: 
[0m15:49:00.327934 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=3 TOTAL=12
[0m15:49:00.328535 [debug] [MainThread]: Command `dbt run` failed at 15:49:00.328430 after 37.00 seconds
[0m15:49:00.328940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facd132e020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faccd1e8bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faccd1e8670>]}
[0m15:49:00.329348 [debug] [MainThread]: Flushing usage events
[0m15:50:50.465247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a142e020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179f5c0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179f5c00d0>]}


============================== 15:50:50.467321 | c871614c-bb4e-410b-932a-802c6a9572b6 ==============================
[0m15:50:50.467321 [info ] [MainThread]: Running with dbt=1.6.5
[0m15:50:50.467772 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:50:50.745703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c871614c-bb4e-410b-932a-802c6a9572b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179d542c50>]}
[0m15:50:50.761164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c871614c-bb4e-410b-932a-802c6a9572b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179d55c7c0>]}
[0m15:50:50.761718 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m15:50:50.774949 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m15:50:50.839122 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:50:50.839672 [debug] [MainThread]: Partial parsing: updated file: games://models/report/platform.sql
[0m15:50:50.840076 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m15:50:50.886299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c871614c-bb4e-410b-932a-802c6a9572b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179ca4a470>]}
[0m15:50:50.895638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c871614c-bb4e-410b-932a-802c6a9572b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179d3938b0>]}
[0m15:50:50.896092 [info ] [MainThread]: Found 12 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m15:50:50.896436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c871614c-bb4e-410b-932a-802c6a9572b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179d3938e0>]}
[0m15:50:50.897866 [info ] [MainThread]: 
[0m15:50:50.898555 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:50:50.899913 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m15:50:50.900323 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:51.769694 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m15:50:51.770259 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:50:52.442907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c871614c-bb4e-410b-932a-802c6a9572b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179d3927a0>]}
[0m15:50:52.444198 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:50:52.444644 [info ] [MainThread]: 
[0m15:50:52.446733 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m15:50:52.447257 [info ] [Thread-1 (]: 1 of 12 START sql table model games.dim_developers ............................. [RUN]
[0m15:50:52.447906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m15:50:52.448269 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m15:50:52.455334 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m15:50:52.455982 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 15:50:52.448541 => 15:50:52.455770
[0m15:50:52.456363 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m15:50:52.469440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:53.142486 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m15:50:53.143172 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS developer_id,
    developers_name
FROM
    developers_cte
    );
  
[0m15:50:53.704401 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:03839164-3532-4165-b529-6c3bb6e62e45&page=queryresults
[0m15:50:55.967345 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 15:50:52.456627 => 15:50:55.967035
[0m15:50:55.968467 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c871614c-bb4e-410b-932a-802c6a9572b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179d3708e0>]}
[0m15:50:55.969367 [info ] [Thread-1 (]: 1 of 12 OK created sql table model games.dim_developers ........................ [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 3.52s]
[0m15:50:55.970199 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m15:50:55.970806 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m15:50:55.971475 [info ] [Thread-1 (]: 2 of 12 START sql table model games.dim_games .................................. [RUN]
[0m15:50:55.972304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m15:50:55.972830 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m15:50:55.981995 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m15:50:55.982752 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 15:50:55.973203 => 15:50:55.982537
[0m15:50:55.983160 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m15:50:55.985518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:56.685296 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m15:50:56.686193 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m15:50:57.681325 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:fff14e14-1530-4987-b6e6-267fd02d57ac&page=queryresults
[0m15:51:00.380227 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 15:50:55.983446 => 15:51:00.380015
[0m15:51:00.380926 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c871614c-bb4e-410b-932a-802c6a9572b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179d373310>]}
[0m15:51:00.381480 [info ] [Thread-1 (]: 2 of 12 OK created sql table model games.dim_games ............................. [[32mCREATE TABLE (2.7k rows, 753.9 KiB processed)[0m in 4.41s]
[0m15:51:00.382092 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m15:51:00.382569 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m15:51:00.383011 [info ] [Thread-1 (]: 3 of 12 START sql table model games.dim_platforms .............................. [RUN]
[0m15:51:00.383635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m15:51:00.384142 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m15:51:00.386976 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m15:51:00.387597 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 15:51:00.384425 => 15:51:00.387401
[0m15:51:00.387976 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m15:51:00.390134 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:01.106438 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m15:51:01.107092 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m15:51:01.682519 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:0487a694-543f-4230-b75c-91b73ed8a46c&page=queryresults
[0m15:51:04.365463 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 15:51:00.388244 => 15:51:04.365277
[0m15:51:04.366139 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c871614c-bb4e-410b-932a-802c6a9572b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179d370b50>]}
[0m15:51:04.366711 [info ] [Thread-1 (]: 3 of 12 OK created sql table model games.dim_platforms ......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 3.98s]
[0m15:51:04.367280 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m15:51:04.367721 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m15:51:04.368140 [info ] [Thread-1 (]: 4 of 12 START sql table model games.dim_price_overview ......................... [RUN]
[0m15:51:04.368782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m15:51:04.369147 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m15:51:04.372031 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m15:51:04.372632 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 15:51:04.369404 => 15:51:04.372446
[0m15:51:04.372993 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m15:51:04.375167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:05.106895 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m15:51:05.107633 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    platform_id,
    windows,
    mac,
    linux,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte, games.dim_platforms
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m15:51:05.693762 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:188c2d66-006c-40a5-be5b-7e6b682a2dd5&page=queryresults
[0m15:51:11.988404 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 15:51:04.373246 => 15:51:11.988215
[0m15:51:11.989084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c871614c-bb4e-410b-932a-802c6a9572b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179c9561a0>]}
[0m15:51:11.989621 [info ] [Thread-1 (]: 4 of 12 OK created sql table model games.dim_price_overview .................... [[32mCREATE TABLE (3.1m rows, 199.1 KiB processed)[0m in 7.62s]
[0m15:51:11.990186 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m15:51:11.990639 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m15:51:11.991244 [info ] [Thread-1 (]: 5 of 12 START sql table model games.dim_publishers ............................. [RUN]
[0m15:51:11.991839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m15:51:11.992202 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m15:51:11.995053 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m15:51:11.995695 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 15:51:11.992473 => 15:51:11.995492
[0m15:51:11.996080 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m15:51:11.998381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:12.681602 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m15:51:12.684276 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m15:51:13.079915 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5537f6ce-e4ef-4a22-9627-cbf0fde79cd6&page=queryresults
[0m15:51:15.480789 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 15:51:11.996353 => 15:51:15.479909
[0m15:51:15.483919 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c871614c-bb4e-410b-932a-802c6a9572b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179c944ca0>]}
[0m15:51:15.486460 [info ] [Thread-1 (]: 5 of 12 OK created sql table model games.dim_publishers ........................ [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 3.49s]
[0m15:51:15.489302 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m15:51:15.491349 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m15:51:15.493727 [info ] [Thread-1 (]: 6 of 12 START sql table model games.dim_release ................................ [RUN]
[0m15:51:15.496706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m15:51:15.498541 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m15:51:15.505403 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m15:51:15.506154 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 15:51:15.499840 => 15:51:15.505898
[0m15:51:15.506566 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m15:51:15.508948 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:16.244034 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m15:51:16.246820 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m15:51:16.646376 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9772f306-845e-441b-9920-a174ffd9baff&page=queryresults
[0m15:51:19.029492 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 15:51:15.506825 => 15:51:19.029312
[0m15:51:19.030205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c871614c-bb4e-410b-932a-802c6a9572b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179c944f70>]}
[0m15:51:19.030797 [info ] [Thread-1 (]: 6 of 12 OK created sql table model games.dim_release ........................... [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 3.53s]
[0m15:51:19.031409 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m15:51:19.031878 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m15:51:19.032434 [info ] [Thread-1 (]: 7 of 12 START sql table model games.dim_support_language ....................... [RUN]
[0m15:51:19.033103 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m15:51:19.033483 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m15:51:19.036371 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m15:51:19.037003 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 15:51:19.033750 => 15:51:19.036794
[0m15:51:19.037381 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m15:51:19.043937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:19.757836 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m15:51:19.758585 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m15:51:20.284429 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:cce7f5f5-678c-4e69-ad2a-54967efc15a4&page=queryresults
[0m15:51:22.675801 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 15:51:19.037644 => 15:51:22.675463
[0m15:51:22.676831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c871614c-bb4e-410b-932a-802c6a9572b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179c97c160>]}
[0m15:51:22.677698 [info ] [Thread-1 (]: 7 of 12 OK created sql table model games.dim_support_language .................. [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 3.64s]
[0m15:51:22.678430 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m15:51:22.678931 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m15:51:22.679385 [info ] [Thread-1 (]: 8 of 12 START sql table model games.fct_game_pricing ........................... [RUN]
[0m15:51:22.680009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m15:51:22.680458 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m15:51:22.683640 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m15:51:22.684267 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 15:51:22.680729 => 15:51:22.684062
[0m15:51:22.684636 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m15:51:22.686838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:23.405116 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m15:51:23.405853 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para el análisis de precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        formatted_initial_price,
        platform_id,
        formatted_price_with_tax,
        price_with_tax,
        SUM(price_with_tax) AS total_sales,
        SUM(discount_amount) AS total_discounts,
        COUNT(*) AS num_sales,
        MAX(discount_pct) AS max_discount,
        MIN(initial_price) AS min_price,
        MAX(initial_price) AS max_price,
        SUM(price_with_tax) AS total_sales_with_tax,
        SUM(final_price) AS total_sales_with_tax_discounted
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id, platform_id, formatted_initial_price, formatted_price_with_tax, price_with_tax
)

SELECT
    fct.app_id,
    fct.formatted_initial_price,
    fct.total_sales,
    fct.platform_id,
    fct.formatted_price_with_tax,
    fct.total_discounts,
    fct.price_with_tax,
    fct.num_sales,
    fct.max_discount,
    fct.min_price,
    fct.max_price,
    fct.total_sales_with_tax,
    fct.total_sales_with_tax_discounted,
    games.name AS game_name,
    games.description AS game_description,
    games.is_free AS game_is_free,
    games.fullgame_app_id,
    games.fullgame_name,
    games.type,
    games.genre_id,
    games.type_genre,
FROM
    game_sales AS fct
INNER JOIN
    `pristine-flames-400818`.`games`.`dim_games` AS games
ON
    fct.app_id = games.app_id
INNER JOIN 
    `pristine-flames-400818`.`games`.`dim_platforms` AS dp
ON
    fct.platform_id = dp.platform_id
    );
  
[0m15:51:23.823264 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d998dc1b-4521-4b9d-a84d-43997723cfa0&page=queryresults
[0m15:51:33.083015 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 15:51:22.684896 => 15:51:33.082104
[0m15:51:33.086109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c871614c-bb4e-410b-932a-802c6a9572b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179c97eaa0>]}
[0m15:51:33.088683 [info ] [Thread-1 (]: 8 of 12 OK created sql table model games.fct_game_pricing ...................... [[32mCREATE TABLE (3.1m rows, 292.5 MiB processed)[0m in 10.41s]
[0m15:51:33.091515 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m15:51:33.095155 [debug] [Thread-1 (]: Began running node model.games.platform
[0m15:51:33.097378 [info ] [Thread-1 (]: 9 of 12 START sql table model games.platform ................................... [RUN]
[0m15:51:33.099819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.fct_game_pricing, now model.games.platform)
[0m15:51:33.100197 [debug] [Thread-1 (]: Began compiling node model.games.platform
[0m15:51:33.103430 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.platform"
[0m15:51:33.104302 [debug] [Thread-1 (]: Timing info for model.games.platform (compile): 15:51:33.100463 => 15:51:33.104049
[0m15:51:33.104699 [debug] [Thread-1 (]: Began executing node model.games.platform
[0m15:51:33.106999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:33.820074 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.platform"
[0m15:51:33.820825 [debug] [Thread-1 (]: On model.games.platform: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.platform"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`platform`
      
    
    

    OPTIONS()
    as (
      -- Informe de Ingresos por Plataforma
SELECT
    p.platform_id,
    s.total_sales,
    SUM(CASE WHEN p.windows = 1 THEN s.price_with_tax ELSE 0 END) AS total_sales_windows,
    SUM(CASE WHEN p.mac = 1 THEN s.price_with_tax ELSE 0 END) AS total_sales_mac,
    SUM(CASE WHEN p.linux = 1 THEN s.price_with_tax ELSE 0 END) AS total_sales_linux
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing` s
JOIN
    `pristine-flames-400818`.`games`.`dim_platforms` p ON s.platform_id = p.platform_id
GROUP BY
    p.platform_id
ORDER BY
    total_sales DESC
    );
  
[0m15:51:34.227658 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:6ce873d1-867b-4c46-a136-ad41dacfe04e&page=queryresults
[0m15:51:34.695576 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references s.total_sales which is neither grouped nor aggregated at [16:5]')
[0m15:51:35.406603 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:1d3db1f1-eeba-4ecf-b369-b21ef9a79b88&page=queryresults
[0m15:51:35.869061 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:1d3db1f1-eeba-4ecf-b369-b21ef9a79b88&page=queryresults
[0m15:51:35.872120 [debug] [Thread-1 (]: Timing info for model.games.platform (execute): 15:51:33.104956 => 15:51:35.871199
[0m15:51:35.876171 [debug] [Thread-1 (]: Database Error in model platform (models/report/platform.sql)
  SELECT list expression references s.total_sales which is neither grouped nor aggregated at [16:5]
  compiled Code at target/run/games/models/report/platform.sql
[0m15:51:35.876629 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c871614c-bb4e-410b-932a-802c6a9572b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179caad390>]}
[0m15:51:35.877181 [error] [Thread-1 (]: 9 of 12 ERROR creating sql table model games.platform .......................... [[31mERROR[0m in 2.78s]
[0m15:51:35.877812 [debug] [Thread-1 (]: Finished running node model.games.platform
[0m15:51:35.878269 [debug] [Thread-1 (]: Began running node model.games.top_10_discounted_games
[0m15:51:35.878759 [info ] [Thread-1 (]: 10 of 12 START sql table model games.top_10_discounted_games ................... [RUN]
[0m15:51:35.879430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.platform, now model.games.top_10_discounted_games)
[0m15:51:35.879957 [debug] [Thread-1 (]: Began compiling node model.games.top_10_discounted_games
[0m15:51:35.882824 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_discounted_games"
[0m15:51:35.883547 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (compile): 15:51:35.880232 => 15:51:35.883296
[0m15:51:35.884005 [debug] [Thread-1 (]: Began executing node model.games.top_10_discounted_games
[0m15:51:35.892082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:36.608015 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_discounted_games"
[0m15:51:36.608642 [debug] [Thread-1 (]: On model.games.top_10_discounted_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_discounted_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_discounted_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 descuentos más grandes
SELECT
    app_id,
    game_name,
    total_discounts
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY total_discounts DESC
LIMIT 10
    );
  
[0m15:51:37.172796 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c320eb7c-2265-4189-ab45-dde773b3922e&page=queryresults
[0m15:51:39.832714 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (execute): 15:51:35.884261 => 15:51:39.832449
[0m15:51:39.833467 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c871614c-bb4e-410b-932a-802c6a9572b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179c970f40>]}
[0m15:51:39.834072 [info ] [Thread-1 (]: 10 of 12 OK created sql table model games.top_10_discounted_games .............. [[32mCREATE TABLE (10.0 rows, 162.8 MiB processed)[0m in 3.95s]
[0m15:51:39.834708 [debug] [Thread-1 (]: Finished running node model.games.top_10_discounted_games
[0m15:51:39.835166 [debug] [Thread-1 (]: Began running node model.games.top_10_high_tax_games
[0m15:51:39.835623 [info ] [Thread-1 (]: 11 of 12 START sql table model games.top_10_high_tax_games ..................... [RUN]
[0m15:51:39.836261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_discounted_games, now model.games.top_10_high_tax_games)
[0m15:51:39.836743 [debug] [Thread-1 (]: Began compiling node model.games.top_10_high_tax_games
[0m15:51:39.839693 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_high_tax_games"
[0m15:51:39.840357 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (compile): 15:51:39.837036 => 15:51:39.840138
[0m15:51:39.840751 [debug] [Thread-1 (]: Began executing node model.games.top_10_high_tax_games
[0m15:51:39.843017 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:40.562078 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_high_tax_games"
[0m15:51:40.564777 [debug] [Thread-1 (]: On model.games.top_10_high_tax_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_high_tax_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_high_tax_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos con más impuestos
SELECT
    app_id,
    game_name,
    SUM(total_sales_with_tax) AS total_taxes
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
GROUP BY app_id, game_name
ORDER BY total_taxes DESC, game_name DESC
LIMIT 10
    );
  
[0m15:51:40.962035 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:eae25290-3c77-4cc5-b558-0b3c3bcd3bac&page=queryresults
[0m15:51:43.646672 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (execute): 15:51:39.841028 => 15:51:43.645761
[0m15:51:43.649774 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c871614c-bb4e-410b-932a-802c6a9572b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179ca48820>]}
[0m15:51:43.652337 [info ] [Thread-1 (]: 11 of 12 OK created sql table model games.top_10_high_tax_games ................ [[32mCREATE TABLE (10.0 rows, 162.8 MiB processed)[0m in 3.81s]
[0m15:51:43.655218 [debug] [Thread-1 (]: Finished running node model.games.top_10_high_tax_games
[0m15:51:43.657306 [debug] [Thread-1 (]: Began running node model.games.top_10_most_expensive_games
[0m15:51:43.659719 [info ] [Thread-1 (]: 12 of 12 START sql table model games.top_10_most_expensive_games ............... [RUN]
[0m15:51:43.662677 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_high_tax_games, now model.games.top_10_most_expensive_games)
[0m15:51:43.664516 [debug] [Thread-1 (]: Began compiling node model.games.top_10_most_expensive_games
[0m15:51:43.671449 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_most_expensive_games"
[0m15:51:43.672212 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (compile): 15:51:43.665817 => 15:51:43.671993
[0m15:51:43.672617 [debug] [Thread-1 (]: Began executing node model.games.top_10_most_expensive_games
[0m15:51:43.674987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:44.352339 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_most_expensive_games"
[0m15:51:44.355020 [debug] [Thread-1 (]: On model.games.top_10_most_expensive_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_most_expensive_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_most_expensive_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos más caros
SELECT
    app_id,
    game_name,
    max_price,
    formatted_initial_price,
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY max_price DESC
LIMIT 10
    );
  
[0m15:51:44.779932 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:df5d6495-cacb-483e-bc0d-7d5ee0d11aae&page=queryresults
[0m15:51:47.212603 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (execute): 15:51:43.672871 => 15:51:47.212414
[0m15:51:47.213323 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c871614c-bb4e-410b-932a-802c6a9572b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179cab7550>]}
[0m15:51:47.213864 [info ] [Thread-1 (]: 12 of 12 OK created sql table model games.top_10_most_expensive_games .......... [[32mCREATE TABLE (10.0 rows, 177.7 MiB processed)[0m in 3.55s]
[0m15:51:47.214433 [debug] [Thread-1 (]: Finished running node model.games.top_10_most_expensive_games
[0m15:51:47.215809 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:51:47.216137 [debug] [MainThread]: Connection 'model.games.top_10_most_expensive_games' was properly closed.
[0m15:51:47.216480 [info ] [MainThread]: 
[0m15:51:47.216815 [info ] [MainThread]: Finished running 12 table models in 0 hours 0 minutes and 56.32 seconds (56.32s).
[0m15:51:47.219025 [debug] [MainThread]: Command end result
[0m15:51:47.234850 [info ] [MainThread]: 
[0m15:51:47.235275 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:51:47.235595 [info ] [MainThread]: 
[0m15:51:47.235912 [error] [MainThread]:   Database Error in model platform (models/report/platform.sql)
  SELECT list expression references s.total_sales which is neither grouped nor aggregated at [16:5]
  compiled Code at target/run/games/models/report/platform.sql
[0m15:51:47.236244 [info ] [MainThread]: 
[0m15:51:47.236608 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m15:51:47.237148 [debug] [MainThread]: Command `dbt run` failed at 15:51:47.237053 after 56.78 seconds
[0m15:51:47.238167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a142e020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1785fc2e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1785fc2350>]}
[0m15:51:47.238579 [debug] [MainThread]: Flushing usage events
[0m15:54:59.387452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd079f0d180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd077fa0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd077fa00d0>]}


============================== 15:54:59.389576 | 27c371f5-447f-4cdf-b982-52e3b1df3f5d ==============================
[0m15:54:59.389576 [info ] [MainThread]: Running with dbt=1.6.5
[0m15:54:59.390092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '../dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:54:59.678121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27c371f5-447f-4cdf-b982-52e3b1df3f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd079461cf0>]}
[0m15:54:59.694284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27c371f5-447f-4cdf-b982-52e3b1df3f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd075f3c9d0>]}
[0m15:54:59.694955 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m15:54:59.708873 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m15:54:59.776021 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:54:59.776606 [debug] [MainThread]: Partial parsing: updated file: games://models/report/platform.sql
[0m15:54:59.821118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27c371f5-447f-4cdf-b982-52e3b1df3f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd07543e3b0>]}
[0m15:54:59.830404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27c371f5-447f-4cdf-b982-52e3b1df3f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd075d73a00>]}
[0m15:54:59.830884 [info ] [MainThread]: Found 12 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m15:54:59.831236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27c371f5-447f-4cdf-b982-52e3b1df3f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd075d73a30>]}
[0m15:54:59.832731 [info ] [MainThread]: 
[0m15:54:59.833398 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:54:59.834837 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m15:54:59.835316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:55:00.679409 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m15:55:00.681321 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:55:01.411750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27c371f5-447f-4cdf-b982-52e3b1df3f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd075d728f0>]}
[0m15:55:01.415001 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:55:01.416956 [info ] [MainThread]: 
[0m15:55:01.425258 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m15:55:01.427174 [info ] [Thread-1 (]: 1 of 12 START sql table model games.dim_developers ............................. [RUN]
[0m15:55:01.429236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m15:55:01.430559 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m15:55:01.445584 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m15:55:01.446679 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 15:55:01.431440 => 15:55:01.446369
[0m15:55:01.447216 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m15:55:01.462858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:02.221042 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m15:55:02.221685 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS developer_id,
    developers_name
FROM
    developers_cte
    );
  
[0m15:55:02.821179 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7f6b743e-fc9f-4339-9534-6103d90b3887&page=queryresults
[0m15:55:04.964436 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 15:55:01.447585 => 15:55:04.964253
[0m15:55:04.965149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27c371f5-447f-4cdf-b982-52e3b1df3f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd075d50910>]}
[0m15:55:04.965740 [info ] [Thread-1 (]: 1 of 12 OK created sql table model games.dim_developers ........................ [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 3.54s]
[0m15:55:04.966372 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m15:55:04.966861 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m15:55:04.967421 [info ] [Thread-1 (]: 2 of 12 START sql table model games.dim_games .................................. [RUN]
[0m15:55:04.968054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m15:55:04.968422 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m15:55:04.976896 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m15:55:04.977620 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 15:55:04.968698 => 15:55:04.977398
[0m15:55:04.978000 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m15:55:04.980304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:05.708388 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m15:55:05.711151 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m15:55:06.152487 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ecefd7be-2f03-4046-bda0-383fa99c03ef&page=queryresults
[0m15:55:08.397201 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 15:55:04.978259 => 15:55:08.396308
[0m15:55:08.399140 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27c371f5-447f-4cdf-b982-52e3b1df3f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd075d532b0>]}
[0m15:55:08.399781 [info ] [Thread-1 (]: 2 of 12 OK created sql table model games.dim_games ............................. [[32mCREATE TABLE (2.7k rows, 753.9 KiB processed)[0m in 3.43s]
[0m15:55:08.400413 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m15:55:08.400888 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m15:55:08.401367 [info ] [Thread-1 (]: 3 of 12 START sql table model games.dim_platforms .............................. [RUN]
[0m15:55:08.402065 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m15:55:08.402534 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m15:55:08.405351 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m15:55:08.406003 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 15:55:08.402798 => 15:55:08.405773
[0m15:55:08.406386 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m15:55:08.408688 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:09.071200 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m15:55:09.073963 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m15:55:09.816606 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:913c9548-11b1-4875-84a0-0001a8cb4741&page=queryresults
[0m15:55:12.173723 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 15:55:08.406727 => 15:55:12.172842
[0m15:55:12.176846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27c371f5-447f-4cdf-b982-52e3b1df3f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd075303f40>]}
[0m15:55:12.179429 [info ] [Thread-1 (]: 3 of 12 OK created sql table model games.dim_platforms ......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 3.77s]
[0m15:55:12.182227 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m15:55:12.184289 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m15:55:12.186381 [info ] [Thread-1 (]: 4 of 12 START sql table model games.dim_price_overview ......................... [RUN]
[0m15:55:12.189613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m15:55:12.191501 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m15:55:12.202035 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m15:55:12.203568 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 15:55:12.192800 => 15:55:12.203083
[0m15:55:12.204491 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m15:55:12.209238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:12.937926 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m15:55:12.940812 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    platform_id,
    windows,
    mac,
    linux,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte, games.dim_platforms
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m15:55:13.407040 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f70e5b3f-82a3-4039-b3a1-31dc04fec8a5&page=queryresults
[0m15:55:19.060933 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 15:55:12.205144 => 15:55:19.060063
[0m15:55:19.064066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27c371f5-447f-4cdf-b982-52e3b1df3f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd075336230>]}
[0m15:55:19.066630 [info ] [Thread-1 (]: 4 of 12 OK created sql table model games.dim_price_overview .................... [[32mCREATE TABLE (3.1m rows, 199.1 KiB processed)[0m in 6.88s]
[0m15:55:19.069406 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m15:55:19.071445 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m15:55:19.074124 [info ] [Thread-1 (]: 5 of 12 START sql table model games.dim_publishers ............................. [RUN]
[0m15:55:19.077143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m15:55:19.078691 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m15:55:19.082107 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m15:55:19.082915 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 15:55:19.079002 => 15:55:19.082680
[0m15:55:19.083339 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m15:55:19.086419 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:19.650173 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m15:55:19.652884 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m15:55:20.176328 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:dd4d68b0-c448-4d7e-b812-743841362410&page=queryresults
[0m15:55:22.568346 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 15:55:19.083622 => 15:55:22.567462
[0m15:55:22.571481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27c371f5-447f-4cdf-b982-52e3b1df3f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd075324d00>]}
[0m15:55:22.574082 [info ] [Thread-1 (]: 5 of 12 OK created sql table model games.dim_publishers ........................ [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 3.50s]
[0m15:55:22.576936 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m15:55:22.579024 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m15:55:22.581450 [info ] [Thread-1 (]: 6 of 12 START sql table model games.dim_release ................................ [RUN]
[0m15:55:22.584444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m15:55:22.586258 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m15:55:22.593335 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m15:55:22.594046 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 15:55:22.587636 => 15:55:22.593799
[0m15:55:22.594425 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m15:55:22.596593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:23.320352 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m15:55:23.321438 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m15:55:23.878787 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b4680615-bb3d-4dd5-ad6a-bbc50e040248&page=queryresults
[0m15:55:26.323989 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 15:55:22.594700 => 15:55:26.323106
[0m15:55:26.327302 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27c371f5-447f-4cdf-b982-52e3b1df3f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd075325090>]}
[0m15:55:26.329856 [info ] [Thread-1 (]: 6 of 12 OK created sql table model games.dim_release ........................... [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 3.74s]
[0m15:55:26.332753 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m15:55:26.334830 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m15:55:26.337272 [info ] [Thread-1 (]: 7 of 12 START sql table model games.dim_support_language ....................... [RUN]
[0m15:55:26.340409 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m15:55:26.342254 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m15:55:26.348602 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m15:55:26.349290 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 15:55:26.343586 => 15:55:26.349065
[0m15:55:26.349686 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m15:55:26.356595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:27.072415 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m15:55:27.075092 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m15:55:27.716344 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:2564ddc0-46d3-4085-b406-3fb3c67ef118&page=queryresults
[0m15:55:30.252003 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 15:55:26.349940 => 15:55:30.251131
[0m15:55:30.255134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27c371f5-447f-4cdf-b982-52e3b1df3f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd07535c850>]}
[0m15:55:30.257702 [info ] [Thread-1 (]: 7 of 12 OK created sql table model games.dim_support_language .................. [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 3.92s]
[0m15:55:30.260537 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m15:55:30.262601 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m15:55:30.264931 [info ] [Thread-1 (]: 8 of 12 START sql table model games.fct_game_pricing ........................... [RUN]
[0m15:55:30.267855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m15:55:30.269686 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m15:55:30.279432 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m15:55:30.280984 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 15:55:30.271011 => 15:55:30.280490
[0m15:55:30.281841 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m15:55:30.286214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:30.981500 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m15:55:30.982612 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para el análisis de precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        formatted_initial_price,
        platform_id,
        formatted_price_with_tax,
        price_with_tax,
        SUM(price_with_tax) AS total_sales,
        SUM(discount_amount) AS total_discounts,
        COUNT(*) AS num_sales,
        MAX(discount_pct) AS max_discount,
        MIN(initial_price) AS min_price,
        MAX(initial_price) AS max_price,
        SUM(price_with_tax) AS total_sales_with_tax,
        SUM(final_price) AS total_sales_with_tax_discounted
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id, platform_id, formatted_initial_price, formatted_price_with_tax, price_with_tax
)

SELECT
    fct.app_id,
    fct.formatted_initial_price,
    fct.total_sales,
    fct.platform_id,
    fct.formatted_price_with_tax,
    fct.total_discounts,
    fct.price_with_tax,
    fct.num_sales,
    fct.max_discount,
    fct.min_price,
    fct.max_price,
    fct.total_sales_with_tax,
    fct.total_sales_with_tax_discounted,
    games.name AS game_name,
    games.description AS game_description,
    games.is_free AS game_is_free,
    games.fullgame_app_id,
    games.fullgame_name,
    games.type,
    games.genre_id,
    games.type_genre,
FROM
    game_sales AS fct
INNER JOIN
    `pristine-flames-400818`.`games`.`dim_games` AS games
ON
    fct.app_id = games.app_id
INNER JOIN 
    `pristine-flames-400818`.`games`.`dim_platforms` AS dp
ON
    fct.platform_id = dp.platform_id
    );
  
[0m15:55:31.536456 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:31e82506-3087-48ff-95a3-6b2676b0e246&page=queryresults
[0m15:55:39.256117 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 15:55:30.282365 => 15:55:39.255230
[0m15:55:39.259361 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27c371f5-447f-4cdf-b982-52e3b1df3f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd07535e8f0>]}
[0m15:55:39.261928 [info ] [Thread-1 (]: 8 of 12 OK created sql table model games.fct_game_pricing ...................... [[32mCREATE TABLE (3.1m rows, 292.5 MiB processed)[0m in 8.99s]
[0m15:55:39.264747 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m15:55:39.268127 [debug] [Thread-1 (]: Began running node model.games.platform
[0m15:55:39.270697 [info ] [Thread-1 (]: 9 of 12 START sql table model games.platform ................................... [RUN]
[0m15:55:39.273626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.fct_game_pricing, now model.games.platform)
[0m15:55:39.275480 [debug] [Thread-1 (]: Began compiling node model.games.platform
[0m15:55:39.281726 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.platform"
[0m15:55:39.282436 [debug] [Thread-1 (]: Timing info for model.games.platform (compile): 15:55:39.276772 => 15:55:39.282224
[0m15:55:39.282852 [debug] [Thread-1 (]: Began executing node model.games.platform
[0m15:55:39.285092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:40.001195 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.platform"
[0m15:55:40.001918 [debug] [Thread-1 (]: On model.games.platform: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.platform"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`platform`
      
    
    

    OPTIONS()
    as (
      -- Informe de Ingresos por Plataforma
SELECT
    p.platform_id,
    s.total_sales,
    SUM(CASE WHEN p.windows = 1 THEN s.price_with_tax ELSE 0 END) AS total_sales_windows,
    SUM(CASE WHEN p.mac = 1 THEN s.price_with_tax ELSE 0 END) AS total_sales_mac,
    SUM(CASE WHEN p.linux = 1 THEN s.price_with_tax ELSE 0 END) AS total_sales_linux
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing` s
JOIN
    `pristine-flames-400818`.`games`.`dim_platforms` p ON s.platform_id = p.platform_id
GROUP BY
    p.platform_id, s.total_sales
ORDER BY
    total_sales DESC
    );
  
[0m15:55:40.470783 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:73734c24-93ef-4c81-bf77-2791a7d4ebc4&page=queryresults
[0m15:55:44.039965 [debug] [Thread-1 (]: Timing info for model.games.platform (execute): 15:55:39.283105 => 15:55:44.039086
[0m15:55:44.043375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27c371f5-447f-4cdf-b982-52e3b1df3f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd075489120>]}
[0m15:55:44.045937 [info ] [Thread-1 (]: 9 of 12 OK created sql table model games.platform .............................. [[32mCREATE TABLE (432.2k rows, 118.5 MiB processed)[0m in 4.77s]
[0m15:55:44.048786 [debug] [Thread-1 (]: Finished running node model.games.platform
[0m15:55:44.050861 [debug] [Thread-1 (]: Began running node model.games.top_10_discounted_games
[0m15:55:44.053009 [info ] [Thread-1 (]: 10 of 12 START sql table model games.top_10_discounted_games ................... [RUN]
[0m15:55:44.056411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.platform, now model.games.top_10_discounted_games)
[0m15:55:44.058294 [debug] [Thread-1 (]: Began compiling node model.games.top_10_discounted_games
[0m15:55:44.067588 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_discounted_games"
[0m15:55:44.069144 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (compile): 15:55:44.059645 => 15:55:44.068653
[0m15:55:44.070068 [debug] [Thread-1 (]: Began executing node model.games.top_10_discounted_games
[0m15:55:44.085503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:45.028181 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_discounted_games"
[0m15:55:45.028921 [debug] [Thread-1 (]: On model.games.top_10_discounted_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_discounted_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_discounted_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 descuentos más grandes
SELECT
    app_id,
    game_name,
    total_discounts
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY total_discounts DESC
LIMIT 10
    );
  
[0m15:55:45.691777 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:6ba18c78-6df2-4bc6-ac6b-398e3e0aa9fc&page=queryresults
[0m15:55:48.021752 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (execute): 15:55:44.070743 => 15:55:48.021293
[0m15:55:48.023188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27c371f5-447f-4cdf-b982-52e3b1df3f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd07534cc40>]}
[0m15:55:48.024380 [info ] [Thread-1 (]: 10 of 12 OK created sql table model games.top_10_discounted_games .............. [[32mCREATE TABLE (10.0 rows, 162.8 MiB processed)[0m in 3.97s]
[0m15:55:48.025635 [debug] [Thread-1 (]: Finished running node model.games.top_10_discounted_games
[0m15:55:48.026561 [debug] [Thread-1 (]: Began running node model.games.top_10_high_tax_games
[0m15:55:48.027497 [info ] [Thread-1 (]: 11 of 12 START sql table model games.top_10_high_tax_games ..................... [RUN]
[0m15:55:48.028623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_discounted_games, now model.games.top_10_high_tax_games)
[0m15:55:48.029335 [debug] [Thread-1 (]: Began compiling node model.games.top_10_high_tax_games
[0m15:55:48.033704 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_high_tax_games"
[0m15:55:48.034785 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (compile): 15:55:48.029810 => 15:55:48.034463
[0m15:55:48.035353 [debug] [Thread-1 (]: Began executing node model.games.top_10_high_tax_games
[0m15:55:48.038291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:48.702692 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_high_tax_games"
[0m15:55:48.705354 [debug] [Thread-1 (]: On model.games.top_10_high_tax_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_high_tax_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_high_tax_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos con más impuestos
SELECT
    app_id,
    game_name,
    SUM(total_sales_with_tax) AS total_taxes
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
GROUP BY app_id, game_name
ORDER BY total_taxes DESC, game_name DESC
LIMIT 10
    );
  
[0m15:55:49.280249 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:46f0d256-7ab5-4ea4-8a2e-19d4d77a6d48&page=queryresults
[0m15:55:51.667220 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (execute): 15:55:48.035736 => 15:55:51.666233
[0m15:55:51.670515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27c371f5-447f-4cdf-b982-52e3b1df3f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd07530e920>]}
[0m15:55:51.673251 [info ] [Thread-1 (]: 11 of 12 OK created sql table model games.top_10_high_tax_games ................ [[32mCREATE TABLE (10.0 rows, 162.8 MiB processed)[0m in 3.64s]
[0m15:55:51.676114 [debug] [Thread-1 (]: Finished running node model.games.top_10_high_tax_games
[0m15:55:51.678156 [debug] [Thread-1 (]: Began running node model.games.top_10_most_expensive_games
[0m15:55:51.680622 [info ] [Thread-1 (]: 12 of 12 START sql table model games.top_10_most_expensive_games ............... [RUN]
[0m15:55:51.683040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_high_tax_games, now model.games.top_10_most_expensive_games)
[0m15:55:51.684323 [debug] [Thread-1 (]: Began compiling node model.games.top_10_most_expensive_games
[0m15:55:51.691419 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_most_expensive_games"
[0m15:55:51.692761 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (compile): 15:55:51.685228 => 15:55:51.692366
[0m15:55:51.693506 [debug] [Thread-1 (]: Began executing node model.games.top_10_most_expensive_games
[0m15:55:51.697540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:52.418125 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_most_expensive_games"
[0m15:55:52.419005 [debug] [Thread-1 (]: On model.games.top_10_most_expensive_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_most_expensive_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_most_expensive_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos más caros
SELECT
    app_id,
    game_name,
    max_price,
    formatted_initial_price,
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY max_price DESC
LIMIT 10
    );
  
[0m15:55:52.971521 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:841040e7-974e-47b4-9c91-907c7acfe069&page=queryresults
[0m15:55:54.805491 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (execute): 15:55:51.694035 => 15:55:54.805288
[0m15:55:54.806338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27c371f5-447f-4cdf-b982-52e3b1df3f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0753461a0>]}
[0m15:55:54.807050 [info ] [Thread-1 (]: 12 of 12 OK created sql table model games.top_10_most_expensive_games .......... [[32mCREATE TABLE (10.0 rows, 177.7 MiB processed)[0m in 3.12s]
[0m15:55:54.807672 [debug] [Thread-1 (]: Finished running node model.games.top_10_most_expensive_games
[0m15:55:54.809088 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:55:54.809420 [debug] [MainThread]: Connection 'model.games.top_10_most_expensive_games' was properly closed.
[0m15:55:54.809776 [info ] [MainThread]: 
[0m15:55:54.810127 [info ] [MainThread]: Finished running 12 table models in 0 hours 0 minutes and 54.98 seconds (54.98s).
[0m15:55:54.812265 [debug] [MainThread]: Command end result
[0m15:55:54.826734 [info ] [MainThread]: 
[0m15:55:54.827171 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:55:54.827508 [info ] [MainThread]: 
[0m15:55:54.827852 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m15:55:54.828397 [debug] [MainThread]: Command `dbt run` succeeded at 15:55:54.828301 after 55.45 seconds
[0m15:55:54.828750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd079f0d180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0796447f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd075399270>]}
[0m15:55:54.829129 [debug] [MainThread]: Flushing usage events
[0m16:00:14.268707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49dd70dbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49db7a4070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49db7a40d0>]}


============================== 16:00:14.270957 | 7acfb4b1-888d-45bc-920b-170c4496653c ==============================
[0m16:00:14.270957 [info ] [MainThread]: Running with dbt=1.6.5
[0m16:00:14.271454 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:00:14.577672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7acfb4b1-888d-45bc-920b-170c4496653c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49d9722c50>]}
[0m16:00:14.594963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7acfb4b1-888d-45bc-920b-170c4496653c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49d97407c0>]}
[0m16:00:14.595711 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m16:00:14.611705 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m16:00:14.687620 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:00:14.697213 [debug] [MainThread]: Partial parsing: updated file: games://models/report/platform.sql
[0m16:00:14.843309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7acfb4b1-888d-45bc-920b-170c4496653c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49d8e3a320>]}
[0m16:00:15.248659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7acfb4b1-888d-45bc-920b-170c4496653c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49d9577970>]}
[0m16:00:15.249835 [info ] [MainThread]: Found 12 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m16:00:15.250768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7acfb4b1-888d-45bc-920b-170c4496653c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49d95779a0>]}
[0m16:00:15.254500 [info ] [MainThread]: 
[0m16:00:15.256215 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:00:15.259799 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m16:00:15.260968 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:16.097782 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m16:00:16.098270 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:00:16.744154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7acfb4b1-888d-45bc-920b-170c4496653c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49d9576860>]}
[0m16:00:16.750427 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:00:16.750853 [info ] [MainThread]: 
[0m16:00:16.752686 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m16:00:16.753184 [info ] [Thread-1 (]: 1 of 12 START sql table model games.dim_developers ............................. [RUN]
[0m16:00:16.753813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m16:00:16.754186 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m16:00:16.761340 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m16:00:16.767516 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 16:00:16.754445 => 16:00:16.767250
[0m16:00:16.767956 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m16:00:16.781536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:17.632534 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m16:00:17.633246 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS developer_id,
    developers_name
FROM
    developers_cte
    );
  
[0m16:00:18.241237 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:23cc0617-4a4a-44a4-b3bc-10825b92e12d&page=queryresults
[0m16:00:20.745725 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 16:00:16.768226 => 16:00:20.745442
[0m16:00:20.746758 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7acfb4b1-888d-45bc-920b-170c4496653c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49d974d2d0>]}
[0m16:00:20.747598 [info ] [Thread-1 (]: 1 of 12 OK created sql table model games.dim_developers ........................ [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 3.99s]
[0m16:00:20.748342 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m16:00:20.748890 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m16:00:20.749537 [info ] [Thread-1 (]: 2 of 12 START sql table model games.dim_games .................................. [RUN]
[0m16:00:20.750339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m16:00:20.751141 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m16:00:20.760566 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m16:00:20.761299 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 16:00:20.751618 => 16:00:20.761081
[0m16:00:20.761716 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m16:00:20.764223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:21.478532 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m16:00:21.479263 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m16:00:22.091611 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:644a123f-5bd3-4b4c-84f2-41508169e9bb&page=queryresults
[0m16:00:24.581225 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 16:00:20.762004 => 16:00:24.580512
[0m16:00:24.583404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7acfb4b1-888d-45bc-920b-170c4496653c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49d974ce50>]}
[0m16:00:24.584815 [info ] [Thread-1 (]: 2 of 12 OK created sql table model games.dim_games ............................. [[32mCREATE TABLE (2.7k rows, 753.9 KiB processed)[0m in 3.83s]
[0m16:00:24.586471 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m16:00:24.587616 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m16:00:24.588624 [info ] [Thread-1 (]: 3 of 12 START sql table model games.dim_platforms .............................. [RUN]
[0m16:00:24.589893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m16:00:24.590697 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m16:00:24.595927 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m16:00:24.912494 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 16:00:24.591285 => 16:00:24.912211
[0m16:00:24.912932 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m16:00:24.915178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:25.680710 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m16:00:25.723993 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m16:00:26.277885 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:63c2c2df-fe9c-4293-a1ee-d2a29da8d2d7&page=queryresults
[0m16:00:28.721497 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 16:00:24.913201 => 16:00:28.721288
[0m16:00:28.722355 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7acfb4b1-888d-45bc-920b-170c4496653c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49d974e500>]}
[0m16:00:28.723107 [info ] [Thread-1 (]: 3 of 12 OK created sql table model games.dim_platforms ......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 4.13s]
[0m16:00:28.723803 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m16:00:28.724311 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m16:00:28.724822 [info ] [Thread-1 (]: 4 of 12 START sql table model games.dim_price_overview ......................... [RUN]
[0m16:00:28.725593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m16:00:28.725967 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m16:00:28.728900 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m16:00:28.876196 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 16:00:28.726230 => 16:00:28.875861
[0m16:00:28.876698 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m16:00:28.880878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:29.617459 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m16:00:29.635937 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    platform_id,
    windows,
    mac,
    linux,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte, games.dim_platforms
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m16:00:30.278431 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:1ecdf7f3-a044-42fa-97d4-8b76f8db832b&page=queryresults
[0m16:00:37.391132 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 16:00:28.877007 => 16:00:37.390940
[0m16:00:37.391846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7acfb4b1-888d-45bc-920b-170c4496653c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49d8d422c0>]}
[0m16:00:37.392401 [info ] [Thread-1 (]: 4 of 12 OK created sql table model games.dim_price_overview .................... [[32mCREATE TABLE (3.1m rows, 199.1 KiB processed)[0m in 8.67s]
[0m16:00:37.392979 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m16:00:37.393399 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m16:00:37.393846 [info ] [Thread-1 (]: 5 of 12 START sql table model games.dim_publishers ............................. [RUN]
[0m16:00:37.394760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m16:00:37.395243 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m16:00:37.398134 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m16:00:37.403856 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 16:00:37.395525 => 16:00:37.403632
[0m16:00:37.404250 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m16:00:37.406548 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:38.197659 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m16:00:38.198327 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m16:00:38.625580 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:904bd49f-2988-4cff-b067-84a4b905ded5&page=queryresults
[0m16:00:41.277331 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 16:00:37.404515 => 16:00:41.277131
[0m16:00:41.278323 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7acfb4b1-888d-45bc-920b-170c4496653c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49d8d30cd0>]}
[0m16:00:41.278986 [info ] [Thread-1 (]: 5 of 12 OK created sql table model games.dim_publishers ........................ [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 3.88s]
[0m16:00:41.279768 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m16:00:41.280295 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m16:00:41.280882 [info ] [Thread-1 (]: 6 of 12 START sql table model games.dim_release ................................ [RUN]
[0m16:00:41.281687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m16:00:41.282145 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m16:00:41.285539 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m16:00:41.286418 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 16:00:41.282489 => 16:00:41.286161
[0m16:00:41.287000 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m16:00:41.289486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:41.966812 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m16:00:41.967445 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m16:00:42.458258 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:8e870fc2-7219-46d0-a942-e2e7f4101329&page=queryresults
[0m16:00:44.621506 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 16:00:41.287341 => 16:00:44.621039
[0m16:00:44.623416 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7acfb4b1-888d-45bc-920b-170c4496653c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49d8d31030>]}
[0m16:00:44.624831 [info ] [Thread-1 (]: 6 of 12 OK created sql table model games.dim_release ........................... [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 3.34s]
[0m16:00:44.626335 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m16:00:44.627439 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m16:00:44.628746 [info ] [Thread-1 (]: 7 of 12 START sql table model games.dim_support_language ....................... [RUN]
[0m16:00:44.630524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m16:00:44.631550 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m16:00:44.638532 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m16:00:44.639793 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 16:00:44.632422 => 16:00:44.639395
[0m16:00:44.640555 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m16:00:44.651076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:45.320682 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m16:00:45.323443 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m16:00:45.940144 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:70ece291-3d67-4a2b-a804-253156dc65f2&page=queryresults
[0m16:00:48.358372 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 16:00:44.641096 => 16:00:48.358180
[0m16:00:48.359096 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7acfb4b1-888d-45bc-920b-170c4496653c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49d8d68880>]}
[0m16:00:48.359725 [info ] [Thread-1 (]: 7 of 12 OK created sql table model games.dim_support_language .................. [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 3.73s]
[0m16:00:48.360333 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m16:00:48.360766 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m16:00:48.361273 [info ] [Thread-1 (]: 8 of 12 START sql table model games.fct_game_pricing ........................... [RUN]
[0m16:00:48.361911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m16:00:48.362291 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m16:00:48.365602 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m16:00:48.366257 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 16:00:48.362588 => 16:00:48.366055
[0m16:00:48.366649 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m16:00:48.368968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:49.044167 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m16:00:49.044941 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para el análisis de precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        formatted_initial_price,
        platform_id,
        formatted_price_with_tax,
        price_with_tax,
        SUM(price_with_tax) AS total_sales,
        SUM(discount_amount) AS total_discounts,
        COUNT(*) AS num_sales,
        MAX(discount_pct) AS max_discount,
        MIN(initial_price) AS min_price,
        MAX(initial_price) AS max_price,
        SUM(price_with_tax) AS total_sales_with_tax,
        SUM(final_price) AS total_sales_with_tax_discounted
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id, platform_id, formatted_initial_price, formatted_price_with_tax, price_with_tax
)

SELECT
    fct.app_id,
    fct.formatted_initial_price,
    fct.total_sales,
    fct.platform_id,
    fct.formatted_price_with_tax,
    fct.total_discounts,
    fct.price_with_tax,
    fct.num_sales,
    fct.max_discount,
    fct.min_price,
    fct.max_price,
    fct.total_sales_with_tax,
    fct.total_sales_with_tax_discounted,
    games.name AS game_name,
    games.description AS game_description,
    games.is_free AS game_is_free,
    games.fullgame_app_id,
    games.fullgame_name,
    games.type,
    games.genre_id,
    games.type_genre,
FROM
    game_sales AS fct
INNER JOIN
    `pristine-flames-400818`.`games`.`dim_games` AS games
ON
    fct.app_id = games.app_id
INNER JOIN 
    `pristine-flames-400818`.`games`.`dim_platforms` AS dp
ON
    fct.platform_id = dp.platform_id
    );
  
[0m16:00:49.546162 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:406dbffb-7e32-46b1-a262-0bafbf1bde92&page=queryresults
[0m16:00:59.325273 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 16:00:48.366915 => 16:00:59.324381
[0m16:00:59.328456 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7acfb4b1-888d-45bc-920b-170c4496653c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49d8d6a3e0>]}
[0m16:00:59.331342 [info ] [Thread-1 (]: 8 of 12 OK created sql table model games.fct_game_pricing ...................... [[32mCREATE TABLE (3.1m rows, 292.5 MiB processed)[0m in 10.97s]
[0m16:00:59.334248 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m16:00:59.337026 [debug] [Thread-1 (]: Began running node model.games.platform
[0m16:00:59.338636 [info ] [Thread-1 (]: 9 of 12 START sql table model games.platform ................................... [RUN]
[0m16:00:59.340504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.fct_game_pricing, now model.games.platform)
[0m16:00:59.341452 [debug] [Thread-1 (]: Began compiling node model.games.platform
[0m16:00:59.348162 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.platform"
[0m16:00:59.350600 [debug] [Thread-1 (]: Timing info for model.games.platform (compile): 16:00:59.342133 => 16:00:59.350250
[0m16:00:59.351231 [debug] [Thread-1 (]: Began executing node model.games.platform
[0m16:00:59.355113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:00.115245 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.platform"
[0m16:01:00.305428 [debug] [Thread-1 (]: On model.games.platform: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.platform"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`platform`
      
    
    

    OPTIONS()
    as (
      -- Informe de Ingresos por Plataforma
SELECT
    s.app_id,
    p.platform_id,
    s.total_sales,
    SUM(CASE WHEN p.windows = 1 THEN s.price_with_tax ELSE 0 END) AS total_sales_windows,
    SUM(CASE WHEN p.mac = 1 THEN s.price_with_tax ELSE 0 END) AS total_sales_mac,
    SUM(CASE WHEN p.linux = 1 THEN s.price_with_tax ELSE 0 END) AS total_sales_linux
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing` s
JOIN
    `pristine-flames-400818`.`games`.`dim_platforms` p ON s.platform_id = p.platform_id
GROUP BY
    s.app_id, p.platform_id, s.total_sales
ORDER BY
    total_sales DESC
    );
  
[0m16:01:00.856974 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:de219ed1-9e03-44a6-80fb-7dcb1b28eebd&page=queryresults
[0m16:01:10.657825 [debug] [Thread-1 (]: Timing info for model.games.platform (execute): 16:00:59.351674 => 16:01:10.656964
[0m16:01:10.660802 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7acfb4b1-888d-45bc-920b-170c4496653c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49d8e9d8a0>]}
[0m16:01:10.662628 [info ] [Thread-1 (]: 9 of 12 OK created sql table model games.platform .............................. [[32mCREATE TABLE (3.1m rows, 142.2 MiB processed)[0m in 11.32s]
[0m16:01:10.664595 [debug] [Thread-1 (]: Finished running node model.games.platform
[0m16:01:10.665739 [debug] [Thread-1 (]: Began running node model.games.top_10_discounted_games
[0m16:01:10.667002 [info ] [Thread-1 (]: 10 of 12 START sql table model games.top_10_discounted_games ................... [RUN]
[0m16:01:10.668638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.platform, now model.games.top_10_discounted_games)
[0m16:01:10.669592 [debug] [Thread-1 (]: Began compiling node model.games.top_10_discounted_games
[0m16:01:10.675227 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_discounted_games"
[0m16:01:10.676674 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (compile): 16:01:10.670195 => 16:01:10.676201
[0m16:01:10.677579 [debug] [Thread-1 (]: Began executing node model.games.top_10_discounted_games
[0m16:01:10.689114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:11.325702 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_discounted_games"
[0m16:01:11.331005 [debug] [Thread-1 (]: On model.games.top_10_discounted_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_discounted_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_discounted_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 descuentos más grandes
SELECT
    app_id,
    game_name,
    total_discounts
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY total_discounts DESC
LIMIT 10
    );
  
[0m16:01:11.908039 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:92d025c4-bdc2-453d-a765-700dbca653ca&page=queryresults
[0m16:01:14.626090 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (execute): 16:01:10.678253 => 16:01:14.625781
[0m16:01:14.627243 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7acfb4b1-888d-45bc-920b-170c4496653c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49d8d5ee60>]}
[0m16:01:14.628179 [info ] [Thread-1 (]: 10 of 12 OK created sql table model games.top_10_discounted_games .............. [[32mCREATE TABLE (10.0 rows, 162.8 MiB processed)[0m in 3.96s]
[0m16:01:14.629166 [debug] [Thread-1 (]: Finished running node model.games.top_10_discounted_games
[0m16:01:14.629873 [debug] [Thread-1 (]: Began running node model.games.top_10_high_tax_games
[0m16:01:14.630622 [info ] [Thread-1 (]: 11 of 12 START sql table model games.top_10_high_tax_games ..................... [RUN]
[0m16:01:14.631500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_discounted_games, now model.games.top_10_high_tax_games)
[0m16:01:14.632039 [debug] [Thread-1 (]: Began compiling node model.games.top_10_high_tax_games
[0m16:01:14.635856 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_high_tax_games"
[0m16:01:14.636742 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (compile): 16:01:14.632418 => 16:01:14.636464
[0m16:01:14.637277 [debug] [Thread-1 (]: Began executing node model.games.top_10_high_tax_games
[0m16:01:14.640507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:15.356713 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_high_tax_games"
[0m16:01:15.426877 [debug] [Thread-1 (]: On model.games.top_10_high_tax_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_high_tax_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_high_tax_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos con más impuestos
SELECT
    app_id,
    game_name,
    SUM(total_sales_with_tax) AS total_taxes
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
GROUP BY app_id, game_name
ORDER BY total_taxes DESC, game_name DESC
LIMIT 10
    );
  
[0m16:01:15.987447 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:0f27639b-98fd-41d9-8cd0-0ca5d4d7f410&page=queryresults
[0m16:01:18.472488 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (execute): 16:01:14.637654 => 16:01:18.472132
[0m16:01:18.473833 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7acfb4b1-888d-45bc-920b-170c4496653c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49d8d0be50>]}
[0m16:01:18.474885 [info ] [Thread-1 (]: 11 of 12 OK created sql table model games.top_10_high_tax_games ................ [[32mCREATE TABLE (10.0 rows, 162.8 MiB processed)[0m in 3.84s]
[0m16:01:18.476179 [debug] [Thread-1 (]: Finished running node model.games.top_10_high_tax_games
[0m16:01:18.477118 [debug] [Thread-1 (]: Began running node model.games.top_10_most_expensive_games
[0m16:01:18.478240 [info ] [Thread-1 (]: 12 of 12 START sql table model games.top_10_most_expensive_games ............... [RUN]
[0m16:01:18.479598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_high_tax_games, now model.games.top_10_most_expensive_games)
[0m16:01:18.480422 [debug] [Thread-1 (]: Began compiling node model.games.top_10_most_expensive_games
[0m16:01:18.486137 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_most_expensive_games"
[0m16:01:18.539200 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (compile): 16:01:18.481008 => 16:01:18.538134
[0m16:01:18.541081 [debug] [Thread-1 (]: Began executing node model.games.top_10_most_expensive_games
[0m16:01:18.551074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:19.277572 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_most_expensive_games"
[0m16:01:19.306360 [debug] [Thread-1 (]: On model.games.top_10_most_expensive_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_most_expensive_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_most_expensive_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos más caros
SELECT
    app_id,
    game_name,
    max_price,
    formatted_initial_price,
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY max_price DESC
LIMIT 10
    );
  
[0m16:01:19.798553 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:1e4eeb97-e2ff-4163-9599-c15254f9e05a&page=queryresults
[0m16:01:22.169915 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (execute): 16:01:18.542376 => 16:01:22.169039
[0m16:01:22.173212 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7acfb4b1-888d-45bc-920b-170c4496653c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49d8d2f910>]}
[0m16:01:22.175800 [info ] [Thread-1 (]: 12 of 12 OK created sql table model games.top_10_most_expensive_games .......... [[32mCREATE TABLE (10.0 rows, 177.7 MiB processed)[0m in 3.69s]
[0m16:01:22.178698 [debug] [Thread-1 (]: Finished running node model.games.top_10_most_expensive_games
[0m16:01:22.184505 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:01:22.186038 [debug] [MainThread]: Connection 'model.games.top_10_most_expensive_games' was properly closed.
[0m16:01:22.187764 [info ] [MainThread]: 
[0m16:01:22.189467 [info ] [MainThread]: Finished running 12 table models in 0 hours 1 minutes and 6.93 seconds (66.93s).
[0m16:01:22.198512 [debug] [MainThread]: Command end result
[0m16:01:22.741409 [info ] [MainThread]: 
[0m16:01:22.743361 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:01:22.745012 [info ] [MainThread]: 
[0m16:01:22.746718 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m16:01:22.749276 [debug] [MainThread]: Command `dbt run` succeeded at 16:01:22.748816 after 68.49 seconds
[0m16:01:22.750987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49dd70dbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49d8da9a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49d8da92a0>]}
[0m16:01:22.752758 [debug] [MainThread]: Flushing usage events
[0m17:16:53.498339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8788f22b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8786f90070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8786f900d0>]}


============================== 17:16:53.501354 | a72bf520-6660-464a-8bd9-95304cdf0789 ==============================
[0m17:16:53.501354 [info ] [MainThread]: Running with dbt=1.6.5
[0m17:16:53.501887 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:16:54.020873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a72bf520-6660-464a-8bd9-95304cdf0789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87884ddcf0>]}
[0m17:16:54.036694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a72bf520-6660-464a-8bd9-95304cdf0789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8784f2c9d0>]}
[0m17:16:54.037474 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m17:16:54.050989 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m17:16:54.099946 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:16:54.100389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a72bf520-6660-464a-8bd9-95304cdf0789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87884dc7c0>]}
[0m17:16:55.100778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a72bf520-6660-464a-8bd9-95304cdf0789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87846d9b10>]}
[0m17:16:55.111351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a72bf520-6660-464a-8bd9-95304cdf0789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8784f3ad10>]}
[0m17:16:55.111846 [info ] [MainThread]: Found 12 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m17:16:55.112194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a72bf520-6660-464a-8bd9-95304cdf0789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8784d848b0>]}
[0m17:16:55.113686 [info ] [MainThread]: 
[0m17:16:55.114340 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:16:55.115763 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m17:16:55.116175 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:55.116549 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: '/opt/airflow/credentials.json''
[0m17:16:55.117529 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:16:55.117832 [debug] [MainThread]: Connection 'list_pristine-flames-400818' was properly closed.
[0m17:16:55.118131 [info ] [MainThread]: 
[0m17:16:55.118474 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.00 seconds (0.00s).
[0m17:16:55.118911 [error] [MainThread]: Encountered an error:
Database Error
  [Errno 2] No such file or directory: '/opt/airflow/credentials.json'
[0m17:16:55.119422 [debug] [MainThread]: Command `dbt run` failed at 17:16:55.119332 after 1.63 seconds
[0m17:16:55.119759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8788f22b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87846dbfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87846daef0>]}
[0m17:16:55.120112 [debug] [MainThread]: Flushing usage events
[0m17:19:25.706310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c85351b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c6694070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c66940d0>]}


============================== 17:19:25.708487 | 9d0be7f3-e859-4457-a41b-cbc5d8653a3d ==============================
[0m17:19:25.708487 [info ] [MainThread]: Running with dbt=1.6.5
[0m17:19:25.708951 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'debug': 'False', 'profiles_dir': '../dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'send_anonymous_usage_stats': 'True'}
[0m17:19:25.990006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d0be7f3-e859-4457-a41b-cbc5d8653a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c461ab30>]}
[0m17:19:26.005909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d0be7f3-e859-4457-a41b-cbc5d8653a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c4634700>]}
[0m17:19:26.006563 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m17:19:26.020220 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m17:19:26.065722 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:19:26.066157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9d0be7f3-e859-4457-a41b-cbc5d8653a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c461a350>]}
[0m17:19:27.029992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d0be7f3-e859-4457-a41b-cbc5d8653a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c3bdda20>]}
[0m17:19:27.039253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d0be7f3-e859-4457-a41b-cbc5d8653a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c4642bc0>]}
[0m17:19:27.039711 [info ] [MainThread]: Found 12 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m17:19:27.040053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d0be7f3-e859-4457-a41b-cbc5d8653a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c448ca00>]}
[0m17:19:27.041480 [info ] [MainThread]: 
[0m17:19:27.042132 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:19:27.043569 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m17:19:27.043976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:27.874350 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m17:19:27.874920 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:19:28.547294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d0be7f3-e859-4457-a41b-cbc5d8653a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c448c7c0>]}
[0m17:19:28.550583 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:19:28.552255 [info ] [MainThread]: 
[0m17:19:28.559905 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m17:19:28.562089 [info ] [Thread-1 (]: 1 of 12 START sql table model games.dim_developers ............................. [RUN]
[0m17:19:28.565081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m17:19:28.567024 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m17:19:28.594909 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m17:19:28.596148 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 17:19:28.568355 => 17:19:28.595767
[0m17:19:28.596904 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m17:19:28.618905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:29.377120 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m17:19:29.377932 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS developer_id,
    developers_name
FROM
    developers_cte
    );
  
[0m17:19:29.881494 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:2306cf47-a2a7-4f62-b0f1-0adfd3802ac6&page=queryresults
[0m17:19:32.909529 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 17:19:28.597426 => 17:19:32.909229
[0m17:19:32.910530 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d0be7f3-e859-4457-a41b-cbc5d8653a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c449dff0>]}
[0m17:19:32.911328 [info ] [Thread-1 (]: 1 of 12 OK created sql table model games.dim_developers ........................ [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.35s]
[0m17:19:32.912165 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m17:19:32.912771 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m17:19:32.913491 [info ] [Thread-1 (]: 2 of 12 START sql table model games.dim_games .................................. [RUN]
[0m17:19:32.914364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m17:19:32.914858 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m17:19:32.918197 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m17:19:32.920763 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 17:19:32.915191 => 17:19:32.920135
[0m17:19:32.922024 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m17:19:32.928468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:33.643574 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m17:19:33.645262 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m17:19:34.364409 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5a62ecb2-9702-45be-86f4-1c0f44c2aea2&page=queryresults
[0m17:19:36.873503 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 17:19:32.923058 => 17:19:36.872610
[0m17:19:36.874602 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d0be7f3-e859-4457-a41b-cbc5d8653a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c3950e50>]}
[0m17:19:36.875209 [info ] [Thread-1 (]: 2 of 12 OK created sql table model games.dim_games ............................. [[32mCREATE TABLE (2.7k rows, 753.9 KiB processed)[0m in 3.96s]
[0m17:19:36.875796 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m17:19:36.876224 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m17:19:36.876822 [info ] [Thread-1 (]: 3 of 12 START sql table model games.dim_platforms .............................. [RUN]
[0m17:19:36.877875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m17:19:36.878350 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m17:19:36.881764 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m17:19:36.882431 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 17:19:36.878640 => 17:19:36.882237
[0m17:19:36.882814 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m17:19:36.885050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:37.609116 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m17:19:37.611808 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m17:19:38.090225 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:cdd9b062-2b85-4be4-8c25-440ca23ecdcf&page=queryresults
[0m17:19:40.503268 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 17:19:36.883071 => 17:19:40.502375
[0m17:19:40.506584 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d0be7f3-e859-4457-a41b-cbc5d8653a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c39cff70>]}
[0m17:19:40.509164 [info ] [Thread-1 (]: 3 of 12 OK created sql table model games.dim_platforms ......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 3.63s]
[0m17:19:40.511955 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m17:19:40.513985 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m17:19:40.516452 [info ] [Thread-1 (]: 4 of 12 START sql table model games.dim_price_overview ......................... [RUN]
[0m17:19:40.519623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m17:19:40.521468 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m17:19:40.541245 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m17:19:40.542378 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 17:19:40.522815 => 17:19:40.542011
[0m17:19:40.543067 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m17:19:40.546600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:41.257792 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m17:19:41.260819 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    platform_id,
    windows,
    mac,
    linux,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte, games.dim_platforms
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m17:19:41.707239 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:905deb62-549c-48e7-9558-e5351e4e1094&page=queryresults
[0m17:19:47.354342 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 17:19:40.543523 => 17:19:47.354133
[0m17:19:47.355181 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d0be7f3-e859-4457-a41b-cbc5d8653a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c3b6b310>]}
[0m17:19:47.355754 [info ] [Thread-1 (]: 4 of 12 OK created sql table model games.dim_price_overview .................... [[32mCREATE TABLE (3.1m rows, 199.1 KiB processed)[0m in 6.84s]
[0m17:19:47.356365 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m17:19:47.356909 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m17:19:47.357572 [info ] [Thread-1 (]: 5 of 12 START sql table model games.dim_publishers ............................. [RUN]
[0m17:19:47.358345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m17:19:47.358791 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m17:19:47.361635 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m17:19:47.362263 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 17:19:47.359059 => 17:19:47.362067
[0m17:19:47.362653 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m17:19:47.364822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:48.090231 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m17:19:48.092910 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m17:19:48.570714 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f7a74095-1e39-4d4e-aa44-1ef8c4671cf8&page=queryresults
[0m17:19:51.244220 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 17:19:47.362920 => 17:19:51.243343
[0m17:19:51.247386 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d0be7f3-e859-4457-a41b-cbc5d8653a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c3b6b1f0>]}
[0m17:19:51.249976 [info ] [Thread-1 (]: 5 of 12 OK created sql table model games.dim_publishers ........................ [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 3.89s]
[0m17:19:51.252830 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m17:19:51.254892 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m17:19:51.257323 [info ] [Thread-1 (]: 6 of 12 START sql table model games.dim_release ................................ [RUN]
[0m17:19:51.260300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m17:19:51.262126 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m17:19:51.273572 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m17:19:51.275369 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 17:19:51.263492 => 17:19:51.274890
[0m17:19:51.276297 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m17:19:51.281356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:51.998605 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m17:19:52.001279 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m17:19:52.474001 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d25d14ba-29c6-43e6-8736-4eb571ce0668&page=queryresults
[0m17:19:55.140590 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 17:19:51.276953 => 17:19:55.139727
[0m17:19:55.143771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d0be7f3-e859-4457-a41b-cbc5d8653a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c3b6b100>]}
[0m17:19:55.146350 [info ] [Thread-1 (]: 6 of 12 OK created sql table model games.dim_release ........................... [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 3.88s]
[0m17:19:55.149159 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m17:19:55.151203 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m17:19:55.153608 [info ] [Thread-1 (]: 7 of 12 START sql table model games.dim_support_language ....................... [RUN]
[0m17:19:55.156571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m17:19:55.158410 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m17:19:55.169471 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m17:19:55.171068 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 17:19:55.159746 => 17:19:55.170582
[0m17:19:55.172003 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m17:19:55.176934 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:55.972218 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m17:19:55.974991 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m17:19:56.436039 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:254b02bd-4f90-4235-bd1f-f6a7f965019b&page=queryresults
[0m17:19:58.844149 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 17:19:55.172667 => 17:19:58.843722
[0m17:19:58.845948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d0be7f3-e859-4457-a41b-cbc5d8653a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c39f3dc0>]}
[0m17:19:58.847530 [info ] [Thread-1 (]: 7 of 12 OK created sql table model games.dim_support_language .................. [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 3.69s]
[0m17:19:58.849183 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m17:19:58.850653 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m17:19:58.852525 [info ] [Thread-1 (]: 8 of 12 START sql table model games.fct_game_pricing ........................... [RUN]
[0m17:19:58.854792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m17:19:58.856185 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m17:19:58.867506 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m17:19:58.869896 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 17:19:58.857175 => 17:19:58.869096
[0m17:19:58.871360 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m17:19:58.878272 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:59.603485 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m17:19:59.606396 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para el análisis de precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        formatted_initial_price,
        platform_id,
        formatted_price_with_tax,
        price_with_tax,
        SUM(price_with_tax) AS total_sales,
        SUM(discount_amount) AS total_discounts,
        COUNT(*) AS num_sales,
        MAX(discount_pct) AS max_discount,
        MIN(initial_price) AS min_price,
        MAX(initial_price) AS max_price,
        SUM(price_with_tax) AS total_sales_with_tax,
        SUM(final_price) AS total_sales_with_tax_discounted
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id, platform_id, formatted_initial_price, formatted_price_with_tax, price_with_tax
)

SELECT
    fct.app_id,
    fct.formatted_initial_price,
    fct.total_sales,
    fct.platform_id,
    fct.formatted_price_with_tax,
    fct.total_discounts,
    fct.price_with_tax,
    fct.num_sales,
    fct.max_discount,
    fct.min_price,
    fct.max_price,
    fct.total_sales_with_tax,
    fct.total_sales_with_tax_discounted,
    games.name AS game_name,
    games.description AS game_description,
    games.is_free AS game_is_free,
    games.fullgame_app_id,
    games.fullgame_name,
    games.type,
    games.genre_id,
    games.type_genre,
FROM
    game_sales AS fct
INNER JOIN
    `pristine-flames-400818`.`games`.`dim_games` AS games
ON
    fct.app_id = games.app_id
INNER JOIN 
    `pristine-flames-400818`.`games`.`dim_platforms` AS dp
ON
    fct.platform_id = dp.platform_id
    );
  
[0m17:20:00.093987 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:71629639-aad7-4a8b-890d-44510dbc596a&page=queryresults
[0m17:20:08.629736 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 17:19:58.872377 => 17:20:08.629542
[0m17:20:08.630494 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d0be7f3-e859-4457-a41b-cbc5d8653a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c3b6aef0>]}
[0m17:20:08.631073 [info ] [Thread-1 (]: 8 of 12 OK created sql table model games.fct_game_pricing ...................... [[32mCREATE TABLE (3.1m rows, 292.5 MiB processed)[0m in 9.78s]
[0m17:20:08.631670 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m17:20:08.632493 [debug] [Thread-1 (]: Began running node model.games.revenue_by_platform_and_game
[0m17:20:08.632966 [info ] [Thread-1 (]: 9 of 12 START sql table model games.revenue_by_platform_and_game ............... [RUN]
[0m17:20:08.633768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.fct_game_pricing, now model.games.revenue_by_platform_and_game)
[0m17:20:08.634184 [debug] [Thread-1 (]: Began compiling node model.games.revenue_by_platform_and_game
[0m17:20:08.637264 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.revenue_by_platform_and_game"
[0m17:20:08.638899 [debug] [Thread-1 (]: Timing info for model.games.revenue_by_platform_and_game (compile): 17:20:08.634452 => 17:20:08.638666
[0m17:20:08.639323 [debug] [Thread-1 (]: Began executing node model.games.revenue_by_platform_and_game
[0m17:20:08.646617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:09.313706 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.revenue_by_platform_and_game"
[0m17:20:09.314417 [debug] [Thread-1 (]: On model.games.revenue_by_platform_and_game: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.revenue_by_platform_and_game"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`revenue_by_platform_and_game`
      
    
    

    OPTIONS()
    as (
      -- Informe de Ingresos por Plataforma
SELECT
    s.app_id,
    p.platform_id,
    s.total_sales,
    SUM(CASE WHEN p.windows = 1 THEN s.price_with_tax ELSE 0 END) AS total_sales_windows,
    SUM(CASE WHEN p.mac = 1 THEN s.price_with_tax ELSE 0 END) AS total_sales_mac,
    SUM(CASE WHEN p.linux = 1 THEN s.price_with_tax ELSE 0 END) AS total_sales_linux
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing` s
JOIN
    `pristine-flames-400818`.`games`.`dim_platforms` p ON s.platform_id = p.platform_id
GROUP BY
    s.app_id, p.platform_id, s.total_sales
ORDER BY
    total_sales DESC
    );
  
[0m17:20:09.900765 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:15e70bad-b2fb-49a5-8d64-27211628d422&page=queryresults
[0m17:20:20.085916 [debug] [Thread-1 (]: Timing info for model.games.revenue_by_platform_and_game (execute): 17:20:08.639623 => 17:20:20.085044
[0m17:20:20.089072 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d0be7f3-e859-4457-a41b-cbc5d8653a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c39f4250>]}
[0m17:20:20.091801 [info ] [Thread-1 (]: 9 of 12 OK created sql table model games.revenue_by_platform_and_game .......... [[32mCREATE TABLE (3.1m rows, 142.2 MiB processed)[0m in 11.46s]
[0m17:20:20.094613 [debug] [Thread-1 (]: Finished running node model.games.revenue_by_platform_and_game
[0m17:20:20.096673 [debug] [Thread-1 (]: Began running node model.games.top_10_discounted_games
[0m17:20:20.099101 [info ] [Thread-1 (]: 10 of 12 START sql table model games.top_10_discounted_games ................... [RUN]
[0m17:20:20.102207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.revenue_by_platform_and_game, now model.games.top_10_discounted_games)
[0m17:20:20.104066 [debug] [Thread-1 (]: Began compiling node model.games.top_10_discounted_games
[0m17:20:20.114234 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_discounted_games"
[0m17:20:20.115946 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (compile): 17:20:20.105348 => 17:20:20.115465
[0m17:20:20.116881 [debug] [Thread-1 (]: Began executing node model.games.top_10_discounted_games
[0m17:20:20.121821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:20.808866 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_discounted_games"
[0m17:20:20.809524 [debug] [Thread-1 (]: On model.games.top_10_discounted_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_discounted_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_discounted_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 descuentos más grandes
SELECT
    app_id,
    game_name,
    total_discounts
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY total_discounts DESC
LIMIT 10
    );
  
[0m17:20:21.355865 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:570e4407-7d04-45ca-b6d4-613c79e3c49f&page=queryresults
[0m17:20:23.719848 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (execute): 17:20:20.117544 => 17:20:23.719656
[0m17:20:23.720729 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d0be7f3-e859-4457-a41b-cbc5d8653a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c3a131f0>]}
[0m17:20:23.721304 [info ] [Thread-1 (]: 10 of 12 OK created sql table model games.top_10_discounted_games .............. [[32mCREATE TABLE (10.0 rows, 162.8 MiB processed)[0m in 3.62s]
[0m17:20:23.721871 [debug] [Thread-1 (]: Finished running node model.games.top_10_discounted_games
[0m17:20:23.722314 [debug] [Thread-1 (]: Began running node model.games.top_10_high_tax_games
[0m17:20:23.722861 [info ] [Thread-1 (]: 11 of 12 START sql table model games.top_10_high_tax_games ..................... [RUN]
[0m17:20:23.723466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_discounted_games, now model.games.top_10_high_tax_games)
[0m17:20:23.723833 [debug] [Thread-1 (]: Began compiling node model.games.top_10_high_tax_games
[0m17:20:23.726512 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_high_tax_games"
[0m17:20:23.727124 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (compile): 17:20:23.724094 => 17:20:23.726935
[0m17:20:23.727485 [debug] [Thread-1 (]: Began executing node model.games.top_10_high_tax_games
[0m17:20:23.729640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:24.437819 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_high_tax_games"
[0m17:20:24.439780 [debug] [Thread-1 (]: On model.games.top_10_high_tax_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_high_tax_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_high_tax_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos con más impuestos
SELECT
    app_id,
    game_name,
    SUM(total_sales_with_tax) AS total_taxes
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
GROUP BY app_id, game_name
ORDER BY total_taxes DESC, game_name DESC
LIMIT 10
    );
  
[0m17:20:24.892413 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9d9212cc-a179-432d-963b-0c24880b8c19&page=queryresults
[0m17:20:27.624590 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (execute): 17:20:23.727741 => 17:20:27.623723
[0m17:20:27.627909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d0be7f3-e859-4457-a41b-cbc5d8653a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c39f4af0>]}
[0m17:20:27.630511 [info ] [Thread-1 (]: 11 of 12 OK created sql table model games.top_10_high_tax_games ................ [[32mCREATE TABLE (10.0 rows, 162.8 MiB processed)[0m in 3.90s]
[0m17:20:27.633287 [debug] [Thread-1 (]: Finished running node model.games.top_10_high_tax_games
[0m17:20:27.635340 [debug] [Thread-1 (]: Began running node model.games.top_10_most_expensive_games
[0m17:20:27.637778 [info ] [Thread-1 (]: 12 of 12 START sql table model games.top_10_most_expensive_games ............... [RUN]
[0m17:20:27.640907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_high_tax_games, now model.games.top_10_most_expensive_games)
[0m17:20:27.642791 [debug] [Thread-1 (]: Began compiling node model.games.top_10_most_expensive_games
[0m17:20:27.665452 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_most_expensive_games"
[0m17:20:27.666662 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (compile): 17:20:27.644099 => 17:20:27.666283
[0m17:20:27.667317 [debug] [Thread-1 (]: Began executing node model.games.top_10_most_expensive_games
[0m17:20:27.670909 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:28.383511 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_most_expensive_games"
[0m17:20:28.386259 [debug] [Thread-1 (]: On model.games.top_10_most_expensive_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_most_expensive_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_most_expensive_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos más caros
SELECT
    app_id,
    game_name,
    max_price,
    formatted_initial_price,
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY max_price DESC
LIMIT 10
    );
  
[0m17:20:28.976607 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:13bf79d5-7795-4a70-a75a-eb653da9da51&page=queryresults
[0m17:20:31.388902 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (execute): 17:20:27.667765 => 17:20:31.388037
[0m17:20:31.392086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d0be7f3-e859-4457-a41b-cbc5d8653a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c3a23a90>]}
[0m17:20:31.394682 [info ] [Thread-1 (]: 12 of 12 OK created sql table model games.top_10_most_expensive_games .......... [[32mCREATE TABLE (10.0 rows, 177.7 MiB processed)[0m in 3.75s]
[0m17:20:31.397457 [debug] [Thread-1 (]: Finished running node model.games.top_10_most_expensive_games
[0m17:20:31.403344 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:20:31.404915 [debug] [MainThread]: Connection 'model.games.top_10_most_expensive_games' was properly closed.
[0m17:20:31.405393 [info ] [MainThread]: 
[0m17:20:31.405804 [info ] [MainThread]: Finished running 12 table models in 0 hours 1 minutes and 4.36 seconds (64.36s).
[0m17:20:31.408054 [debug] [MainThread]: Command end result
[0m17:20:31.417022 [info ] [MainThread]: 
[0m17:20:31.417443 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:20:31.417768 [info ] [MainThread]: 
[0m17:20:31.418099 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m17:20:31.418663 [debug] [MainThread]: Command `dbt run` succeeded at 17:20:31.418570 after 65.72 seconds
[0m17:20:31.419007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c85351b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c4488880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56c4634700>]}
[0m17:20:31.419367 [debug] [MainThread]: Flushing usage events
[0m17:22:13.275930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d902ab00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d71c0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d71c00d0>]}


============================== 17:22:13.278044 | 96a24f46-90ad-4ca4-aca8-fc51a486cb21 ==============================
[0m17:22:13.278044 [info ] [MainThread]: Running with dbt=1.6.5
[0m17:22:13.278577 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'send_anonymous_usage_stats': 'True'}
[0m17:22:13.558601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96a24f46-90ad-4ca4-aca8-fc51a486cb21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d8645cf0>]}
[0m17:22:13.574453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96a24f46-90ad-4ca4-aca8-fc51a486cb21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d515c9d0>]}
[0m17:22:13.575128 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m17:22:13.588517 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m17:22:13.653702 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:22:13.654082 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:22:13.659738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96a24f46-90ad-4ca4-aca8-fc51a486cb21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d4fc80d0>]}
[0m17:22:13.669547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96a24f46-90ad-4ca4-aca8-fc51a486cb21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d4f91d20>]}
[0m17:22:13.670011 [info ] [MainThread]: Found 12 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m17:22:13.670356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96a24f46-90ad-4ca4-aca8-fc51a486cb21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d4f93a00>]}
[0m17:22:13.671850 [info ] [MainThread]: 
[0m17:22:13.672504 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:22:13.674081 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m17:22:13.674491 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:22:14.441455 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m17:22:14.443310 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:22:15.120019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96a24f46-90ad-4ca4-aca8-fc51a486cb21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d7197eb0>]}
[0m17:22:15.120888 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:22:15.121365 [info ] [MainThread]: 
[0m17:22:15.123388 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m17:22:15.123938 [info ] [Thread-1 (]: 1 of 12 START sql table model games.dim_developers ............................. [RUN]
[0m17:22:15.124591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m17:22:15.124994 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m17:22:15.132525 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m17:22:15.133625 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 17:22:15.125264 => 17:22:15.133346
[0m17:22:15.134177 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m17:22:15.148205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:15.861463 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m17:22:15.862268 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS developer_id,
    developers_name
FROM
    developers_cte
    );
  
[0m17:22:16.342631 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:79b04de8-0c1a-4220-afad-3931e13f943e&page=queryresults
[0m17:22:19.107511 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 17:22:15.134506 => 17:22:19.107212
[0m17:22:19.108607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96a24f46-90ad-4ca4-aca8-fc51a486cb21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d4f6e5c0>]}
[0m17:22:19.109368 [info ] [Thread-1 (]: 1 of 12 OK created sql table model games.dim_developers ........................ [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 3.98s]
[0m17:22:19.110173 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m17:22:19.110769 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m17:22:19.111481 [info ] [Thread-1 (]: 2 of 12 START sql table model games.dim_games .................................. [RUN]
[0m17:22:19.112346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m17:22:19.112896 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m17:22:19.116257 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m17:22:19.117001 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 17:22:19.113270 => 17:22:19.116771
[0m17:22:19.117452 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m17:22:19.125541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:19.879985 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m17:22:19.882744 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m17:22:20.424435 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:120f6845-ad7c-4e2d-91e1-b25c282107e2&page=queryresults
[0m17:22:22.865607 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 17:22:19.117775 => 17:22:22.864737
[0m17:22:22.868811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96a24f46-90ad-4ca4-aca8-fc51a486cb21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d4e89150>]}
[0m17:22:22.871390 [info ] [Thread-1 (]: 2 of 12 OK created sql table model games.dim_games ............................. [[32mCREATE TABLE (2.7k rows, 753.9 KiB processed)[0m in 3.76s]
[0m17:22:22.874298 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m17:22:22.876362 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m17:22:22.878787 [info ] [Thread-1 (]: 3 of 12 START sql table model games.dim_platforms .............................. [RUN]
[0m17:22:22.881683 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m17:22:22.883531 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m17:22:22.893667 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m17:22:22.895190 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 17:22:22.884820 => 17:22:22.894711
[0m17:22:22.896119 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m17:22:22.900629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:23.614281 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m17:22:23.617047 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m17:22:24.172379 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ac5c68ce-9fd8-4600-8b82-4119dd6bf86c&page=queryresults
[0m17:22:26.570575 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 17:22:22.896779 => 17:22:26.569611
[0m17:22:26.574197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96a24f46-90ad-4ca4-aca8-fc51a486cb21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d4fb9a50>]}
[0m17:22:26.576941 [info ] [Thread-1 (]: 3 of 12 OK created sql table model games.dim_platforms ......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 3.69s]
[0m17:22:26.580191 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m17:22:26.582276 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m17:22:26.584723 [info ] [Thread-1 (]: 4 of 12 START sql table model games.dim_price_overview ......................... [RUN]
[0m17:22:26.587767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m17:22:26.589241 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m17:22:26.597209 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m17:22:26.598696 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 17:22:26.590159 => 17:22:26.598270
[0m17:22:26.599441 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m17:22:26.603656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:27.324459 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m17:22:27.327460 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    platform_id,
    windows,
    mac,
    linux,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte, games.dim_platforms
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m17:22:27.822417 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:05cfd449-7d6d-4916-b0b3-ed3ceb9f0f3b&page=queryresults
[0m17:22:33.190141 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 17:22:26.599964 => 17:22:33.189757
[0m17:22:33.191696 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96a24f46-90ad-4ca4-aca8-fc51a486cb21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d4e5d900>]}
[0m17:22:33.192950 [info ] [Thread-1 (]: 4 of 12 OK created sql table model games.dim_price_overview .................... [[32mCREATE TABLE (3.1m rows, 199.1 KiB processed)[0m in 6.61s]
[0m17:22:33.194272 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m17:22:33.195203 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m17:22:33.196406 [info ] [Thread-1 (]: 5 of 12 START sql table model games.dim_publishers ............................. [RUN]
[0m17:22:33.197961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m17:22:33.198797 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m17:22:33.216148 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m17:22:33.218626 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 17:22:33.199364 => 17:22:33.218192
[0m17:22:33.219416 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m17:22:33.224168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:33.945216 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m17:22:33.946212 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m17:22:34.373496 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:2fdd7ec8-2cdb-4fad-aa9f-cefaa82eb874&page=queryresults
[0m17:22:36.762781 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 17:22:33.219979 => 17:22:36.762600
[0m17:22:36.763642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96a24f46-90ad-4ca4-aca8-fc51a486cb21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d4fc9180>]}
[0m17:22:36.764215 [info ] [Thread-1 (]: 5 of 12 OK created sql table model games.dim_publishers ........................ [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 3.57s]
[0m17:22:36.765042 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m17:22:36.765635 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m17:22:36.766223 [info ] [Thread-1 (]: 6 of 12 START sql table model games.dim_release ................................ [RUN]
[0m17:22:36.766932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m17:22:36.767334 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m17:22:36.770160 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m17:22:36.770796 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 17:22:36.767601 => 17:22:36.770591
[0m17:22:36.771169 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m17:22:36.773279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:37.486197 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m17:22:37.488923 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m17:22:37.925303 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:be054d02-51f5-4949-9d1f-9a4332a126f3&page=queryresults
[0m17:22:40.863205 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 17:22:36.771426 => 17:22:40.862308
[0m17:22:40.866294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96a24f46-90ad-4ca4-aca8-fc51a486cb21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d5141b70>]}
[0m17:22:40.868890 [info ] [Thread-1 (]: 6 of 12 OK created sql table model games.dim_release ........................... [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.10s]
[0m17:22:40.871713 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m17:22:40.873760 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m17:22:40.876212 [info ] [Thread-1 (]: 7 of 12 START sql table model games.dim_support_language ....................... [RUN]
[0m17:22:40.879179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m17:22:40.881023 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m17:22:40.892465 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m17:22:40.894447 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 17:22:40.882324 => 17:22:40.893802
[0m17:22:40.895500 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m17:22:40.900592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:41.609729 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m17:22:41.610373 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m17:22:42.156315 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:747f3a1a-77bc-4591-8b29-ea7ba163aa6d&page=queryresults
[0m17:22:44.571758 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 17:22:40.896162 => 17:22:44.571573
[0m17:22:44.572475 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96a24f46-90ad-4ca4-aca8-fc51a486cb21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d4501570>]}
[0m17:22:44.573023 [info ] [Thread-1 (]: 7 of 12 OK created sql table model games.dim_support_language .................. [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 3.69s]
[0m17:22:44.573592 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m17:22:44.574036 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m17:22:44.574566 [info ] [Thread-1 (]: 8 of 12 START sql table model games.fct_game_pricing ........................... [RUN]
[0m17:22:44.575160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m17:22:44.575521 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m17:22:44.578692 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m17:22:44.579335 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 17:22:44.575782 => 17:22:44.579142
[0m17:22:44.579705 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m17:22:44.581889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:45.252014 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m17:22:45.252819 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para el análisis de precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        formatted_initial_price,
        platform_id,
        formatted_price_with_tax,
        price_with_tax,
        SUM(price_with_tax) AS total_sales,
        SUM(discount_amount) AS total_discounts,
        COUNT(*) AS num_sales,
        MAX(discount_pct) AS max_discount,
        MIN(initial_price) AS min_price,
        MAX(initial_price) AS max_price,
        SUM(price_with_tax) AS total_sales_with_tax,
        SUM(final_price) AS total_sales_with_tax_discounted
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id, platform_id, formatted_initial_price, formatted_price_with_tax, price_with_tax
)

SELECT
    fct.app_id,
    fct.formatted_initial_price,
    fct.total_sales,
    fct.platform_id,
    fct.formatted_price_with_tax,
    fct.total_discounts,
    fct.price_with_tax,
    fct.num_sales,
    fct.max_discount,
    fct.min_price,
    fct.max_price,
    fct.total_sales_with_tax,
    fct.total_sales_with_tax_discounted,
    games.name AS game_name,
    games.description AS game_description,
    games.is_free AS game_is_free,
    games.fullgame_app_id,
    games.fullgame_name,
    games.type,
    games.genre_id,
    games.type_genre,
FROM
    game_sales AS fct
INNER JOIN
    `pristine-flames-400818`.`games`.`dim_games` AS games
ON
    fct.app_id = games.app_id
INNER JOIN 
    `pristine-flames-400818`.`games`.`dim_platforms` AS dp
ON
    fct.platform_id = dp.platform_id
    );
  
[0m17:22:45.861585 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:cf299658-ca78-400f-8eec-80b80d138a82&page=queryresults
[0m17:22:54.900243 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 17:22:44.579963 => 17:22:54.900060
[0m17:22:54.901080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96a24f46-90ad-4ca4-aca8-fc51a486cb21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d4f6ca00>]}
[0m17:22:54.901653 [info ] [Thread-1 (]: 8 of 12 OK created sql table model games.fct_game_pricing ...................... [[32mCREATE TABLE (3.1m rows, 292.5 MiB processed)[0m in 10.33s]
[0m17:22:54.902285 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m17:22:54.903246 [debug] [Thread-1 (]: Began running node model.games.revenue_by_platform_and_game
[0m17:22:54.903729 [info ] [Thread-1 (]: 9 of 12 START sql table model games.revenue_by_platform_and_game ............... [RUN]
[0m17:22:54.904424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.fct_game_pricing, now model.games.revenue_by_platform_and_game)
[0m17:22:54.904816 [debug] [Thread-1 (]: Began compiling node model.games.revenue_by_platform_and_game
[0m17:22:54.907759 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.revenue_by_platform_and_game"
[0m17:22:54.908453 [debug] [Thread-1 (]: Timing info for model.games.revenue_by_platform_and_game (compile): 17:22:54.905072 => 17:22:54.908223
[0m17:22:54.908845 [debug] [Thread-1 (]: Began executing node model.games.revenue_by_platform_and_game
[0m17:22:54.911040 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:55.691435 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.revenue_by_platform_and_game"
[0m17:22:55.692181 [debug] [Thread-1 (]: On model.games.revenue_by_platform_and_game: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.revenue_by_platform_and_game"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`revenue_by_platform_and_game`
      
    
    

    OPTIONS()
    as (
      -- Informe de Ingresos por Plataforma
SELECT
    s.app_id,
    p.platform_id,
    s.total_sales,
    SUM(CASE WHEN p.windows = 1 THEN s.price_with_tax ELSE 0 END) AS total_sales_windows,
    SUM(CASE WHEN p.mac = 1 THEN s.price_with_tax ELSE 0 END) AS total_sales_mac,
    SUM(CASE WHEN p.linux = 1 THEN s.price_with_tax ELSE 0 END) AS total_sales_linux
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing` s
JOIN
    `pristine-flames-400818`.`games`.`dim_platforms` p ON s.platform_id = p.platform_id
GROUP BY
    s.app_id, p.platform_id, s.total_sales
ORDER BY
    total_sales DESC
    );
  
[0m17:22:56.292563 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:fc907981-73ba-402c-a786-023f4eaf8382&page=queryresults
[0m17:23:06.094240 [debug] [Thread-1 (]: Timing info for model.games.revenue_by_platform_and_game (execute): 17:22:54.909100 => 17:23:06.093367
[0m17:23:06.097565 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96a24f46-90ad-4ca4-aca8-fc51a486cb21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d4eb4850>]}
[0m17:23:06.100208 [info ] [Thread-1 (]: 9 of 12 OK created sql table model games.revenue_by_platform_and_game .......... [[32mCREATE TABLE (3.1m rows, 142.2 MiB processed)[0m in 11.19s]
[0m17:23:06.103070 [debug] [Thread-1 (]: Finished running node model.games.revenue_by_platform_and_game
[0m17:23:06.105161 [debug] [Thread-1 (]: Began running node model.games.top_10_discounted_games
[0m17:23:06.107638 [info ] [Thread-1 (]: 10 of 12 START sql table model games.top_10_discounted_games ................... [RUN]
[0m17:23:06.110814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.revenue_by_platform_and_game, now model.games.top_10_discounted_games)
[0m17:23:06.112676 [debug] [Thread-1 (]: Began compiling node model.games.top_10_discounted_games
[0m17:23:06.118581 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_discounted_games"
[0m17:23:06.119275 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (compile): 17:23:06.113989 => 17:23:06.119047
[0m17:23:06.119669 [debug] [Thread-1 (]: Began executing node model.games.top_10_discounted_games
[0m17:23:06.126076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:23:06.675814 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_discounted_games"
[0m17:23:06.678537 [debug] [Thread-1 (]: On model.games.top_10_discounted_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_discounted_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_discounted_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 descuentos más grandes
SELECT
    app_id,
    game_name,
    total_discounts
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY total_discounts DESC
LIMIT 10
    );
  
[0m17:23:07.094852 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:1d0a052b-e237-44c9-9932-a1997009d6d1&page=queryresults
[0m17:23:09.202774 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (execute): 17:23:06.119924 => 17:23:09.201865
[0m17:23:09.205881 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96a24f46-90ad-4ca4-aca8-fc51a486cb21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d4ed3be0>]}
[0m17:23:09.208470 [info ] [Thread-1 (]: 10 of 12 OK created sql table model games.top_10_discounted_games .............. [[32mCREATE TABLE (10.0 rows, 162.8 MiB processed)[0m in 3.10s]
[0m17:23:09.211296 [debug] [Thread-1 (]: Finished running node model.games.top_10_discounted_games
[0m17:23:09.213346 [debug] [Thread-1 (]: Began running node model.games.top_10_high_tax_games
[0m17:23:09.215746 [info ] [Thread-1 (]: 11 of 12 START sql table model games.top_10_high_tax_games ..................... [RUN]
[0m17:23:09.218675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_discounted_games, now model.games.top_10_high_tax_games)
[0m17:23:09.220513 [debug] [Thread-1 (]: Began compiling node model.games.top_10_high_tax_games
[0m17:23:09.230286 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_high_tax_games"
[0m17:23:09.231839 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (compile): 17:23:09.221813 => 17:23:09.231355
[0m17:23:09.232774 [debug] [Thread-1 (]: Began executing node model.games.top_10_high_tax_games
[0m17:23:09.237511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:23:09.945794 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_high_tax_games"
[0m17:23:09.948631 [debug] [Thread-1 (]: On model.games.top_10_high_tax_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_high_tax_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_high_tax_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos con más impuestos
SELECT
    app_id,
    game_name,
    SUM(total_sales_with_tax) AS total_taxes
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
GROUP BY app_id, game_name
ORDER BY total_taxes DESC, game_name DESC
LIMIT 10
    );
  
[0m17:23:10.618040 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f3dcc9fc-360f-480e-9f7a-381557dd72bb&page=queryresults
[0m17:23:13.078050 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (execute): 17:23:09.233435 => 17:23:13.077185
[0m17:23:13.081322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96a24f46-90ad-4ca4-aca8-fc51a486cb21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d4517460>]}
[0m17:23:13.083912 [info ] [Thread-1 (]: 11 of 12 OK created sql table model games.top_10_high_tax_games ................ [[32mCREATE TABLE (10.0 rows, 162.8 MiB processed)[0m in 3.86s]
[0m17:23:13.086736 [debug] [Thread-1 (]: Finished running node model.games.top_10_high_tax_games
[0m17:23:13.088825 [debug] [Thread-1 (]: Began running node model.games.top_10_most_expensive_games
[0m17:23:13.091265 [info ] [Thread-1 (]: 12 of 12 START sql table model games.top_10_most_expensive_games ............... [RUN]
[0m17:23:13.094388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_high_tax_games, now model.games.top_10_most_expensive_games)
[0m17:23:13.096254 [debug] [Thread-1 (]: Began compiling node model.games.top_10_most_expensive_games
[0m17:23:13.105782 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_most_expensive_games"
[0m17:23:13.107430 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (compile): 17:23:13.097559 => 17:23:13.106940
[0m17:23:13.108400 [debug] [Thread-1 (]: Began executing node model.games.top_10_most_expensive_games
[0m17:23:13.112950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:23:13.821217 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_most_expensive_games"
[0m17:23:13.823187 [debug] [Thread-1 (]: On model.games.top_10_most_expensive_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_most_expensive_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_most_expensive_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos más caros
SELECT
    app_id,
    game_name,
    max_price,
    formatted_initial_price,
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY max_price DESC
LIMIT 10
    );
  
[0m17:23:14.494464 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a4d25703-eebe-4926-99cd-6cee32342035&page=queryresults
[0m17:23:16.877497 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (execute): 17:23:13.109061 => 17:23:16.877007
[0m17:23:16.879377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96a24f46-90ad-4ca4-aca8-fc51a486cb21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d45179a0>]}
[0m17:23:16.880846 [info ] [Thread-1 (]: 12 of 12 OK created sql table model games.top_10_most_expensive_games .......... [[32mCREATE TABLE (10.0 rows, 177.7 MiB processed)[0m in 3.79s]
[0m17:23:16.882643 [debug] [Thread-1 (]: Finished running node model.games.top_10_most_expensive_games
[0m17:23:16.885989 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:23:16.886977 [debug] [MainThread]: Connection 'model.games.top_10_most_expensive_games' was properly closed.
[0m17:23:16.887964 [info ] [MainThread]: 
[0m17:23:16.888941 [info ] [MainThread]: Finished running 12 table models in 0 hours 1 minutes and 3.22 seconds (63.22s).
[0m17:23:16.894925 [debug] [MainThread]: Command end result
[0m17:23:16.921620 [info ] [MainThread]: 
[0m17:23:16.922166 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:23:16.922627 [info ] [MainThread]: 
[0m17:23:16.923092 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m17:23:16.923814 [debug] [MainThread]: Command `dbt run` succeeded at 17:23:16.923684 after 63.65 seconds
[0m17:23:16.924267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d902ab00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d453fb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d453f910>]}
[0m17:23:16.924733 [debug] [MainThread]: Flushing usage events
[0m17:24:27.456102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff491e19180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff48feb8070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff48feb80d0>]}


============================== 17:24:27.458223 | 35fec492-5d4a-47bf-b968-7a85b4916f1c ==============================
[0m17:24:27.458223 [info ] [MainThread]: Running with dbt=1.6.5
[0m17:24:27.458718 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:24:27.740963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35fec492-5d4a-47bf-b968-7a85b4916f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4913a2620>]}
[0m17:24:27.757298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35fec492-5d4a-47bf-b968-7a85b4916f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff48de589d0>]}
[0m17:24:27.757949 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m17:24:27.771787 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m17:24:27.843055 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:24:27.843446 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:24:27.849346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35fec492-5d4a-47bf-b968-7a85b4916f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff48dcc40d0>]}
[0m17:24:27.859681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35fec492-5d4a-47bf-b968-7a85b4916f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff48dc8dcf0>]}
[0m17:24:27.860161 [info ] [MainThread]: Found 12 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m17:24:27.860513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35fec492-5d4a-47bf-b968-7a85b4916f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff48dc8f9d0>]}
[0m17:24:27.862001 [info ] [MainThread]: 
[0m17:24:27.862708 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:24:27.864510 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m17:24:27.864970 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:28.637227 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m17:24:28.637823 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:24:29.262938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35fec492-5d4a-47bf-b968-7a85b4916f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff48dc8d210>]}
[0m17:24:29.263695 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:24:29.264051 [info ] [MainThread]: 
[0m17:24:29.265897 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m17:24:29.266423 [info ] [Thread-1 (]: 1 of 12 START sql table model games.dim_developers ............................. [RUN]
[0m17:24:29.267119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m17:24:29.267498 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m17:24:29.274730 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m17:24:29.275688 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 17:24:29.267759 => 17:24:29.275471
[0m17:24:29.276104 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m17:24:29.315617 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m17:24:29.316341 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:29.349012 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS developer_id,
    developers_name
FROM
    developers_cte
    );
  
[0m17:24:30.173353 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b9ebd6fa-6052-4572-a4cb-66efdef697ec&page=queryresults
[0m17:24:32.869005 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 17:24:29.276436 => 17:24:32.868800
[0m17:24:32.869763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35fec492-5d4a-47bf-b968-7a85b4916f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff48db53d60>]}
[0m17:24:32.870369 [info ] [Thread-1 (]: 1 of 12 OK created sql table model games.dim_developers ........................ [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 3.60s]
[0m17:24:32.871223 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m17:24:32.871898 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m17:24:32.872524 [info ] [Thread-1 (]: 2 of 12 START sql table model games.dim_games .................................. [RUN]
[0m17:24:32.873218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m17:24:32.873631 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m17:24:32.876667 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m17:24:32.877448 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 17:24:32.873929 => 17:24:32.877207
[0m17:24:32.877881 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m17:24:32.887698 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m17:24:32.888314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:32.920848 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m17:24:33.917299 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:86678d66-aa1b-47d9-b7b4-fa15385369a8&page=queryresults
[0m17:24:36.301298 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 17:24:32.878170 => 17:24:36.301043
[0m17:24:36.302241 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35fec492-5d4a-47bf-b968-7a85b4916f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff48db67280>]}
[0m17:24:36.303011 [info ] [Thread-1 (]: 2 of 12 OK created sql table model games.dim_games ............................. [[32mCREATE TABLE (2.7k rows, 753.9 KiB processed)[0m in 3.43s]
[0m17:24:36.303841 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m17:24:36.304434 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m17:24:36.305080 [info ] [Thread-1 (]: 3 of 12 START sql table model games.dim_platforms .............................. [RUN]
[0m17:24:36.305900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m17:24:36.306407 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m17:24:36.310607 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m17:24:36.311502 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 17:24:36.306798 => 17:24:36.311235
[0m17:24:36.312026 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m17:24:36.316208 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m17:24:36.317011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:36.353232 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m17:24:37.174680 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d4268706-a9e8-451b-a80f-3623fe30929e&page=queryresults
[0m17:24:39.862541 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 17:24:36.312386 => 17:24:39.862136
[0m17:24:39.864849 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35fec492-5d4a-47bf-b968-7a85b4916f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff48db65f30>]}
[0m17:24:39.866081 [info ] [Thread-1 (]: 3 of 12 OK created sql table model games.dim_platforms ......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 3.56s]
[0m17:24:39.867350 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m17:24:39.868249 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m17:24:39.869321 [info ] [Thread-1 (]: 4 of 12 START sql table model games.dim_price_overview ......................... [RUN]
[0m17:24:39.870627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m17:24:39.871418 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m17:24:39.877947 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m17:24:39.879451 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 17:24:39.871981 => 17:24:39.879016
[0m17:24:39.880295 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m17:24:39.887196 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m17:24:39.888427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:39.925263 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    platform_id,
    windows,
    mac,
    linux,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte, games.dim_platforms
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m17:24:40.839764 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a43268dc-38aa-489b-8f3c-bd75e68da0d0&page=queryresults
[0m17:24:45.635427 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 17:24:39.880980 => 17:24:45.634475
[0m17:24:45.638882 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35fec492-5d4a-47bf-b968-7a85b4916f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff48db64b80>]}
[0m17:24:45.641468 [info ] [Thread-1 (]: 4 of 12 OK created sql table model games.dim_price_overview .................... [[32mCREATE TABLE (3.1m rows, 199.1 KiB processed)[0m in 5.77s]
[0m17:24:45.644298 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m17:24:45.646371 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m17:24:45.649056 [info ] [Thread-1 (]: 5 of 12 START sql table model games.dim_publishers ............................. [RUN]
[0m17:24:45.652182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m17:24:45.653993 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m17:24:45.675546 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m17:24:45.676661 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 17:24:45.655328 => 17:24:45.676316
[0m17:24:45.677292 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m17:24:45.681856 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m17:24:45.682681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:45.716686 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m17:24:46.618580 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a49c4c59-da46-4d74-8394-4d2016f36bda&page=queryresults
[0m17:24:48.973756 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 17:24:45.677738 => 17:24:48.972883
[0m17:24:48.976895 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35fec492-5d4a-47bf-b968-7a85b4916f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff48dbd71f0>]}
[0m17:24:48.979482 [info ] [Thread-1 (]: 5 of 12 OK created sql table model games.dim_publishers ........................ [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 3.33s]
[0m17:24:48.982305 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m17:24:48.984383 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m17:24:48.986756 [info ] [Thread-1 (]: 6 of 12 START sql table model games.dim_release ................................ [RUN]
[0m17:24:48.989704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m17:24:48.991603 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m17:24:49.006531 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m17:24:49.008089 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 17:24:48.992910 => 17:24:49.007607
[0m17:24:49.009052 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m17:24:49.015024 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m17:24:49.016013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:49.052536 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m17:24:50.012297 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9714081c-9026-4838-985e-2b73788ed440&page=queryresults
[0m17:24:52.382125 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 17:24:49.009743 => 17:24:52.381863
[0m17:24:52.383138 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35fec492-5d4a-47bf-b968-7a85b4916f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff48de58e50>]}
[0m17:24:52.383927 [info ] [Thread-1 (]: 6 of 12 OK created sql table model games.dim_release ........................... [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 3.39s]
[0m17:24:52.384788 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m17:24:52.385465 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m17:24:52.386258 [info ] [Thread-1 (]: 7 of 12 START sql table model games.dim_support_language ....................... [RUN]
[0m17:24:52.387247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m17:24:52.387848 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m17:24:52.392304 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m17:24:52.393374 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 17:24:52.388275 => 17:24:52.393029
[0m17:24:52.394046 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m17:24:52.399340 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m17:24:52.400345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:52.442762 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m17:24:53.441352 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:87ac728d-c64f-4a89-9eac-1ee522f2330e&page=queryresults
[0m17:24:55.850775 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 17:24:52.394536 => 17:24:55.849879
[0m17:24:55.853945 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35fec492-5d4a-47bf-b968-7a85b4916f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff48dbfbd30>]}
[0m17:24:55.856573 [info ] [Thread-1 (]: 7 of 12 OK created sql table model games.dim_support_language .................. [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 3.47s]
[0m17:24:55.859398 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m17:24:55.861441 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m17:24:55.863848 [info ] [Thread-1 (]: 8 of 12 START sql table model games.fct_game_pricing ........................... [RUN]
[0m17:24:55.866844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m17:24:55.868687 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m17:24:55.888527 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m17:24:55.889799 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 17:24:55.869988 => 17:24:55.889425
[0m17:24:55.890487 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m17:24:55.895356 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m17:24:55.896151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:55.930596 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para el análisis de precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        formatted_initial_price,
        platform_id,
        formatted_price_with_tax,
        price_with_tax,
        SUM(price_with_tax) AS total_sales,
        SUM(discount_amount) AS total_discounts,
        COUNT(*) AS num_sales,
        MAX(discount_pct) AS max_discount,
        MIN(initial_price) AS min_price,
        MAX(initial_price) AS max_price,
        SUM(price_with_tax) AS total_sales_with_tax,
        SUM(final_price) AS total_sales_with_tax_discounted
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id, platform_id, formatted_initial_price, formatted_price_with_tax, price_with_tax
)

SELECT
    fct.app_id,
    fct.formatted_initial_price,
    fct.total_sales,
    fct.platform_id,
    fct.formatted_price_with_tax,
    fct.total_discounts,
    fct.price_with_tax,
    fct.num_sales,
    fct.max_discount,
    fct.min_price,
    fct.max_price,
    fct.total_sales_with_tax,
    fct.total_sales_with_tax_discounted,
    games.name AS game_name,
    games.description AS game_description,
    games.is_free AS game_is_free,
    games.fullgame_app_id,
    games.fullgame_name,
    games.type,
    games.genre_id,
    games.type_genre,
FROM
    game_sales AS fct
INNER JOIN
    `pristine-flames-400818`.`games`.`dim_games` AS games
ON
    fct.app_id = games.app_id
INNER JOIN 
    `pristine-flames-400818`.`games`.`dim_platforms` AS dp
ON
    fct.platform_id = dp.platform_id
    );
  
[0m17:24:56.707541 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c21ef56b-9481-44cb-bed0-83ebe7b3b68f&page=queryresults
[0m17:25:04.462872 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 17:24:55.890941 => 17:25:04.461975
[0m17:25:04.465968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35fec492-5d4a-47bf-b968-7a85b4916f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff48db45930>]}
[0m17:25:04.468540 [info ] [Thread-1 (]: 8 of 12 OK created sql table model games.fct_game_pricing ...................... [[32mCREATE TABLE (3.1m rows, 292.5 MiB processed)[0m in 8.60s]
[0m17:25:04.471344 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m17:25:04.474695 [debug] [Thread-1 (]: Began running node model.games.revenue_by_platform_and_game
[0m17:25:04.477180 [info ] [Thread-1 (]: 9 of 12 START sql table model games.revenue_by_platform_and_game ............... [RUN]
[0m17:25:04.479533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.fct_game_pricing, now model.games.revenue_by_platform_and_game)
[0m17:25:04.479897 [debug] [Thread-1 (]: Began compiling node model.games.revenue_by_platform_and_game
[0m17:25:04.484780 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.revenue_by_platform_and_game"
[0m17:25:04.485495 [debug] [Thread-1 (]: Timing info for model.games.revenue_by_platform_and_game (compile): 17:25:04.480152 => 17:25:04.485263
[0m17:25:04.485887 [debug] [Thread-1 (]: Began executing node model.games.revenue_by_platform_and_game
[0m17:25:04.488774 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.revenue_by_platform_and_game"
[0m17:25:04.489329 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:04.521390 [debug] [Thread-1 (]: On model.games.revenue_by_platform_and_game: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.revenue_by_platform_and_game"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`revenue_by_platform_and_game`
      
    
    

    OPTIONS()
    as (
      -- Informe de Ingresos por Plataforma
SELECT
    s.app_id,
    p.platform_id,
    s.total_sales,
    SUM(CASE WHEN p.windows = 1 THEN s.price_with_tax ELSE 0 END) AS total_sales_windows,
    SUM(CASE WHEN p.mac = 1 THEN s.price_with_tax ELSE 0 END) AS total_sales_mac,
    SUM(CASE WHEN p.linux = 1 THEN s.price_with_tax ELSE 0 END) AS total_sales_linux
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing` s
JOIN
    `pristine-flames-400818`.`games`.`dim_platforms` p ON s.platform_id = p.platform_id
GROUP BY
    s.app_id, p.platform_id, s.total_sales
ORDER BY
    total_sales DESC
    );
  
[0m17:25:05.466267 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7f4e3ade-1e32-4824-a4dd-27717cc3951e&page=queryresults
[0m17:25:15.701095 [debug] [Thread-1 (]: Timing info for model.games.revenue_by_platform_and_game (execute): 17:25:04.486141 => 17:25:15.700232
[0m17:25:15.704214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35fec492-5d4a-47bf-b968-7a85b4916f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff48c200310>]}
[0m17:25:15.706815 [info ] [Thread-1 (]: 9 of 12 OK created sql table model games.revenue_by_platform_and_game .......... [[32mCREATE TABLE (3.1m rows, 142.2 MiB processed)[0m in 11.23s]
[0m17:25:15.709619 [debug] [Thread-1 (]: Finished running node model.games.revenue_by_platform_and_game
[0m17:25:15.711745 [debug] [Thread-1 (]: Began running node model.games.top_10_discounted_games
[0m17:25:15.713829 [info ] [Thread-1 (]: 10 of 12 START sql table model games.top_10_discounted_games ................... [RUN]
[0m17:25:15.717023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.revenue_by_platform_and_game, now model.games.top_10_discounted_games)
[0m17:25:15.718909 [debug] [Thread-1 (]: Began compiling node model.games.top_10_discounted_games
[0m17:25:15.728851 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_discounted_games"
[0m17:25:15.730452 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (compile): 17:25:15.720213 => 17:25:15.729951
[0m17:25:15.731386 [debug] [Thread-1 (]: Began executing node model.games.top_10_discounted_games
[0m17:25:15.737726 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_discounted_games"
[0m17:25:15.738933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:15.775849 [debug] [Thread-1 (]: On model.games.top_10_discounted_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_discounted_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_discounted_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 descuentos más grandes
SELECT
    app_id,
    game_name,
    total_discounts
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY total_discounts DESC
LIMIT 10
    );
  
[0m17:25:16.575378 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:06fa495f-4070-4bea-8369-286ea0a987f6&page=queryresults
[0m17:25:18.712764 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (execute): 17:25:15.732035 => 17:25:18.711879
[0m17:25:18.716131 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35fec492-5d4a-47bf-b968-7a85b4916f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff48dbfbd30>]}
[0m17:25:18.719052 [info ] [Thread-1 (]: 10 of 12 OK created sql table model games.top_10_discounted_games .............. [[32mCREATE TABLE (10.0 rows, 162.8 MiB processed)[0m in 3.00s]
[0m17:25:18.722010 [debug] [Thread-1 (]: Finished running node model.games.top_10_discounted_games
[0m17:25:18.724076 [debug] [Thread-1 (]: Began running node model.games.top_10_high_tax_games
[0m17:25:18.725714 [info ] [Thread-1 (]: 11 of 12 START sql table model games.top_10_high_tax_games ..................... [RUN]
[0m17:25:18.727807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_discounted_games, now model.games.top_10_high_tax_games)
[0m17:25:18.729137 [debug] [Thread-1 (]: Began compiling node model.games.top_10_high_tax_games
[0m17:25:18.735752 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_high_tax_games"
[0m17:25:18.737115 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (compile): 17:25:18.729849 => 17:25:18.736721
[0m17:25:18.737864 [debug] [Thread-1 (]: Began executing node model.games.top_10_high_tax_games
[0m17:25:18.742822 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_high_tax_games"
[0m17:25:18.743698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:18.778963 [debug] [Thread-1 (]: On model.games.top_10_high_tax_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_high_tax_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_high_tax_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos con más impuestos
SELECT
    app_id,
    game_name,
    SUM(total_sales_with_tax) AS total_taxes
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
GROUP BY app_id, game_name
ORDER BY total_taxes DESC, game_name DESC
LIMIT 10
    );
  
[0m17:25:19.588437 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:13a27963-9d8e-4ed3-a217-a09b349f5eff&page=queryresults
[0m17:25:21.967860 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (execute): 17:25:18.738397 => 17:25:21.966976
[0m17:25:21.970980 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35fec492-5d4a-47bf-b968-7a85b4916f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff48c20f820>]}
[0m17:25:21.973552 [info ] [Thread-1 (]: 11 of 12 OK created sql table model games.top_10_high_tax_games ................ [[32mCREATE TABLE (10.0 rows, 162.8 MiB processed)[0m in 3.24s]
[0m17:25:21.976385 [debug] [Thread-1 (]: Finished running node model.games.top_10_high_tax_games
[0m17:25:21.978442 [debug] [Thread-1 (]: Began running node model.games.top_10_most_expensive_games
[0m17:25:21.980881 [info ] [Thread-1 (]: 12 of 12 START sql table model games.top_10_most_expensive_games ............... [RUN]
[0m17:25:21.983818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_high_tax_games, now model.games.top_10_most_expensive_games)
[0m17:25:21.985667 [debug] [Thread-1 (]: Began compiling node model.games.top_10_most_expensive_games
[0m17:25:21.996909 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_most_expensive_games"
[0m17:25:21.999001 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (compile): 17:25:21.987004 => 17:25:21.998369
[0m17:25:21.999936 [debug] [Thread-1 (]: Began executing node model.games.top_10_most_expensive_games
[0m17:25:22.006593 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_most_expensive_games"
[0m17:25:22.007733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:22.045114 [debug] [Thread-1 (]: On model.games.top_10_most_expensive_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_most_expensive_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_most_expensive_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos más caros
SELECT
    app_id,
    game_name,
    max_price,
    formatted_initial_price,
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY max_price DESC
LIMIT 10
    );
  
[0m17:25:22.905100 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:47fa4ab5-e6f7-4f4c-964c-0dd2ee2492fb&page=queryresults
[0m17:25:25.036025 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (execute): 17:25:22.000590 => 17:25:25.035148
[0m17:25:25.039372 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35fec492-5d4a-47bf-b968-7a85b4916f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff48c20fac0>]}
[0m17:25:25.041948 [info ] [Thread-1 (]: 12 of 12 OK created sql table model games.top_10_most_expensive_games .......... [[32mCREATE TABLE (10.0 rows, 177.7 MiB processed)[0m in 3.06s]
[0m17:25:25.044780 [debug] [Thread-1 (]: Finished running node model.games.top_10_most_expensive_games
[0m17:25:25.050677 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:25:25.052233 [debug] [MainThread]: Connection 'model.games.top_10_most_expensive_games' was properly closed.
[0m17:25:25.053927 [info ] [MainThread]: 
[0m17:25:25.055627 [info ] [MainThread]: Finished running 12 table models in 0 hours 0 minutes and 57.19 seconds (57.19s).
[0m17:25:25.065531 [debug] [MainThread]: Command end result
[0m17:25:25.089048 [info ] [MainThread]: 
[0m17:25:25.089574 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:25:25.089998 [info ] [MainThread]: 
[0m17:25:25.090438 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m17:25:25.091134 [debug] [MainThread]: Command `dbt run` succeeded at 17:25:25.091013 after 57.64 seconds
[0m17:25:25.091570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff491e19180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff48c21bb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff48c21a4a0>]}
[0m17:25:25.092029 [debug] [MainThread]: Flushing usage events
[0m18:59:00.166216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f252730d180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25253a4070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25253a40d0>]}


============================== 18:59:00.169312 | ac8e7bdf-dfb6-4cab-87ea-6bcf35f22c14 ==============================
[0m18:59:00.169312 [info ] [MainThread]: Running with dbt=1.6.5
[0m18:59:00.169813 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'version_check': 'True', 'profiles_dir': '../dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'send_anonymous_usage_stats': 'True'}
[0m18:59:00.900030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac8e7bdf-dfb6-4cab-87ea-6bcf35f22c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25268be620>]}
[0m18:59:00.915696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac8e7bdf-dfb6-4cab-87ea-6bcf35f22c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25233409d0>]}
[0m18:59:00.916444 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m18:59:00.929872 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m18:59:01.020600 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:59:01.020970 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:59:01.026673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac8e7bdf-dfb6-4cab-87ea-6bcf35f22c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25231ac0d0>]}
[0m18:59:01.037370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac8e7bdf-dfb6-4cab-87ea-6bcf35f22c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2523175cf0>]}
[0m18:59:01.037832 [info ] [MainThread]: Found 12 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m18:59:01.038171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac8e7bdf-dfb6-4cab-87ea-6bcf35f22c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25231779d0>]}
[0m18:59:01.039594 [info ] [MainThread]: 
[0m18:59:01.040243 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:59:01.041840 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m18:59:01.042255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:59:01.923884 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m18:59:01.925896 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:59:02.679411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac8e7bdf-dfb6-4cab-87ea-6bcf35f22c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f252557beb0>]}
[0m18:59:02.682621 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:59:02.684249 [info ] [MainThread]: 
[0m18:59:02.692261 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m18:59:02.694425 [info ] [Thread-1 (]: 1 of 12 START sql table model games.dim_developers ............................. [RUN]
[0m18:59:02.696815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m18:59:02.697255 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m18:59:02.704434 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m18:59:02.705091 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 18:59:02.697563 => 18:59:02.704870
[0m18:59:02.705564 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m18:59:02.718956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:59:03.502312 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m18:59:03.503091 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS developer_id,
    developers_name
FROM
    developers_cte
    );
  
[0m18:59:04.155230 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f37b4c33-5817-4e44-b332-ae7f6428eb1c&page=queryresults
[0m18:59:07.302895 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 18:59:02.705831 => 18:59:07.302693
[0m18:59:07.303843 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac8e7bdf-dfb6-4cab-87ea-6bcf35f22c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2523150490>]}
[0m18:59:07.304548 [info ] [Thread-1 (]: 1 of 12 OK created sql table model games.dim_developers ........................ [[32mCREATE TABLE (2.6k rows, 40.8 KiB processed)[0m in 4.61s]
[0m18:59:07.305217 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m18:59:07.305763 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m18:59:07.306371 [info ] [Thread-1 (]: 2 of 12 START sql table model games.dim_games .................................. [RUN]
[0m18:59:07.307097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m18:59:07.307521 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m18:59:07.310323 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m18:59:07.311006 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 18:59:07.307798 => 18:59:07.310792
[0m18:59:07.311410 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m18:59:07.320218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:59:07.990444 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m18:59:07.991115 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m18:59:08.536848 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:cba35665-f619-47ba-b324-3395a7dce7a1&page=queryresults
[0m18:59:10.931509 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 18:59:07.311683 => 18:59:10.931326
[0m18:59:10.932233 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac8e7bdf-dfb6-4cab-87ea-6bcf35f22c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2523197fd0>]}
[0m18:59:10.932788 [info ] [Thread-1 (]: 2 of 12 OK created sql table model games.dim_games ............................. [[32mCREATE TABLE (2.7k rows, 753.9 KiB processed)[0m in 3.63s]
[0m18:59:10.933436 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m18:59:10.933901 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m18:59:10.934367 [info ] [Thread-1 (]: 3 of 12 START sql table model games.dim_platforms .............................. [RUN]
[0m18:59:10.935048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m18:59:10.935575 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m18:59:10.938550 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m18:59:10.939272 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 18:59:10.935897 => 18:59:10.939023
[0m18:59:10.939660 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m18:59:10.941846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:59:11.626819 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m18:59:11.627525 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m18:59:12.190658 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c2aee06b-0f96-4b60-ab42-4c3ca873d2e7&page=queryresults
[0m18:59:14.882877 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 18:59:10.939911 => 18:59:14.882674
[0m18:59:14.883732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac8e7bdf-dfb6-4cab-87ea-6bcf35f22c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f252319cb50>]}
[0m18:59:14.884469 [info ] [Thread-1 (]: 3 of 12 OK created sql table model games.dim_platforms ......................... [[32mCREATE TABLE (2.7k rows, 63.7 KiB processed)[0m in 3.95s]
[0m18:59:14.885872 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m18:59:14.886433 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m18:59:14.886982 [info ] [Thread-1 (]: 4 of 12 START sql table model games.dim_price_overview ......................... [RUN]
[0m18:59:14.887629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m18:59:14.888013 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m18:59:14.890905 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m18:59:14.891542 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 18:59:14.888271 => 18:59:14.891315
[0m18:59:14.891928 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m18:59:14.894152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:59:15.589627 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m18:59:15.590501 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    platform_id,
    windows,
    mac,
    linux,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte, games.dim_platforms
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m18:59:16.213178 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:df3c1712-4505-4fab-9186-0904166618bb&page=queryresults
[0m18:59:21.605655 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 18:59:14.892181 => 18:59:21.605470
[0m18:59:21.606415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac8e7bdf-dfb6-4cab-87ea-6bcf35f22c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2523041ab0>]}
[0m18:59:21.607054 [info ] [Thread-1 (]: 4 of 12 OK created sql table model games.dim_price_overview .................... [[32mCREATE TABLE (3.1m rows, 199.1 KiB processed)[0m in 6.72s]
[0m18:59:21.607693 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m18:59:21.608163 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m18:59:21.608699 [info ] [Thread-1 (]: 5 of 12 START sql table model games.dim_publishers ............................. [RUN]
[0m18:59:21.609366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m18:59:21.609885 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m18:59:21.621154 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m18:59:21.621873 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 18:59:21.610636 => 18:59:21.621679
[0m18:59:21.622238 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m18:59:21.624725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:59:22.339288 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m18:59:22.339961 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m18:59:23.003300 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:128cd35a-f750-41e1-9dd4-b23a5937b4da&page=queryresults
[0m18:59:25.753130 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 18:59:21.622492 => 18:59:25.752893
[0m18:59:25.754022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac8e7bdf-dfb6-4cab-87ea-6bcf35f22c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25231ae020>]}
[0m18:59:25.754727 [info ] [Thread-1 (]: 5 of 12 OK created sql table model games.dim_publishers ........................ [[32mCREATE TABLE (1.9k rows, 37.3 KiB processed)[0m in 4.14s]
[0m18:59:25.755431 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m18:59:25.756063 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m18:59:25.756684 [info ] [Thread-1 (]: 6 of 12 START sql table model games.dim_release ................................ [RUN]
[0m18:59:25.757449 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m18:59:25.757916 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m18:59:25.761295 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m18:59:25.762137 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 18:59:25.758235 => 18:59:25.761862
[0m18:59:25.762658 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m18:59:25.765444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:59:26.610427 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m18:59:26.611178 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m18:59:27.174023 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:8e9a951e-86ae-4421-8fed-7a7af7d2aa6e&page=queryresults
[0m18:59:30.152895 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 18:59:25.763039 => 18:59:30.152610
[0m18:59:30.153839 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac8e7bdf-dfb6-4cab-87ea-6bcf35f22c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2523341de0>]}
[0m18:59:30.154621 [info ] [Thread-1 (]: 6 of 12 OK created sql table model games.dim_release ........................... [[32mCREATE TABLE (2.7k rows, 58.4 KiB processed)[0m in 4.40s]
[0m18:59:30.155396 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m18:59:30.155896 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m18:59:30.156558 [info ] [Thread-1 (]: 7 of 12 START sql table model games.dim_support_language ....................... [RUN]
[0m18:59:30.157352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m18:59:30.157732 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m18:59:30.160520 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m18:59:30.161137 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 18:59:30.157989 => 18:59:30.160931
[0m18:59:30.161549 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m18:59:30.164048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:59:30.893578 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m18:59:30.894226 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m18:59:31.538738 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:24c6b24a-e754-45c7-81d5-9a6cb75ef76e&page=queryresults
[0m18:59:34.318177 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 18:59:30.161802 => 18:59:34.317988
[0m18:59:34.318871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac8e7bdf-dfb6-4cab-87ea-6bcf35f22c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25230e56c0>]}
[0m18:59:34.319411 [info ] [Thread-1 (]: 7 of 12 OK created sql table model games.dim_support_language .................. [[32mCREATE TABLE (2.7k rows, 326.5 KiB processed)[0m in 4.16s]
[0m18:59:34.319983 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m18:59:34.320420 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m18:59:34.320830 [info ] [Thread-1 (]: 8 of 12 START sql table model games.fct_game_pricing ........................... [RUN]
[0m18:59:34.321509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m18:59:34.321867 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m18:59:34.325076 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m18:59:34.325732 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 18:59:34.322122 => 18:59:34.325540
[0m18:59:34.326090 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m18:59:34.328225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:59:35.047953 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m18:59:35.048616 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para el análisis de precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        formatted_initial_price,
        platform_id,
        formatted_price_with_tax,
        price_with_tax,
        SUM(price_with_tax) AS total_sales,
        SUM(discount_amount) AS total_discounts,
        COUNT(*) AS num_sales,
        MAX(discount_pct) AS max_discount,
        MIN(initial_price) AS min_price,
        MAX(initial_price) AS max_price,
        SUM(price_with_tax) AS total_sales_with_tax,
        SUM(final_price) AS total_sales_with_tax_discounted
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id, platform_id, formatted_initial_price, formatted_price_with_tax, price_with_tax
)

SELECT
    fct.app_id,
    fct.formatted_initial_price,
    fct.total_sales,
    fct.platform_id,
    fct.formatted_price_with_tax,
    fct.total_discounts,
    fct.price_with_tax,
    fct.num_sales,
    fct.max_discount,
    fct.min_price,
    fct.max_price,
    fct.total_sales_with_tax,
    fct.total_sales_with_tax_discounted,
    games.name AS game_name,
    games.description AS game_description,
    games.is_free AS game_is_free,
    games.fullgame_app_id,
    games.fullgame_name,
    games.type,
    games.genre_id,
    games.type_genre,
FROM
    game_sales AS fct
INNER JOIN
    `pristine-flames-400818`.`games`.`dim_games` AS games
ON
    fct.app_id = games.app_id
INNER JOIN 
    `pristine-flames-400818`.`games`.`dim_platforms` AS dp
ON
    fct.platform_id = dp.platform_id
    );
  
[0m18:59:35.611510 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d17cfcc6-9b67-4bf7-b724-e5560b4e807d&page=queryresults
[0m18:59:44.145087 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 18:59:34.326342 => 18:59:44.144859
[0m18:59:44.146010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac8e7bdf-dfb6-4cab-87ea-6bcf35f22c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25230e5d20>]}
[0m18:59:44.146668 [info ] [Thread-1 (]: 8 of 12 OK created sql table model games.fct_game_pricing ...................... [[32mCREATE TABLE (3.1m rows, 292.5 MiB processed)[0m in 9.82s]
[0m18:59:44.147322 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m18:59:44.148444 [debug] [Thread-1 (]: Began running node model.games.revenue_by_platform_and_game
[0m18:59:44.149156 [info ] [Thread-1 (]: 9 of 12 START sql table model games.revenue_by_platform_and_game ............... [RUN]
[0m18:59:44.150021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.fct_game_pricing, now model.games.revenue_by_platform_and_game)
[0m18:59:44.150477 [debug] [Thread-1 (]: Began compiling node model.games.revenue_by_platform_and_game
[0m18:59:44.153633 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.revenue_by_platform_and_game"
[0m18:59:44.154425 [debug] [Thread-1 (]: Timing info for model.games.revenue_by_platform_and_game (compile): 18:59:44.150748 => 18:59:44.154159
[0m18:59:44.154851 [debug] [Thread-1 (]: Began executing node model.games.revenue_by_platform_and_game
[0m18:59:44.157347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:59:44.914853 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.revenue_by_platform_and_game"
[0m18:59:44.915503 [debug] [Thread-1 (]: On model.games.revenue_by_platform_and_game: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.revenue_by_platform_and_game"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`revenue_by_platform_and_game`
      
    
    

    OPTIONS()
    as (
      -- Informe de Ingresos por Plataforma
SELECT
    s.app_id,
    p.platform_id,
    s.total_sales,
    SUM(CASE WHEN p.windows = 1 THEN s.price_with_tax ELSE 0 END) AS total_sales_windows,
    SUM(CASE WHEN p.mac = 1 THEN s.price_with_tax ELSE 0 END) AS total_sales_mac,
    SUM(CASE WHEN p.linux = 1 THEN s.price_with_tax ELSE 0 END) AS total_sales_linux
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing` s
JOIN
    `pristine-flames-400818`.`games`.`dim_platforms` p ON s.platform_id = p.platform_id
GROUP BY
    s.app_id, p.platform_id, s.total_sales
ORDER BY
    total_sales DESC
    );
  
[0m18:59:45.591007 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:fd655d05-17fa-45be-ad84-29cdfa398ce3&page=queryresults
[0m18:59:54.588464 [debug] [Thread-1 (]: Timing info for model.games.revenue_by_platform_and_game (execute): 18:59:44.155159 => 18:59:54.588250
[0m18:59:54.589485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac8e7bdf-dfb6-4cab-87ea-6bcf35f22c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25231766e0>]}
[0m18:59:54.590151 [info ] [Thread-1 (]: 9 of 12 OK created sql table model games.revenue_by_platform_and_game .......... [[32mCREATE TABLE (3.1m rows, 142.2 MiB processed)[0m in 10.44s]
[0m18:59:54.590808 [debug] [Thread-1 (]: Finished running node model.games.revenue_by_platform_and_game
[0m18:59:54.591255 [debug] [Thread-1 (]: Began running node model.games.top_10_discounted_games
[0m18:59:54.591708 [info ] [Thread-1 (]: 10 of 12 START sql table model games.top_10_discounted_games ................... [RUN]
[0m18:59:54.592395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.revenue_by_platform_and_game, now model.games.top_10_discounted_games)
[0m18:59:54.592876 [debug] [Thread-1 (]: Began compiling node model.games.top_10_discounted_games
[0m18:59:54.595632 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_discounted_games"
[0m18:59:54.596450 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (compile): 18:59:54.593176 => 18:59:54.596169
[0m18:59:54.596891 [debug] [Thread-1 (]: Began executing node model.games.top_10_discounted_games
[0m18:59:54.603309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:59:55.365890 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_discounted_games"
[0m18:59:55.366605 [debug] [Thread-1 (]: On model.games.top_10_discounted_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_discounted_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_discounted_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 descuentos más grandes
SELECT
    app_id,
    game_name,
    total_discounts
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY total_discounts DESC
LIMIT 10
    );
  
[0m18:59:55.944743 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:02bba553-6732-47e4-ba91-c4c43c94a518&page=queryresults
[0m18:59:58.297640 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (execute): 18:59:54.597157 => 18:59:58.296748
[0m18:59:58.300729 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac8e7bdf-dfb6-4cab-87ea-6bcf35f22c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2520701f00>]}
[0m18:59:58.303291 [info ] [Thread-1 (]: 10 of 12 OK created sql table model games.top_10_discounted_games .............. [[32mCREATE TABLE (10.0 rows, 162.8 MiB processed)[0m in 3.71s]
[0m18:59:58.306090 [debug] [Thread-1 (]: Finished running node model.games.top_10_discounted_games
[0m18:59:58.308089 [debug] [Thread-1 (]: Began running node model.games.top_10_high_tax_games
[0m18:59:58.310176 [info ] [Thread-1 (]: 11 of 12 START sql table model games.top_10_high_tax_games ..................... [RUN]
[0m18:59:58.313350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_discounted_games, now model.games.top_10_high_tax_games)
[0m18:59:58.315184 [debug] [Thread-1 (]: Began compiling node model.games.top_10_high_tax_games
[0m18:59:58.325054 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_high_tax_games"
[0m18:59:58.326646 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (compile): 18:59:58.316481 => 18:59:58.326172
[0m18:59:58.327551 [debug] [Thread-1 (]: Began executing node model.games.top_10_high_tax_games
[0m18:59:58.332247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:59:59.314663 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_high_tax_games"
[0m18:59:59.315269 [debug] [Thread-1 (]: On model.games.top_10_high_tax_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_high_tax_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_high_tax_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos con más impuestos
SELECT
    app_id,
    game_name,
    SUM(total_sales_with_tax) AS total_taxes
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
GROUP BY app_id, game_name
ORDER BY total_taxes DESC, game_name DESC
LIMIT 10
    );
  
[0m18:59:59.861790 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:50b18f5e-b107-4898-8042-0c22d1d57bb2&page=queryresults
[0m19:00:02.280226 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (execute): 18:59:58.328199 => 19:00:02.280036
[0m19:00:02.281086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac8e7bdf-dfb6-4cab-87ea-6bcf35f22c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25230f92d0>]}
[0m19:00:02.281764 [info ] [Thread-1 (]: 11 of 12 OK created sql table model games.top_10_high_tax_games ................ [[32mCREATE TABLE (10.0 rows, 162.8 MiB processed)[0m in 3.97s]
[0m19:00:02.282352 [debug] [Thread-1 (]: Finished running node model.games.top_10_high_tax_games
[0m19:00:02.282829 [debug] [Thread-1 (]: Began running node model.games.top_10_most_expensive_games
[0m19:00:02.283416 [info ] [Thread-1 (]: 12 of 12 START sql table model games.top_10_most_expensive_games ............... [RUN]
[0m19:00:02.284083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_high_tax_games, now model.games.top_10_most_expensive_games)
[0m19:00:02.284517 [debug] [Thread-1 (]: Began compiling node model.games.top_10_most_expensive_games
[0m19:00:02.287451 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_most_expensive_games"
[0m19:00:02.288167 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (compile): 19:00:02.284795 => 19:00:02.287923
[0m19:00:02.288538 [debug] [Thread-1 (]: Began executing node model.games.top_10_most_expensive_games
[0m19:00:02.290812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:03.063064 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_most_expensive_games"
[0m19:00:03.063764 [debug] [Thread-1 (]: On model.games.top_10_most_expensive_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_most_expensive_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_most_expensive_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos más caros
SELECT
    app_id,
    game_name,
    max_price,
    formatted_initial_price,
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY max_price DESC
LIMIT 10
    );
  
[0m19:00:03.631159 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e196a6ae-297c-4863-8fb1-30f4ba8b83b1&page=queryresults
[0m19:00:06.043460 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (execute): 19:00:02.288790 => 19:00:06.043188
[0m19:00:06.044371 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac8e7bdf-dfb6-4cab-87ea-6bcf35f22c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25230b8b50>]}
[0m19:00:06.045072 [info ] [Thread-1 (]: 12 of 12 OK created sql table model games.top_10_most_expensive_games .......... [[32mCREATE TABLE (10.0 rows, 177.7 MiB processed)[0m in 3.76s]
[0m19:00:06.045817 [debug] [Thread-1 (]: Finished running node model.games.top_10_most_expensive_games
[0m19:00:06.047426 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:00:06.047850 [debug] [MainThread]: Connection 'model.games.top_10_most_expensive_games' was properly closed.
[0m19:00:06.048294 [info ] [MainThread]: 
[0m19:00:06.048707 [info ] [MainThread]: Finished running 12 table models in 0 hours 1 minutes and 5.01 seconds (65.01s).
[0m19:00:06.051073 [debug] [MainThread]: Command end result
[0m19:00:06.066843 [info ] [MainThread]: 
[0m19:00:06.067330 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:00:06.067726 [info ] [MainThread]: 
[0m19:00:06.068110 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m19:00:06.068716 [debug] [MainThread]: Command `dbt run` succeeded at 19:00:06.068606 after 65.91 seconds
[0m19:00:06.069107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f252730d180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f252071fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f252071fa60>]}
[0m19:00:06.069537 [debug] [MainThread]: Flushing usage events
[0m14:12:06.586507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feab4b09bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feab2ba0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feab2ba00d0>]}


============================== 14:12:06.589839 | af9ddb6a-8b47-45f2-a2db-3121987cd76b ==============================
[0m14:12:06.589839 [info ] [MainThread]: Running with dbt=1.6.5
[0m14:12:06.590310 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'send_anonymous_usage_stats': 'True'}
[0m14:12:07.331054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af9ddb6a-8b47-45f2-a2db-3121987cd76b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feab0b22c50>]}
[0m14:12:07.348761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af9ddb6a-8b47-45f2-a2db-3121987cd76b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feab0b3c7c0>]}
[0m14:12:07.349606 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m14:12:07.365216 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m14:12:07.465739 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:12:07.466114 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:12:07.472300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af9ddb6a-8b47-45f2-a2db-3121987cd76b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feab09a80d0>]}
[0m14:12:07.483867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af9ddb6a-8b47-45f2-a2db-3121987cd76b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feab0971c90>]}
[0m14:12:07.484339 [info ] [MainThread]: Found 12 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m14:12:07.484688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af9ddb6a-8b47-45f2-a2db-3121987cd76b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feab0973970>]}
[0m14:12:07.486122 [info ] [MainThread]: 
[0m14:12:07.486805 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:12:07.488432 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m14:12:07.488884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:08.379348 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m14:12:08.381433 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:12:09.074936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af9ddb6a-8b47-45f2-a2db-3121987cd76b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feab2d77f10>]}
[0m14:12:09.078229 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:12:09.080003 [info ] [MainThread]: 
[0m14:12:09.087962 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m14:12:09.090170 [info ] [Thread-1 (]: 1 of 12 START sql table model games.dim_developers ............................. [RUN]
[0m14:12:09.093132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m14:12:09.094956 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m14:12:09.124650 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m14:12:09.126346 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 14:12:09.096284 => 14:12:09.125866
[0m14:12:09.127163 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m14:12:09.147235 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:09.940868 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m14:12:09.943534 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS developer_id,
    developers_name
FROM
    developers_cte
    );
  
[0m14:12:10.538853 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:1d8cf0f1-fa71-4b6e-94fd-98bb2cfbf634&page=queryresults
[0m14:12:13.043669 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 14:12:09.127713 => 14:12:13.043351
[0m14:12:13.044811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af9ddb6a-8b47-45f2-a2db-3121987cd76b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feab0b49f60>]}
[0m14:12:13.045735 [info ] [Thread-1 (]: 1 of 12 OK created sql table model games.dim_developers ........................ [[32mCREATE TABLE (2.6k rows, 41.9 KiB processed)[0m in 3.95s]
[0m14:12:13.046610 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m14:12:13.047235 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m14:12:13.047958 [info ] [Thread-1 (]: 2 of 12 START sql table model games.dim_games .................................. [RUN]
[0m14:12:13.048827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m14:12:13.049361 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m14:12:13.052806 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m14:12:13.054834 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 14:12:13.049740 => 14:12:13.054584
[0m14:12:13.055316 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m14:12:13.063883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:13.753434 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m14:12:13.757695 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m14:12:14.354963 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b8b45c2a-6e1c-415f-afa4-393ea34eada4&page=queryresults
[0m14:12:16.497091 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 14:12:13.055649 => 14:12:16.496209
[0m14:12:16.500468 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af9ddb6a-8b47-45f2-a2db-3121987cd76b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feab0993f10>]}
[0m14:12:16.503063 [info ] [Thread-1 (]: 2 of 12 OK created sql table model games.dim_games ............................. [[32mCREATE TABLE (2.8k rows, 776.0 KiB processed)[0m in 3.45s]
[0m14:12:16.505893 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m14:12:16.507950 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m14:12:16.510326 [info ] [Thread-1 (]: 3 of 12 START sql table model games.dim_platforms .............................. [RUN]
[0m14:12:16.513383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m14:12:16.515273 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m14:12:16.521793 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m14:12:16.522597 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 14:12:16.516564 => 14:12:16.522351
[0m14:12:16.523003 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m14:12:16.525279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:17.246000 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m14:12:17.248736 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m14:12:17.859222 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c11be4ae-6136-431d-bb41-e09729d155d3&page=queryresults
[0m14:12:20.539997 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 14:12:16.523313 => 14:12:20.539070
[0m14:12:20.543148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af9ddb6a-8b47-45f2-a2db-3121987cd76b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feab08295a0>]}
[0m14:12:20.545743 [info ] [Thread-1 (]: 3 of 12 OK created sql table model games.dim_platforms ......................... [[32mCREATE TABLE (2.8k rows, 65.6 KiB processed)[0m in 4.03s]
[0m14:12:20.548613 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m14:12:20.550665 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m14:12:20.553142 [info ] [Thread-1 (]: 4 of 12 START sql table model games.dim_price_overview ......................... [RUN]
[0m14:12:20.556116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m14:12:20.557413 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m14:12:20.564081 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m14:12:20.564888 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 14:12:20.558330 => 14:12:20.564687
[0m14:12:20.565346 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m14:12:20.567682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:21.306729 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m14:12:21.309703 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
    SELECT
        initial_price,
        final_price,
        discount_percent AS discount_pct,
        formatted_initial_price,
        formatted_final_price,
        app_id,
        -- Monto del Descuento formateado como decimal con dos decimales
       CAST(
        (CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END) / 100 AS NUMERIC
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (CASE
    WHEN discount_percent > 0 THEN
        CAST((initial_price * (1 - discount_percent / 100) * 1.75) AS NUMERIC)
    ELSE
        CAST(initial_price * 1.75 AS NUMERIC)
    END) AS price_with_tax
    FROM
    `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    platform_id,
    windows,
    mac,
    linux,
    CONCAT('ARS$ ', REPLACE(FORMAT('%.2f', price_with_tax), '.', ',')) AS formatted_price_with_tax
FROM price_overview_cte, games.dim_platforms
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m14:12:21.932424 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:34147e6c-5d85-482a-912d-0a59afb53317&page=queryresults
[0m14:12:27.472996 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 14:12:20.565609 => 14:12:27.472795
[0m14:12:27.473891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af9ddb6a-8b47-45f2-a2db-3121987cd76b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feab083c2b0>]}
[0m14:12:27.474588 [info ] [Thread-1 (]: 4 of 12 OK created sql table model games.dim_price_overview .................... [[32mCREATE TABLE (3.3m rows, 205.3 KiB processed)[0m in 6.92s]
[0m14:12:27.475296 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m14:12:27.475745 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m14:12:27.476449 [info ] [Thread-1 (]: 5 of 12 START sql table model games.dim_publishers ............................. [RUN]
[0m14:12:27.477147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m14:12:27.477543 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m14:12:27.485748 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m14:12:27.486507 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 14:12:27.477805 => 14:12:27.486265
[0m14:12:27.486914 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m14:12:27.489412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:28.210426 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m14:12:28.213153 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m14:12:28.791500 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f1e83818-1cf9-48bf-9a0e-f2453da37563&page=queryresults
[0m14:12:31.251204 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 14:12:27.487221 => 14:12:31.250954
[0m14:12:31.251987 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af9ddb6a-8b47-45f2-a2db-3121987cd76b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feab084a6e0>]}
[0m14:12:31.252980 [info ] [Thread-1 (]: 5 of 12 OK created sql table model games.dim_publishers ........................ [[32mCREATE TABLE (1.9k rows, 38.3 KiB processed)[0m in 3.78s]
[0m14:12:31.255812 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m14:12:31.256362 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m14:12:31.256887 [info ] [Thread-1 (]: 6 of 12 START sql table model games.dim_release ................................ [RUN]
[0m14:12:31.257697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m14:12:31.258195 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m14:12:31.261312 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m14:12:31.262559 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 14:12:31.258529 => 14:12:31.262292
[0m14:12:31.263085 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m14:12:31.268389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:31.958988 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m14:12:31.959705 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m14:12:32.613921 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b91b129c-a7c4-4b49-acd2-a5d7f0a9fd1a&page=queryresults
[0m14:12:35.303509 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 14:12:31.263468 => 14:12:35.303318
[0m14:12:35.304305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af9ddb6a-8b47-45f2-a2db-3121987cd76b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feab099af80>]}
[0m14:12:35.304972 [info ] [Thread-1 (]: 6 of 12 OK created sql table model games.dim_release ........................... [[32mCREATE TABLE (2.8k rows, 60.1 KiB processed)[0m in 4.05s]
[0m14:12:35.305691 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m14:12:35.306192 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m14:12:35.306774 [info ] [Thread-1 (]: 7 of 12 START sql table model games.dim_support_language ....................... [RUN]
[0m14:12:35.307441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m14:12:35.307852 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m14:12:35.310665 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m14:12:35.311398 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 14:12:35.308116 => 14:12:35.311128
[0m14:12:35.311801 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m14:12:35.314119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:35.986013 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m14:12:35.986737 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m14:12:36.563931 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:0a77191d-f797-4018-8bc1-7577db54002e&page=queryresults
[0m14:12:39.290986 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 14:12:35.312062 => 14:12:39.290795
[0m14:12:39.291780 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af9ddb6a-8b47-45f2-a2db-3121987cd76b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feab08e1390>]}
[0m14:12:39.292381 [info ] [Thread-1 (]: 7 of 12 OK created sql table model games.dim_support_language .................. [[32mCREATE TABLE (2.8k rows, 336.1 KiB processed)[0m in 3.98s]
[0m14:12:39.293023 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m14:12:39.293558 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m14:12:39.294219 [info ] [Thread-1 (]: 8 of 12 START sql table model games.fct_game_pricing ........................... [RUN]
[0m14:12:39.294936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m14:12:39.295394 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m14:12:39.298678 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m14:12:39.299435 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 14:12:39.295662 => 14:12:39.299198
[0m14:12:39.299844 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m14:12:39.302160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:39.987821 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m14:12:39.988619 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para el análisis de precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        formatted_initial_price,
        platform_id,
        formatted_price_with_tax,
        price_with_tax,
        SUM(price_with_tax) AS total_sales,
        SUM(discount_amount) AS total_discounts,
        COUNT(*) AS num_sales,
        MAX(discount_pct) AS max_discount,
        MIN(initial_price) AS min_price,
        MAX(initial_price) AS max_price,
        SUM(price_with_tax) AS total_sales_with_tax,
        SUM(final_price) AS total_sales_with_tax_discounted
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id, platform_id, formatted_initial_price, formatted_price_with_tax, price_with_tax
)

SELECT
    fct.app_id,
    fct.formatted_initial_price,
    fct.total_sales,
    fct.platform_id,
    fct.formatted_price_with_tax,
    fct.total_discounts,
    fct.price_with_tax,
    fct.num_sales,
    fct.max_discount,
    fct.min_price,
    fct.max_price,
    fct.total_sales_with_tax,
    fct.total_sales_with_tax_discounted,
    games.name AS game_name,
    games.description AS game_description,
    games.is_free AS game_is_free,
    games.fullgame_app_id,
    games.fullgame_name,
    games.type,
    games.genre_id,
    games.type_genre,
FROM
    game_sales AS fct
INNER JOIN
    `pristine-flames-400818`.`games`.`dim_games` AS games
ON
    fct.app_id = games.app_id
INNER JOIN 
    `pristine-flames-400818`.`games`.`dim_platforms` AS dp
ON
    fct.platform_id = dp.platform_id
    );
  
[0m14:12:40.584660 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:2bea0a00-1d58-4bf8-8918-5125004d194b&page=queryresults
[0m14:12:49.120356 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 14:12:39.300105 => 14:12:49.119463
[0m14:12:49.123512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af9ddb6a-8b47-45f2-a2db-3121987cd76b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feab08e16c0>]}
[0m14:12:49.126088 [info ] [Thread-1 (]: 8 of 12 OK created sql table model games.fct_game_pricing ...................... [[32mCREATE TABLE (3.3m rows, 313.2 MiB processed)[0m in 9.83s]
[0m14:12:49.128950 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m14:12:49.132374 [debug] [Thread-1 (]: Began running node model.games.revenue_by_platform_and_game
[0m14:12:49.134710 [info ] [Thread-1 (]: 9 of 12 START sql table model games.revenue_by_platform_and_game ............... [RUN]
[0m14:12:49.136782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.fct_game_pricing, now model.games.revenue_by_platform_and_game)
[0m14:12:49.138074 [debug] [Thread-1 (]: Began compiling node model.games.revenue_by_platform_and_game
[0m14:12:49.145314 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.revenue_by_platform_and_game"
[0m14:12:49.146599 [debug] [Thread-1 (]: Timing info for model.games.revenue_by_platform_and_game (compile): 14:12:49.138982 => 14:12:49.146194
[0m14:12:49.147371 [debug] [Thread-1 (]: Began executing node model.games.revenue_by_platform_and_game
[0m14:12:49.151341 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:49.853448 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.revenue_by_platform_and_game"
[0m14:12:49.856302 [debug] [Thread-1 (]: On model.games.revenue_by_platform_and_game: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.revenue_by_platform_and_game"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`revenue_by_platform_and_game`
      
    
    

    OPTIONS()
    as (
      -- Informe de Ingresos por Plataforma
SELECT
    s.app_id,
    p.platform_id,
    s.total_sales,
    SUM(CASE WHEN p.windows = 1 THEN s.price_with_tax ELSE 0 END) AS total_sales_windows,
    SUM(CASE WHEN p.mac = 1 THEN s.price_with_tax ELSE 0 END) AS total_sales_mac,
    SUM(CASE WHEN p.linux = 1 THEN s.price_with_tax ELSE 0 END) AS total_sales_linux
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing` s
JOIN
    `pristine-flames-400818`.`games`.`dim_platforms` p ON s.platform_id = p.platform_id
GROUP BY
    s.app_id, p.platform_id, s.total_sales
ORDER BY
    total_sales DESC
    );
  
[0m14:12:50.407803 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:fa6f04a3-4608-4e0f-9638-3025821ebe07&page=queryresults
[0m14:13:01.037769 [debug] [Thread-1 (]: Timing info for model.games.revenue_by_platform_and_game (execute): 14:12:49.147908 => 14:13:01.036874
[0m14:13:01.041177 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af9ddb6a-8b47-45f2-a2db-3121987cd76b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feab08953f0>]}
[0m14:13:01.043875 [info ] [Thread-1 (]: 9 of 12 OK created sql table model games.revenue_by_platform_and_game .......... [[32mCREATE TABLE (3.3m rows, 152.1 MiB processed)[0m in 11.90s]
[0m14:13:01.046778 [debug] [Thread-1 (]: Finished running node model.games.revenue_by_platform_and_game
[0m14:13:01.049001 [debug] [Thread-1 (]: Began running node model.games.top_10_discounted_games
[0m14:13:01.051189 [info ] [Thread-1 (]: 10 of 12 START sql table model games.top_10_discounted_games ................... [RUN]
[0m14:13:01.054703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.revenue_by_platform_and_game, now model.games.top_10_discounted_games)
[0m14:13:01.056720 [debug] [Thread-1 (]: Began compiling node model.games.top_10_discounted_games
[0m14:13:01.065919 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_discounted_games"
[0m14:13:01.067643 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (compile): 14:13:01.058072 => 14:13:01.067099
[0m14:13:01.068634 [debug] [Thread-1 (]: Began executing node model.games.top_10_discounted_games
[0m14:13:01.080417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:01.789791 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_discounted_games"
[0m14:13:01.790596 [debug] [Thread-1 (]: On model.games.top_10_discounted_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_discounted_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_discounted_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 descuentos más grandes
SELECT
    app_id,
    game_name,
    total_discounts
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY total_discounts DESC
LIMIT 10
    );
  
[0m14:13:02.330496 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:fe35bdb1-c0ad-4b95-974d-ee793ac03c77&page=queryresults
[0m14:13:04.434164 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (execute): 14:13:01.069320 => 14:13:04.433276
[0m14:13:04.437302 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af9ddb6a-8b47-45f2-a2db-3121987cd76b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaadefd510>]}
[0m14:13:04.439897 [info ] [Thread-1 (]: 10 of 12 OK created sql table model games.top_10_discounted_games .............. [[32mCREATE TABLE (10.0 rows, 173.9 MiB processed)[0m in 3.38s]
[0m14:13:04.442733 [debug] [Thread-1 (]: Finished running node model.games.top_10_discounted_games
[0m14:13:04.444864 [debug] [Thread-1 (]: Began running node model.games.top_10_high_tax_games
[0m14:13:04.447300 [info ] [Thread-1 (]: 11 of 12 START sql table model games.top_10_high_tax_games ..................... [RUN]
[0m14:13:04.450231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_discounted_games, now model.games.top_10_high_tax_games)
[0m14:13:04.452102 [debug] [Thread-1 (]: Began compiling node model.games.top_10_high_tax_games
[0m14:13:04.458689 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_high_tax_games"
[0m14:13:04.459467 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (compile): 14:13:04.453411 => 14:13:04.459247
[0m14:13:04.459905 [debug] [Thread-1 (]: Began executing node model.games.top_10_high_tax_games
[0m14:13:04.462241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:05.168901 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_high_tax_games"
[0m14:13:05.171693 [debug] [Thread-1 (]: On model.games.top_10_high_tax_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_high_tax_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_high_tax_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos con más impuestos
SELECT
    app_id,
    game_name,
    SUM(total_sales_with_tax) AS total_taxes
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
GROUP BY app_id, game_name
ORDER BY total_taxes DESC, game_name DESC
LIMIT 10
    );
  
[0m14:13:05.743353 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b75e615d-7140-4fcc-a7ea-56257df16074&page=queryresults
[0m14:13:08.171826 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (execute): 14:13:04.460165 => 14:13:08.170903
[0m14:13:08.175115 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af9ddb6a-8b47-45f2-a2db-3121987cd76b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feab084a6e0>]}
[0m14:13:08.177742 [info ] [Thread-1 (]: 11 of 12 OK created sql table model games.top_10_high_tax_games ................ [[32mCREATE TABLE (10.0 rows, 173.9 MiB processed)[0m in 3.73s]
[0m14:13:08.180591 [debug] [Thread-1 (]: Finished running node model.games.top_10_high_tax_games
[0m14:13:08.182634 [debug] [Thread-1 (]: Began running node model.games.top_10_most_expensive_games
[0m14:13:08.185080 [info ] [Thread-1 (]: 12 of 12 START sql table model games.top_10_most_expensive_games ............... [RUN]
[0m14:13:08.188269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_high_tax_games, now model.games.top_10_most_expensive_games)
[0m14:13:08.190199 [debug] [Thread-1 (]: Began compiling node model.games.top_10_most_expensive_games
[0m14:13:08.200066 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_most_expensive_games"
[0m14:13:08.201661 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (compile): 14:13:08.191559 => 14:13:08.201145
[0m14:13:08.202598 [debug] [Thread-1 (]: Began executing node model.games.top_10_most_expensive_games
[0m14:13:08.207360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:08.903735 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_most_expensive_games"
[0m14:13:08.906701 [debug] [Thread-1 (]: On model.games.top_10_most_expensive_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_most_expensive_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_most_expensive_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos más caros
SELECT
    app_id,
    game_name,
    max_price,
    formatted_initial_price,
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY max_price DESC
LIMIT 10
    );
  
[0m14:13:09.490198 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:8f141168-5b95-4f56-bcfb-26a68b4a7104&page=queryresults
[0m14:13:11.972070 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (execute): 14:13:08.203275 => 14:13:11.971161
[0m14:13:11.975416 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af9ddb6a-8b47-45f2-a2db-3121987cd76b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feab0b22740>]}
[0m14:13:11.978025 [info ] [Thread-1 (]: 12 of 12 OK created sql table model games.top_10_most_expensive_games .......... [[32mCREATE TABLE (10.0 rows, 189.9 MiB processed)[0m in 3.79s]
[0m14:13:11.980900 [debug] [Thread-1 (]: Finished running node model.games.top_10_most_expensive_games
[0m14:13:11.986882 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:13:11.988583 [debug] [MainThread]: Connection 'model.games.top_10_most_expensive_games' was properly closed.
[0m14:13:11.990348 [info ] [MainThread]: 
[0m14:13:11.992162 [info ] [MainThread]: Finished running 12 table models in 0 hours 1 minutes and 4.50 seconds (64.50s).
[0m14:13:12.003297 [debug] [MainThread]: Command end result
[0m14:13:12.033695 [info ] [MainThread]: 
[0m14:13:12.034290 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:13:12.034740 [info ] [MainThread]: 
[0m14:13:12.035187 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m14:13:12.035868 [debug] [MainThread]: Command `dbt run` succeeded at 14:13:12.035747 after 65.46 seconds
[0m14:13:12.036310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feab4b09bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feab08b3e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaadf1b940>]}
[0m14:13:12.036774 [debug] [MainThread]: Flushing usage events
[0m17:45:48.434243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f477722be50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4775288220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4775288310>]}


============================== 17:45:48.438061 | 83e63d93-412e-444d-bf2f-e839abebd042 ==============================
[0m17:45:48.438061 [info ] [MainThread]: Running with dbt=1.6.5
[0m17:45:48.438522 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/tomi/GCPSteamAnalytics/includes/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ls', 'send_anonymous_usage_stats': 'True'}
[0m17:45:49.050418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83e63d93-412e-444d-bf2f-e839abebd042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47767d5840>]}
[0m17:45:49.066381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83e63d93-412e-444d-bf2f-e839abebd042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f477322b4f0>]}
[0m17:45:49.067273 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m17:45:49.081629 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m17:45:49.133314 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:45:49.133760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '83e63d93-412e-444d-bf2f-e839abebd042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47767d4940>]}
[0m17:45:50.127044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83e63d93-412e-444d-bf2f-e839abebd042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47729b1c30>]}
[0m17:45:50.138602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83e63d93-412e-444d-bf2f-e839abebd042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4773232cb0>]}
[0m17:45:50.139054 [info ] [MainThread]: Found 12 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m17:45:50.139437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83e63d93-412e-444d-bf2f-e839abebd042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4773088a00>]}
[0m17:45:50.140446 [debug] [MainThread]: Command `dbt ls` succeeded at 17:45:50.140350 after 1.71 seconds
[0m17:45:50.140796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f477722be50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47731ef670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4776a53280>]}
[0m17:45:50.141142 [debug] [MainThread]: Flushing usage events
[0m19:08:42.812091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c7932b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c5ac0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c5ac00d0>]}


============================== 19:08:42.815412 | 922663dd-a53d-4355-80f6-3380c69a1c42 ==============================
[0m19:08:42.815412 [info ] [MainThread]: Running with dbt=1.6.5
[0m19:08:42.816029 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'debug': 'False', 'profiles_dir': '../dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'send_anonymous_usage_stats': 'True'}
[0m19:08:43.384676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '922663dd-a53d-4355-80f6-3380c69a1c42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c3a46c50>]}
[0m19:08:43.400528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '922663dd-a53d-4355-80f6-3380c69a1c42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c3a60640>]}
[0m19:08:43.401376 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m19:08:43.415850 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m19:08:43.518969 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:08:43.519615 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m19:08:43.565169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '922663dd-a53d-4355-80f6-3380c69a1c42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c2f5a470>]}
[0m19:08:43.575901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '922663dd-a53d-4355-80f6-3380c69a1c42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c3897a30>]}
[0m19:08:43.576407 [info ] [MainThread]: Found 12 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m19:08:43.576764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '922663dd-a53d-4355-80f6-3380c69a1c42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c3897a60>]}
[0m19:08:43.578318 [info ] [MainThread]: 
[0m19:08:43.579026 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:08:43.580518 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m19:08:43.580932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:08:43.581336 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: '/opt/airflow/credentials.json''
[0m19:08:43.582400 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:08:43.582718 [debug] [MainThread]: Connection 'list_pristine-flames-400818' was properly closed.
[0m19:08:43.583053 [info ] [MainThread]: 
[0m19:08:43.583428 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.00 seconds (0.00s).
[0m19:08:43.583905 [error] [MainThread]: Encountered an error:
Database Error
  [Errno 2] No such file or directory: '/opt/airflow/credentials.json'
[0m19:08:43.584454 [debug] [MainThread]: Command `dbt run` failed at 19:08:43.584363 after 0.78 seconds
[0m19:08:43.584810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c7932b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c3897a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c38954e0>]}
[0m19:08:43.585214 [debug] [MainThread]: Flushing usage events
[0m19:08:58.407816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f388eb31180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f388ccc0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f388ccc00d0>]}


============================== 19:08:58.409958 | 4e7714b6-6df7-482d-a3fe-8d8ca56aa810 ==============================
[0m19:08:58.409958 [info ] [MainThread]: Running with dbt=1.6.5
[0m19:08:58.410420 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:08:58.688996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e7714b6-6df7-482d-a3fe-8d8ca56aa810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f388e149cf0>]}
[0m19:08:58.704787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e7714b6-6df7-482d-a3fe-8d8ca56aa810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f388ac609d0>]}
[0m19:08:58.705432 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m19:08:58.719163 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m19:08:58.766120 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m19:08:58.766565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4e7714b6-6df7-482d-a3fe-8d8ca56aa810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f388e1487c0>]}
[0m19:08:59.737956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e7714b6-6df7-482d-a3fe-8d8ca56aa810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f388a3e9b10>]}
[0m19:08:59.747293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e7714b6-6df7-482d-a3fe-8d8ca56aa810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f388ac6ed10>]}
[0m19:08:59.747756 [info ] [MainThread]: Found 12 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m19:08:59.748102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e7714b6-6df7-482d-a3fe-8d8ca56aa810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f388aac48b0>]}
[0m19:08:59.749556 [info ] [MainThread]: 
[0m19:08:59.750210 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:08:59.751731 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m19:08:59.752178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:09:00.607826 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818_games'
[0m19:09:00.608430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:09:01.320021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e7714b6-6df7-482d-a3fe-8d8ca56aa810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f388aac4af0>]}
[0m19:09:01.323207 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:09:01.324905 [info ] [MainThread]: 
[0m19:09:01.335495 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m19:09:01.337760 [info ] [Thread-1 (]: 1 of 12 START sql table model games.dim_developers ............................. [RUN]
[0m19:09:01.340899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m19:09:01.342839 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m19:09:01.374288 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m19:09:01.375990 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 19:09:01.344197 => 19:09:01.375449
[0m19:09:01.377000 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m19:09:01.421360 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m19:09:01.421991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:01.453409 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS developer_id,
    developers_name
FROM
    developers_cte
    );
  
[0m19:09:02.394728 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c9df40e1-8d26-424a-ab00-1f7e33c5ae8d&page=queryresults
[0m19:09:05.131344 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 19:09:01.377691 => 19:09:05.130948
[0m19:09:05.132718 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e7714b6-6df7-482d-a3fe-8d8ca56aa810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f388aa92ec0>]}
[0m19:09:05.133805 [info ] [Thread-1 (]: 1 of 12 OK created sql table model games.dim_developers ........................ [[32mCREATE TABLE (84.0 rows, 1.5 KiB processed)[0m in 3.79s]
[0m19:09:05.134785 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m19:09:05.135508 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m19:09:05.136349 [info ] [Thread-1 (]: 2 of 12 START sql table model games.dim_games .................................. [RUN]
[0m19:09:05.137363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m19:09:05.137992 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m19:09:05.141923 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m19:09:05.144090 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 19:09:05.138442 => 19:09:05.143830
[0m19:09:05.144574 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m19:09:05.148621 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m19:09:05.150467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:05.184362 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m19:09:06.149710 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d89cf5cb-1309-48b7-ac5e-3fe343c84c52&page=queryresults
[0m19:09:08.587953 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 19:09:05.144920 => 19:09:08.587057
[0m19:09:08.591260 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e7714b6-6df7-482d-a3fe-8d8ca56aa810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f388a245060>]}
[0m19:09:08.593868 [info ] [Thread-1 (]: 2 of 12 OK created sql table model games.dim_games ............................. [[32mCREATE TABLE (87.0 rows, 24.3 KiB processed)[0m in 3.45s]
[0m19:09:08.596713 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m19:09:08.598764 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m19:09:08.601258 [info ] [Thread-1 (]: 3 of 12 START sql table model games.dim_platforms .............................. [RUN]
[0m19:09:08.604431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m19:09:08.606295 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m19:09:08.612752 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m19:09:08.613548 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 19:09:08.607639 => 19:09:08.613284
[0m19:09:08.614009 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m19:09:08.617197 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m19:09:08.617836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:08.649682 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m19:09:09.649224 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d5219be6-9698-4500-8277-ae381f51dc03&page=queryresults
[0m19:09:12.667975 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 19:09:08.614275 => 19:09:12.667079
[0m19:09:12.671348 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e7714b6-6df7-482d-a3fe-8d8ca56aa810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f388a246b90>]}
[0m19:09:12.673919 [info ] [Thread-1 (]: 3 of 12 OK created sql table model games.dim_platforms ......................... [[32mCREATE TABLE (87.0 rows, 2.0 KiB processed)[0m in 4.07s]
[0m19:09:12.676754 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m19:09:12.678773 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m19:09:12.681246 [info ] [Thread-1 (]: 4 of 12 START sql table model games.dim_price_overview ......................... [RUN]
[0m19:09:12.684368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m19:09:12.686335 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m19:09:12.699683 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m19:09:12.700433 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 19:09:12.687721 => 19:09:12.700201
[0m19:09:12.700819 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m19:09:12.704312 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m19:09:12.704959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:12.737529 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
   SELECT
    initial_price,
    final_price,
    discount_percent AS discount_pct,
    formatted_initial_price,
    formatted_final_price,
    app_id,
    -- Monto del Descuento formateado como decimal con dos decimales
    (
        CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END / 100
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (
        CASE
            WHEN discount_percent > 0 THEN initial_price * (1 - discount_percent / 100) * 1.75
            ELSE initial_price * 1.75
        END
    
    ) AS price_with_tax
    FROM 
        `pristine-flames-400818`.`games`.`raw_games`
)


SELECT
    ROW_NUMBER() OVER() AS purchase_id,
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    platform_id,
    windows,
    mac,
    linux,
    CONCAT('ARS$ ', FORMAT("%'.2f", price_with_tax / 100)) AS formatted_price_with_tax
FROM price_overview_cte, games.dim_platforms
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m19:09:13.742259 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:9dcd145e-c24d-4764-abe8-2951ca4b1ffc&page=queryresults
[0m19:09:16.712264 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 19:09:12.701111 => 19:09:16.711384
[0m19:09:16.715454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e7714b6-6df7-482d-a3fe-8d8ca56aa810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f388a117820>]}
[0m19:09:16.718040 [info ] [Thread-1 (]: 4 of 12 OK created sql table model games.dim_price_overview .................... [[32mCREATE TABLE (5.1k rows, 6.9 KiB processed)[0m in 4.03s]
[0m19:09:16.720940 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m19:09:16.723035 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m19:09:16.725788 [info ] [Thread-1 (]: 5 of 12 START sql table model games.dim_publishers ............................. [RUN]
[0m19:09:16.728843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m19:09:16.730706 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m19:09:16.752212 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m19:09:16.754796 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 19:09:16.732071 => 19:09:16.754086
[0m19:09:16.756190 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m19:09:16.764236 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m19:09:16.765403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:16.804249 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m19:09:17.754746 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:be7b18ea-1304-41a1-82b7-a9748f759269&page=queryresults
[0m19:09:21.228522 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 19:09:16.757136 => 19:09:21.227654
[0m19:09:21.231746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e7714b6-6df7-482d-a3fe-8d8ca56aa810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f388a117820>]}
[0m19:09:21.234378 [info ] [Thread-1 (]: 5 of 12 OK created sql table model games.dim_publishers ........................ [[32mCREATE TABLE (67.0 rows, 1.3 KiB processed)[0m in 4.50s]
[0m19:09:21.237275 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m19:09:21.239407 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m19:09:21.241580 [info ] [Thread-1 (]: 6 of 12 START sql table model games.dim_release ................................ [RUN]
[0m19:09:21.244906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m19:09:21.246806 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m19:09:21.255507 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m19:09:21.257025 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 19:09:21.248161 => 19:09:21.256538
[0m19:09:21.257976 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m19:09:21.263917 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m19:09:21.264824 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:21.301430 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m19:09:22.152286 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e61ccd2d-d77a-4ddb-95e6-d11d56728925&page=queryresults
[0m19:09:24.883509 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 19:09:21.258664 => 19:09:24.882635
[0m19:09:24.886619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e7714b6-6df7-482d-a3fe-8d8ca56aa810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f388a1074f0>]}
[0m19:09:24.889227 [info ] [Thread-1 (]: 6 of 12 OK created sql table model games.dim_release ........................... [[32mCREATE TABLE (87.0 rows, 1.8 KiB processed)[0m in 3.64s]
[0m19:09:24.892056 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m19:09:24.894112 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m19:09:24.896548 [info ] [Thread-1 (]: 7 of 12 START sql table model games.dim_support_language ....................... [RUN]
[0m19:09:24.899514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m19:09:24.901354 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m19:09:24.912732 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m19:09:24.914620 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 19:09:24.902641 => 19:09:24.914086
[0m19:09:24.915618 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m19:09:24.922441 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m19:09:24.923609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:24.962126 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m19:09:25.901247 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b0d88a26-e31f-4337-9199-472f934ebe84&page=queryresults
[0m19:09:28.580973 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 19:09:24.916300 => 19:09:28.580785
[0m19:09:28.581731 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e7714b6-6df7-482d-a3fe-8d8ca56aa810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f388a1064a0>]}
[0m19:09:28.582289 [info ] [Thread-1 (]: 7 of 12 OK created sql table model games.dim_support_language .................. [[32mCREATE TABLE (87.0 rows, 10.5 KiB processed)[0m in 3.68s]
[0m19:09:28.582981 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m19:09:28.583481 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m19:09:28.584124 [info ] [Thread-1 (]: 8 of 12 START sql table model games.fct_game_pricing ........................... [RUN]
[0m19:09:28.584835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m19:09:28.585240 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m19:09:28.590466 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m19:09:28.591336 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 19:09:28.585506 => 19:09:28.591068
[0m19:09:28.591757 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m19:09:28.594908 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m19:09:28.595607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:28.629382 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para el análisis de precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        formatted_initial_price,
        platform_id,
        formatted_price_with_tax,
        price_with_tax,
        SUM(price_with_tax) AS total_sales,
        SUM(discount_amount) AS total_discounts,
        COUNT(*) AS num_sales,
        MAX(discount_pct) AS max_discount,
        MIN(initial_price) AS min_price,
        MAX(initial_price) AS max_price,
        SUM(price_with_tax) AS total_sales_with_tax,
        SUM(final_price) AS total_sales_with_tax_discounted
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id, platform_id, formatted_initial_price, formatted_price_with_tax, price_with_tax
)

SELECT
    fct.app_id,
    fct.formatted_initial_price,
    fct.total_sales,
    fct.platform_id,
    fct.formatted_price_with_tax,
    fct.total_discounts,
    fct.price_with_tax,
    fct.num_sales,
    fct.max_discount,
    fct.min_price,
    fct.max_price,
    fct.total_sales_with_tax,
    fct.total_sales_with_tax_discounted,
    games.name AS game_name,
    games.description AS game_description,
    games.is_free AS game_is_free,
    games.fullgame_app_id,
    games.fullgame_name,
    games.type,
    games.genre_id,
    games.type_genre,
FROM
    game_sales AS fct
INNER JOIN
    `pristine-flames-400818`.`games`.`dim_games` AS games
ON
    fct.app_id = games.app_id
INNER JOIN 
    `pristine-flames-400818`.`games`.`dim_platforms` AS dp
ON
    fct.platform_id = dp.platform_id
    );
  
[0m19:09:29.598805 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e29af85d-1cd8-4994-8108-a44f69007ed1&page=queryresults
[0m19:09:32.603524 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 19:09:28.592034 => 19:09:32.603333
[0m19:09:32.604271 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e7714b6-6df7-482d-a3fe-8d8ca56aa810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f388a2490f0>]}
[0m19:09:32.604865 [info ] [Thread-1 (]: 8 of 12 OK created sql table model games.fct_game_pricing ...................... [[32mCREATE TABLE (5.1k rows, 437.2 KiB processed)[0m in 4.02s]
[0m19:09:32.605481 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m19:09:32.606499 [debug] [Thread-1 (]: Began running node model.games.revenue_by_platform_and_game
[0m19:09:32.607100 [info ] [Thread-1 (]: 9 of 12 START sql table model games.revenue_by_platform_and_game ............... [RUN]
[0m19:09:32.607795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.fct_game_pricing, now model.games.revenue_by_platform_and_game)
[0m19:09:32.608218 [debug] [Thread-1 (]: Began compiling node model.games.revenue_by_platform_and_game
[0m19:09:32.611397 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.revenue_by_platform_and_game"
[0m19:09:32.614026 [debug] [Thread-1 (]: Timing info for model.games.revenue_by_platform_and_game (compile): 19:09:32.608489 => 19:09:32.613723
[0m19:09:32.614595 [debug] [Thread-1 (]: Began executing node model.games.revenue_by_platform_and_game
[0m19:09:32.621437 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.revenue_by_platform_and_game"
[0m19:09:32.622155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:32.655424 [debug] [Thread-1 (]: On model.games.revenue_by_platform_and_game: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.revenue_by_platform_and_game"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`revenue_by_platform_and_game`
      
    
    

    OPTIONS()
    as (
      -- Informe de Ingresos por Plataforma
SELECT
    s.app_id,
    p.platform_id,
    s.total_sales,
    SUM(CASE WHEN p.windows = 1 THEN s.price_with_tax ELSE 0 END) AS total_sales_windows,
    SUM(CASE WHEN p.mac = 1 THEN s.price_with_tax ELSE 0 END) AS total_sales_mac,
    SUM(CASE WHEN p.linux = 1 THEN s.price_with_tax ELSE 0 END) AS total_sales_linux
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing` s
JOIN
    `pristine-flames-400818`.`games`.`dim_platforms` p ON s.platform_id = p.platform_id
GROUP BY
    s.app_id, p.platform_id, s.total_sales
ORDER BY
    total_sales DESC
    );
  
[0m19:09:33.583943 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:1574727c-6e71-46a2-b6f8-5b5212f7a947&page=queryresults
[0m19:09:36.325854 [debug] [Thread-1 (]: Timing info for model.games.revenue_by_platform_and_game (execute): 19:09:32.615008 => 19:09:36.325662
[0m19:09:36.326554 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e7714b6-6df7-482d-a3fe-8d8ca56aa810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f388a16c280>]}
[0m19:09:36.327114 [info ] [Thread-1 (]: 9 of 12 OK created sql table model games.revenue_by_platform_and_game .......... [[32mCREATE TABLE (5.1k rows, 163.1 KiB processed)[0m in 3.72s]
[0m19:09:36.327710 [debug] [Thread-1 (]: Finished running node model.games.revenue_by_platform_and_game
[0m19:09:36.328132 [debug] [Thread-1 (]: Began running node model.games.top_10_discounted_games
[0m19:09:36.328564 [info ] [Thread-1 (]: 10 of 12 START sql table model games.top_10_discounted_games ................... [RUN]
[0m19:09:36.329239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.revenue_by_platform_and_game, now model.games.top_10_discounted_games)
[0m19:09:36.329627 [debug] [Thread-1 (]: Began compiling node model.games.top_10_discounted_games
[0m19:09:36.332562 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_discounted_games"
[0m19:09:36.333221 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (compile): 19:09:36.329904 => 19:09:36.333023
[0m19:09:36.333594 [debug] [Thread-1 (]: Began executing node model.games.top_10_discounted_games
[0m19:09:36.336569 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_discounted_games"
[0m19:09:36.337094 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:36.369135 [debug] [Thread-1 (]: On model.games.top_10_discounted_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_discounted_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_discounted_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 descuentos más grandes
SELECT
    app_id,
    game_name,
    total_discounts
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY total_discounts DESC
LIMIT 10
    );
  
[0m19:09:37.261649 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:df3a1d35-3a2b-4333-bc6f-43f55b2c158f&page=queryresults
[0m19:09:39.916258 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (execute): 19:09:36.333853 => 19:09:39.916050
[0m19:09:39.918190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e7714b6-6df7-482d-a3fe-8d8ca56aa810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f388a120910>]}
[0m19:09:39.919057 [info ] [Thread-1 (]: 10 of 12 OK created sql table model games.top_10_discounted_games .............. [[32mCREATE TABLE (10.0 rows, 225.2 KiB processed)[0m in 3.59s]
[0m19:09:39.920078 [debug] [Thread-1 (]: Finished running node model.games.top_10_discounted_games
[0m19:09:39.920753 [debug] [Thread-1 (]: Began running node model.games.top_10_high_tax_games
[0m19:09:39.921477 [info ] [Thread-1 (]: 11 of 12 START sql table model games.top_10_high_tax_games ..................... [RUN]
[0m19:09:39.922468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_discounted_games, now model.games.top_10_high_tax_games)
[0m19:09:39.923067 [debug] [Thread-1 (]: Began compiling node model.games.top_10_high_tax_games
[0m19:09:39.928441 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_high_tax_games"
[0m19:09:39.929565 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (compile): 19:09:39.923437 => 19:09:39.929272
[0m19:09:39.930550 [debug] [Thread-1 (]: Began executing node model.games.top_10_high_tax_games
[0m19:09:39.934303 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_high_tax_games"
[0m19:09:39.934984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:39.970896 [debug] [Thread-1 (]: On model.games.top_10_high_tax_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_high_tax_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_high_tax_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos con más impuestos
SELECT
    app_id,
    game_name,
    SUM(total_sales_with_tax) AS total_taxes
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
GROUP BY app_id, game_name
ORDER BY total_taxes DESC, game_name DESC
LIMIT 10
    );
  
[0m19:09:40.789435 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c27f3f8a-c9b8-41f0-a533-d7b216b3791e&page=queryresults
[0m19:09:44.112785 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (execute): 19:09:39.930920 => 19:09:44.112594
[0m19:09:44.113667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e7714b6-6df7-482d-a3fe-8d8ca56aa810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f388a2490f0>]}
[0m19:09:44.114297 [info ] [Thread-1 (]: 11 of 12 OK created sql table model games.top_10_high_tax_games ................ [[32mCREATE TABLE (10.0 rows, 225.2 KiB processed)[0m in 4.19s]
[0m19:09:44.114941 [debug] [Thread-1 (]: Finished running node model.games.top_10_high_tax_games
[0m19:09:44.115488 [debug] [Thread-1 (]: Began running node model.games.top_10_most_expensive_games
[0m19:09:44.116046 [info ] [Thread-1 (]: 12 of 12 START sql table model games.top_10_most_expensive_games ............... [RUN]
[0m19:09:44.116779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_high_tax_games, now model.games.top_10_most_expensive_games)
[0m19:09:44.117209 [debug] [Thread-1 (]: Began compiling node model.games.top_10_most_expensive_games
[0m19:09:44.121887 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_most_expensive_games"
[0m19:09:44.122653 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (compile): 19:09:44.117474 => 19:09:44.122421
[0m19:09:44.123054 [debug] [Thread-1 (]: Began executing node model.games.top_10_most_expensive_games
[0m19:09:44.129641 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_most_expensive_games"
[0m19:09:44.130548 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:44.163596 [debug] [Thread-1 (]: On model.games.top_10_most_expensive_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_most_expensive_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_most_expensive_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos más caros
SELECT
    app_id,
    game_name,
    max_price,
    formatted_initial_price,
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY max_price DESC
LIMIT 10
    );
  
[0m19:09:45.126901 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:588eced3-a4b1-4e7a-b85c-e7253dc645e3&page=queryresults
[0m19:09:47.598634 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (execute): 19:09:44.123336 => 19:09:47.597760
[0m19:09:47.601812 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e7714b6-6df7-482d-a3fe-8d8ca56aa810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f388a15d960>]}
[0m19:09:47.604527 [info ] [Thread-1 (]: 12 of 12 OK created sql table model games.top_10_most_expensive_games .......... [[32mCREATE TABLE (10.0 rows, 289.7 KiB processed)[0m in 3.48s]
[0m19:09:47.607420 [debug] [Thread-1 (]: Finished running node model.games.top_10_most_expensive_games
[0m19:09:47.613253 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:09:47.615223 [debug] [MainThread]: Connection 'list_pristine-flames-400818' was properly closed.
[0m19:09:47.617005 [debug] [MainThread]: Connection 'model.games.top_10_most_expensive_games' was properly closed.
[0m19:09:47.618834 [info ] [MainThread]: 
[0m19:09:47.620586 [info ] [MainThread]: Finished running 12 table models in 0 hours 0 minutes and 47.87 seconds (47.87s).
[0m19:09:47.629960 [debug] [MainThread]: Command end result
[0m19:09:47.646737 [info ] [MainThread]: 
[0m19:09:47.647332 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:09:47.647811 [info ] [MainThread]: 
[0m19:09:47.648299 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m19:09:47.649063 [debug] [MainThread]: Command `dbt run` succeeded at 19:09:47.648925 after 49.25 seconds
[0m19:09:47.649569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f388eb31180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f388a190a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f388e3407f0>]}
[0m19:09:47.650098 [debug] [MainThread]: Flushing usage events
[0m19:11:11.261648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f479b335180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47994c4070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47994c40d0>]}


============================== 19:11:11.263850 | b817752c-daa6-446a-937d-050007e1e3c6 ==============================
[0m19:11:11.263850 [info ] [MainThread]: Running with dbt=1.6.5
[0m19:11:11.264357 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'profiles_dir': '../dbt/', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:11:11.542782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b817752c-daa6-446a-937d-050007e1e3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f479744abf0>]}
[0m19:11:11.558895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b817752c-daa6-446a-937d-050007e1e3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4797464640>]}
[0m19:11:11.559599 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m19:11:11.573147 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m19:11:11.639965 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:11:11.640565 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/dim_price_overview.sql
[0m19:11:11.684262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b817752c-daa6-446a-937d-050007e1e3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4796b5e470>]}
[0m19:11:11.693608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b817752c-daa6-446a-937d-050007e1e3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f479729ba30>]}
[0m19:11:11.694066 [info ] [MainThread]: Found 12 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m19:11:11.694412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b817752c-daa6-446a-937d-050007e1e3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f479729ba60>]}
[0m19:11:11.695904 [info ] [MainThread]: 
[0m19:11:11.696554 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:11:11.697992 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m19:11:11.698470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:11:12.455982 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m19:11:12.458060 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:11:13.140426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b817752c-daa6-446a-937d-050007e1e3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f479729a9e0>]}
[0m19:11:13.141213 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:11:13.141592 [info ] [MainThread]: 
[0m19:11:13.143606 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m19:11:13.144179 [info ] [Thread-1 (]: 1 of 12 START sql table model games.dim_developers ............................. [RUN]
[0m19:11:13.144910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m19:11:13.145337 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m19:11:13.152432 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m19:11:13.153516 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 19:11:13.145649 => 19:11:13.153234
[0m19:11:13.154092 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m19:11:13.170568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:11:13.848225 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m19:11:13.849030 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS developer_id,
    developers_name
FROM
    developers_cte
    );
  
[0m19:11:14.287144 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c21bbc96-244d-48a2-b58b-a1b48a85da85&page=queryresults
[0m19:11:17.294945 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 19:11:13.154464 => 19:11:17.294747
[0m19:11:17.295799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b817752c-daa6-446a-937d-050007e1e3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f479727ac80>]}
[0m19:11:17.296410 [info ] [Thread-1 (]: 1 of 12 OK created sql table model games.dim_developers ........................ [[32mCREATE TABLE (84.0 rows, 1.5 KiB processed)[0m in 4.15s]
[0m19:11:17.297038 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m19:11:17.297505 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m19:11:17.298018 [info ] [Thread-1 (]: 2 of 12 START sql table model games.dim_games .................................. [RUN]
[0m19:11:17.298785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m19:11:17.299274 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m19:11:17.308470 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m19:11:17.309681 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 19:11:17.299629 => 19:11:17.309365
[0m19:11:17.310304 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m19:11:17.313250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:11:17.879656 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m19:11:17.880414 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m19:11:18.306704 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:3e7fefc1-5a92-448d-8690-1acda0ae48f0&page=queryresults
[0m19:11:20.702346 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 19:11:17.310716 => 19:11:20.702155
[0m19:11:20.703188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b817752c-daa6-446a-937d-050007e1e3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4797278e50>]}
[0m19:11:20.703813 [info ] [Thread-1 (]: 2 of 12 OK created sql table model games.dim_games ............................. [[32mCREATE TABLE (87.0 rows, 24.3 KiB processed)[0m in 3.40s]
[0m19:11:20.704488 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m19:11:20.704961 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m19:11:20.705783 [info ] [Thread-1 (]: 3 of 12 START sql table model games.dim_platforms .............................. [RUN]
[0m19:11:20.706518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m19:11:20.706961 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m19:11:20.713627 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m19:11:20.714602 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 19:11:20.707274 => 19:11:20.714379
[0m19:11:20.715071 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m19:11:20.717570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:11:21.372425 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m19:11:21.375106 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m19:11:21.821708 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:907de968-3203-40a7-ab83-a27297675855&page=queryresults
[0m19:11:24.925561 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 19:11:20.715409 => 19:11:24.925374
[0m19:11:24.926397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b817752c-daa6-446a-937d-050007e1e3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4797278d60>]}
[0m19:11:24.926990 [info ] [Thread-1 (]: 3 of 12 OK created sql table model games.dim_platforms ......................... [[32mCREATE TABLE (87.0 rows, 2.0 KiB processed)[0m in 4.22s]
[0m19:11:24.927671 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m19:11:24.928120 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m19:11:24.928689 [info ] [Thread-1 (]: 4 of 12 START sql table model games.dim_price_overview ......................... [RUN]
[0m19:11:24.929374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m19:11:24.929781 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m19:11:24.932779 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m19:11:24.933507 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 19:11:24.930046 => 19:11:24.933234
[0m19:11:24.933912 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m19:11:24.936256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:11:25.587308 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m19:11:25.588093 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
   SELECT
    initial_price,
    final_price,
    discount_percent AS discount_pct,
    formatted_initial_price,
    formatted_final_price,
    app_id,
    -- Monto del Descuento formateado como decimal con dos decimales
    (
        CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END / 100
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (
        CASE
            WHEN discount_percent > 0 THEN initial_price * (1 - discount_percent / 100) * 1.75
            ELSE initial_price * 1.75
        END
    
    ) AS price_with_tax
    FROM 
        `pristine-flames-400818`.`games`.`raw_games`
)


SELECT
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', FORMAT("%'.2f", price_with_tax / 100)) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m19:11:26.139305 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d7e5bfcb-b5b0-4eea-b84d-f4fa8dd1fc9b&page=queryresults
[0m19:11:28.544058 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 19:11:24.934174 => 19:11:28.543876
[0m19:11:28.544842 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b817752c-daa6-446a-937d-050007e1e3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4796a66110>]}
[0m19:11:28.545430 [info ] [Thread-1 (]: 4 of 12 OK created sql table model games.dim_price_overview .................... [[32mCREATE TABLE (59.0 rows, 4.2 KiB processed)[0m in 3.62s]
[0m19:11:28.546018 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m19:11:28.546449 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m19:11:28.547056 [info ] [Thread-1 (]: 5 of 12 START sql table model games.dim_publishers ............................. [RUN]
[0m19:11:28.547742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m19:11:28.548154 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m19:11:28.550986 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m19:11:28.551655 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 19:11:28.548433 => 19:11:28.551442
[0m19:11:28.552035 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m19:11:28.554271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:11:29.209205 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m19:11:29.210122 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m19:11:29.639677 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:5fbfbc90-e6a6-4708-9a02-54fd7a496e72&page=queryresults
[0m19:11:32.759854 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 19:11:28.552304 => 19:11:32.759661
[0m19:11:32.760568 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b817752c-daa6-446a-937d-050007e1e3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4796a54d00>]}
[0m19:11:32.761137 [info ] [Thread-1 (]: 5 of 12 OK created sql table model games.dim_publishers ........................ [[32mCREATE TABLE (67.0 rows, 1.3 KiB processed)[0m in 4.21s]
[0m19:11:32.761784 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m19:11:32.762218 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m19:11:32.762735 [info ] [Thread-1 (]: 6 of 12 START sql table model games.dim_release ................................ [RUN]
[0m19:11:32.763368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m19:11:32.763746 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m19:11:32.766534 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m19:11:32.767151 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 19:11:32.764014 => 19:11:32.766951
[0m19:11:32.767521 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m19:11:32.769644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:11:33.480962 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m19:11:33.483741 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m19:11:34.030311 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:0fd316d8-16d2-49ec-98ac-356e44b8ebe0&page=queryresults
[0m19:11:36.810172 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 19:11:32.767788 => 19:11:36.809987
[0m19:11:36.810950 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b817752c-daa6-446a-937d-050007e1e3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4796a54fa0>]}
[0m19:11:36.811509 [info ] [Thread-1 (]: 6 of 12 OK created sql table model games.dim_release ........................... [[32mCREATE TABLE (87.0 rows, 1.8 KiB processed)[0m in 4.05s]
[0m19:11:36.812079 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m19:11:36.812523 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m19:11:36.813028 [info ] [Thread-1 (]: 7 of 12 START sql table model games.dim_support_language ....................... [RUN]
[0m19:11:36.813668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m19:11:36.814034 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m19:11:36.816825 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m19:11:36.817427 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 19:11:36.814293 => 19:11:36.817240
[0m19:11:36.817791 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m19:11:36.825123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:11:37.651925 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m19:11:37.654940 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m19:11:38.221421 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7b2c582b-85b7-473a-b190-e80d9e5d846f&page=queryresults
[0m19:11:41.041418 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 19:11:36.818047 => 19:11:41.041231
[0m19:11:41.042252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b817752c-daa6-446a-937d-050007e1e3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4796a84c10>]}
[0m19:11:41.042846 [info ] [Thread-1 (]: 7 of 12 OK created sql table model games.dim_support_language .................. [[32mCREATE TABLE (87.0 rows, 10.5 KiB processed)[0m in 4.23s]
[0m19:11:41.043498 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m19:11:41.043975 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m19:11:41.044523 [info ] [Thread-1 (]: 8 of 12 START sql table model games.fct_game_pricing ........................... [RUN]
[0m19:11:41.045211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m19:11:41.045609 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m19:11:41.048916 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m19:11:41.049609 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 19:11:41.045871 => 19:11:41.049381
[0m19:11:41.050017 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m19:11:41.052443 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:11:41.738356 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m19:11:41.739116 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para el análisis de precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        formatted_initial_price,
        platform_id,
        formatted_price_with_tax,
        price_with_tax,
        SUM(price_with_tax) AS total_sales,
        SUM(discount_amount) AS total_discounts,
        COUNT(*) AS num_sales,
        MAX(discount_pct) AS max_discount,
        MIN(initial_price) AS min_price,
        MAX(initial_price) AS max_price,
        SUM(price_with_tax) AS total_sales_with_tax,
        SUM(final_price) AS total_sales_with_tax_discounted
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id, platform_id, formatted_initial_price, formatted_price_with_tax, price_with_tax
)

SELECT
    fct.app_id,
    fct.formatted_initial_price,
    fct.total_sales,
    fct.platform_id,
    fct.formatted_price_with_tax,
    fct.total_discounts,
    fct.price_with_tax,
    fct.num_sales,
    fct.max_discount,
    fct.min_price,
    fct.max_price,
    fct.total_sales_with_tax,
    fct.total_sales_with_tax_discounted,
    games.name AS game_name,
    games.description AS game_description,
    games.is_free AS game_is_free,
    games.fullgame_app_id,
    games.fullgame_name,
    games.type,
    games.genre_id,
    games.type_genre,
FROM
    game_sales AS fct
INNER JOIN
    `pristine-flames-400818`.`games`.`dim_games` AS games
ON
    fct.app_id = games.app_id
INNER JOIN 
    `pristine-flames-400818`.`games`.`dim_platforms` AS dp
ON
    fct.platform_id = dp.platform_id
    );
  
[0m19:11:42.448426 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:1c3ce957-fcba-4f3a-9e12-c50010a06504&page=queryresults
[0m19:11:42.906205 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: platform_id at [20:9]')
[0m19:11:43.973288 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d4bae134-70e3-4520-9649-cc77f089e43e&page=queryresults
[0m19:11:44.443064 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d4bae134-70e3-4520-9649-cc77f089e43e&page=queryresults
[0m19:11:44.444596 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 19:11:41.050283 => 19:11:44.444146
[0m19:11:44.461828 [debug] [Thread-1 (]: Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Unrecognized name: platform_id at [20:9]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m19:11:44.464029 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b817752c-daa6-446a-937d-050007e1e3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4796a87910>]}
[0m19:11:44.466644 [error] [Thread-1 (]: 8 of 12 ERROR creating sql table model games.fct_game_pricing .................. [[31mERROR[0m in 3.42s]
[0m19:11:44.469472 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m19:11:44.473216 [debug] [Thread-1 (]: Began running node model.games.revenue_by_platform_and_game
[0m19:11:44.475502 [info ] [Thread-1 (]: 9 of 12 SKIP relation games.revenue_by_platform_and_game ....................... [[33mSKIP[0m]
[0m19:11:44.477709 [debug] [Thread-1 (]: Finished running node model.games.revenue_by_platform_and_game
[0m19:11:44.479807 [debug] [Thread-1 (]: Began running node model.games.top_10_discounted_games
[0m19:11:44.481801 [info ] [Thread-1 (]: 10 of 12 SKIP relation games.top_10_discounted_games ........................... [[33mSKIP[0m]
[0m19:11:44.484344 [debug] [Thread-1 (]: Finished running node model.games.top_10_discounted_games
[0m19:11:44.486473 [debug] [Thread-1 (]: Began running node model.games.top_10_high_tax_games
[0m19:11:44.488861 [info ] [Thread-1 (]: 11 of 12 SKIP relation games.top_10_high_tax_games ............................. [[33mSKIP[0m]
[0m19:11:44.491044 [debug] [Thread-1 (]: Finished running node model.games.top_10_high_tax_games
[0m19:11:44.493157 [debug] [Thread-1 (]: Began running node model.games.top_10_most_expensive_games
[0m19:11:44.495333 [info ] [Thread-1 (]: 12 of 12 SKIP relation games.top_10_most_expensive_games ....................... [[33mSKIP[0m]
[0m19:11:44.497614 [debug] [Thread-1 (]: Finished running node model.games.top_10_most_expensive_games
[0m19:11:44.503880 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:11:44.505445 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m19:11:44.506672 [info ] [MainThread]: 
[0m19:11:44.507901 [info ] [MainThread]: Finished running 12 table models in 0 hours 0 minutes and 32.81 seconds (32.81s).
[0m19:11:44.512842 [debug] [MainThread]: Command end result
[0m19:11:44.528214 [info ] [MainThread]: 
[0m19:11:44.528799 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:11:44.529261 [info ] [MainThread]: 
[0m19:11:44.529717 [error] [MainThread]:   Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Unrecognized name: platform_id at [20:9]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m19:11:44.530203 [info ] [MainThread]: 
[0m19:11:44.530647 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=4 TOTAL=12
[0m19:11:44.531324 [debug] [MainThread]: Command `dbt run` failed at 19:11:44.531204 after 33.28 seconds
[0m19:11:44.531794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f479b335180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4797464640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4796a86470>]}
[0m19:11:44.532255 [debug] [MainThread]: Flushing usage events
[0m20:21:04.402578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e62211b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e43b4070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e43b40d0>]}


============================== 20:21:04.407114 | 6cb63742-eace-4337-bb3b-dc0cacd2324f ==============================
[0m20:21:04.407114 [info ] [MainThread]: Running with dbt=1.6.5
[0m20:21:04.407710 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:21:04.896296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6cb63742-eace-4337-bb3b-dc0cacd2324f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e58593f0>]}
[0m20:21:04.912880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6cb63742-eace-4337-bb3b-dc0cacd2324f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e23509d0>]}
[0m20:21:04.913744 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m20:21:04.928440 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m20:21:05.014535 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:21:05.014926 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:21:05.020735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6cb63742-eace-4337-bb3b-dc0cacd2324f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e21bc0d0>]}
[0m20:21:05.031796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6cb63742-eace-4337-bb3b-dc0cacd2324f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e21879a0>]}
[0m20:21:05.032434 [info ] [MainThread]: Found 12 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m20:21:05.032922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cb63742-eace-4337-bb3b-dc0cacd2324f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e21879d0>]}
[0m20:21:05.035623 [info ] [MainThread]: 
[0m20:21:05.036629 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:21:05.039537 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m20:21:05.040110 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:21:06.064129 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m20:21:06.064974 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:21:06.745076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cb63742-eace-4337-bb3b-dc0cacd2324f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e438feb0>]}
[0m20:21:06.745803 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:21:06.746158 [info ] [MainThread]: 
[0m20:21:06.747908 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m20:21:06.748382 [info ] [Thread-1 (]: 1 of 12 START sql table model games.dim_developers ............................. [RUN]
[0m20:21:06.748988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m20:21:06.749351 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m20:21:06.756721 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m20:21:06.757681 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 20:21:06.749610 => 20:21:06.757469
[0m20:21:06.758057 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m20:21:06.771181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:07.546770 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m20:21:07.548081 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS developer_id,
    developers_name
FROM
    developers_cte
    );
  
[0m20:21:08.267937 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:45a8fd8a-3243-48b4-8047-06eb40c57469&page=queryresults
[0m20:21:10.848505 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 20:21:06.758316 => 20:21:10.848183
[0m20:21:10.850655 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cb63742-eace-4337-bb3b-dc0cacd2324f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e2162590>]}
[0m20:21:10.851566 [info ] [Thread-1 (]: 1 of 12 OK created sql table model games.dim_developers ........................ [[32mCREATE TABLE (84.0 rows, 1.5 KiB processed)[0m in 4.10s]
[0m20:21:10.852437 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m20:21:10.853067 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m20:21:10.853828 [info ] [Thread-1 (]: 2 of 12 START sql table model games.dim_games .................................. [RUN]
[0m20:21:10.854733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m20:21:10.855268 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m20:21:10.859249 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m20:21:10.860202 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 20:21:10.855690 => 20:21:10.859899
[0m20:21:10.860755 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m20:21:10.870183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:11.616689 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m20:21:11.617431 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m20:21:12.091730 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f3bc69c4-8d8a-46c9-b24f-f1420764b6ea&page=queryresults
[0m20:21:14.551561 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 20:21:10.861158 => 20:21:14.550804
[0m20:21:14.553807 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cb63742-eace-4337-bb3b-dc0cacd2324f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e21abf70>]}
[0m20:21:14.555633 [info ] [Thread-1 (]: 2 of 12 OK created sql table model games.dim_games ............................. [[32mCREATE TABLE (87.0 rows, 24.3 KiB processed)[0m in 3.70s]
[0m20:21:14.557587 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m20:21:14.558983 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m20:21:14.560639 [info ] [Thread-1 (]: 3 of 12 START sql table model games.dim_platforms .............................. [RUN]
[0m20:21:14.562784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m20:21:14.564155 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m20:21:14.572463 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m20:21:14.573958 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 20:21:14.565091 => 20:21:14.573478
[0m20:21:14.574886 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m20:21:14.579449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:15.290334 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m20:21:15.290995 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m20:21:15.728011 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:8ca26cd9-3af4-4b79-8d9b-75ab9253fae4&page=queryresults
[0m20:21:18.488481 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 20:21:14.575563 => 20:21:18.488271
[0m20:21:18.489317 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cb63742-eace-4337-bb3b-dc0cacd2324f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e21ad540>]}
[0m20:21:18.489952 [info ] [Thread-1 (]: 3 of 12 OK created sql table model games.dim_platforms ......................... [[32mCREATE TABLE (87.0 rows, 2.0 KiB processed)[0m in 3.93s]
[0m20:21:18.490599 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m20:21:18.491155 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m20:21:18.491753 [info ] [Thread-1 (]: 4 of 12 START sql table model games.dim_price_overview ......................... [RUN]
[0m20:21:18.493093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m20:21:18.493653 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m20:21:18.497148 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m20:21:18.547934 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 20:21:18.494071 => 20:21:18.547633
[0m20:21:18.553536 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m20:21:18.556188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:19.421928 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m20:21:19.428497 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
   SELECT
    initial_price,
    final_price,
    discount_percent AS discount_pct,
    formatted_initial_price,
    formatted_final_price,
    app_id,
    -- Monto del Descuento formateado como decimal con dos decimales
    (
        CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END / 100
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (
        CASE
            WHEN discount_percent > 0 THEN initial_price * (1 - discount_percent / 100) * 1.75
            ELSE initial_price * 1.75
        END
    
    ) AS price_with_tax
    FROM 
        `pristine-flames-400818`.`games`.`raw_games`
)


SELECT
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', FORMAT("%'.2f", price_with_tax / 100)) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m20:21:19.989497 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:002b4b35-e88c-4517-832d-066dd5ea1563&page=queryresults
[0m20:21:22.443569 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 20:21:18.553963 => 20:21:22.442911
[0m20:21:22.445998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cb63742-eace-4337-bb3b-dc0cacd2324f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e2051750>]}
[0m20:21:22.447906 [info ] [Thread-1 (]: 4 of 12 OK created sql table model games.dim_price_overview .................... [[32mCREATE TABLE (59.0 rows, 4.2 KiB processed)[0m in 3.95s]
[0m20:21:22.449879 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m20:21:22.451366 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m20:21:22.453580 [info ] [Thread-1 (]: 5 of 12 START sql table model games.dim_publishers ............................. [RUN]
[0m20:21:22.456762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m20:21:22.458463 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m20:21:22.478356 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m20:21:22.479537 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 20:21:22.461419 => 20:21:22.479175
[0m20:21:22.480133 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m20:21:22.485111 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:23.237431 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m20:21:23.238093 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m20:21:23.693179 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:b8d528ba-e32d-4130-8b2d-cef689a6f637&page=queryresults
[0m20:21:26.395353 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 20:21:22.481875 => 20:21:26.395153
[0m20:21:26.396147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cb63742-eace-4337-bb3b-dc0cacd2324f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e21608e0>]}
[0m20:21:26.396706 [info ] [Thread-1 (]: 5 of 12 OK created sql table model games.dim_publishers ........................ [[32mCREATE TABLE (67.0 rows, 1.3 KiB processed)[0m in 3.94s]
[0m20:21:26.397343 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m20:21:26.397784 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m20:21:26.398253 [info ] [Thread-1 (]: 6 of 12 START sql table model games.dim_release ................................ [RUN]
[0m20:21:26.399022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m20:21:26.399496 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m20:21:26.402726 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m20:21:26.403492 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 20:21:26.399780 => 20:21:26.403241
[0m20:21:26.403887 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m20:21:26.406401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:27.083532 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m20:21:27.084353 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m20:21:27.621255 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:3a981ac3-44e7-4922-a430-c5d5fe851b4e&page=queryresults
[0m20:21:30.054300 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 20:21:26.404168 => 20:21:30.054090
[0m20:21:30.055536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cb63742-eace-4337-bb3b-dc0cacd2324f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e2351a50>]}
[0m20:21:30.056385 [info ] [Thread-1 (]: 6 of 12 OK created sql table model games.dim_release ........................... [[32mCREATE TABLE (87.0 rows, 1.8 KiB processed)[0m in 3.66s]
[0m20:21:30.057201 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m20:21:30.057836 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m20:21:30.058467 [info ] [Thread-1 (]: 7 of 12 START sql table model games.dim_support_language ....................... [RUN]
[0m20:21:30.059319 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m20:21:30.060069 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m20:21:30.064603 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m20:21:30.065707 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 20:21:30.060505 => 20:21:30.065425
[0m20:21:30.066266 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m20:21:30.072002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:30.776594 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m20:21:30.777644 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m20:21:31.213868 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d4bf0862-7a8b-4c94-b7c2-e94d3ba96c8c&page=queryresults
[0m20:21:33.929021 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 20:21:30.066700 => 20:21:33.928822
[0m20:21:33.929770 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cb63742-eace-4337-bb3b-dc0cacd2324f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e20f5870>]}
[0m20:21:33.930357 [info ] [Thread-1 (]: 7 of 12 OK created sql table model games.dim_support_language .................. [[32mCREATE TABLE (87.0 rows, 10.5 KiB processed)[0m in 3.87s]
[0m20:21:33.931483 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m20:21:33.932073 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m20:21:33.932703 [info ] [Thread-1 (]: 8 of 12 START sql table model games.fct_game_pricing ........................... [RUN]
[0m20:21:33.933587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m20:21:33.934118 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m20:21:33.937851 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m20:21:33.938905 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 20:21:33.934472 => 20:21:33.938651
[0m20:21:33.939396 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m20:21:33.942692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:34.649470 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m20:21:34.650219 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para el análisis de precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        formatted_initial_price,
        platform_id,
        formatted_price_with_tax,
        price_with_tax,
        SUM(price_with_tax) AS total_sales,
        SUM(discount_amount) AS total_discounts,
        COUNT(*) AS num_sales,
        MAX(discount_pct) AS max_discount,
        MIN(initial_price) AS min_price,
        MAX(initial_price) AS max_price,
        SUM(price_with_tax) AS total_sales_with_tax,
        SUM(final_price) AS total_sales_with_tax_discounted
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id, platform_id, formatted_initial_price, formatted_price_with_tax, price_with_tax
)

SELECT
    fct.app_id,
    fct.formatted_initial_price,
    fct.total_sales,
    fct.platform_id,
    fct.formatted_price_with_tax,
    fct.total_discounts,
    fct.price_with_tax,
    fct.num_sales,
    fct.max_discount,
    fct.min_price,
    fct.max_price,
    fct.total_sales_with_tax,
    fct.total_sales_with_tax_discounted,
    games.name AS game_name,
    games.description AS game_description,
    games.is_free AS game_is_free,
    games.fullgame_app_id,
    games.fullgame_name,
    games.type,
    games.genre_id,
    games.type_genre,
FROM
    game_sales AS fct
INNER JOIN
    `pristine-flames-400818`.`games`.`dim_games` AS games
ON
    fct.app_id = games.app_id
INNER JOIN 
    `pristine-flames-400818`.`games`.`dim_platforms` AS dp
ON
    fct.platform_id = dp.platform_id
    );
  
[0m20:21:35.308183 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:61a06de8-ece4-4d33-8cf4-1b732b6f098d&page=queryresults
[0m20:21:35.829279 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: platform_id at [20:9]')
[0m20:21:36.484321 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:90cd3a60-bb72-44ce-91eb-5c9be19a2334&page=queryresults
[0m20:21:36.962923 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:90cd3a60-bb72-44ce-91eb-5c9be19a2334&page=queryresults
[0m20:21:36.964302 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 20:21:33.939727 => 20:21:36.963900
[0m20:21:36.978260 [debug] [Thread-1 (]: Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Unrecognized name: platform_id at [20:9]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m20:21:36.979701 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cb63742-eace-4337-bb3b-dc0cacd2324f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e20e4e20>]}
[0m20:21:36.981396 [error] [Thread-1 (]: 8 of 12 ERROR creating sql table model games.fct_game_pricing .................. [[31mERROR[0m in 3.05s]
[0m20:21:36.983113 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m20:21:36.985279 [debug] [Thread-1 (]: Began running node model.games.revenue_by_platform_and_game
[0m20:21:36.986784 [info ] [Thread-1 (]: 9 of 12 SKIP relation games.revenue_by_platform_and_game ....................... [[33mSKIP[0m]
[0m20:21:36.988106 [debug] [Thread-1 (]: Finished running node model.games.revenue_by_platform_and_game
[0m20:21:36.989301 [debug] [Thread-1 (]: Began running node model.games.top_10_discounted_games
[0m20:21:36.990686 [info ] [Thread-1 (]: 10 of 12 SKIP relation games.top_10_discounted_games ........................... [[33mSKIP[0m]
[0m20:21:36.992028 [debug] [Thread-1 (]: Finished running node model.games.top_10_discounted_games
[0m20:21:36.993279 [debug] [Thread-1 (]: Began running node model.games.top_10_high_tax_games
[0m20:21:36.994663 [info ] [Thread-1 (]: 11 of 12 SKIP relation games.top_10_high_tax_games ............................. [[33mSKIP[0m]
[0m20:21:36.996075 [debug] [Thread-1 (]: Finished running node model.games.top_10_high_tax_games
[0m20:21:36.997304 [debug] [Thread-1 (]: Began running node model.games.top_10_most_expensive_games
[0m20:21:36.998700 [info ] [Thread-1 (]: 12 of 12 SKIP relation games.top_10_most_expensive_games ....................... [[33mSKIP[0m]
[0m20:21:36.999995 [debug] [Thread-1 (]: Finished running node model.games.top_10_most_expensive_games
[0m20:21:37.004581 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:21:37.005594 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m20:21:37.006622 [info ] [MainThread]: 
[0m20:21:37.007650 [info ] [MainThread]: Finished running 12 table models in 0 hours 0 minutes and 31.97 seconds (31.97s).
[0m20:21:37.012462 [debug] [MainThread]: Command end result
[0m20:21:37.029670 [info ] [MainThread]: 
[0m20:21:37.030245 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:21:37.030812 [info ] [MainThread]: 
[0m20:21:37.031319 [error] [MainThread]:   Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Unrecognized name: platform_id at [20:9]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m20:21:37.031784 [info ] [MainThread]: 
[0m20:21:37.032275 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=4 TOTAL=12
[0m20:21:37.033033 [debug] [MainThread]: Command `dbt run` failed at 20:21:37.032897 after 32.64 seconds
[0m20:21:37.033509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e62211b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e5858e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e2054df0>]}
[0m20:21:37.033969 [debug] [MainThread]: Flushing usage events
[0m20:22:38.309897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba59f091b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba58164070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba581640d0>]}


============================== 20:22:38.312874 | 894d61e8-8aeb-4577-8ef9-051fe3d1c531 ==============================
[0m20:22:38.312874 [info ] [MainThread]: Running with dbt=1.6.5
[0m20:22:38.313414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '../dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'send_anonymous_usage_stats': 'True'}
[0m20:22:38.609385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '894d61e8-8aeb-4577-8ef9-051fe3d1c531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba5942d3f0>]}
[0m20:22:38.624889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '894d61e8-8aeb-4577-8ef9-051fe3d1c531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba55f049d0>]}
[0m20:22:38.625471 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m20:22:38.638945 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m20:22:38.704527 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:22:38.705127 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m20:22:38.749869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '894d61e8-8aeb-4577-8ef9-051fe3d1c531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba55dde2f0>]}
[0m20:22:38.759557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '894d61e8-8aeb-4577-8ef9-051fe3d1c531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba55d3b9d0>]}
[0m20:22:38.760115 [info ] [MainThread]: Found 12 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m20:22:38.760572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '894d61e8-8aeb-4577-8ef9-051fe3d1c531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba55d3b970>]}
[0m20:22:38.762275 [info ] [MainThread]: 
[0m20:22:38.763205 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:22:38.764907 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m20:22:38.765534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:22:39.487384 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m20:22:39.487937 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:22:40.175415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '894d61e8-8aeb-4577-8ef9-051fe3d1c531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba55d39270>]}
[0m20:22:40.176209 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:22:40.176608 [info ] [MainThread]: 
[0m20:22:40.178787 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m20:22:40.179303 [info ] [Thread-1 (]: 1 of 12 START sql table model games.dim_developers ............................. [RUN]
[0m20:22:40.179954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m20:22:40.180344 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m20:22:40.187505 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m20:22:40.188411 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 20:22:40.180620 => 20:22:40.188129
[0m20:22:40.188863 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m20:22:40.201889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:22:40.968379 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m20:22:40.969188 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS developer_id,
    developers_name
FROM
    developers_cte
    );
  
[0m20:22:41.553785 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:411ed51e-6b3e-4860-8d06-b05fd2096cb1&page=queryresults
[0m20:22:44.056827 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 20:22:40.189145 => 20:22:44.056513
[0m20:22:44.057954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '894d61e8-8aeb-4577-8ef9-051fe3d1c531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba55d1ab60>]}
[0m20:22:44.058864 [info ] [Thread-1 (]: 1 of 12 OK created sql table model games.dim_developers ........................ [[32mCREATE TABLE (84.0 rows, 1.5 KiB processed)[0m in 3.88s]
[0m20:22:44.059812 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m20:22:44.060419 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m20:22:44.061146 [info ] [Thread-1 (]: 2 of 12 START sql table model games.dim_games .................................. [RUN]
[0m20:22:44.062010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m20:22:44.062541 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m20:22:44.072100 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m20:22:44.073037 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 20:22:44.062919 => 20:22:44.072792
[0m20:22:44.073466 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m20:22:44.075974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:22:44.816405 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m20:22:44.819165 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m20:22:45.357542 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:435b2c38-b15d-42cc-98c8-91621b2ef395&page=queryresults
[0m20:22:47.751206 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 20:22:44.073760 => 20:22:47.750970
[0m20:22:47.752034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '894d61e8-8aeb-4577-8ef9-051fe3d1c531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba55d18d60>]}
[0m20:22:47.752618 [info ] [Thread-1 (]: 2 of 12 OK created sql table model games.dim_games ............................. [[32mCREATE TABLE (87.0 rows, 24.3 KiB processed)[0m in 3.69s]
[0m20:22:47.753251 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m20:22:47.753698 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m20:22:47.754179 [info ] [Thread-1 (]: 3 of 12 START sql table model games.dim_platforms .............................. [RUN]
[0m20:22:47.754869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m20:22:47.755398 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m20:22:47.758153 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m20:22:47.758833 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 20:22:47.755672 => 20:22:47.758613
[0m20:22:47.759263 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m20:22:47.761766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:22:48.508897 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m20:22:48.509633 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m20:22:49.051180 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:45ed8bad-143c-4ac3-8226-e9098532999b&page=queryresults
[0m20:22:51.748360 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 20:22:47.759526 => 20:22:51.747962
[0m20:22:51.749760 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '894d61e8-8aeb-4577-8ef9-051fe3d1c531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba556cff40>]}
[0m20:22:51.750709 [info ] [Thread-1 (]: 3 of 12 OK created sql table model games.dim_platforms ......................... [[32mCREATE TABLE (87.0 rows, 2.0 KiB processed)[0m in 4.00s]
[0m20:22:51.751719 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m20:22:51.752488 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m20:22:51.753273 [info ] [Thread-1 (]: 4 of 12 START sql table model games.dim_price_overview ......................... [RUN]
[0m20:22:51.760443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m20:22:51.761042 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m20:22:51.764920 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m20:22:51.766180 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 20:22:51.761448 => 20:22:51.765887
[0m20:22:51.766773 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m20:22:51.769637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:22:52.515657 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m20:22:52.518516 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
   SELECT
    initial_price,
    final_price,
    discount_percent AS discount_pct,
    formatted_initial_price,
    formatted_final_price,
    app_id,
    -- Monto del Descuento formateado como decimal con dos decimales
    (
        CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END / 100
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (
        CASE
            WHEN discount_percent > 0 THEN initial_price * (1 - discount_percent / 100) * 1.75
            ELSE initial_price * 1.75
        END
    
    ) AS price_with_tax
    FROM 
        `pristine-flames-400818`.`games`.`raw_games`
)


SELECT
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', FORMAT("%'.2f", price_with_tax / 100)) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m20:22:53.047574 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:653681b5-9cea-4851-9606-247bc6839163&page=queryresults
[0m20:22:55.843047 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 20:22:51.767169 => 20:22:55.842139
[0m20:22:55.846217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '894d61e8-8aeb-4577-8ef9-051fe3d1c531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba5550a2f0>]}
[0m20:22:55.848837 [info ] [Thread-1 (]: 4 of 12 OK created sql table model games.dim_price_overview .................... [[32mCREATE TABLE (59.0 rows, 4.2 KiB processed)[0m in 4.09s]
[0m20:22:55.851692 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m20:22:55.853753 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m20:22:55.856517 [info ] [Thread-1 (]: 5 of 12 START sql table model games.dim_publishers ............................. [RUN]
[0m20:22:55.859495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m20:22:55.861336 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m20:22:55.873926 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m20:22:55.876862 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 20:22:55.862640 => 20:22:55.875911
[0m20:22:55.878724 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m20:22:55.887839 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:22:56.683302 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m20:22:56.685996 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m20:22:57.243024 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:6ecdb6df-e70b-480b-8a93-58a47a3ed997&page=queryresults
[0m20:23:00.269652 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 20:22:55.880083 => 20:23:00.268746
[0m20:23:00.272783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '894d61e8-8aeb-4577-8ef9-051fe3d1c531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba556f0c40>]}
[0m20:23:00.275408 [info ] [Thread-1 (]: 5 of 12 OK created sql table model games.dim_publishers ........................ [[32mCREATE TABLE (67.0 rows, 1.3 KiB processed)[0m in 4.41s]
[0m20:23:00.278260 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m20:23:00.280336 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m20:23:00.282764 [info ] [Thread-1 (]: 6 of 12 START sql table model games.dim_release ................................ [RUN]
[0m20:23:00.285724 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m20:23:00.287596 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m20:23:00.298690 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m20:23:00.300499 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 20:23:00.288914 => 20:23:00.300000
[0m20:23:00.301507 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m20:23:00.306526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:01.069951 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m20:23:01.070746 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m20:23:01.611028 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:a64acd31-fec9-4f75-9fe1-6967ffd375c3&page=queryresults
[0m20:23:04.366430 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 20:23:00.302188 => 20:23:04.366172
[0m20:23:04.367406 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '894d61e8-8aeb-4577-8ef9-051fe3d1c531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba556f0fd0>]}
[0m20:23:04.368163 [info ] [Thread-1 (]: 6 of 12 OK created sql table model games.dim_release ........................... [[32mCREATE TABLE (87.0 rows, 1.8 KiB processed)[0m in 4.08s]
[0m20:23:04.368978 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m20:23:04.369580 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m20:23:04.370354 [info ] [Thread-1 (]: 7 of 12 START sql table model games.dim_support_language ....................... [RUN]
[0m20:23:04.371367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m20:23:04.371950 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m20:23:04.376084 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m20:23:04.377003 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 20:23:04.372364 => 20:23:04.376708
[0m20:23:04.377570 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m20:23:04.387697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:05.139530 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m20:23:05.142271 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m20:23:05.722378 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e2b295b7-2802-43c8-be91-974b7fa7b896&page=queryresults
[0m20:23:08.153299 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 20:23:04.377988 => 20:23:08.152415
[0m20:23:08.156424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '894d61e8-8aeb-4577-8ef9-051fe3d1c531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba55528160>]}
[0m20:23:08.158992 [info ] [Thread-1 (]: 7 of 12 OK created sql table model games.dim_support_language .................. [[32mCREATE TABLE (87.0 rows, 10.5 KiB processed)[0m in 3.79s]
[0m20:23:08.161851 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m20:23:08.163945 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m20:23:08.165819 [info ] [Thread-1 (]: 8 of 12 START sql table model games.fct_game_pricing ........................... [RUN]
[0m20:23:08.167900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m20:23:08.169168 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m20:23:08.176303 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m20:23:08.177590 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 20:23:08.169962 => 20:23:08.177192
[0m20:23:08.178346 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m20:23:08.182250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:08.913985 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m20:23:08.914793 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para el análisis de precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        formatted_initial_price,
        platform_id,
        formatted_price_with_tax,
        price_with_tax,
        SUM(price_with_tax) AS total_sales,
        SUM(discount_amount) AS total_discounts,
        COUNT(*) AS num_sales,
        MAX(discount_pct) AS max_discount,
        MIN(initial_price) AS min_price,
        MAX(initial_price) AS max_price,
        SUM(price_with_tax) AS total_sales_with_tax,
        SUM(final_price) AS total_sales_with_tax_discounted
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id, platform_id, formatted_initial_price, formatted_price_with_tax, price_with_tax
)

SELECT
    fct.app_id,
    fct.formatted_initial_price,
    fct.total_sales,
    fct.platform_id,
    fct.formatted_price_with_tax,
    fct.total_discounts,
    fct.price_with_tax,
    fct.num_sales,
    fct.max_discount,
    fct.min_price,
    fct.max_price,
    fct.total_sales_with_tax,
    fct.total_sales_with_tax_discounted,
    games.name AS game_name,
    games.description AS game_description,
    games.is_free AS game_is_free,
    games.fullgame_app_id,
    games.fullgame_name,
    games.type,
    games.genre_id,
    games.type_genre,
FROM
    game_sales AS fct
INNER JOIN
    `pristine-flames-400818`.`games`.`dim_games` AS games
ON
    fct.app_id = games.app_id
    );
  
[0m20:23:09.460620 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:4b603826-b11a-45b3-837c-615d0bebcc60&page=queryresults
[0m20:23:09.915969 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: platform_id at [20:9]')
[0m20:23:11.154576 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:2c888c0c-49f6-4add-8225-e01f3a1ce6e1&page=queryresults
[0m20:23:11.619370 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:2c888c0c-49f6-4add-8225-e01f3a1ce6e1&page=queryresults
[0m20:23:11.620160 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 20:23:08.178882 => 20:23:11.619960
[0m20:23:11.622968 [debug] [Thread-1 (]: Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Unrecognized name: platform_id at [20:9]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m20:23:11.623514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '894d61e8-8aeb-4577-8ef9-051fe3d1c531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba55527e20>]}
[0m20:23:11.624104 [error] [Thread-1 (]: 8 of 12 ERROR creating sql table model games.fct_game_pricing .................. [[31mERROR[0m in 3.46s]
[0m20:23:11.624731 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m20:23:11.625663 [debug] [Thread-1 (]: Began running node model.games.revenue_by_platform_and_game
[0m20:23:11.626117 [info ] [Thread-1 (]: 9 of 12 SKIP relation games.revenue_by_platform_and_game ....................... [[33mSKIP[0m]
[0m20:23:11.626613 [debug] [Thread-1 (]: Finished running node model.games.revenue_by_platform_and_game
[0m20:23:11.627062 [debug] [Thread-1 (]: Began running node model.games.top_10_discounted_games
[0m20:23:11.627591 [info ] [Thread-1 (]: 10 of 12 SKIP relation games.top_10_discounted_games ........................... [[33mSKIP[0m]
[0m20:23:11.628084 [debug] [Thread-1 (]: Finished running node model.games.top_10_discounted_games
[0m20:23:11.628521 [debug] [Thread-1 (]: Began running node model.games.top_10_high_tax_games
[0m20:23:11.629035 [info ] [Thread-1 (]: 11 of 12 SKIP relation games.top_10_high_tax_games ............................. [[33mSKIP[0m]
[0m20:23:11.629528 [debug] [Thread-1 (]: Finished running node model.games.top_10_high_tax_games
[0m20:23:11.629971 [debug] [Thread-1 (]: Began running node model.games.top_10_most_expensive_games
[0m20:23:11.630433 [info ] [Thread-1 (]: 12 of 12 SKIP relation games.top_10_most_expensive_games ....................... [[33mSKIP[0m]
[0m20:23:11.630950 [debug] [Thread-1 (]: Finished running node model.games.top_10_most_expensive_games
[0m20:23:11.632652 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:23:11.633169 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m20:23:11.633653 [info ] [MainThread]: 
[0m20:23:11.634123 [info ] [MainThread]: Finished running 12 table models in 0 hours 0 minutes and 32.87 seconds (32.87s).
[0m20:23:11.635917 [debug] [MainThread]: Command end result
[0m20:23:11.645053 [info ] [MainThread]: 
[0m20:23:11.645545 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:23:11.645931 [info ] [MainThread]: 
[0m20:23:11.646321 [error] [MainThread]:   Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Unrecognized name: platform_id at [20:9]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m20:23:11.646747 [info ] [MainThread]: 
[0m20:23:11.647170 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=4 TOTAL=12
[0m20:23:11.647885 [debug] [MainThread]: Command `dbt run` failed at 20:23:11.647766 after 33.35 seconds
[0m20:23:11.648363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba59f091b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba5942ce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba55e943d0>]}
[0m20:23:11.648825 [debug] [MainThread]: Flushing usage events
[0m20:23:28.470079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf6960ab00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf6769c070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf6769c0d0>]}


============================== 20:23:28.472310 | 129585a3-b38c-446d-9cfd-a1a239fc0914 ==============================
[0m20:23:28.472310 [info ] [MainThread]: Running with dbt=1.6.5
[0m20:23:28.472913 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:23:28.758296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '129585a3-b38c-446d-9cfd-a1a239fc0914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf68bd9cf0>]}
[0m20:23:28.773956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '129585a3-b38c-446d-9cfd-a1a239fc0914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf6563c9d0>]}
[0m20:23:28.774574 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m20:23:28.787989 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m20:23:28.853324 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:23:28.853909 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m20:23:28.897554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '129585a3-b38c-446d-9cfd-a1a239fc0914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf64d3e350>]}
[0m20:23:28.906768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '129585a3-b38c-446d-9cfd-a1a239fc0914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf654739a0>]}
[0m20:23:28.907281 [info ] [MainThread]: Found 12 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m20:23:28.907631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '129585a3-b38c-446d-9cfd-a1a239fc0914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf654739d0>]}
[0m20:23:28.909136 [info ] [MainThread]: 
[0m20:23:28.909797 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:23:28.911216 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m20:23:28.911633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:23:29.685572 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m20:23:29.686070 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:23:30.369577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '129585a3-b38c-446d-9cfd-a1a239fc0914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf65472890>]}
[0m20:23:30.370375 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:23:30.370771 [info ] [MainThread]: 
[0m20:23:30.372760 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m20:23:30.373259 [info ] [Thread-1 (]: 1 of 12 START sql table model games.dim_developers ............................. [RUN]
[0m20:23:30.373915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m20:23:30.374310 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m20:23:30.381510 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m20:23:30.382182 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 20:23:30.374567 => 20:23:30.381974
[0m20:23:30.382580 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m20:23:30.396914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:31.150225 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m20:23:31.151017 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS developer_id,
    developers_name
FROM
    developers_cte
    );
  
[0m20:23:31.659551 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7759902e-8270-47e5-b6ca-e768066aa00d&page=queryresults
[0m20:23:34.215185 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 20:23:30.382871 => 20:23:34.214967
[0m20:23:34.215954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '129585a3-b38c-446d-9cfd-a1a239fc0914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf65452c20>]}
[0m20:23:34.216527 [info ] [Thread-1 (]: 1 of 12 OK created sql table model games.dim_developers ........................ [[32mCREATE TABLE (84.0 rows, 1.5 KiB processed)[0m in 3.84s]
[0m20:23:34.217150 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m20:23:34.217606 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m20:23:34.218213 [info ] [Thread-1 (]: 2 of 12 START sql table model games.dim_games .................................. [RUN]
[0m20:23:34.218853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m20:23:34.219280 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m20:23:34.227070 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m20:23:34.227862 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 20:23:34.219549 => 20:23:34.227607
[0m20:23:34.228304 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m20:23:34.231034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:34.997177 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m20:23:34.998170 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m20:23:35.556785 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:3cebb012-c60f-47ff-b20f-d94547c71374&page=queryresults
[0m20:23:37.657915 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 20:23:34.228566 => 20:23:37.657707
[0m20:23:37.658700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '129585a3-b38c-446d-9cfd-a1a239fc0914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf65453280>]}
[0m20:23:37.659340 [info ] [Thread-1 (]: 2 of 12 OK created sql table model games.dim_games ............................. [[32mCREATE TABLE (87.0 rows, 24.3 KiB processed)[0m in 3.44s]
[0m20:23:37.659978 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m20:23:37.660439 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m20:23:37.660997 [info ] [Thread-1 (]: 3 of 12 START sql table model games.dim_platforms .............................. [RUN]
[0m20:23:37.661673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m20:23:37.662081 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m20:23:37.665172 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m20:23:37.665928 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 20:23:37.662367 => 20:23:37.665697
[0m20:23:37.666355 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m20:23:37.668827 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:38.422100 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m20:23:38.422804 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m20:23:38.822783 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:83283fb5-5f2e-457a-abf3-79ed08ab3c18&page=queryresults
[0m20:23:41.739495 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 20:23:37.666645 => 20:23:41.739299
[0m20:23:41.740342 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '129585a3-b38c-446d-9cfd-a1a239fc0914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf64c0fa90>]}
[0m20:23:41.740958 [info ] [Thread-1 (]: 3 of 12 OK created sql table model games.dim_platforms ......................... [[32mCREATE TABLE (87.0 rows, 2.0 KiB processed)[0m in 4.08s]
[0m20:23:41.741607 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m20:23:41.742093 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m20:23:41.742587 [info ] [Thread-1 (]: 4 of 12 START sql table model games.dim_price_overview ......................... [RUN]
[0m20:23:41.743402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m20:23:41.743815 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m20:23:41.746935 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m20:23:41.747727 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 20:23:41.744096 => 20:23:41.747490
[0m20:23:41.748194 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m20:23:41.750462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:42.483381 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m20:23:42.484818 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
   SELECT
    initial_price,
    final_price,
    discount_percent AS discount_pct,
    formatted_initial_price,
    formatted_final_price,
    app_id,
    -- Monto del Descuento formateado como decimal con dos decimales
    (
        CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END / 100
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (
        CASE
            WHEN discount_percent > 0 THEN initial_price * (1 - discount_percent / 100) * 1.75
            ELSE initial_price * 1.75
        END
    
    ) AS price_with_tax
    FROM 
        `pristine-flames-400818`.`games`.`raw_games`
)


SELECT
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', FORMAT("%'.2f", price_with_tax / 100)) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m20:23:42.910738 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c2fa41d8-8b92-4d63-96fd-3a6e84b15995&page=queryresults
[0m20:23:45.404158 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 20:23:41.748494 => 20:23:45.403947
[0m20:23:45.404930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '129585a3-b38c-446d-9cfd-a1a239fc0914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf64c3e2f0>]}
[0m20:23:45.405545 [info ] [Thread-1 (]: 4 of 12 OK created sql table model games.dim_price_overview .................... [[32mCREATE TABLE (59.0 rows, 4.2 KiB processed)[0m in 3.66s]
[0m20:23:45.406197 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m20:23:45.406667 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m20:23:45.407222 [info ] [Thread-1 (]: 5 of 12 START sql table model games.dim_publishers ............................. [RUN]
[0m20:23:45.407988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m20:23:45.408414 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m20:23:45.411399 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m20:23:45.412084 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 20:23:45.408710 => 20:23:45.411867
[0m20:23:45.412500 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m20:23:45.414905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:46.193156 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m20:23:46.193948 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m20:23:46.739782 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e7778587-1b9d-4478-8101-c7ca79f1fc1d&page=queryresults
[0m20:23:49.446874 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 20:23:45.412799 => 20:23:49.446689
[0m20:23:49.447711 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '129585a3-b38c-446d-9cfd-a1a239fc0914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf64c2cd00>]}
[0m20:23:49.448283 [info ] [Thread-1 (]: 5 of 12 OK created sql table model games.dim_publishers ........................ [[32mCREATE TABLE (67.0 rows, 1.3 KiB processed)[0m in 4.04s]
[0m20:23:49.448912 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m20:23:49.449390 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m20:23:49.449917 [info ] [Thread-1 (]: 6 of 12 START sql table model games.dim_release ................................ [RUN]
[0m20:23:49.450620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m20:23:49.451036 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m20:23:49.453876 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m20:23:49.454488 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 20:23:49.451366 => 20:23:49.454296
[0m20:23:49.454853 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m20:23:49.456958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:50.157020 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m20:23:50.159740 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m20:23:50.699088 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:400deda2-690c-4d1d-9527-c19adc9693da&page=queryresults
[0m20:23:53.172879 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 20:23:49.455111 => 20:23:53.172693
[0m20:23:53.173654 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '129585a3-b38c-446d-9cfd-a1a239fc0914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf64c2d060>]}
[0m20:23:53.174205 [info ] [Thread-1 (]: 6 of 12 OK created sql table model games.dim_release ........................... [[32mCREATE TABLE (87.0 rows, 1.8 KiB processed)[0m in 3.72s]
[0m20:23:53.174782 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m20:23:53.175240 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m20:23:53.175748 [info ] [Thread-1 (]: 7 of 12 START sql table model games.dim_support_language ....................... [RUN]
[0m20:23:53.176380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m20:23:53.176752 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m20:23:53.179560 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m20:23:53.180165 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 20:23:53.177017 => 20:23:53.179975
[0m20:23:53.180532 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m20:23:53.187577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:53.972957 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m20:23:53.975763 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m20:23:54.638789 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:38c889e7-c0de-45d5-9dec-9ff7bdf41b20&page=queryresults
[0m20:23:57.009369 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 20:23:53.180792 => 20:23:57.008495
[0m20:23:57.012471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '129585a3-b38c-446d-9cfd-a1a239fc0914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf64c5cd30>]}
[0m20:23:57.015040 [info ] [Thread-1 (]: 7 of 12 OK created sql table model games.dim_support_language .................. [[32mCREATE TABLE (87.0 rows, 10.5 KiB processed)[0m in 3.84s]
[0m20:23:57.017907 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m20:23:57.019978 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m20:23:57.022413 [info ] [Thread-1 (]: 8 of 12 START sql table model games.fct_game_pricing ........................... [RUN]
[0m20:23:57.025396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m20:23:57.027257 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m20:23:57.038091 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m20:23:57.039710 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 20:23:57.028577 => 20:23:57.039190
[0m20:23:57.040677 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m20:23:57.045430 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:57.743901 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m20:23:57.744863 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para el análisis de precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        formatted_initial_price,
        formatted_price_with_tax,
        price_with_tax,
        SUM(price_with_tax) AS total_sales,
        SUM(discount_amount) AS total_discounts,
        COUNT(*) AS num_sales,
        MAX(discount_pct) AS max_discount,
        MIN(initial_price) AS min_price,
        MAX(initial_price) AS max_price,
        SUM(price_with_tax) AS total_sales_with_tax,
        SUM(final_price) AS total_sales_with_tax_discounted
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id, platform_id, formatted_initial_price, formatted_price_with_tax, price_with_tax
)

SELECT
    fct.app_id,
    fct.formatted_initial_price,
    fct.total_sales,
    fct.platform_id,
    fct.formatted_price_with_tax,
    fct.total_discounts,
    fct.price_with_tax,
    fct.num_sales,
    fct.max_discount,
    fct.min_price,
    fct.max_price,
    fct.total_sales_with_tax,
    fct.total_sales_with_tax_discounted,
    games.name AS game_name,
    games.description AS game_description,
    games.is_free AS game_is_free,
    games.fullgame_app_id,
    games.fullgame_name,
    games.type,
    games.genre_id,
    games.type_genre,
FROM
    game_sales AS fct
INNER JOIN
    `pristine-flames-400818`.`games`.`dim_games` AS games
ON
    fct.app_id = games.app_id
    );
  
[0m20:23:58.267450 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:07592ab3-516e-4d2a-b74e-f59bfb45d18d&page=queryresults
[0m20:23:58.748908 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: platform_id at [32:22]')
[0m20:23:59.509256 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:1d920096-1270-4fd7-9348-85729ec78a1b&page=queryresults
[0m20:24:00.254674 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:1d920096-1270-4fd7-9348-85729ec78a1b&page=queryresults
[0m20:24:00.255432 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 20:23:57.041362 => 20:24:00.255226
[0m20:24:00.258226 [debug] [Thread-1 (]: Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Unrecognized name: platform_id at [32:22]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m20:24:00.258746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '129585a3-b38c-446d-9cfd-a1a239fc0914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf64c5fb50>]}
[0m20:24:00.259387 [error] [Thread-1 (]: 8 of 12 ERROR creating sql table model games.fct_game_pricing .................. [[31mERROR[0m in 3.23s]
[0m20:24:00.260060 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m20:24:00.261020 [debug] [Thread-1 (]: Began running node model.games.revenue_by_platform_and_game
[0m20:24:00.261488 [info ] [Thread-1 (]: 9 of 12 SKIP relation games.revenue_by_platform_and_game ....................... [[33mSKIP[0m]
[0m20:24:00.261982 [debug] [Thread-1 (]: Finished running node model.games.revenue_by_platform_and_game
[0m20:24:00.262444 [debug] [Thread-1 (]: Began running node model.games.top_10_discounted_games
[0m20:24:00.262914 [info ] [Thread-1 (]: 10 of 12 SKIP relation games.top_10_discounted_games ........................... [[33mSKIP[0m]
[0m20:24:00.263412 [debug] [Thread-1 (]: Finished running node model.games.top_10_discounted_games
[0m20:24:00.263848 [debug] [Thread-1 (]: Began running node model.games.top_10_high_tax_games
[0m20:24:00.264385 [info ] [Thread-1 (]: 11 of 12 SKIP relation games.top_10_high_tax_games ............................. [[33mSKIP[0m]
[0m20:24:00.264883 [debug] [Thread-1 (]: Finished running node model.games.top_10_high_tax_games
[0m20:24:00.265326 [debug] [Thread-1 (]: Began running node model.games.top_10_most_expensive_games
[0m20:24:00.265840 [info ] [Thread-1 (]: 12 of 12 SKIP relation games.top_10_most_expensive_games ....................... [[33mSKIP[0m]
[0m20:24:00.266388 [debug] [Thread-1 (]: Finished running node model.games.top_10_most_expensive_games
[0m20:24:00.267936 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:24:00.268437 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m20:24:00.268950 [info ] [MainThread]: 
[0m20:24:00.269397 [info ] [MainThread]: Finished running 12 table models in 0 hours 0 minutes and 31.36 seconds (31.36s).
[0m20:24:00.271296 [debug] [MainThread]: Command end result
[0m20:24:00.280591 [info ] [MainThread]: 
[0m20:24:00.281075 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:24:00.281442 [info ] [MainThread]: 
[0m20:24:00.281857 [error] [MainThread]:   Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Unrecognized name: platform_id at [32:22]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m20:24:00.282220 [info ] [MainThread]: 
[0m20:24:00.282672 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=4 TOTAL=12
[0m20:24:00.283387 [debug] [MainThread]: Command `dbt run` failed at 20:24:00.283261 after 31.82 seconds
[0m20:24:00.283840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf6960ab00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf68dbc7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf64c5e380>]}
[0m20:24:00.284294 [debug] [MainThread]: Flushing usage events
[0m20:24:38.648421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb4e725bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb4c8c4070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb4c8c40d0>]}


============================== 20:24:38.650570 | e75e9d21-386e-4358-9620-55727bdbe351 ==============================
[0m20:24:38.650570 [info ] [MainThread]: Running with dbt=1.6.5
[0m20:24:38.651036 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:24:38.931589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e75e9d21-386e-4358-9620-55727bdbe351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb4a84ac50>]}
[0m20:24:38.947508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e75e9d21-386e-4358-9620-55727bdbe351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb4a8647c0>]}
[0m20:24:38.948181 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m20:24:38.961897 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m20:24:39.028452 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:24:39.029021 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m20:24:39.072884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e75e9d21-386e-4358-9620-55727bdbe351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb49d562c0>]}
[0m20:24:39.082288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e75e9d21-386e-4358-9620-55727bdbe351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb4a69b910>]}
[0m20:24:39.082761 [info ] [MainThread]: Found 12 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m20:24:39.083115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e75e9d21-386e-4358-9620-55727bdbe351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb4a69b940>]}
[0m20:24:39.084600 [info ] [MainThread]: 
[0m20:24:39.085258 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:24:39.086658 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m20:24:39.087097 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:24:39.829682 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m20:24:39.831539 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:24:40.571116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e75e9d21-386e-4358-9620-55727bdbe351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb4a69a800>]}
[0m20:24:40.574502 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:24:40.576364 [info ] [MainThread]: 
[0m20:24:40.584497 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m20:24:40.586752 [info ] [Thread-1 (]: 1 of 12 START sql table model games.dim_developers ............................. [RUN]
[0m20:24:40.589772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m20:24:40.591757 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m20:24:40.619808 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m20:24:40.621189 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 20:24:40.593130 => 20:24:40.620785
[0m20:24:40.621967 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m20:24:40.641504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:41.394572 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m20:24:41.395372 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS developer_id,
    developers_name
FROM
    developers_cte
    );
  
[0m20:24:41.949910 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:77536e61-f3ad-4eca-99a5-2f73c1dde170&page=queryresults
[0m20:24:44.334923 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 20:24:40.622511 => 20:24:44.334724
[0m20:24:44.336410 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e75e9d21-386e-4358-9620-55727bdbe351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb4a676b90>]}
[0m20:24:44.337153 [info ] [Thread-1 (]: 1 of 12 OK created sql table model games.dim_developers ........................ [[32mCREATE TABLE (84.0 rows, 1.5 KiB processed)[0m in 3.75s]
[0m20:24:44.337872 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m20:24:44.338362 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m20:24:44.338898 [info ] [Thread-1 (]: 2 of 12 START sql table model games.dim_games .................................. [RUN]
[0m20:24:44.339609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m20:24:44.340044 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m20:24:44.349406 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m20:24:44.350377 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 20:24:44.340378 => 20:24:44.350100
[0m20:24:44.350879 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m20:24:44.353696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:45.018720 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m20:24:45.019624 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m20:24:45.450091 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:6f5d51d3-b51d-4547-9a2b-40ce06ede3d5&page=queryresults
[0m20:24:47.808504 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 20:24:44.351203 => 20:24:47.807619
[0m20:24:47.811679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e75e9d21-386e-4358-9620-55727bdbe351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb4a6771f0>]}
[0m20:24:47.814263 [info ] [Thread-1 (]: 2 of 12 OK created sql table model games.dim_games ............................. [[32mCREATE TABLE (87.0 rows, 24.3 KiB processed)[0m in 3.47s]
[0m20:24:47.817124 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m20:24:47.819394 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m20:24:47.821932 [info ] [Thread-1 (]: 3 of 12 START sql table model games.dim_platforms .............................. [RUN]
[0m20:24:47.824949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m20:24:47.826835 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m20:24:47.837440 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m20:24:47.839036 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 20:24:47.828192 => 20:24:47.838534
[0m20:24:47.840044 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m20:24:47.844878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:48.588425 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m20:24:48.589176 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m20:24:49.192304 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f601c8dd-4589-4bd1-8e39-f176c9379227&page=queryresults
[0m20:24:51.544275 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 20:24:47.840726 => 20:24:51.544084
[0m20:24:51.545030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e75e9d21-386e-4358-9620-55727bdbe351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb49c2ffd0>]}
[0m20:24:51.545615 [info ] [Thread-1 (]: 3 of 12 OK created sql table model games.dim_platforms ......................... [[32mCREATE TABLE (87.0 rows, 2.0 KiB processed)[0m in 3.72s]
[0m20:24:51.546248 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m20:24:51.546734 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m20:24:51.547276 [info ] [Thread-1 (]: 4 of 12 START sql table model games.dim_price_overview ......................... [RUN]
[0m20:24:51.547968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m20:24:51.548379 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m20:24:51.551371 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m20:24:51.552059 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 20:24:51.548646 => 20:24:51.551836
[0m20:24:51.552466 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m20:24:51.554742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:52.244277 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m20:24:52.245061 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
   SELECT
    initial_price,
    final_price,
    discount_percent AS discount_pct,
    formatted_initial_price,
    formatted_final_price,
    app_id,
    -- Monto del Descuento formateado como decimal con dos decimales
    (
        CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END / 100
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (
        CASE
            WHEN discount_percent > 0 THEN initial_price * (1 - discount_percent / 100) * 1.75
            ELSE initial_price * 1.75
        END
    
    ) AS price_with_tax
    FROM 
        `pristine-flames-400818`.`games`.`raw_games`
)


SELECT
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', FORMAT("%'.2f", price_with_tax / 100)) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m20:24:52.758157 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e0bd045a-3cdd-45c7-82be-e463ee730751&page=queryresults
[0m20:24:55.185091 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 20:24:51.552728 => 20:24:55.184896
[0m20:24:55.185955 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e75e9d21-386e-4358-9620-55727bdbe351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb49c5e3b0>]}
[0m20:24:55.186635 [info ] [Thread-1 (]: 4 of 12 OK created sql table model games.dim_price_overview .................... [[32mCREATE TABLE (59.0 rows, 4.2 KiB processed)[0m in 3.64s]
[0m20:24:55.187371 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m20:24:55.187867 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m20:24:55.188560 [info ] [Thread-1 (]: 5 of 12 START sql table model games.dim_publishers ............................. [RUN]
[0m20:24:55.189287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m20:24:55.189709 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m20:24:55.192654 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m20:24:55.193322 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 20:24:55.190001 => 20:24:55.193110
[0m20:24:55.193739 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m20:24:55.196658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:55.909139 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m20:24:55.909876 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m20:24:56.309598 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:2505beeb-5743-4662-aee9-0a7a058e35b2&page=queryresults
[0m20:24:58.767203 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 20:24:55.194030 => 20:24:58.766958
[0m20:24:58.768062 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e75e9d21-386e-4358-9620-55727bdbe351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb49c4cd00>]}
[0m20:24:58.768727 [info ] [Thread-1 (]: 5 of 12 OK created sql table model games.dim_publishers ........................ [[32mCREATE TABLE (67.0 rows, 1.3 KiB processed)[0m in 3.58s]
[0m20:24:58.769461 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m20:24:58.770013 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m20:24:58.770734 [info ] [Thread-1 (]: 6 of 12 START sql table model games.dim_release ................................ [RUN]
[0m20:24:58.771510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m20:24:58.772018 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m20:24:58.775521 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m20:24:58.776338 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 20:24:58.772345 => 20:24:58.776060
[0m20:24:58.776799 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m20:24:58.779373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:59.431224 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m20:24:59.431952 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m20:24:59.965634 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7e961f3b-b7a6-48c8-84ea-32d2e58de5db&page=queryresults
[0m20:25:02.334319 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 20:24:58.777131 => 20:25:02.334130
[0m20:25:02.335197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e75e9d21-386e-4358-9620-55727bdbe351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb49c4d0c0>]}
[0m20:25:02.335802 [info ] [Thread-1 (]: 6 of 12 OK created sql table model games.dim_release ........................... [[32mCREATE TABLE (87.0 rows, 1.8 KiB processed)[0m in 3.56s]
[0m20:25:02.336457 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m20:25:02.336922 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m20:25:02.337489 [info ] [Thread-1 (]: 7 of 12 START sql table model games.dim_support_language ....................... [RUN]
[0m20:25:02.338223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m20:25:02.338639 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m20:25:02.341516 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m20:25:02.342182 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 20:25:02.338909 => 20:25:02.341958
[0m20:25:02.342574 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m20:25:02.350476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:03.005032 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m20:25:03.005818 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m20:25:03.515414 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:8ed09b7e-22e4-40f0-b667-16f231610565&page=queryresults
[0m20:25:06.017650 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 20:25:02.342853 => 20:25:06.017457
[0m20:25:06.018503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e75e9d21-386e-4358-9620-55727bdbe351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb49c74220>]}
[0m20:25:06.019107 [info ] [Thread-1 (]: 7 of 12 OK created sql table model games.dim_support_language .................. [[32mCREATE TABLE (87.0 rows, 10.5 KiB processed)[0m in 3.68s]
[0m20:25:06.019795 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m20:25:06.020347 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m20:25:06.020915 [info ] [Thread-1 (]: 8 of 12 START sql table model games.fct_game_pricing ........................... [RUN]
[0m20:25:06.021608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m20:25:06.022017 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m20:25:06.025068 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m20:25:06.025784 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 20:25:06.022283 => 20:25:06.025523
[0m20:25:06.026195 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m20:25:06.028488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:06.713927 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m20:25:06.714731 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para el análisis de precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        formatted_initial_price,
        formatted_price_with_tax,
        price_with_tax,
        SUM(price_with_tax) AS total_sales,
        SUM(discount_amount) AS total_discounts,
        COUNT(*) AS num_sales,
        MAX(discount_pct) AS max_discount,
        MIN(initial_price) AS min_price,
        MAX(initial_price) AS max_price,
        SUM(price_with_tax) AS total_sales_with_tax,
        SUM(final_price) AS total_sales_with_tax_discounted
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id, platform_id, formatted_initial_price, formatted_price_with_tax, price_with_tax
)

SELECT
    fct.app_id,
    fct.formatted_initial_price,
    fct.total_sales,
    fct.formatted_price_with_tax,
    fct.total_discounts,
    fct.price_with_tax,
    fct.num_sales,
    fct.max_discount,
    fct.min_price,
    fct.max_price,
    fct.total_sales_with_tax,
    fct.total_sales_with_tax_discounted,
    games.name AS game_name,
    games.description AS game_description,
    games.is_free AS game_is_free,
    games.fullgame_app_id,
    games.fullgame_name,
    games.type,
    games.genre_id,
    games.type_genre,
FROM
    game_sales AS fct
INNER JOIN
    `pristine-flames-400818`.`games`.`dim_games` AS games
ON
    fct.app_id = games.app_id
    );
  
[0m20:25:07.302716 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:db116398-fed6-492d-9355-9f38be788706&page=queryresults
[0m20:25:07.760964 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: platform_id at [32:22]')
[0m20:25:09.177776 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d6c2f5d7-9484-4015-aaa2-5f8918fcbf56&page=queryresults
[0m20:25:09.651911 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d6c2f5d7-9484-4015-aaa2-5f8918fcbf56&page=queryresults
[0m20:25:09.655205 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 20:25:06.026463 => 20:25:09.654181
[0m20:25:09.659031 [debug] [Thread-1 (]: Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Unrecognized name: platform_id at [32:22]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m20:25:09.659615 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e75e9d21-386e-4358-9620-55727bdbe351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb49c77b20>]}
[0m20:25:09.660185 [error] [Thread-1 (]: 8 of 12 ERROR creating sql table model games.fct_game_pricing .................. [[31mERROR[0m in 3.64s]
[0m20:25:09.660802 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m20:25:09.661839 [debug] [Thread-1 (]: Began running node model.games.revenue_by_platform_and_game
[0m20:25:09.662274 [info ] [Thread-1 (]: 9 of 12 SKIP relation games.revenue_by_platform_and_game ....................... [[33mSKIP[0m]
[0m20:25:09.662743 [debug] [Thread-1 (]: Finished running node model.games.revenue_by_platform_and_game
[0m20:25:09.663235 [debug] [Thread-1 (]: Began running node model.games.top_10_discounted_games
[0m20:25:09.663721 [info ] [Thread-1 (]: 10 of 12 SKIP relation games.top_10_discounted_games ........................... [[33mSKIP[0m]
[0m20:25:09.664228 [debug] [Thread-1 (]: Finished running node model.games.top_10_discounted_games
[0m20:25:09.664699 [debug] [Thread-1 (]: Began running node model.games.top_10_high_tax_games
[0m20:25:09.665163 [info ] [Thread-1 (]: 11 of 12 SKIP relation games.top_10_high_tax_games ............................. [[33mSKIP[0m]
[0m20:25:09.665790 [debug] [Thread-1 (]: Finished running node model.games.top_10_high_tax_games
[0m20:25:09.666296 [debug] [Thread-1 (]: Began running node model.games.top_10_most_expensive_games
[0m20:25:09.666846 [info ] [Thread-1 (]: 12 of 12 SKIP relation games.top_10_most_expensive_games ....................... [[33mSKIP[0m]
[0m20:25:09.667373 [debug] [Thread-1 (]: Finished running node model.games.top_10_most_expensive_games
[0m20:25:09.668902 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:25:09.669272 [debug] [MainThread]: Connection 'model.games.fct_game_pricing' was properly closed.
[0m20:25:09.669732 [info ] [MainThread]: 
[0m20:25:09.670138 [info ] [MainThread]: Finished running 12 table models in 0 hours 0 minutes and 30.58 seconds (30.58s).
[0m20:25:09.671968 [debug] [MainThread]: Command end result
[0m20:25:09.681007 [info ] [MainThread]: 
[0m20:25:09.681594 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:25:09.681993 [info ] [MainThread]: 
[0m20:25:09.682386 [error] [MainThread]:   Database Error in model fct_game_pricing (models/transform/fct_game_pricing.sql)
  Unrecognized name: platform_id at [32:22]
  compiled Code at target/run/games/models/transform/fct_game_pricing.sql
[0m20:25:09.682735 [info ] [MainThread]: 
[0m20:25:09.683161 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=4 TOTAL=12
[0m20:25:09.683748 [debug] [MainThread]: Command `dbt run` failed at 20:25:09.683649 after 31.04 seconds
[0m20:25:09.684149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb4e725bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb4a8647c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb4a699810>]}
[0m20:25:09.684576 [debug] [MainThread]: Flushing usage events
[0m20:25:27.523300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66ef326ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66ed4c4070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66ed4c40d0>]}


============================== 20:25:27.525442 | c25dcbbc-2be1-448d-a0cd-38d0a8a7b1b6 ==============================
[0m20:25:27.525442 [info ] [MainThread]: Running with dbt=1.6.5
[0m20:25:27.525903 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '../dbt/', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/tomi/GCPSteamAnalytics/includes/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir ../dbt/', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:25:27.803394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c25dcbbc-2be1-448d-a0cd-38d0a8a7b1b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66ee962620>]}
[0m20:25:27.818938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c25dcbbc-2be1-448d-a0cd-38d0a8a7b1b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66eb4649d0>]}
[0m20:25:27.819520 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m20:25:27.832999 [debug] [MainThread]: checksum: aab365d456d99653250b9db50d1a1ebb1796991a326d59c2eea7a74da9519161, vars: {}, profile: , target: , version: 1.6.5
[0m20:25:27.898654 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:25:27.899250 [debug] [MainThread]: Partial parsing: updated file: games://models/transform/fct_game_pricing.sql
[0m20:25:27.942803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c25dcbbc-2be1-448d-a0cd-38d0a8a7b1b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66ea952320>]}
[0m20:25:27.952123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c25dcbbc-2be1-448d-a0cd-38d0a8a7b1b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66eb29b9a0>]}
[0m20:25:27.952585 [info ] [MainThread]: Found 12 models, 1 source, 0 exposures, 0 metrics, 508 macros, 0 groups, 0 semantic models
[0m20:25:27.952936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c25dcbbc-2be1-448d-a0cd-38d0a8a7b1b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66eb29b940>]}
[0m20:25:27.954390 [info ] [MainThread]: 
[0m20:25:27.955043 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:25:27.956469 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pristine-flames-400818'
[0m20:25:27.956883 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:28.677101 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pristine-flames-400818, now list_pristine-flames-400818_games)
[0m20:25:28.679113 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:25:29.399089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c25dcbbc-2be1-448d-a0cd-38d0a8a7b1b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66eb299240>]}
[0m20:25:29.402429 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:25:29.404215 [info ] [MainThread]: 
[0m20:25:29.412500 [debug] [Thread-1 (]: Began running node model.games.dim_developers
[0m20:25:29.414768 [info ] [Thread-1 (]: 1 of 12 START sql table model games.dim_developers ............................. [RUN]
[0m20:25:29.417761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pristine-flames-400818_games, now model.games.dim_developers)
[0m20:25:29.419481 [debug] [Thread-1 (]: Began compiling node model.games.dim_developers
[0m20:25:29.426817 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_developers"
[0m20:25:29.427534 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (compile): 20:25:29.419772 => 20:25:29.427338
[0m20:25:29.427905 [debug] [Thread-1 (]: Began executing node model.games.dim_developers
[0m20:25:29.441277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:30.237974 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_developers"
[0m20:25:30.238816 [debug] [Thread-1 (]: On model.games.dim_developers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_developers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_developers`
      
    
    

    OPTIONS()
    as (
      -- dim_developers.sql

-- Crea la dimension de la tabla
WITH developers_cte AS (
    SELECT
        developers AS developers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE developers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS developer_id,
    developers_name
FROM
    developers_cte
    );
  
[0m20:25:30.778907 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:69a6ef69-fb87-4858-ac3f-5121f9948db1&page=queryresults
[0m20:25:33.255088 [debug] [Thread-1 (]: Timing info for model.games.dim_developers (execute): 20:25:29.428167 => 20:25:33.254766
[0m20:25:33.256249 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c25dcbbc-2be1-448d-a0cd-38d0a8a7b1b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66eb274820>]}
[0m20:25:33.257187 [info ] [Thread-1 (]: 1 of 12 OK created sql table model games.dim_developers ........................ [[32mCREATE TABLE (84.0 rows, 1.5 KiB processed)[0m in 3.84s]
[0m20:25:33.258077 [debug] [Thread-1 (]: Finished running node model.games.dim_developers
[0m20:25:33.258687 [debug] [Thread-1 (]: Began running node model.games.dim_games
[0m20:25:33.259425 [info ] [Thread-1 (]: 2 of 12 START sql table model games.dim_games .................................. [RUN]
[0m20:25:33.260302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_developers, now model.games.dim_games)
[0m20:25:33.260841 [debug] [Thread-1 (]: Began compiling node model.games.dim_games
[0m20:25:33.270281 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_games"
[0m20:25:33.271242 [debug] [Thread-1 (]: Timing info for model.games.dim_games (compile): 20:25:33.261225 => 20:25:33.270966
[0m20:25:33.271715 [debug] [Thread-1 (]: Began executing node model.games.dim_games
[0m20:25:33.274224 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:33.988836 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_games"
[0m20:25:33.989643 [debug] [Thread-1 (]: On model.games.dim_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_games`
      
    
    

    OPTIONS()
    as (
      -- dim_games.sql

WITH games_cte AS (
    SELECT
        app_id,
        name,
        description,
        fullgame_app_id,
        fullgame_name,
        type,
        is_free,
        genre_id,
        type_genre
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    g.*
FROM games_cte g
    );
  
[0m20:25:34.518718 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:e4e32144-8b09-4df8-8e05-044afcb4966f&page=queryresults
[0m20:25:36.971058 [debug] [Thread-1 (]: Timing info for model.games.dim_games (execute): 20:25:33.272023 => 20:25:36.970167
[0m20:25:36.974275 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c25dcbbc-2be1-448d-a0cd-38d0a8a7b1b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66eb277190>]}
[0m20:25:36.976898 [info ] [Thread-1 (]: 2 of 12 OK created sql table model games.dim_games ............................. [[32mCREATE TABLE (87.0 rows, 24.3 KiB processed)[0m in 3.71s]
[0m20:25:36.979764 [debug] [Thread-1 (]: Finished running node model.games.dim_games
[0m20:25:36.981827 [debug] [Thread-1 (]: Began running node model.games.dim_platforms
[0m20:25:36.984301 [info ] [Thread-1 (]: 3 of 12 START sql table model games.dim_platforms .............................. [RUN]
[0m20:25:36.987293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_games, now model.games.dim_platforms)
[0m20:25:36.989160 [debug] [Thread-1 (]: Began compiling node model.games.dim_platforms
[0m20:25:37.000205 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_platforms"
[0m20:25:37.001966 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (compile): 20:25:36.990485 => 20:25:37.001322
[0m20:25:37.002848 [debug] [Thread-1 (]: Began executing node model.games.dim_platforms
[0m20:25:37.007674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:37.733465 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_platforms"
[0m20:25:37.734917 [debug] [Thread-1 (]: On model.games.dim_platforms: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_platforms"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_platforms`
      
    
    

    OPTIONS()
    as (
      -- dim_platforms.sql

WITH platforms_cte AS (
    SELECT
        windows, mac, linux
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS platform_id,
    windows,
    mac,
    linux
FROM
    platforms_cte
    );
  
[0m20:25:38.265389 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:feaa398b-cd4b-4321-ae25-9e149b8ec244&page=queryresults
[0m20:25:40.890809 [debug] [Thread-1 (]: Timing info for model.games.dim_platforms (execute): 20:25:37.003410 => 20:25:40.890613
[0m20:25:40.891665 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c25dcbbc-2be1-448d-a0cd-38d0a8a7b1b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66eb277130>]}
[0m20:25:40.892279 [info ] [Thread-1 (]: 3 of 12 OK created sql table model games.dim_platforms ......................... [[32mCREATE TABLE (87.0 rows, 2.0 KiB processed)[0m in 3.91s]
[0m20:25:40.892965 [debug] [Thread-1 (]: Finished running node model.games.dim_platforms
[0m20:25:40.893473 [debug] [Thread-1 (]: Began running node model.games.dim_price_overview
[0m20:25:40.893992 [info ] [Thread-1 (]: 4 of 12 START sql table model games.dim_price_overview ......................... [RUN]
[0m20:25:40.894828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_platforms, now model.games.dim_price_overview)
[0m20:25:40.895281 [debug] [Thread-1 (]: Began compiling node model.games.dim_price_overview
[0m20:25:40.898340 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_price_overview"
[0m20:25:40.899073 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (compile): 20:25:40.895574 => 20:25:40.898856
[0m20:25:40.899521 [debug] [Thread-1 (]: Began executing node model.games.dim_price_overview
[0m20:25:40.901953 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:41.544151 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_price_overview"
[0m20:25:41.544931 [debug] [Thread-1 (]: On model.games.dim_price_overview: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_price_overview"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_price_overview`
      
    
    

    OPTIONS()
    as (
      -- dim_price_overview.sql

-- Calculamos el precio final con impuesto considerando el descuento
WITH price_overview_cte AS (
   SELECT
    initial_price,
    final_price,
    discount_percent AS discount_pct,
    formatted_initial_price,
    formatted_final_price,
    app_id,
    -- Monto del Descuento formateado como decimal con dos decimales
    (
        CASE
            WHEN discount_percent > 0 THEN initial_price * (discount_percent / 100)
            ELSE 0.0
        END / 100
    ) AS discount_amount,

    -- Precio del Juego con Impuesto (75%)
    (
        CASE
            WHEN discount_percent > 0 THEN initial_price * (1 - discount_percent / 100) * 1.75
            ELSE initial_price * 1.75
        END
    
    ) AS price_with_tax
    FROM 
        `pristine-flames-400818`.`games`.`raw_games`
)


SELECT
    app_id,
    initial_price,
    final_price,
    discount_pct,
    discount_amount,
    formatted_initial_price,
    formatted_final_price,
    price_with_tax,
    CONCAT('ARS$ ', FORMAT("%'.2f", price_with_tax / 100)) AS formatted_price_with_tax
FROM price_overview_cte
WHERE 
    (initial_price IS NOT NULL)
    AND (final_price IS NOT NULL)
    AND (discount_pct IS NOT NULL)
    AND (discount_amount IS NOT NULL)
    AND (formatted_initial_price IS NOT NULL)
    AND (formatted_final_price IS NOT NULL)
    AND (price_with_tax IS NOT NULL)
    );
  
[0m20:25:42.073832 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ca61ea75-03e5-4ed4-b981-d0fdf4ce6a42&page=queryresults
[0m20:25:44.473881 [debug] [Thread-1 (]: Timing info for model.games.dim_price_overview (execute): 20:25:40.899808 => 20:25:44.473695
[0m20:25:44.474647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c25dcbbc-2be1-448d-a0cd-38d0a8a7b1b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66ea85e200>]}
[0m20:25:44.475252 [info ] [Thread-1 (]: 4 of 12 OK created sql table model games.dim_price_overview .................... [[32mCREATE TABLE (59.0 rows, 4.2 KiB processed)[0m in 3.58s]
[0m20:25:44.475823 [debug] [Thread-1 (]: Finished running node model.games.dim_price_overview
[0m20:25:44.476266 [debug] [Thread-1 (]: Began running node model.games.dim_publishers
[0m20:25:44.476856 [info ] [Thread-1 (]: 5 of 12 START sql table model games.dim_publishers ............................. [RUN]
[0m20:25:44.477464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_price_overview, now model.games.dim_publishers)
[0m20:25:44.477830 [debug] [Thread-1 (]: Began compiling node model.games.dim_publishers
[0m20:25:44.480528 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_publishers"
[0m20:25:44.481174 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (compile): 20:25:44.478091 => 20:25:44.480955
[0m20:25:44.481540 [debug] [Thread-1 (]: Began executing node model.games.dim_publishers
[0m20:25:44.483733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:45.190269 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_publishers"
[0m20:25:45.192896 [debug] [Thread-1 (]: On model.games.dim_publishers: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_publishers"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_publishers`
      
    
    

    OPTIONS()
    as (
      -- dim_publishers.sql

-- Crea la dimension de la tabla
WITH publishers_cte AS (
    SELECT
        DISTINCT publishers AS publishers_name
    FROM `pristine-flames-400818`.`games`.`raw_games`
    WHERE publishers IS NOT NULL
)

SELECT
    ROW_NUMBER() OVER() AS publisher_id,
    publishers_name
FROM
    publishers_cte
    );
  
[0m20:25:45.689453 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:d2af3149-9f35-4eea-9bfb-bb5d79cf2bda&page=queryresults
[0m20:25:48.347001 [debug] [Thread-1 (]: Timing info for model.games.dim_publishers (execute): 20:25:44.481802 => 20:25:48.346784
[0m20:25:48.347903 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c25dcbbc-2be1-448d-a0cd-38d0a8a7b1b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66ea84cd00>]}
[0m20:25:48.348616 [info ] [Thread-1 (]: 5 of 12 OK created sql table model games.dim_publishers ........................ [[32mCREATE TABLE (67.0 rows, 1.3 KiB processed)[0m in 3.87s]
[0m20:25:48.349420 [debug] [Thread-1 (]: Finished running node model.games.dim_publishers
[0m20:25:48.349957 [debug] [Thread-1 (]: Began running node model.games.dim_release
[0m20:25:48.350549 [info ] [Thread-1 (]: 6 of 12 START sql table model games.dim_release ................................ [RUN]
[0m20:25:48.351374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_publishers, now model.games.dim_release)
[0m20:25:48.351828 [debug] [Thread-1 (]: Began compiling node model.games.dim_release
[0m20:25:48.355099 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_release"
[0m20:25:48.369490 [debug] [Thread-1 (]: Timing info for model.games.dim_release (compile): 20:25:48.352133 => 20:25:48.359820
[0m20:25:48.369992 [debug] [Thread-1 (]: Began executing node model.games.dim_release
[0m20:25:48.372500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:49.106070 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_release"
[0m20:25:49.106855 [debug] [Thread-1 (]: On model.games.dim_release: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_release"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_release`
      
    
    

    OPTIONS()
    as (
      -- dim_release.sql

WITH release_cte AS (
    SELECT
        release_date, coming_soon
    FROM
        `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS release_id,
    release_date,
    coming_soon
FROM release_cte
    );
  
[0m20:25:49.675713 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f64c0b8c-3333-49c4-a772-10e734dae5f4&page=queryresults
[0m20:25:52.100926 [debug] [Thread-1 (]: Timing info for model.games.dim_release (execute): 20:25:48.370287 => 20:25:52.100733
[0m20:25:52.101786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c25dcbbc-2be1-448d-a0cd-38d0a8a7b1b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66ea84cfd0>]}
[0m20:25:52.102396 [info ] [Thread-1 (]: 6 of 12 OK created sql table model games.dim_release ........................... [[32mCREATE TABLE (87.0 rows, 1.8 KiB processed)[0m in 3.75s]
[0m20:25:52.103130 [debug] [Thread-1 (]: Finished running node model.games.dim_release
[0m20:25:52.103759 [debug] [Thread-1 (]: Began running node model.games.dim_support_language
[0m20:25:52.104416 [info ] [Thread-1 (]: 7 of 12 START sql table model games.dim_support_language ....................... [RUN]
[0m20:25:52.105368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_release, now model.games.dim_support_language)
[0m20:25:52.105866 [debug] [Thread-1 (]: Began compiling node model.games.dim_support_language
[0m20:25:52.109413 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.dim_support_language"
[0m20:25:52.110222 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (compile): 20:25:52.106204 => 20:25:52.109978
[0m20:25:52.110691 [debug] [Thread-1 (]: Began executing node model.games.dim_support_language
[0m20:25:52.118798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:52.839846 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.dim_support_language"
[0m20:25:52.840762 [debug] [Thread-1 (]: On model.games.dim_support_language: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.dim_support_language"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`dim_support_language`
      
    
    

    OPTIONS()
    as (
      -- dim_support_language.sql

WITH support_language_cte AS (
    SELECT
        interface_languages,
        subtitles_languages,
        fullaudio_languages
    FROM `pristine-flames-400818`.`games`.`raw_games`
)

SELECT
    ROW_NUMBER() OVER() AS language_id,
    interface_languages,
    subtitles_languages,
    fullaudio_languages
FROM support_language_cte
    );
  
[0m20:25:53.432023 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:4742ef40-a3ad-4baf-bf7d-5a7a7477516f&page=queryresults
[0m20:25:55.559689 [debug] [Thread-1 (]: Timing info for model.games.dim_support_language (execute): 20:25:52.110992 => 20:25:55.559501
[0m20:25:55.560539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c25dcbbc-2be1-448d-a0cd-38d0a8a7b1b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66ea87c9a0>]}
[0m20:25:55.561136 [info ] [Thread-1 (]: 7 of 12 OK created sql table model games.dim_support_language .................. [[32mCREATE TABLE (87.0 rows, 10.5 KiB processed)[0m in 3.46s]
[0m20:25:55.561783 [debug] [Thread-1 (]: Finished running node model.games.dim_support_language
[0m20:25:55.562270 [debug] [Thread-1 (]: Began running node model.games.fct_game_pricing
[0m20:25:55.562810 [info ] [Thread-1 (]: 8 of 12 START sql table model games.fct_game_pricing ........................... [RUN]
[0m20:25:55.563535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.dim_support_language, now model.games.fct_game_pricing)
[0m20:25:55.563966 [debug] [Thread-1 (]: Began compiling node model.games.fct_game_pricing
[0m20:25:55.567240 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.fct_game_pricing"
[0m20:25:55.568035 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (compile): 20:25:55.564239 => 20:25:55.567783
[0m20:25:55.568457 [debug] [Thread-1 (]: Began executing node model.games.fct_game_pricing
[0m20:25:55.570921 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:56.230309 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.fct_game_pricing"
[0m20:25:56.231094 [debug] [Thread-1 (]: On model.games.fct_game_pricing: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.fct_game_pricing"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`fct_game_pricing`
      
    
    

    OPTIONS()
    as (
      -- fct_game_pricing.sql

-- Crea una tabla de hechos para el análisis de precios de juegos
WITH game_sales AS (
    SELECT
        app_id,
        formatted_initial_price,
        formatted_price_with_tax,
        price_with_tax,
        SUM(price_with_tax) AS total_sales,
        SUM(discount_amount) AS total_discounts,
        COUNT(*) AS num_sales,
        MAX(discount_pct) AS max_discount,
        MIN(initial_price) AS min_price,
        MAX(initial_price) AS max_price,
        SUM(price_with_tax) AS total_sales_with_tax,
        SUM(final_price) AS total_sales_with_tax_discounted
    FROM
        `pristine-flames-400818`.`games`.`dim_price_overview`
    GROUP BY app_id, formatted_initial_price, formatted_price_with_tax, price_with_tax
)

SELECT
    fct.app_id,
    fct.formatted_initial_price,
    fct.total_sales,
    fct.formatted_price_with_tax,
    fct.total_discounts,
    fct.price_with_tax,
    fct.num_sales,
    fct.max_discount,
    fct.min_price,
    fct.max_price,
    fct.total_sales_with_tax,
    fct.total_sales_with_tax_discounted,
    games.name AS game_name,
    games.description AS game_description,
    games.is_free AS game_is_free,
    games.fullgame_app_id,
    games.fullgame_name,
    games.type,
    games.genre_id,
    games.type_genre,
FROM
    game_sales AS fct
INNER JOIN
    `pristine-flames-400818`.`games`.`dim_games` AS games
ON
    fct.app_id = games.app_id
    );
  
[0m20:25:56.839603 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:c2648896-7fa9-48df-ba7f-94d47bacd9aa&page=queryresults
[0m20:25:59.832199 [debug] [Thread-1 (]: Timing info for model.games.fct_game_pricing (execute): 20:25:55.568726 => 20:25:59.832010
[0m20:25:59.833058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c25dcbbc-2be1-448d-a0cd-38d0a8a7b1b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66ea87e5f0>]}
[0m20:25:59.833654 [info ] [Thread-1 (]: 8 of 12 OK created sql table model games.fct_game_pricing ...................... [[32mCREATE TABLE (59.0 rows, 28.6 KiB processed)[0m in 4.27s]
[0m20:25:59.834295 [debug] [Thread-1 (]: Finished running node model.games.fct_game_pricing
[0m20:25:59.835216 [debug] [Thread-1 (]: Began running node model.games.revenue_by_platform_and_game
[0m20:25:59.835699 [info ] [Thread-1 (]: 9 of 12 START sql table model games.revenue_by_platform_and_game ............... [RUN]
[0m20:25:59.836384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.fct_game_pricing, now model.games.revenue_by_platform_and_game)
[0m20:25:59.836786 [debug] [Thread-1 (]: Began compiling node model.games.revenue_by_platform_and_game
[0m20:25:59.839822 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.revenue_by_platform_and_game"
[0m20:25:59.840520 [debug] [Thread-1 (]: Timing info for model.games.revenue_by_platform_and_game (compile): 20:25:59.837046 => 20:25:59.840281
[0m20:25:59.840924 [debug] [Thread-1 (]: Began executing node model.games.revenue_by_platform_and_game
[0m20:25:59.843149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:00.549848 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.revenue_by_platform_and_game"
[0m20:26:00.552672 [debug] [Thread-1 (]: On model.games.revenue_by_platform_and_game: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.revenue_by_platform_and_game"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`revenue_by_platform_and_game`
      
    
    

    OPTIONS()
    as (
      -- Informe de Ingresos por Plataforma
SELECT
    s.app_id,
    p.platform_id,
    s.total_sales,
    SUM(CASE WHEN p.windows = 1 THEN s.price_with_tax ELSE 0 END) AS total_sales_windows,
    SUM(CASE WHEN p.mac = 1 THEN s.price_with_tax ELSE 0 END) AS total_sales_mac,
    SUM(CASE WHEN p.linux = 1 THEN s.price_with_tax ELSE 0 END) AS total_sales_linux
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing` s
JOIN
    `pristine-flames-400818`.`games`.`dim_platforms` p ON s.platform_id = p.platform_id
GROUP BY
    s.app_id, p.platform_id, s.total_sales
ORDER BY
    total_sales DESC
    );
  
[0m20:26:01.227068 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:f59008e2-286f-427d-bc09-27f68844bd11&page=queryresults
[0m20:26:01.720012 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name platform_id not found inside s at [24:61]')
[0m20:26:03.145166 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:96dc7063-844a-4956-986f-2ab4b92095c6&page=queryresults
[0m20:26:03.584946 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:96dc7063-844a-4956-986f-2ab4b92095c6&page=queryresults
[0m20:26:03.588002 [debug] [Thread-1 (]: Timing info for model.games.revenue_by_platform_and_game (execute): 20:25:59.841185 => 20:26:03.587029
[0m20:26:03.601439 [debug] [Thread-1 (]: Database Error in model revenue_by_platform_and_game (models/report/revenue_by_platform_and_game.sql)
  Name platform_id not found inside s at [24:61]
  compiled Code at target/run/games/models/report/revenue_by_platform_and_game.sql
[0m20:26:03.602274 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c25dcbbc-2be1-448d-a0cd-38d0a8a7b1b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66ea9b7430>]}
[0m20:26:03.602999 [error] [Thread-1 (]: 9 of 12 ERROR creating sql table model games.revenue_by_platform_and_game ...... [[31mERROR[0m in 3.77s]
[0m20:26:03.603711 [debug] [Thread-1 (]: Finished running node model.games.revenue_by_platform_and_game
[0m20:26:03.604204 [debug] [Thread-1 (]: Began running node model.games.top_10_discounted_games
[0m20:26:03.604711 [info ] [Thread-1 (]: 10 of 12 START sql table model games.top_10_discounted_games ................... [RUN]
[0m20:26:03.605495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.revenue_by_platform_and_game, now model.games.top_10_discounted_games)
[0m20:26:03.605934 [debug] [Thread-1 (]: Began compiling node model.games.top_10_discounted_games
[0m20:26:03.609192 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_discounted_games"
[0m20:26:03.609900 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (compile): 20:26:03.606370 => 20:26:03.609674
[0m20:26:03.610270 [debug] [Thread-1 (]: Began executing node model.games.top_10_discounted_games
[0m20:26:03.620298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:04.358097 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_discounted_games"
[0m20:26:04.361145 [debug] [Thread-1 (]: On model.games.top_10_discounted_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_discounted_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_discounted_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 descuentos más grandes
SELECT
    app_id,
    game_name,
    total_discounts
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY total_discounts DESC
LIMIT 10
    );
  
[0m20:26:04.893031 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:ec01de73-9086-43a6-853a-9c806e33cebf&page=queryresults
[0m20:26:07.270306 [debug] [Thread-1 (]: Timing info for model.games.top_10_discounted_games (execute): 20:26:03.610533 => 20:26:07.269411
[0m20:26:07.273473 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c25dcbbc-2be1-448d-a0cd-38d0a8a7b1b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66ea8714b0>]}
[0m20:26:07.276103 [info ] [Thread-1 (]: 10 of 12 OK created sql table model games.top_10_discounted_games .............. [[32mCREATE TABLE (10.0 rows, 2.6 KiB processed)[0m in 3.67s]
[0m20:26:07.278941 [debug] [Thread-1 (]: Finished running node model.games.top_10_discounted_games
[0m20:26:07.281025 [debug] [Thread-1 (]: Began running node model.games.top_10_high_tax_games
[0m20:26:07.283159 [info ] [Thread-1 (]: 11 of 12 START sql table model games.top_10_high_tax_games ..................... [RUN]
[0m20:26:07.286403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_discounted_games, now model.games.top_10_high_tax_games)
[0m20:26:07.288332 [debug] [Thread-1 (]: Began compiling node model.games.top_10_high_tax_games
[0m20:26:07.294708 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_high_tax_games"
[0m20:26:07.295539 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (compile): 20:26:07.289648 => 20:26:07.295292
[0m20:26:07.295947 [debug] [Thread-1 (]: Began executing node model.games.top_10_high_tax_games
[0m20:26:07.298417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:08.061863 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_high_tax_games"
[0m20:26:08.064583 [debug] [Thread-1 (]: On model.games.top_10_high_tax_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_high_tax_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_high_tax_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos con más impuestos
SELECT
    app_id,
    game_name,
    SUM(total_sales_with_tax) AS total_taxes
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
GROUP BY app_id, game_name
ORDER BY total_taxes DESC, game_name DESC
LIMIT 10
    );
  
[0m20:26:08.638302 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:cfc6194a-36de-4c50-98b4-96b0cd2ea6a4&page=queryresults
[0m20:26:10.799011 [debug] [Thread-1 (]: Timing info for model.games.top_10_high_tax_games (execute): 20:26:07.296208 => 20:26:10.798121
[0m20:26:10.802155 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c25dcbbc-2be1-448d-a0cd-38d0a8a7b1b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66ea822890>]}
[0m20:26:10.804761 [info ] [Thread-1 (]: 11 of 12 OK created sql table model games.top_10_high_tax_games ................ [[32mCREATE TABLE (10.0 rows, 2.6 KiB processed)[0m in 3.52s]
[0m20:26:10.807626 [debug] [Thread-1 (]: Finished running node model.games.top_10_high_tax_games
[0m20:26:10.809731 [debug] [Thread-1 (]: Began running node model.games.top_10_most_expensive_games
[0m20:26:10.812235 [info ] [Thread-1 (]: 12 of 12 START sql table model games.top_10_most_expensive_games ............... [RUN]
[0m20:26:10.815227 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.games.top_10_high_tax_games, now model.games.top_10_most_expensive_games)
[0m20:26:10.817077 [debug] [Thread-1 (]: Began compiling node model.games.top_10_most_expensive_games
[0m20:26:10.827276 [debug] [Thread-1 (]: Writing injected SQL for node "model.games.top_10_most_expensive_games"
[0m20:26:10.828873 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (compile): 20:26:10.818401 => 20:26:10.828355
[0m20:26:10.829830 [debug] [Thread-1 (]: Began executing node model.games.top_10_most_expensive_games
[0m20:26:10.834560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:11.555576 [debug] [Thread-1 (]: Writing runtime sql for node "model.games.top_10_most_expensive_games"
[0m20:26:11.556360 [debug] [Thread-1 (]: On model.games.top_10_most_expensive_games: /* {"app": "dbt", "dbt_version": "1.6.5", "profile_name": "games", "target_name": "dev", "node_id": "model.games.top_10_most_expensive_games"} */

  
    

    create or replace table `pristine-flames-400818`.`games`.`top_10_most_expensive_games`
      
    
    

    OPTIONS()
    as (
      -- Top 10 juegos más caros
SELECT
    app_id,
    game_name,
    max_price,
    formatted_initial_price,
FROM
    `pristine-flames-400818`.`games`.`fct_game_pricing`
ORDER BY max_price DESC
LIMIT 10
    );
  
[0m20:26:12.077029 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pristine-flames-400818&j=bq:US:7f9cb561-f578-4453-b9f7-82164aac7573&page=queryresults
[0m20:26:14.206861 [debug] [Thread-1 (]: Timing info for model.games.top_10_most_expensive_games (execute): 20:26:10.830516 => 20:26:14.205972
[0m20:26:14.210153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c25dcbbc-2be1-448d-a0cd-38d0a8a7b1b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66ea87c880>]}
[0m20:26:14.212753 [info ] [Thread-1 (]: 12 of 12 OK created sql table model games.top_10_most_expensive_games .......... [[32mCREATE TABLE (10.0 rows, 3.3 KiB processed)[0m in 3.40s]
[0m20:26:14.215641 [debug] [Thread-1 (]: Finished running node model.games.top_10_most_expensive_games
[0m20:26:14.221623 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:26:14.223266 [debug] [MainThread]: Connection 'model.games.top_10_most_expensive_games' was properly closed.
[0m20:26:14.223975 [info ] [MainThread]: 
[0m20:26:14.224321 [info ] [MainThread]: Finished running 12 table models in 0 hours 0 minutes and 46.27 seconds (46.27s).
[0m20:26:14.226504 [debug] [MainThread]: Command end result
[0m20:26:14.242016 [info ] [MainThread]: 
[0m20:26:14.242554 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:26:14.242914 [info ] [MainThread]: 
[0m20:26:14.243285 [error] [MainThread]:   Database Error in model revenue_by_platform_and_game (models/report/revenue_by_platform_and_game.sql)
  Name platform_id not found inside s at [24:61]
  compiled Code at target/run/games/models/report/revenue_by_platform_and_game.sql
[0m20:26:14.243635 [info ] [MainThread]: 
[0m20:26:14.243988 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m20:26:14.244563 [debug] [MainThread]: Command `dbt run` failed at 20:26:14.244460 after 46.73 seconds
[0m20:26:14.244954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66ef326ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66ea9e0550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66ea9e1600>]}
[0m20:26:14.245494 [debug] [MainThread]: Flushing usage events
